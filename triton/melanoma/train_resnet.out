File path is /scratch/work/hakkina7/melanoma/
Device is cuda
Training ResNet50 model.
Since there is class imbalance present in some of the data sets, use the following weights in the loss function:
tensor([ 29.1988,   7.6238,   9.6541, 106.0942,   5.6009,   1.9674,  40.3665,
        100.3168], device='cuda:0')


Epoch 1:
Mean loss 2.1138903017299784 - Correctly labeled training images 15.77%
Classified 34.54 % of validation images correctly.
Precision on validation set: [0.09 0.16 0.14 0.   0.43 0.69 0.   0.  ]
Recall on validation set: [0.26 0.14 0.53 0.   0.06 0.5  0.   0.  ]
F1-score on validation set: [0.13 0.15 0.22 0.   0.1  0.58 0.   0.  ]
ROC AUC on validation set: {'AK': 0.68, 'BCC': 0.67, 'BKL': 0.59, 'DF': 0.64, 'MEL': 0.52, 'NV': 0.34, 'SCC': 0.6, 'VASC': 0.51}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            11            9  ...            0             0
true class BCC           29           23  ...            0             0
true class BKL           14           22  ...            0             0
true class DF             1            1  ...            0             0
true class MEL           28           33  ...            0             0
true class NV            34           44  ...            0             0
true class SCC            5            6  ...            0             0
true class VASC           1            2  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.799

Epoch 2:
Mean loss 2.060418345386674 - Correctly labeled training images 25.80%
Classified 25.95 % of validation images correctly.
Precision on validation set: [0.09 0.26 0.12 0.   0.   0.82 0.   0.  ]
Recall on validation set: [0.21 0.07 0.82 0.   0.   0.31 0.   0.  ]
F1-score on validation set: [0.12 0.1  0.21 0.   0.   0.45 0.   0.  ]
ROC AUC on validation set: {'AK': 0.74, 'BCC': 0.69, 'BKL': 0.62, 'DF': 0.63, 'MEL': 0.51, 'NV': 0.31, 'SCC': 0.67, 'VASC': 0.51}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             9            5  ...            0             0
true class BCC           23           11  ...            0             0
true class BKL           13            3  ...            0             0
true class DF             1            1  ...            0             0
true class MEL           26           10  ...            0             0
true class NV            26            9  ...            0             0
true class SCC            3            3  ...            0             0
true class VASC           0            1  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.901

Epoch 3:
Mean loss 1.9831271596511455 - Correctly labeled training images 31.44%
Classified 12.15 % of validation images correctly.
Precision on validation set: [0.09 0.   0.15 0.   0.4  0.75 0.04 0.02]
Recall on validation set: [0.4  0.   0.14 0.   0.11 0.11 0.72 0.23]
F1-score on validation set: [0.15 0.   0.15 0.   0.17 0.19 0.07 0.03]
ROC AUC on validation set: {'AK': 0.71, 'BCC': 0.68, 'BKL': 0.62, 'DF': 0.69, 'MEL': 0.46, 'NV': 0.35, 'SCC': 0.58, 'VASC': 0.49}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            17            0  ...           19             0
true class BCC           40            0  ...           99             5
true class BKL           24            0  ...           75             1
true class DF             2            0  ...            6             0
true class MEL           42            0  ...          112            16
true class NV            48            0  ...          305           144
true class SCC            7            0  ...           23             1
true class VASC           1            0  ...            9             3

[8 rows x 8 columns]

Current validation loss: 2.142

Epoch 4:
Mean loss 1.8877663191184637 - Correctly labeled training images 34.38%
Classified 32.10 % of validation images correctly.
Precision on validation set: [0.11 0.21 0.   0.01 0.39 0.78 0.09 0.19]
Recall on validation set: [0.35 0.18 0.   0.42 0.25 0.45 0.06 0.46]
F1-score on validation set: [0.16 0.2  0.   0.02 0.31 0.57 0.07 0.27]
ROC AUC on validation set: {'AK': 0.76, 'BCC': 0.71, 'BKL': 0.63, 'DF': 0.8, 'MEL': 0.47, 'NV': 0.32, 'SCC': 0.67, 'VASC': 0.37}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            15            4  ...            1             0
true class BCC           34           30  ...            6             3
true class BKL           22           20  ...            2             2
true class DF             2            4  ...            0             0
true class MEL           27           16  ...            1             5
true class NV            35           60  ...           10            15
true class SCC            5            4  ...            2             1
true class VASC           1            2  ...            0             6

[8 rows x 8 columns]

Current validation loss: 1.770

Epoch 5:
Mean loss 1.8730744761811446 - Correctly labeled training images 35.99%
Classified 38.49 % of validation images correctly.
Precision on validation set: [0.1  0.24 0.15 0.   0.41 0.82 0.   0.33]
Recall on validation set: [0.37 0.05 0.6  0.   0.29 0.49 0.   0.46]
F1-score on validation set: [0.16 0.09 0.24 0.   0.34 0.61 0.   0.39]
ROC AUC on validation set: {'AK': 0.8, 'BCC': 0.73, 'BKL': 0.63, 'DF': 0.71, 'MEL': 0.47, 'NV': 0.3, 'SCC': 0.69, 'VASC': 0.44}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            16            4  ...            0             0
true class BCC           38            9  ...            0             1
true class BKL           24            5  ...            0             1
true class DF             2            0  ...            0             0
true class MEL           27            6  ...            0             3
true class NV            38           11  ...            0             6
true class SCC            9            2  ...            0             1
true class VASC           1            1  ...            0             6

[8 rows x 8 columns]

Current validation loss: 1.664

Epoch 6:
Mean loss 1.8272134806455498 - Correctly labeled training images 36.66%
Classified 41.09 % of validation images correctly.
Precision on validation set: [0.1  0.27 0.16 0.08 0.41 0.81 0.08 0.16]
Recall on validation set: [0.33 0.31 0.15 0.08 0.27 0.55 0.47 0.23]
F1-score on validation set: [0.16 0.29 0.15 0.08 0.33 0.66 0.13 0.19]
ROC AUC on validation set: {'AK': 0.77, 'BCC': 0.75, 'BKL': 0.64, 'DF': 0.75, 'MEL': 0.46, 'NV': 0.3, 'SCC': 0.7, 'VASC': 0.47}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            14           11  ...           12             0
true class BCC           33           52  ...           42             2
true class BKL           17           30  ...           31             0
true class DF             2            6  ...            1             0
true class MEL           28           23  ...           34             1
true class NV            33           63  ...           62            12
true class SCC            6            7  ...           15             1
true class VASC           1            1  ...            3             3

[8 rows x 8 columns]

Current validation loss: 1.649

Epoch 7:
Mean loss 1.8060553991456136 - Correctly labeled training images 37.45%
Classified 32.49 % of validation images correctly.
Precision on validation set: [0.08 0.18 0.   0.01 0.35 0.86 0.06 0.12]
Recall on validation set: [0.33 0.09 0.   0.08 0.36 0.42 0.59 0.69]
F1-score on validation set: [0.13 0.12 0.   0.02 0.36 0.57 0.11 0.21]
ROC AUC on validation set: {'AK': 0.8, 'BCC': 0.73, 'BKL': 0.64, 'DF': 0.73, 'MEL': 0.48, 'NV': 0.3, 'SCC': 0.65, 'VASC': 0.34}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            14            5  ...           16             0
true class BCC           47           15  ...           62             8
true class BKL           26           14  ...           47             9
true class DF             2            3  ...            4             0
true class MEL           26           11  ...           51            10
true class NV            45           36  ...          113            35
true class SCC            7            0  ...           19             2
true class VASC           2            1  ...            0             9

/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
[8 rows x 8 columns]

Current validation loss: 1.844

Epoch 8:
Mean loss 1.7856927858166138 - Correctly labeled training images 38.89%
Classified 35.17 % of validation images correctly.
Precision on validation set: [0.11 0.26 0.12 0.   0.34 0.81 0.06 0.13]
Recall on validation set: [0.42 0.07 0.11 0.   0.31 0.48 0.59 0.54]
F1-score on validation set: [0.17 0.1  0.11 0.   0.32 0.6  0.11 0.21]
ROC AUC on validation set: {'AK': 0.8, 'BCC': 0.75, 'BKL': 0.63, 'DF': 0.74, 'MEL': 0.45, 'NV': 0.3, 'SCC': 0.69, 'VASC': 0.34}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            18            2  ...           16             0
true class BCC           41           11  ...           66             6
true class BKL           25            6  ...           48             2
true class DF             2            2  ...            5             0
true class MEL           28            5  ...           46            10
true class NV            41           16  ...           99            28
true class SCC            7            1  ...           19             1
true class VASC           1            0  ...            1             7

[8 rows x 8 columns]

Current validation loss: 1.688

Epoch 9:
Mean loss 1.747557594103016 - Correctly labeled training images 39.42%
Classified 41.09 % of validation images correctly.
Precision on validation set: [0.1  0.38 0.17 0.   0.38 0.82 0.   0.12]
Recall on validation set: [0.56 0.04 0.39 0.   0.29 0.57 0.   0.62]
F1-score on validation set: [0.16 0.07 0.23 0.   0.33 0.67 0.   0.21]
ROC AUC on validation set: {'AK': 0.81, 'BCC': 0.76, 'BKL': 0.65, 'DF': 0.73, 'MEL': 0.48, 'NV': 0.27, 'SCC': 0.73, 'VASC': 0.37}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            24            1  ...            0             0
true class BCC           64            6  ...            2             7
true class BKL           43            1  ...            0             2
true class DF             2            0  ...            1             0
true class MEL           46            3  ...            1            13
true class NV            52            3  ...            0            34
true class SCC           17            2  ...            0             1
true class VASC           2            0  ...            0             8

[8 rows x 8 columns]

Current validation loss: 1.569

Epoch 10:
Mean loss 1.7357203080451076 - Correctly labeled training images 41.15%
Classified 31.39 % of validation images correctly.
Precision on validation set: [0.07 0.25 0.12 0.   0.34 0.92 0.07 0.11]
Recall on validation set: [0.09 0.01 0.11 0.   0.4  0.39 0.97 0.62]
F1-score on validation set: [0.08 0.02 0.11 0.   0.37 0.54 0.12 0.19]
ROC AUC on validation set: {'AK': 0.75, 'BCC': 0.74, 'BKL': 0.64, 'DF': 0.75, 'MEL': 0.46, 'NV': 0.31, 'SCC': 0.69, 'VASC': 0.35}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             4            2  ...           31             1
true class BCC           18            2  ...          104             7
true class BKL           10            1  ...           72             4
true class DF             1            0  ...            7             0
true class MEL            9            1  ...           84             9
true class NV            13            2  ...          134            43
true class SCC            0            0  ...           31             1
true class VASC           0            0  ...            3             8

[8 rows x 8 columns]

Current validation loss: 1.841

Epoch 11:
Mean loss 1.7256024785410342 - Correctly labeled training images 41.45%
Classified 32.02 % of validation images correctly.
Precision on validation set: [0.08 0.   0.15 0.02 0.36 0.9  0.   0.11]
Recall on validation set: [0.74 0.   0.02 0.42 0.37 0.43 0.   0.62]
F1-score on validation set: [0.15 0.   0.03 0.04 0.36 0.58 0.   0.19]
ROC AUC on validation set: {'AK': 0.77, 'BCC': 0.77, 'BKL': 0.62, 'DF': 0.73, 'MEL': 0.49, 'NV': 0.28, 'SCC': 0.72, 'VASC': 0.36}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            32            0  ...            0             0
true class BCC           87            0  ...            0             8
true class BKL           60            0  ...            1             5
true class DF             5            0  ...            0             0
true class MEL           81            0  ...            0            12
true class NV           100            0  ...            0            37
true class SCC           17            0  ...            0             2
true class VASC           2            0  ...            0             8

[8 rows x 8 columns]

Current validation loss: 1.806

Epoch 12:
Mean loss 1.7050380470812885 - Correctly labeled training images 41.15%
Classified 45.74 % of validation images correctly.
Precision on validation set: [0.15 0.3  0.21 0.   0.39 0.8  0.08 0.19]
Recall on validation set: [0.37 0.17 0.21 0.   0.31 0.65 0.41 0.62]
F1-score on validation set: [0.21 0.22 0.21 0.   0.35 0.72 0.14 0.29]
ROC AUC on validation set: {'AK': 0.78, 'BCC': 0.76, 'BKL': 0.64, 'DF': 0.75, 'MEL': 0.48, 'NV': 0.27, 'SCC': 0.74, 'VASC': 0.38}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            16            6  ...           10             0
true class BCC           29           29  ...           47             5
true class BKL           14           16  ...           28             4
true class DF             2            2  ...            2             0
true class MEL           23            8  ...           28             2
true class NV            18           31  ...           31            23
true class SCC            4            5  ...           13             1
true class VASC           0            1  ...            1             8

[8 rows x 8 columns]

Current validation loss: 1.496

Epoch 13:
Mean loss 1.6914150870936902 - Correctly labeled training images 41.91%
Classified 46.37 % of validation images correctly.
Precision on validation set: [0.25 0.27 0.19 0.   0.39 0.84 0.05 0.12]
Recall on validation set: [0.12 0.72 0.08 0.   0.35 0.56 0.03 0.69]
F1-score on validation set: [0.16 0.39 0.12 0.   0.37 0.68 0.04 0.2 ]
ROC AUC on validation set: {'AK': 0.81, 'BCC': 0.79, 'BKL': 0.64, 'DF': 0.77, 'MEL': 0.49, 'NV': 0.25, 'SCC': 0.76, 'VASC': 0.39}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             5           31  ...            1             0
true class BCC            2          120  ...            9             6
true class BKL            6           65  ...            7             5
true class DF             0            9  ...            0             0
true class MEL            4           72  ...            1            13
true class NV             2          118  ...            0            43
true class SCC            1           27  ...            1             1
true class VASC           0            3  ...            0             9

[8 rows x 8 columns]

Current validation loss: 1.479

Epoch 14:
Mean loss 1.6814229083174035 - Correctly labeled training images 42.96%
Classified 39.20 % of validation images correctly.
Precision on validation set: [0.15 0.21 0.16 0.   0.34 0.89 0.06 0.17]
Recall on validation set: [0.3  0.41 0.1  0.   0.42 0.45 0.19 0.77]
F1-score on validation set: [0.2  0.28 0.12 0.   0.38 0.6  0.09 0.28]
ROC AUC on validation set: {'AK': 0.8, 'BCC': 0.78, 'BKL': 0.64, 'DF': 0.72, 'MEL': 0.49, 'NV': 0.26, 'SCC': 0.75, 'VASC': 0.39}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            13           21  ...            5             0
true class BCC           29           69  ...           40             6
true class BKL           11           51  ...           19             5
true class DF             3            6  ...            1             0
true class MEL           12           54  ...           21             8
true class NV            13          105  ...           15            29
true class SCC            7           16  ...            6             1
true class VASC           0            2  ...            1            10

/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
[8 rows x 8 columns]

Current validation loss: 1.631

Epoch 15:
Mean loss 1.666563261758642 - Correctly labeled training images 42.74%
Classified 36.51 % of validation images correctly.
Precision on validation set: [0.13 0.22 0.16 0.02 0.38 0.87 0.12 0.09]
Recall on validation set: [0.37 0.04 0.08 0.58 0.42 0.49 0.12 0.77]
F1-score on validation set: [0.2  0.07 0.11 0.05 0.4  0.62 0.12 0.17]
ROC AUC on validation set: {'AK': 0.8, 'BCC': 0.77, 'BKL': 0.64, 'DF': 0.75, 'MEL': 0.47, 'NV': 0.28, 'SCC': 0.71, 'VASC': 0.23}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            16            2  ...            3             1
true class BCC           35            7  ...            6            16
true class BKL           24            5  ...            6             5
true class DF             3            0  ...            1             0
true class MEL           19            7  ...            9            17
true class NV            16           10  ...            5            55
true class SCC            7            1  ...            4             3
true class VASC           0            0  ...            0            10

[8 rows x 8 columns]

Current validation loss: 1.745

Epoch 16:
Mean loss 1.6489314561950672 - Correctly labeled training images 43.32%
Classified 43.45 % of validation images correctly.
Precision on validation set: [0.15 0.3  0.17 0.05 0.39 0.85 0.03 0.12]
Recall on validation set: [0.33 0.4  0.24 0.08 0.38 0.53 0.03 0.77]
F1-score on validation set: [0.2  0.34 0.2  0.06 0.38 0.65 0.03 0.21]
ROC AUC on validation set: {'AK': 0.8, 'BCC': 0.8, 'BKL': 0.65, 'DF': 0.76, 'MEL': 0.49, 'NV': 0.25, 'SCC': 0.76, 'VASC': 0.32}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            14           19  ...            1             1
true class BCC           27           66  ...           15            10
true class BKL           17           32  ...            9             7
true class DF             2            5  ...            1             0
true class MEL           17           26  ...            3            13
true class NV            10           60  ...            3            42
true class SCC            9           11  ...            1             1
true class VASC           0            2  ...            0            10

[8 rows x 8 columns]

Current validation loss: 1.471

Epoch 17:
Mean loss 1.6340278577917382 - Correctly labeled training images 44.06%
Classified 43.06 % of validation images correctly.
Precision on validation set: [0.2  0.35 0.19 0.03 0.39 0.88 0.12 0.14]
Recall on validation set: [0.05 0.4  0.34 0.42 0.38 0.51 0.09 0.69]
F1-score on validation set: [0.08 0.38 0.25 0.06 0.38 0.65 0.1  0.24]
ROC AUC on validation set: {'AK': 0.8, 'BCC': 0.8, 'BKL': 0.65, 'DF': 0.75, 'MEL': 0.49, 'NV': 0.24, 'SCC': 0.77, 'VASC': 0.33}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             2           17  ...            0             1
true class BCC            2           67  ...           12             8
true class BKL            3           24  ...            9             3
true class DF             0            4  ...            0             0
true class MEL            2           29  ...            2             9
true class NV             1           36  ...            0            33
true class SCC            0           10  ...            3             0
true class VASC           0            2  ...            0             9

[8 rows x 8 columns]

Current validation loss: 1.530

Epoch 18:
Mean loss 1.6195404539913034 - Correctly labeled training images 45.01%
Classified 44.24 % of validation images correctly.
Precision on validation set: [0.19 0.33 0.2  0.   0.41 0.81 0.11 0.09]
Recall on validation set: [0.19 0.11 0.18 0.   0.32 0.62 0.78 0.85]
F1-score on validation set: [0.19 0.16 0.19 0.   0.36 0.7  0.19 0.15]
ROC AUC on validation set: {'AK': 0.82, 'BCC': 0.8, 'BKL': 0.66, 'DF': 0.77, 'MEL': 0.49, 'NV': 0.24, 'SCC': 0.79, 'VASC': 0.28}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             8            4  ...           15             5
true class BCC           15           18  ...           67            22
true class BKL            6            7  ...           46            10
true class DF             1            0  ...            6             1
true class MEL            7            8  ...           42            18
true class NV             4           15  ...           33            62
true class SCC            2            3  ...           25             0
true class VASC           0            0  ...            1            11

[8 rows x 8 columns]

Current validation loss: 1.510

Epoch 19:
Mean loss 1.5920935985793827 - Correctly labeled training images 45.56%
Classified 44.16 % of validation images correctly.
Precision on validation set: [0.11 0.28 0.22 0.   0.35 0.83 0.   0.3 ]
Recall on validation set: [0.65 0.04 0.28 0.   0.4  0.6  0.   0.69]
F1-score on validation set: [0.19 0.07 0.24 0.   0.38 0.7  0.   0.42]
ROC AUC on validation set: {'AK': 0.79, 'BCC': 0.82, 'BKL': 0.64, 'DF': 0.78, 'MEL': 0.48, 'NV': 0.24, 'SCC': 0.78, 'VASC': 0.36}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            28            0  ...            0             0
true class BCC           84            7  ...            1             4
true class BKL           40            4  ...            0             1
true class DF             8            0  ...            0             0
true class MEL           37            4  ...            0             4
true class NV            40            7  ...            0            12
true class SCC           19            2  ...            0             0
true class VASC           1            1  ...            0             9

[8 rows x 8 columns]

Current validation loss: 1.391

Epoch 20:
Mean loss 1.5975801006476587 - Correctly labeled training images 45.04%
Classified 44.01 % of validation images correctly.
Precision on validation set: [0.12 0.37 0.19 0.04 0.41 0.86 0.11 0.15]
Recall on validation set: [0.49 0.19 0.26 0.33 0.28 0.6  0.16 0.85]
F1-score on validation set: [0.2  0.25 0.22 0.07 0.33 0.71 0.13 0.25]
ROC AUC on validation set: {'AK': 0.77, 'BCC': 0.81, 'BKL': 0.65, 'DF': 0.74, 'MEL': 0.54, 'NV': 0.22, 'SCC': 0.78, 'VASC': 0.22}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            21            4  ...            2             0
true class BCC           49           32  ...           14            10
true class BKL           29           10  ...            6             6
true class DF             1            2  ...            1             0
true class MEL           29           15  ...           13            11
true class NV            28           18  ...            3            37
true class SCC           14            4  ...            5             0
true class VASC           0            1  ...            1            11

[8 rows x 8 columns]

Current validation loss: 1.545

Epoch 21:
Mean loss 1.570709148039953 - Correctly labeled training images 45.73%
Classified 48.66 % of validation images correctly.
Precision on validation set: [0.12 0.38 0.23 0.   0.41 0.83 0.08 0.25]
Recall on validation set: [0.7  0.28 0.17 0.   0.38 0.66 0.06 0.69]
F1-score on validation set: [0.21 0.32 0.2  0.   0.39 0.73 0.07 0.37]
ROC AUC on validation set: {'AK': 0.77, 'BCC': 0.83, 'BKL': 0.65, 'DF': 0.73, 'MEL': 0.5, 'NV': 0.23, 'SCC': 0.77, 'VASC': 0.4}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            30            4  ...            2             0
true class BCC           72           46  ...           10             4
true class BKL           49           12  ...            6             2
true class DF             5            2  ...            1             0
true class MEL           36           15  ...            4             5
true class NV            39           33  ...            1            16
true class SCC           17            7  ...            2             0
true class VASC           0            2  ...            0             9

[8 rows x 8 columns]

Current validation loss: 1.367

Epoch 22:
Mean loss 1.557353396426992 - Correctly labeled training images 46.29%
Classified 47.95 % of validation images correctly.
Precision on validation set: [0.15 0.36 0.18 0.   0.4  0.85 0.12 0.26]
Recall on validation set: [0.28 0.43 0.31 0.   0.36 0.6  0.22 0.69]
F1-score on validation set: [0.2  0.39 0.23 0.   0.38 0.7  0.15 0.38]
ROC AUC on validation set: {'AK': 0.81, 'BCC': 0.83, 'BKL': 0.64, 'DF': 0.75, 'MEL': 0.49, 'NV': 0.23, 'SCC': 0.81, 'VASC': 0.36}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            12           16  ...            3             0
true class BCC           22           72  ...           22             5
true class BKL           10           29  ...           11             2
true class DF             3            5  ...            1             0
true class MEL           16           24  ...            8             3
true class NV            11           39  ...            7            15
true class SCC            6           12  ...            7             0
true class VASC           0            1  ...            0             9

[8 rows x 8 columns]

Current validation loss: 1.360

Epoch 23:
Mean loss 1.5387330208479042 - Correctly labeled training images 46.79%
Classified 44.56 % of validation images correctly.
Precision on validation set: [0.11 0.43 0.25 0.01 0.43 0.84 0.11 0.19]
Recall on validation set: [0.79 0.05 0.25 0.08 0.3  0.63 0.12 0.85]
F1-score on validation set: [0.19 0.1  0.25 0.02 0.36 0.72 0.12 0.31]
ROC AUC on validation set: {'AK': 0.78, 'BCC': 0.82, 'BKL': 0.66, 'DF': 0.74, 'MEL': 0.51, 'NV': 0.23, 'SCC': 0.75, 'VASC': 0.3}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            34            2  ...            1             0
true class BCC           88            9  ...           18             8
true class BKL           49            2  ...            3             3
true class DF             5            2  ...            0             0
true class MEL           55            1  ...            7            12
true class NV            63            5  ...            4            25
true class SCC           17            0  ...            4             0
true class VASC           2            0  ...            0            11

[8 rows x 8 columns]

Current validation loss: 1.488

Epoch 24:
Mean loss 1.523626531524237 - Correctly labeled training images 47.13%
Classified 43.69 % of validation images correctly.
Precision on validation set: [0.14 0.44 0.19 0.04 0.41 0.87 0.12 0.15]
Recall on validation set: [0.4  0.14 0.24 0.25 0.35 0.58 0.56 0.92]
F1-score on validation set: [0.2  0.22 0.21 0.07 0.37 0.69 0.2  0.26]
ROC AUC on validation set: {'AK': 0.81, 'BCC': 0.82, 'BKL': 0.64, 'DF': 0.73, 'MEL': 0.51, 'NV': 0.23, 'SCC': 0.77, 'VASC': 0.24}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            17            3  ...           13             1
true class BCC           34           24  ...           55            11
true class BKL           21            5  ...           23             4
true class DF             3            0  ...            2             0
true class MEL           24            5  ...           24            16
true class NV            19           15  ...           16            36
true class SCC            7            3  ...           18             0
true class VASC           0            0  ...            1            12

[8 rows x 8 columns]

Current validation loss: 1.490

Epoch 25:
Mean loss 1.4855895650687654 - Correctly labeled training images 47.44%
Classified 45.43 % of validation images correctly.
Precision on validation set: [0.16 0.36 0.19 0.02 0.42 0.88 0.15 0.26]
Recall on validation set: [0.51 0.33 0.34 0.08 0.38 0.55 0.25 0.69]
F1-score on validation set: [0.24 0.34 0.25 0.03 0.4  0.67 0.19 0.37]
ROC AUC on validation set: {'AK': 0.77, 'BCC': 0.84, 'BKL': 0.6, 'DF': 0.75, 'MEL': 0.5, 'NV': 0.24, 'SCC': 0.8, 'VASC': 0.33}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            22           10  ...            2             1
true class BCC           37           55  ...           22             3
true class BKL           24           16  ...            7             2
true class DF             5            2  ...            0             0
true class MEL           20           26  ...           11             3
true class NV            22           37  ...            3            16
true class SCC           10            4  ...            8             1
true class VASC           0            2  ...            0             9

[8 rows x 8 columns]

Current validation loss: 1.478

Epoch 26:
Mean loss 1.4942599849934082 - Correctly labeled training images 47.68%
Classified 51.50 % of validation images correctly.
Precision on validation set: [0.16 0.39 0.3  0.   0.39 0.85 0.15 0.21]
Recall on validation set: [0.49 0.37 0.28 0.   0.43 0.65 0.28 0.77]
F1-score on validation set: [0.24 0.38 0.29 0.   0.41 0.73 0.2  0.33]
ROC AUC on validation set: {'AK': 0.8, 'BCC': 0.85, 'BKL': 0.61, 'DF': 0.8, 'MEL': 0.49, 'NV': 0.23, 'SCC': 0.81, 'VASC': 0.29}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            21            9  ...            2             0
true class BCC           33           61  ...           27             5
true class BKL           26           15  ...            8             1
true class DF             2            6  ...            1             0
true class MEL           24           20  ...            7             6
true class NV            18           35  ...            5            26
true class SCC            9            9  ...            9             0
true class VASC           0            1  ...            0            10

[8 rows x 8 columns]

Current validation loss: 1.311

Epoch 27:
Mean loss 1.4734369239972593 - Correctly labeled training images 49.38%
Classified 45.35 % of validation images correctly.
Precision on validation set: [0.16 0.4  0.26 0.04 0.36 0.88 0.18 0.15]
Recall on validation set: [0.49 0.17 0.33 0.25 0.49 0.54 0.25 0.92]
F1-score on validation set: [0.24 0.24 0.29 0.07 0.41 0.67 0.21 0.26]
ROC AUC on validation set: {'AK': 0.79, 'BCC': 0.83, 'BKL': 0.63, 'DF': 0.77, 'MEL': 0.48, 'NV': 0.25, 'SCC': 0.8, 'VASC': 0.24}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            21            5  ...            3             1
true class BCC           39           28  ...           19            17
true class BKL           24            6  ...            4             5
true class DF             4            2  ...            1             1
true class MEL           18           10  ...            7             9
true class NV            19           15  ...            2            34
true class SCC            8            4  ...            8             1
true class VASC           0            0  ...            1            12

[8 rows x 8 columns]

Current validation loss: 1.471

Epoch 28:
Mean loss 1.463188956776628 - Correctly labeled training images 48.46%
Classified 48.34 % of validation images correctly.
Precision on validation set: [0.15 0.34 0.21 0.   0.41 0.86 0.12 0.37]
Recall on validation set: [0.35 0.39 0.27 0.   0.36 0.61 0.34 0.77]
F1-score on validation set: [0.21 0.36 0.24 0.   0.38 0.72 0.17 0.5 ]
ROC AUC on validation set: {'AK': 0.77, 'BCC': 0.84, 'BKL': 0.62, 'DF': 0.78, 'MEL': 0.5, 'NV': 0.23, 'SCC': 0.78, 'VASC': 0.38}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            15           13  ...            8             0
true class BCC           27           65  ...           33             2
true class BKL           22           18  ...           16             2
true class DF             3            5  ...            1             0
true class MEL           12           37  ...           16             1
true class NV            16           46  ...           10            12
true class SCC            6            8  ...           11             0
true class VASC           0            2  ...            0            10

/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
[8 rows x 8 columns]

Current validation loss: 1.354

Epoch 29:
Mean loss 1.4498760109820201 - Correctly labeled training images 48.81%
Classified 44.87 % of validation images correctly.
Precision on validation set: [0.17 0.24 0.25 0.04 0.4  0.87 0.1  0.27]
Recall on validation set: [0.33 0.1  0.27 0.25 0.37 0.6  0.66 0.77]
F1-score on validation set: [0.22 0.14 0.26 0.07 0.39 0.71 0.17 0.4 ]
ROC AUC on validation set: {'AK': 0.77, 'BCC': 0.82, 'BKL': 0.63, 'DF': 0.76, 'MEL': 0.5, 'NV': 0.24, 'SCC': 0.75, 'VASC': 0.25}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            14            3  ...           20             0
true class BCC           25           16  ...           70             7
true class BKL           14            9  ...           28             1
true class DF             2            1  ...            3             1
true class MEL           12           15  ...           39             3
true class NV            12           23  ...           33            15
true class SCC            5            0  ...           21             0
true class VASC           0            1  ...            1            10

[8 rows x 8 columns]

Current validation loss: 1.420

Epoch 30:
Mean loss 1.4399398593496449 - Correctly labeled training images 48.64%
Classified 42.27 % of validation images correctly.
Precision on validation set: [0.16 0.41 0.23 0.   0.36 0.92 0.11 0.1 ]
Recall on validation set: [0.44 0.39 0.41 0.   0.46 0.43 0.16 0.92]
F1-score on validation set: [0.23 0.4  0.3  0.   0.41 0.59 0.13 0.18]
ROC AUC on validation set: {'AK': 0.79, 'BCC': 0.85, 'BKL': 0.61, 'DF': 0.82, 'MEL': 0.46, 'NV': 0.25, 'SCC': 0.84, 'VASC': 0.16}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            19           11  ...            4             1
true class BCC           28           65  ...           25            18
true class BKL           26           14  ...            3             4
true class DF             3            6  ...            0             1
true class MEL           21           17  ...            6            11
true class NV            16           33  ...            1            70
true class SCC            8           13  ...            5             1
true class VASC           0            1  ...            0            12

[8 rows x 8 columns]

Current validation loss: 1.556

Epoch 31:
Mean loss 1.423608362956754 - Correctly labeled training images 49.34%
Classified 50.16 % of validation images correctly.
Precision on validation set: [0.15 0.44 0.21 0.   0.51 0.85 0.23 0.29]
Recall on validation set: [0.44 0.37 0.53 0.   0.26 0.64 0.22 0.85]
F1-score on validation set: [0.22 0.4  0.3  0.   0.35 0.73 0.23 0.43]
ROC AUC on validation set: {'AK': 0.79, 'BCC': 0.86, 'BKL': 0.61, 'DF': 0.82, 'MEL': 0.48, 'NV': 0.23, 'SCC': 0.83, 'VASC': 0.36}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            19           11  ...            1             0
true class BCC           34           62  ...           13             6
true class BKL           19           15  ...            1             1
true class DF             3            6  ...            0             0
true class MEL           19           16  ...            5             2
true class NV            21           22  ...            3            18
true class SCC           11            8  ...            7             0
true class VASC           0            1  ...            0            11

[8 rows x 8 columns]

Current validation loss: 1.314

Epoch 32:
Mean loss 1.413750710876582 - Correctly labeled training images 50.44%
Classified 50.63 % of validation images correctly.
Precision on validation set: [0.19 0.44 0.28 0.08 0.4  0.85 0.22 0.19]
Recall on validation set: [0.42 0.41 0.4  0.33 0.37 0.61 0.25 1.  ]
F1-score on validation set: [0.26 0.42 0.33 0.13 0.38 0.71 0.23 0.31]
ROC AUC on validation set: {'AK': 0.79, 'BCC': 0.86, 'BKL': 0.62, 'DF': 0.78, 'MEL': 0.5, 'NV': 0.22, 'SCC': 0.82, 'VASC': 0.23}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            18           14  ...            3             1
true class BCC           22           68  ...            9            15
true class BKL           17           13  ...            3             3
true class DF             2            2  ...            1             2
true class MEL           22           17  ...           10             6
true class NV            13           31  ...            3            30
true class SCC            3           10  ...            8             0
true class VASC           0            0  ...            0            13

[8 rows x 8 columns]

Current validation loss: 1.331

Epoch 33:
Mean loss 1.38875588022572 - Correctly labeled training images 50.50%
Classified 51.03 % of validation images correctly.
Precision on validation set: [0.22 0.41 0.33 0.04 0.45 0.84 0.16 0.2 ]
Recall on validation set: [0.23 0.36 0.24 0.58 0.36 0.68 0.19 0.92]
F1-score on validation set: [0.23 0.38 0.28 0.07 0.4  0.75 0.17 0.33]
ROC AUC on validation set: {'AK': 0.79, 'BCC': 0.88, 'BKL': 0.62, 'DF': 0.74, 'MEL': 0.49, 'NV': 0.22, 'SCC': 0.82, 'VASC': 0.19}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            10           15  ...            4             1
true class BCC           12           60  ...           11            12
true class BKL            9           14  ...            5             3
true class DF             0            3  ...            1             0
true class MEL            5           26  ...            8             3
true class NV             5           20  ...            2            28
true class SCC            4            9  ...            6             0
true class VASC           0            0  ...            0            12

[8 rows x 8 columns]

Current validation loss: 1.309

Epoch 34:
Mean loss 1.3567250864550895 - Correctly labeled training images 51.19%
Classified 52.52 % of validation images correctly.
Precision on validation set: [0.18 0.43 0.27 0.   0.42 0.88 0.18 0.43]
Recall on validation set: [0.35 0.46 0.47 0.   0.4  0.62 0.47 0.77]
F1-score on validation set: [0.24 0.45 0.35 0.   0.41 0.73 0.26 0.56]
ROC AUC on validation set: {'AK': 0.77, 'BCC': 0.87, 'BKL': 0.6, 'DF': 0.78, 'MEL': 0.48, 'NV': 0.24, 'SCC': 0.77, 'VASC': 0.5}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            15           15  ...            6             0
true class BCC           20           77  ...           28             1
true class BKL           13           15  ...            6             2
true class DF             2            5  ...            1             0
true class MEL           15           22  ...           17             1
true class NV            13           35  ...           11             9
true class SCC            6            8  ...           15             0
true class VASC           0            1  ...            0            10

[8 rows x 8 columns]

Current validation loss: 1.273

Epoch 35:
Mean loss 1.3576359147153065 - Correctly labeled training images 50.64%
Classified 50.39 % of validation images correctly.
Precision on validation set: [0.13 0.51 0.33 0.02 0.4  0.84 0.16 0.32]
Recall on validation set: [0.72 0.13 0.24 0.08 0.43 0.68 0.25 0.85]
F1-score on validation set: [0.22 0.2  0.28 0.04 0.41 0.75 0.2  0.47]
ROC AUC on validation set: {'AK': 0.76, 'BCC': 0.87, 'BKL': 0.61, 'DF': 0.78, 'MEL': 0.48, 'NV': 0.23, 'SCC': 0.79, 'VASC': 0.45}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            31            1  ...            4             0
true class BCC           73           21  ...           27             2
true class BKL           43            3  ...            4             1
true class DF             6            0  ...            1             0
true class MEL           40            6  ...            3             4
true class NV            34            9  ...            2            16
true class SCC           15            0  ...            8             0
true class VASC           0            1  ...            0            11

/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
[8 rows x 8 columns]

Current validation loss: 1.266

Epoch 36:
Mean loss 1.3467335241262093 - Correctly labeled training images 50.85%
Classified 42.51 % of validation images correctly.
Precision on validation set: [0.15 0.58 0.23 0.05 0.42 0.88 0.12 0.21]
Recall on validation set: [0.42 0.13 0.44 0.5  0.3  0.53 0.53 0.85]
F1-score on validation set: [0.22 0.21 0.3  0.09 0.35 0.66 0.2  0.33]
ROC AUC on validation set: {'AK': 0.71, 'BCC': 0.84, 'BKL': 0.57, 'DF': 0.72, 'MEL': 0.49, 'NV': 0.27, 'SCC': 0.75, 'VASC': 0.28}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            18            2  ...            9             0
true class BCC           31           22  ...           57             7
true class BKL           20            3  ...           14             3
true class DF             1            1  ...            2             1
true class MEL           25            1  ...           13             7
true class NV            17            9  ...           26            23
true class SCC            8            0  ...           17             1
true class VASC           0            0  ...            1            11

[8 rows x 8 columns]

Current validation loss: 1.548

Epoch 37:
Mean loss 1.3170917370717985 - Correctly labeled training images 52.13%
Classified 55.36 % of validation images correctly.
Precision on validation set: [0.17 0.44 0.29 0.07 0.4  0.83 0.24 0.42]
Recall on validation set: [0.37 0.46 0.28 0.08 0.41 0.71 0.31 0.77]
F1-score on validation set: [0.23 0.45 0.28 0.07 0.4  0.77 0.27 0.54]
ROC AUC on validation set: {'AK': 0.78, 'BCC': 0.87, 'BKL': 0.62, 'DF': 0.79, 'MEL': 0.48, 'NV': 0.22, 'SCC': 0.82, 'VASC': 0.4}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            16           14  ...            2             0
true class BCC           24           76  ...           15             3
true class BKL           21           18  ...            5             1
true class DF             2            4  ...            1             1
true class MEL           17           19  ...            7             1
true class NV            10           31  ...            1             8
true class SCC            6           10  ...           10             0
true class VASC           0            2  ...            0            10

[8 rows x 8 columns]

Current validation loss: 1.158

Epoch 38:
Mean loss 1.2962176924342237 - Correctly labeled training images 51.90%
Classified 45.50 % of validation images correctly.
Precision on validation set: [0.12 0.33 0.33 0.06 0.39 0.88 0.14 0.42]
Recall on validation set: [0.67 0.16 0.15 0.33 0.46 0.57 0.5  0.85]
F1-score on validation set: [0.2  0.21 0.21 0.11 0.42 0.69 0.22 0.56]
ROC AUC on validation set: {'AK': 0.72, 'BCC': 0.85, 'BKL': 0.58, 'DF': 0.72, 'MEL': 0.48, 'NV': 0.27, 'SCC': 0.74, 'VASC': 0.44}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            29            1  ...            8             0
true class BCC           61           26  ...           51             1
true class BKL           48            7  ...           10             1
true class DF             4            1  ...            2             0
true class MEL           43           13  ...           17             1
true class NV            46           29  ...           12            12
true class SCC           12            1  ...           16             0
true class VASC           0            1  ...            0            11

[8 rows x 8 columns]

Current validation loss: 1.424

Epoch 39:
Mean loss 1.2692335893867144 - Correctly labeled training images 52.39%
Classified 51.74 % of validation images correctly.
Precision on validation set: [0.14 0.37 0.28 0.03 0.45 0.85 0.24 0.18]
Recall on validation set: [0.3  0.52 0.36 0.08 0.32 0.65 0.25 0.85]
F1-score on validation set: [0.19 0.43 0.32 0.05 0.37 0.73 0.25 0.3 ]
ROC AUC on validation set: {'AK': 0.77, 'BCC': 0.86, 'BKL': 0.61, 'DF': 0.73, 'MEL': 0.5, 'NV': 0.23, 'SCC': 0.8, 'VASC': 0.2}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            13           20  ...            1             0
true class BCC           25           87  ...           10            11
true class BKL           19           24  ...            2             3
true class DF             2            5  ...            0             1
true class MEL           12           42  ...            6             8
true class NV            13           47  ...            6            26
true class SCC            8           11  ...            8             1
true class VASC           0            1  ...            0            11

[8 rows x 8 columns]

Current validation loss: 1.309

Epoch 40:
Mean loss 1.2615693828284928 - Correctly labeled training images 52.56%
Classified 51.42 % of validation images correctly.
Precision on validation set: [0.2  0.57 0.23 0.06 0.47 0.87 0.16 0.55]
Recall on validation set: [0.44 0.34 0.57 0.25 0.33 0.63 0.22 0.85]
F1-score on validation set: [0.27 0.42 0.33 0.09 0.39 0.73 0.18 0.67]
ROC AUC on validation set: {'AK': 0.76, 'BCC': 0.87, 'BKL': 0.59, 'DF': 0.75, 'MEL': 0.46, 'NV': 0.25, 'SCC': 0.78, 'VASC': 0.45}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            19            6  ...            2             0
true class BCC           24           56  ...           18             1
true class BKL           14            6  ...            5             1
true class DF             2            2  ...            2             0
true class MEL           16           15  ...            5             1
true class NV            13            9  ...            6             6
true class SCC            9            3  ...            7             0
true class VASC           0            1  ...            0            11

[8 rows x 8 columns]

Current validation loss: 1.272

Epoch 41:
Mean loss 1.2485643549108354 - Correctly labeled training images 52.58%
Classified 48.03 % of validation images correctly.
Precision on validation set: [0.16 0.4  0.29 0.06 0.38 0.88 0.19 0.23]
Recall on validation set: [0.56 0.22 0.3  0.42 0.42 0.6  0.44 0.85]
F1-score on validation set: [0.25 0.28 0.29 0.1  0.4  0.71 0.27 0.36]
ROC AUC on validation set: {'AK': 0.74, 'BCC': 0.87, 'BKL': 0.59, 'DF': 0.69, 'MEL': 0.46, 'NV': 0.25, 'SCC': 0.83, 'VASC': 0.31}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            24            6  ...            4             0
true class BCC           33           36  ...           29             8
true class BKL           27            7  ...            6             3
true class DF             2            0  ...            1             0
true class MEL           28            7  ...           11             6
true class NV            26           27  ...            7            20
true class SCC            6            5  ...           14             0
true class VASC           0            1  ...            0            11

[8 rows x 8 columns]

Current validation loss: 1.345

Epoch 42:
Mean loss 1.236607254914681 - Correctly labeled training images 53.70%
Classified 53.86 % of validation images correctly.
Precision on validation set: [0.17 0.58 0.25 0.1  0.47 0.85 0.24 0.38]
Recall on validation set: [0.53 0.42 0.39 0.33 0.4  0.66 0.31 0.92]
F1-score on validation set: [0.26 0.49 0.3  0.15 0.43 0.74 0.27 0.53]
ROC AUC on validation set: {'AK': 0.73, 'BCC': 0.89, 'BKL': 0.6, 'DF': 0.75, 'MEL': 0.49, 'NV': 0.23, 'SCC': 0.78, 'VASC': 0.33}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            23            4  ...            4             0
true class BCC           34           70  ...           13             3
true class BKL           23            9  ...            5             2
true class DF             1            4  ...            1             0
true class MEL           30           13  ...            5             1
true class NV            14           15  ...            3            14
true class SCC           11            4  ...           10             0
true class VASC           0            1  ...            0            12

[8 rows x 8 columns]

Current validation loss: 1.209

Epoch 43:
Mean loss 1.1996831938107306 - Correctly labeled training images 53.46%
Classified 49.45 % of validation images correctly.
Precision on validation set: [0.16 0.47 0.29 0.07 0.38 0.91 0.2  0.39]
Recall on validation set: [0.47 0.45 0.4  0.58 0.43 0.56 0.19 0.85]
F1-score on validation set: [0.24 0.46 0.33 0.13 0.41 0.69 0.19 0.54]
ROC AUC on validation set: {'AK': 0.74, 'BCC': 0.88, 'BKL': 0.58, 'DF': 0.7, 'MEL': 0.5, 'NV': 0.24, 'SCC': 0.76, 'VASC': 0.32}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            20           11  ...            2             0
true class BCC           28           75  ...           10             1
true class BKL           29            9  ...            3             1
true class DF             0            3  ...            0             0
true class MEL           27           21  ...            7             3
true class NV            20           32  ...            2            12
true class SCC            3            8  ...            6             0
true class VASC           0            2  ...            0            11

[8 rows x 8 columns]

Current validation loss: 1.350

Epoch 44:
Mean loss 1.1978818223303425 - Correctly labeled training images 53.97%
Classified 48.90 % of validation images correctly.
Precision on validation set: [0.17 0.48 0.27 0.05 0.38 0.88 0.17 0.3 ]
Recall on validation set: [0.7  0.28 0.28 0.33 0.44 0.6  0.22 0.85]
F1-score on validation set: [0.28 0.35 0.28 0.09 0.4  0.71 0.19 0.44]
ROC AUC on validation set: {'AK': 0.74, 'BCC': 0.87, 'BKL': 0.6, 'DF': 0.73, 'MEL': 0.47, 'NV': 0.25, 'SCC': 0.77, 'VASC': 0.28}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            30            4  ...            3             0
true class BCC           40           47  ...           12             4
true class BKL           36            6  ...            3             2
true class DF             1            4  ...            1             0
true class MEL           33           10  ...            6             3
true class NV            20           22  ...            9            17
true class SCC           13            4  ...            7             0
true class VASC           0            1  ...            0            11

[8 rows x 8 columns]

Current validation loss: 1.320

Epoch 45:
Mean loss 1.1891807743145464 - Correctly labeled training images 54.42%
Classified 52.37 % of validation images correctly.
Precision on validation set: [0.2  0.52 0.36 0.07 0.37 0.86 0.2  0.35]
Recall on validation set: [0.53 0.26 0.29 0.42 0.47 0.65 0.5  1.  ]
F1-score on validation set: [0.29 0.34 0.32 0.12 0.42 0.74 0.28 0.52]
ROC AUC on validation set: {'AK': 0.78, 'BCC': 0.88, 'BKL': 0.62, 'DF': 0.72, 'MEL': 0.46, 'NV': 0.24, 'SCC': 0.8, 'VASC': 0.35}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            23            4  ...            6             0
true class BCC           23           43  ...           31             3
true class BKL           24            8  ...            6             2
true class DF             0            2  ...            1             0
true class MEL           24            9  ...           14             4
true class NV            14           13  ...            7            15
true class SCC            5            4  ...           16             0
true class VASC           0            0  ...            0            13

[8 rows x 8 columns]

Current validation loss: 1.213

Epoch 46:
Mean loss 1.182408440047258 - Correctly labeled training images 54.24%
Classified 53.00 % of validation images correctly.
Precision on validation set: [0.18 0.55 0.32 0.08 0.42 0.84 0.16 0.43]
Recall on validation set: [0.7  0.22 0.27 0.42 0.43 0.69 0.41 0.92]
F1-score on validation set: [0.28 0.31 0.29 0.14 0.42 0.76 0.23 0.59]
ROC AUC on validation set: {'AK': 0.75, 'BCC': 0.86, 'BKL': 0.61, 'DF': 0.72, 'MEL': 0.48, 'NV': 0.25, 'SCC': 0.77, 'VASC': 0.32}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            30            1  ...            5             0
true class BCC           44           36  ...           32             4
true class BKL           32            3  ...            6             2
true class DF             1            1  ...            1             0
true class MEL           30            3  ...           11             1
true class NV            22           19  ...           11             9
true class SCC            9            2  ...           13             0
true class VASC           0            0  ...            0            12

[8 rows x 8 columns]

Current validation loss: 1.235

Epoch 47:
Mean loss 1.1487312338987736 - Correctly labeled training images 55.51%
Classified 52.84 % of validation images correctly.
Precision on validation set: [0.19 0.42 0.28 0.08 0.44 0.89 0.18 0.48]
Recall on validation set: [0.37 0.59 0.38 0.25 0.41 0.6  0.41 0.77]
F1-score on validation set: [0.25 0.49 0.33 0.12 0.42 0.72 0.25 0.59]
ROC AUC on validation set: {'AK': 0.76, 'BCC': 0.89, 'BKL': 0.61, 'DF': 0.68, 'MEL': 0.49, 'NV': 0.23, 'SCC': 0.76, 'VASC': 0.32}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            16           16  ...            6             0
true class BCC           16           98  ...           23             0
true class BKL           21           26  ...            9             2
true class DF             3            3  ...            2             0
true class MEL           12           38  ...           10             2
true class NV            12           38  ...           10             7
true class SCC            6           10  ...           13             0
true class VASC           0            2  ...            0            10

[8 rows x 8 columns]

Current validation loss: 1.274

Epoch 48:
Mean loss 1.1099540150786047 - Correctly labeled training images 55.79%
Classified 49.76 % of validation images correctly.
Precision on validation set: [0.2  0.53 0.27 0.05 0.39 0.9  0.23 0.67]
Recall on validation set: [0.47 0.32 0.3  0.5  0.53 0.57 0.53 0.77]
F1-score on validation set: [0.28 0.4  0.28 0.09 0.45 0.7  0.32 0.71]
ROC AUC on validation set: {'AK': 0.74, 'BCC': 0.87, 'BKL': 0.58, 'DF': 0.68, 'MEL': 0.46, 'NV': 0.26, 'SCC': 0.78, 'VASC': 0.44}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            20            6  ...            4             0
true class BCC           21           54  ...           25             0
true class BKL           20            8  ...            9             1
true class DF             0            2  ...            0             0
true class MEL           18            9  ...           11             1
true class NV            14           18  ...            8             3
true class SCC            5            3  ...           17             0
true class VASC           0            1  ...            0            10

[8 rows x 8 columns]

Current validation loss: 1.282

Epoch 49:
Mean loss 1.1272256555335378 - Correctly labeled training images 55.77%
Classified 50.24 % of validation images correctly.
Precision on validation set: [0.15 0.5  0.3  0.07 0.41 0.89 0.23 0.29]
Recall on validation set: [0.63 0.3  0.28 0.42 0.44 0.61 0.47 0.85]
F1-score on validation set: [0.24 0.37 0.29 0.11 0.42 0.72 0.31 0.43]
ROC AUC on validation set: {'AK': 0.74, 'BCC': 0.87, 'BKL': 0.6, 'DF': 0.76, 'MEL': 0.48, 'NV': 0.25, 'SCC': 0.73, 'VASC': 0.35}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            27            8  ...            3             0
true class BCC           41           50  ...           22             6
true class BKL           32            8  ...            6             2
true class DF             2            2  ...            1             1
true class MEL           32           14  ...           12             2
true class NV            32           17  ...            7            16
true class SCC           12            1  ...           15             0
true class VASC           0            1  ...            0            11

/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
[8 rows x 8 columns]

Current validation loss: 1.305

Epoch 50:
Mean loss 1.0980365182793104 - Correctly labeled training images 56.35%
Classified 52.05 % of validation images correctly.
Precision on validation set: [0.16 0.5  0.36 0.14 0.37 0.87 0.15 0.46]
Recall on validation set: [0.51 0.46 0.19 0.25 0.49 0.61 0.5  0.92]
F1-score on validation set: [0.24 0.48 0.25 0.18 0.42 0.72 0.23 0.62]
ROC AUC on validation set: {'AK': 0.76, 'BCC': 0.88, 'BKL': 0.61, 'DF': 0.76, 'MEL': 0.5, 'NV': 0.22, 'SCC': 0.75, 'VASC': 0.37}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            22           13  ...            6             0
true class BCC           20           76  ...           39             2
true class BKL           28           12  ...           15             2
true class DF             1            5  ...            1             0
true class MEL           33           14  ...           18             1
true class NV            25           26  ...           11             9
true class SCC            8            6  ...           16             0
true class VASC           0            1  ...            0            12

[8 rows x 8 columns]

Current validation loss: 1.233

Epoch 51:
Mean loss 1.0867263807765317 - Correctly labeled training images 56.65%
Classified 56.39 % of validation images correctly.
Precision on validation set: [0.17 0.48 0.33 0.14 0.48 0.85 0.21 0.48]
Recall on validation set: [0.42 0.46 0.39 0.5  0.37 0.7  0.47 0.85]
F1-score on validation set: [0.24 0.46 0.36 0.22 0.42 0.77 0.29 0.61]
ROC AUC on validation set: {'AK': 0.76, 'BCC': 0.88, 'BKL': 0.6, 'DF': 0.76, 'MEL': 0.5, 'NV': 0.22, 'SCC': 0.76, 'VASC': 0.35}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            18           13  ...            6             0
true class BCC           23           76  ...           22             3
true class BKL           17           13  ...            5             2
true class DF             1            2  ...            1             0
true class MEL           27           22  ...           12             3
true class NV            17           28  ...            9             4
true class SCC            4            5  ...           15             0
true class VASC           0            1  ...            0            11

[8 rows x 8 columns]

Current validation loss: 1.178

Epoch 52:
Mean loss 1.0431097341166686 - Correctly labeled training images 57.16%
Classified 51.42 % of validation images correctly.
Precision on validation set: [0.29 0.48 0.28 0.08 0.38 0.9  0.19 0.58]
Recall on validation set: [0.26 0.44 0.44 0.25 0.49 0.57 0.66 0.85]
F1-score on validation set: [0.27 0.46 0.34 0.12 0.43 0.69 0.29 0.69]
ROC AUC on validation set: {'AK': 0.75, 'BCC': 0.88, 'BKL': 0.58, 'DF': 0.66, 'MEL': 0.48, 'NV': 0.25, 'SCC': 0.75, 'VASC': 0.41}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            11            9  ...            9             0
true class BCC            9           73  ...           37             2
true class BKL            9           13  ...           11             1
true class DF             0            3  ...            2             0
true class MEL            3           20  ...           21             1
true class NV             4           29  ...           12             4
true class SCC            2            5  ...           21             0
true class VASC           0            1  ...            0            11

[8 rows x 8 columns]

Current validation loss: 1.248

Epoch 53:
Mean loss 1.046729316470751 - Correctly labeled training images 57.31%
Classified 54.02 % of validation images correctly.
Precision on validation set: [0.19 0.45 0.38 0.11 0.47 0.84 0.1  0.3 ]
Recall on validation set: [0.35 0.41 0.31 0.5  0.29 0.72 0.47 1.  ]
F1-score on validation set: [0.24 0.43 0.34 0.18 0.36 0.78 0.17 0.46]
ROC AUC on validation set: {'AK': 0.71, 'BCC': 0.87, 'BKL': 0.6, 'DF': 0.68, 'MEL': 0.53, 'NV': 0.23, 'SCC': 0.72, 'VASC': 0.22}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            15            7  ...           13             0
true class BCC           16           68  ...           41             5
true class BKL           19           11  ...           19             3
true class DF             0            3  ...            1             0
true class MEL           14           29  ...           31             4
true class NV            13           28  ...           26            18
true class SCC            4            4  ...           15             1
true class VASC           0            0  ...            0            13

[8 rows x 8 columns]

Current validation loss: 1.298

Epoch 54:
Mean loss 1.0546847903390035 - Correctly labeled training images 57.51%
Classified 49.29 % of validation images correctly.
Precision on validation set: [0.19 0.53 0.3  0.07 0.4  0.87 0.14 0.24]
Recall on validation set: [0.35 0.31 0.31 0.58 0.42 0.6  0.59 0.92]
F1-score on validation set: [0.25 0.39 0.3  0.13 0.41 0.71 0.22 0.38]
ROC AUC on validation set: {'AK': 0.71, 'BCC': 0.89, 'BKL': 0.59, 'DF': 0.64, 'MEL': 0.5, 'NV': 0.24, 'SCC': 0.7, 'VASC': 0.29}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            15            2  ...           16             0
true class BCC           20           51  ...           42             5
true class BKL           19            6  ...           18             3
true class DF             0            2  ...            1             0
true class MEL           15           14  ...           26             5
true class NV             6           17  ...           17            24
true class SCC            2            3  ...           19             1
true class VASC           0            1  ...            0            12

[8 rows x 8 columns]

Current validation loss: 1.329

Epoch 55:
Mean loss 1.0420814580533784 - Correctly labeled training images 57.76%
Classified 49.53 % of validation images correctly.
Precision on validation set: [0.16 0.47 0.28 0.06 0.41 0.89 0.18 0.5 ]
Recall on validation set: [0.51 0.43 0.4  0.33 0.48 0.55 0.22 0.77]
F1-score on validation set: [0.25 0.45 0.33 0.1  0.44 0.68 0.2  0.61]
ROC AUC on validation set: {'AK': 0.74, 'BCC': 0.87, 'BKL': 0.57, 'DF': 0.72, 'MEL': 0.47, 'NV': 0.26, 'SCC': 0.78, 'VASC': 0.45}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            22           11  ...            2             0
true class BCC           29           71  ...           10             1
true class BKL           25            9  ...            1             2
true class DF             1            4  ...            2             0
true class MEL           33           17  ...            5             1
true class NV            18           29  ...           11             6
true class SCC            6            9  ...            7             0
true class VASC           0            2  ...            0            10

[8 rows x 8 columns]

Current validation loss: 1.307

Epoch 56:
Mean loss 1.0019977676567595 - Correctly labeled training images 58.46%
Classified 57.49 % of validation images correctly.
Precision on validation set: [0.16 0.55 0.3  0.07 0.53 0.81 0.23 0.58]
Recall on validation set: [0.58 0.44 0.33 0.25 0.3  0.77 0.22 0.85]
F1-score on validation set: [0.25 0.49 0.32 0.11 0.38 0.79 0.22 0.69]
ROC AUC on validation set: {'AK': 0.76, 'BCC': 0.9, 'BKL': 0.6, 'DF': 0.76, 'MEL': 0.48, 'NV': 0.22, 'SCC': 0.78, 'VASC': 0.5}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            25            7  ...            0             0
true class BCC           36           73  ...           15             1
true class BKL           32            9  ...            2             1
true class DF             1            4  ...            1             0
true class MEL           33           14  ...            3             2
true class NV            18           17  ...            3             4
true class SCC           11            7  ...            7             0
true class VASC           0            1  ...            0            11

/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
[8 rows x 8 columns]

Current validation loss: 1.107

Epoch 57:
Mean loss 0.9855685375090277 - Correctly labeled training images 59.14%
Classified 54.34 % of validation images correctly.
Precision on validation set: [0.22 0.44 0.3  0.12 0.47 0.88 0.24 0.24]
Recall on validation set: [0.33 0.62 0.44 0.5  0.4  0.62 0.22 1.  ]
F1-score on validation set: [0.26 0.51 0.35 0.19 0.43 0.73 0.23 0.39]
ROC AUC on validation set: {'AK': 0.76, 'BCC': 0.88, 'BKL': 0.57, 'DF': 0.61, 'MEL': 0.5, 'NV': 0.25, 'SCC': 0.76, 'VASC': 0.18}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            14           19  ...            1             0
true class BCC           12          103  ...            5             9
true class BKL           13           22  ...            3             3
true class DF             1            3  ...            1             0
true class MEL           15           31  ...            9             7
true class NV             5           48  ...            3            21
true class SCC            5           10  ...            7             1
true class VASC           0            0  ...            0            13

[8 rows x 8 columns]

Current validation loss: 1.268

Epoch 58:
Mean loss 0.9693698091931899 - Correctly labeled training images 58.82%
Classified 52.92 % of validation images correctly.
Precision on validation set: [0.15 0.53 0.38 0.1  0.41 0.87 0.17 0.43]
Recall on validation set: [0.74 0.29 0.27 0.5  0.47 0.66 0.19 1.  ]
F1-score on validation set: [0.25 0.38 0.32 0.17 0.44 0.75 0.18 0.6 ]
ROC AUC on validation set: {'AK': 0.73, 'BCC': 0.89, 'BKL': 0.6, 'DF': 0.69, 'MEL': 0.46, 'NV': 0.26, 'SCC': 0.77, 'VASC': 0.26}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            32            2  ...            3             0
true class BCC           60           49  ...           10             3
true class BKL           37            8  ...            6             1
true class DF             1            2  ...            1             0
true class MEL           42            7  ...            4             3
true class NV            23           20  ...            6            10
true class SCC           13            4  ...            6             0
true class VASC           0            0  ...            0            13

[8 rows x 8 columns]

Current validation loss: 1.220

Epoch 59:
Mean loss 0.9370611179796303 - Correctly labeled training images 59.57%
Classified 56.07 % of validation images correctly.
Precision on validation set: [0.15 0.51 0.28 0.12 0.53 0.84 0.13 0.48]
Recall on validation set: [0.44 0.53 0.33 0.42 0.27 0.73 0.31 0.85]
F1-score on validation set: [0.23 0.52 0.3  0.19 0.36 0.78 0.19 0.61]
ROC AUC on validation set: {'AK': 0.73, 'BCC': 0.9, 'BKL': 0.58, 'DF': 0.69, 'MEL': 0.49, 'NV': 0.23, 'SCC': 0.76, 'VASC': 0.51}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            19           11  ...            7             0
true class BCC           27           89  ...           18             3
true class BKL           32           15  ...            7             1
true class DF             1            3  ...            1             0
true class MEL           29           20  ...           19             2
true class NV            12           24  ...           13             6
true class SCC            3           11  ...           10             0
true class VASC           0            1  ...            0            11

[8 rows x 8 columns]

Current validation loss: 1.168

Epoch 60:
Mean loss 0.9236175724384537 - Correctly labeled training images 60.12%
Classified 53.55 % of validation images correctly.
Precision on validation set: [0.2  0.52 0.3  0.18 0.41 0.88 0.24 0.29]
Recall on validation set: [0.49 0.38 0.42 0.5  0.51 0.61 0.38 0.92]
F1-score on validation set: [0.28 0.44 0.35 0.27 0.46 0.72 0.29 0.44]
ROC AUC on validation set: {'AK': 0.74, 'BCC': 0.88, 'BKL': 0.58, 'DF': 0.68, 'MEL': 0.46, 'NV': 0.26, 'SCC': 0.78, 'VASC': 0.31}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            21            7  ...            2             0
true class BCC           25           64  ...           25             5
true class BKL           20            9  ...            3             2
true class DF             0            3  ...            1             0
true class MEL           21           14  ...            3             5
true class NV            12           19  ...            4            18
true class SCC            8            5  ...           12             0
true class VASC           0            1  ...            0            12

[8 rows x 8 columns]

Current validation loss: 1.224

Epoch 61:
Mean loss 0.8972624288842506 - Correctly labeled training images 60.78%
Classified 52.76 % of validation images correctly.
Precision on validation set: [0.21 0.52 0.24 0.17 0.43 0.89 0.21 0.48]
Recall on validation set: [0.65 0.47 0.36 0.5  0.44 0.6  0.44 0.92]
F1-score on validation set: [0.32 0.49 0.29 0.26 0.44 0.71 0.28 0.63]
ROC AUC on validation set: {'AK': 0.71, 'BCC': 0.9, 'BKL': 0.59, 'DF': 0.65, 'MEL': 0.47, 'NV': 0.25, 'SCC': 0.71, 'VASC': 0.39}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            28            6  ...            3             0
true class BCC           30           79  ...           17             1
true class BKL           26           15  ...            9             1
true class DF             1            2  ...            1             0
true class MEL           27           17  ...           13             3
true class NV            14           28  ...           10             8
true class SCC            8            6  ...           14             0
true class VASC           0            0  ...            0            12

[8 rows x 8 columns]

Current validation loss: 1.239

Epoch 62:
Mean loss 0.877248475322212 - Correctly labeled training images 60.53%
Classified 53.08 % of validation images correctly.
Precision on validation set: [0.16 0.56 0.26 0.19 0.4  0.88 0.19 0.5 ]
Recall on validation set: [0.6  0.53 0.35 0.25 0.42 0.61 0.28 1.  ]
F1-score on validation set: [0.25 0.54 0.3  0.21 0.41 0.72 0.22 0.67]
ROC AUC on validation set: {'AK': 0.71, 'BCC': 0.9, 'BKL': 0.57, 'DF': 0.75, 'MEL': 0.45, 'NV': 0.26, 'SCC': 0.8, 'VASC': 0.36}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            26           11  ...            2             0
true class BCC           38           88  ...           10             3
true class BKL           34           11  ...            3             1
true class DF             1            4  ...            2             0
true class MEL           33           14  ...           10             2
true class NV            21           24  ...           12             7
true class SCC           11            6  ...            9             0
true class VASC           0            0  ...            0            13

[8 rows x 8 columns]

Current validation loss: 1.216

Epoch 63:
Mean loss 0.8539664272442224 - Correctly labeled training images 61.92%
Classified 55.76 % of validation images correctly.
Precision on validation set: [0.21 0.57 0.31 0.19 0.43 0.89 0.18 0.69]
Recall on validation set: [0.67 0.44 0.39 0.42 0.5  0.64 0.38 0.85]
F1-score on validation set: [0.33 0.5  0.34 0.26 0.46 0.74 0.24 0.76]
ROC AUC on validation set: {'AK': 0.72, 'BCC': 0.9, 'BKL': 0.58, 'DF': 0.72, 'MEL': 0.45, 'NV': 0.25, 'SCC': 0.72, 'VASC': 0.53}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            29            4  ...            1             0
true class BCC           33           73  ...           25             0
true class BKL           24            9  ...            5             0
true class DF             1            3  ...            1             0
true class MEL           24           11  ...           13             1
true class NV            13           23  ...           10             4
true class SCC           11            3  ...           12             0
true class VASC           0            1  ...            0            11

[8 rows x 8 columns]

Current validation loss: 1.159

Epoch 64:
Mean loss 0.8427367995402039 - Correctly labeled training images 61.71%
Classified 58.83 % of validation images correctly.
Precision on validation set: [0.26 0.49 0.43 0.15 0.49 0.83 0.16 0.79]
Recall on validation set: [0.6  0.41 0.32 0.5  0.39 0.75 0.53 0.85]
F1-score on validation set: [0.36 0.45 0.37 0.23 0.44 0.79 0.24 0.81]
ROC AUC on validation set: {'AK': 0.7, 'BCC': 0.88, 'BKL': 0.58, 'DF': 0.66, 'MEL': 0.48, 'NV': 0.25, 'SCC': 0.73, 'VASC': 0.54}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            26            8  ...            7             0
true class BCC           19           69  ...           42             0
true class BKL           17            8  ...           12             1
true class DF             0            2  ...            1             0
true class MEL           25           19  ...           17             0
true class NV             9           31  ...           13             2
true class SCC            5            4  ...           17             0
true class VASC           0            1  ...            0            11

[8 rows x 8 columns]

Current validation loss: 1.133

Epoch 65:
Mean loss 0.7952815889842126 - Correctly labeled training images 63.58%
Classified 53.15 % of validation images correctly.
Precision on validation set: [0.28 0.5  0.28 0.14 0.43 0.9  0.14 0.52]
Recall on validation set: [0.4  0.53 0.4  0.5  0.44 0.59 0.53 0.85]
F1-score on validation set: [0.33 0.51 0.33 0.21 0.44 0.71 0.22 0.65]
ROC AUC on validation set: {'AK': 0.7, 'BCC': 0.87, 'BKL': 0.58, 'DF': 0.57, 'MEL': 0.46, 'NV': 0.28, 'SCC': 0.69, 'VASC': 0.46}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            17            8  ...            8             0
true class BCC           14           89  ...           34             0
true class BKL           10           20  ...           19             1
true class DF             0            2  ...            1             0
true class MEL            6           20  ...           28             2
true class NV            10           34  ...           18             7
true class SCC            3            5  ...           17             0
true class VASC           0            1  ...            0            11

[8 rows x 8 columns]

Current validation loss: 1.306

Epoch 66:
Mean loss 0.8028891911548018 - Correctly labeled training images 63.03%
Classified 55.60 % of validation images correctly.
Precision on validation set: [0.21 0.55 0.34 0.12 0.43 0.88 0.27 0.28]
Recall on validation set: [0.63 0.51 0.34 0.5  0.48 0.64 0.31 0.85]
F1-score on validation set: [0.32 0.53 0.34 0.19 0.45 0.74 0.29 0.42]
ROC AUC on validation set: {'AK': 0.72, 'BCC': 0.9, 'BKL': 0.59, 'DF': 0.53, 'MEL': 0.49, 'NV': 0.25, 'SCC': 0.78, 'VASC': 0.23}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            27            7  ...            0             0
true class BCC           28           86  ...            7             6
true class BKL           22           13  ...            4             1
true class DF             0            2  ...            1             1
true class MEL           23           19  ...            7             2
true class NV            16           22  ...            8            18
true class SCC           10            7  ...           10             0
true class VASC           0            1  ...            0            11

[8 rows x 8 columns]

Current validation loss: 1.221

Epoch 67:
Mean loss 0.8024163249445262 - Correctly labeled training images 63.21%
Classified 55.52 % of validation images correctly.
Precision on validation set: [0.17 0.55 0.29 0.27 0.47 0.88 0.26 0.41]
Recall on validation set: [0.56 0.53 0.51 0.33 0.42 0.63 0.25 0.69]
F1-score on validation set: [0.26 0.54 0.37 0.3  0.45 0.74 0.25 0.51]
ROC AUC on validation set: {'AK': 0.73, 'BCC': 0.91, 'BKL': 0.57, 'DF': 0.72, 'MEL': 0.46, 'NV': 0.24, 'SCC': 0.78, 'VASC': 0.56}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            24           11  ...            0             0
true class BCC           33           89  ...            7             2
true class BKL           24           11  ...            4             1
true class DF             2            3  ...            1             0
true class MEL           26           15  ...            5             2
true class NV            20           23  ...            6             8
true class SCC           13            8  ...            8             0
true class VASC           0            2  ...            0             9

[8 rows x 8 columns]

Current validation loss: 1.169

Epoch 68:
Mean loss 0.7691739616615915 - Correctly labeled training images 64.00%
Classified 55.76 % of validation images correctly.
Precision on validation set: [0.25 0.47 0.29 0.14 0.46 0.87 0.21 0.48]
Recall on validation set: [0.47 0.43 0.45 0.42 0.48 0.65 0.38 0.85]
F1-score on validation set: [0.32 0.45 0.36 0.2  0.47 0.75 0.27 0.61]
ROC AUC on validation set: {'AK': 0.73, 'BCC': 0.89, 'BKL': 0.57, 'DF': 0.65, 'MEL': 0.46, 'NV': 0.27, 'SCC': 0.72, 'VASC': 0.42}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            20            9  ...            3             0
true class BCC           20           71  ...           19             3
true class BKL           15           11  ...            9             1
true class DF             1            3  ...            1             0
true class MEL            9           19  ...            6             2
true class NV             8           30  ...            6             6
true class SCC            8            7  ...           12             0
true class VASC           0            1  ...            0            11

[8 rows x 8 columns]

Current validation loss: 1.171

Epoch 69:
Mean loss 0.743781763813473 - Correctly labeled training images 64.16%
Classified 55.68 % of validation images correctly.
Precision on validation set: [0.22 0.55 0.26 0.18 0.48 0.88 0.24 0.45]
Recall on validation set: [0.51 0.46 0.58 0.17 0.46 0.64 0.22 0.69]
F1-score on validation set: [0.31 0.5  0.36 0.17 0.47 0.74 0.23 0.55]
ROC AUC on validation set: {'AK': 0.71, 'BCC': 0.91, 'BKL': 0.56, 'DF': 0.74, 'MEL': 0.47, 'NV': 0.24, 'SCC': 0.79, 'VASC': 0.56}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            22            7  ...            2             0
true class BCC           30           77  ...            8             0
true class BKL           13            9  ...            5             1
true class DF             1            5  ...            1             0
true class MEL           18           15  ...            2             2
true class NV            10           16  ...            4             7
true class SCC            6            8  ...            7             1
true class VASC           0            2  ...            0             9

[8 rows x 8 columns]

Current validation loss: 1.180

Epoch 70:
Mean loss 0.7240586052839688 - Correctly labeled training images 64.88%
Classified 54.42 % of validation images correctly.
Precision on validation set: [0.22 0.53 0.26 0.13 0.49 0.87 0.16 0.6 ]
Recall on validation set: [0.56 0.6  0.53 0.17 0.33 0.62 0.28 0.92]
F1-score on validation set: [0.32 0.57 0.35 0.15 0.39 0.72 0.2  0.73]
ROC AUC on validation set: {'AK': 0.67, 'BCC': 0.91, 'BKL': 0.55, 'DF': 0.74, 'MEL': 0.45, 'NV': 0.27, 'SCC': 0.77, 'VASC': 0.37}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            24           11  ...            3             0
true class BCC           20          101  ...           18             1
true class BKL           19            9  ...            9             1
true class DF             1            6  ...            1             0
true class MEL           23           21  ...            6             2
true class NV            13           32  ...           11             4
true class SCC            8            9  ...            9             0
true class VASC           0            0  ...            0            12

/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
[8 rows x 8 columns]

Current validation loss: 1.208

Epoch 71:
Mean loss 0.6597343139373918 - Correctly labeled training images 66.87%
Classified 60.41 % of validation images correctly.
Precision on validation set: [0.23 0.5  0.35 0.21 0.53 0.85 0.35 0.6 ]
Recall on validation set: [0.49 0.62 0.56 0.5  0.31 0.74 0.25 0.69]
F1-score on validation set: [0.31 0.55 0.43 0.29 0.39 0.79 0.29 0.64]
ROC AUC on validation set: {'AK': 0.71, 'BCC': 0.91, 'BKL': 0.58, 'DF': 0.61, 'MEL': 0.47, 'NV': 0.24, 'SCC': 0.79, 'VASC': 0.55}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            21           14  ...            0             0
true class BCC           16          103  ...            5             0
true class BKL           13           16  ...            3             1
true class DF             1            3  ...            0             0
true class MEL           20           22  ...            3             2
true class NV            12           34  ...            4             3
true class SCC            9           11  ...            8             0
true class VASC           0            3  ...            0             9

[8 rows x 8 columns]

Current validation loss: 1.097

Epoch 72:
Mean loss 0.6601713259560452 - Correctly labeled training images 66.70%
Classified 60.88 % of validation images correctly.
Precision on validation set: [0.28 0.54 0.38 0.31 0.44 0.86 0.29 0.5 ]
Recall on validation set: [0.4  0.67 0.43 0.42 0.48 0.7  0.44 0.92]
F1-score on validation set: [0.33 0.6  0.4  0.36 0.46 0.77 0.35 0.65]
ROC AUC on validation set: {'AK': 0.73, 'BCC': 0.92, 'BKL': 0.59, 'DF': 0.69, 'MEL': 0.48, 'NV': 0.23, 'SCC': 0.77, 'VASC': 0.32}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            17           14  ...            1             0
true class BCC            8          112  ...           13             1
true class BKL           14           13  ...            2             1
true class DF             2            2  ...            1             0
true class MEL           10           25  ...            8             3
true class NV             4           31  ...            9             7
true class SCC            5            9  ...           14             0
true class VASC           0            0  ...            0            12

[8 rows x 8 columns]

Current validation loss: 1.069

Epoch 73:
Mean loss 0.6469067879232698 - Correctly labeled training images 67.43%
Classified 59.07 % of validation images correctly.
Precision on validation set: [0.22 0.58 0.32 0.1  0.49 0.84 0.28 0.59]
Recall on validation set: [0.6  0.52 0.39 0.42 0.4  0.73 0.31 0.77]
F1-score on validation set: [0.32 0.55 0.35 0.17 0.44 0.78 0.29 0.67]
ROC AUC on validation set: {'AK': 0.72, 'BCC': 0.9, 'BKL': 0.57, 'DF': 0.66, 'MEL': 0.43, 'NV': 0.27, 'SCC': 0.76, 'VASC': 0.5}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            26            7  ...            2             0
true class BCC           27           87  ...            6             1
true class BKL           23            7  ...            3             1
true class DF             2            3  ...            0             0
true class MEL           16           14  ...            8             3
true class NV            18           21  ...            7             2
true class SCC            8            9  ...           10             0
true class VASC           0            1  ...            0            10

[8 rows x 8 columns]

Current validation loss: 1.154

Epoch 74:
Mean loss 0.6341537982225418 - Correctly labeled training images 68.05%
Classified 56.07 % of validation images correctly.
Precision on validation set: [0.21 0.56 0.29 0.15 0.44 0.86 0.24 0.61]
Recall on validation set: [0.56 0.44 0.5  0.25 0.45 0.66 0.25 0.85]
F1-score on validation set: [0.3  0.49 0.37 0.19 0.44 0.75 0.25 0.71]
ROC AUC on validation set: {'AK': 0.65, 'BCC': 0.89, 'BKL': 0.58, 'DF': 0.73, 'MEL': 0.48, 'NV': 0.25, 'SCC': 0.76, 'VASC': 0.49}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            24            4  ...            2             0
true class BCC           31           73  ...           12             1
true class BKL           19            7  ...            3             1
true class DF             3            3  ...            0             0
true class MEL           17           14  ...            4             1
true class NV             9           22  ...            4             4
true class SCC           12            6  ...            8             0
true class VASC           0            1  ...            0            11

[8 rows x 8 columns]

Current validation loss: 1.125

Epoch 75:
Mean loss 0.6405606197680961 - Correctly labeled training images 67.53%
Classified 59.38 % of validation images correctly.
Precision on validation set: [0.26 0.54 0.32 0.17 0.48 0.86 0.29 0.73]
Recall on validation set: [0.56 0.62 0.49 0.42 0.36 0.7  0.44 0.62]
F1-score on validation set: [0.35 0.58 0.39 0.24 0.41 0.78 0.35 0.67]
ROC AUC on validation set: {'AK': 0.68, 'BCC': 0.91, 'BKL': 0.59, 'DF': 0.57, 'MEL': 0.47, 'NV': 0.24, 'SCC': 0.73, 'VASC': 0.6}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            24           11  ...            2             0
true class BCC           15          104  ...           11             0
true class BKL           15           15  ...            5             1
true class DF             2            2  ...            1             0
true class MEL           21           23  ...            5             1
true class NV            14           27  ...           10             1
true class SCC            3            9  ...           14             0
true class VASC           0            3  ...            0             8

[8 rows x 8 columns]

Current validation loss: 1.136

Epoch 76:
Mean loss 0.6101303407070389 - Correctly labeled training images 68.43%
Classified 57.49 % of validation images correctly.
Precision on validation set: [0.22 0.59 0.34 0.19 0.47 0.86 0.13 0.64]
Recall on validation set: [0.65 0.46 0.47 0.5  0.44 0.69 0.22 0.54]
F1-score on validation set: [0.33 0.52 0.39 0.27 0.45 0.76 0.16 0.58]
ROC AUC on validation set: {'AK': 0.64, 'BCC': 0.9, 'BKL': 0.59, 'DF': 0.68, 'MEL': 0.45, 'NV': 0.27, 'SCC': 0.7, 'VASC': 0.55}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            28            3  ...            3             0
true class BCC           38           76  ...           18             0
true class BKL           14            7  ...            7             0
true class DF             1            3  ...            1             0
true class MEL           23           14  ...            3             2
true class NV            10           17  ...           16             2
true class SCC           12            4  ...            7             0
true class VASC           0            4  ...            0             7

[8 rows x 8 columns]

Current validation loss: 1.150

Epoch 77:
Mean loss 0.5866179758159896 - Correctly labeled training images 68.89%
Classified 57.97 % of validation images correctly.
Precision on validation set: [0.25 0.59 0.27 0.16 0.52 0.86 0.2  0.69]
Recall on validation set: [0.6  0.54 0.49 0.42 0.39 0.68 0.28 0.85]
F1-score on validation set: [0.36 0.56 0.35 0.23 0.45 0.76 0.23 0.76]
ROC AUC on validation set: {'AK': 0.66, 'BCC': 0.89, 'BKL': 0.59, 'DF': 0.64, 'MEL': 0.48, 'NV': 0.25, 'SCC': 0.71, 'VASC': 0.48}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            26            5  ...            1             0
true class BCC           23           90  ...           12             0
true class BKL           20           13  ...            5             0
true class DF             1            1  ...            2             0
true class MEL           15           15  ...            4             3
true class NV             7           20  ...           12             2
true class SCC           11            6  ...            9             0
true class VASC           0            2  ...            0            11

/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
[8 rows x 8 columns]

Current validation loss: 1.205

Epoch 78:
Mean loss 0.5950796398736701 - Correctly labeled training images 69.20%
Classified 57.33 % of validation images correctly.
Precision on validation set: [0.19 0.56 0.28 0.45 0.5  0.87 0.19 0.82]
Recall on validation set: [0.63 0.44 0.46 0.42 0.47 0.68 0.25 0.69]
F1-score on validation set: [0.29 0.49 0.34 0.43 0.49 0.76 0.22 0.75]
ROC AUC on validation set: {'AK': 0.66, 'BCC': 0.91, 'BKL': 0.59, 'DF': 0.59, 'MEL': 0.47, 'NV': 0.25, 'SCC': 0.75, 'VASC': 0.59}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            27            4  ...            4             0
true class BCC           41           74  ...           12             0
true class BKL           27            6  ...            2             0
true class DF             1            2  ...            1             0
true class MEL           19           16  ...            9             2
true class NV            13           25  ...            6             0
true class SCC           13            4  ...            8             0
true class VASC           0            2  ...            0             9

[8 rows x 8 columns]

Current validation loss: 1.171

Epoch 79:
Mean loss 0.5435726130939432 - Correctly labeled training images 70.93%
Classified 61.59 % of validation images correctly.
Precision on validation set: [0.29 0.49 0.41 0.24 0.53 0.86 0.26 0.52]
Recall on validation set: [0.49 0.65 0.42 0.5  0.44 0.72 0.53 0.85]
F1-score on validation set: [0.36 0.56 0.41 0.32 0.48 0.78 0.35 0.65]
ROC AUC on validation set: {'AK': 0.68, 'BCC': 0.9, 'BKL': 0.58, 'DF': 0.62, 'MEL': 0.47, 'NV': 0.26, 'SCC': 0.71, 'VASC': 0.37}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            21           10  ...            6             0
true class BCC           17          108  ...           16             0
true class BKL           14           19  ...            5             1
true class DF             0            2  ...            1             0
true class MEL           11           28  ...           10             3
true class NV             6           45  ...           10             6
true class SCC            4            8  ...           17             0
true class VASC           0            2  ...            0            11

[8 rows x 8 columns]

Current validation loss: 1.095

Epoch 80:
Mean loss 0.5399485571010255 - Correctly labeled training images 70.58%
Classified 56.86 % of validation images correctly.
Precision on validation set: [0.26 0.58 0.3  0.4  0.4  0.9  0.28 0.7 ]
Recall on validation set: [0.49 0.63 0.4  0.67 0.58 0.59 0.41 0.54]
F1-score on validation set: [0.34 0.61 0.35 0.5  0.47 0.71 0.33 0.61]
ROC AUC on validation set: {'AK': 0.71, 'BCC': 0.91, 'BKL': 0.57, 'DF': 0.65, 'MEL': 0.44, 'NV': 0.26, 'SCC': 0.77, 'VASC': 0.53}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            21           10  ...            1             0
true class BCC           15          106  ...           14             0
true class BKL           19           11  ...            5             1
true class DF             0            2  ...            1             0
true class MEL            8           18  ...            6             1
true class NV            12           26  ...            7             1
true class SCC            5            7  ...           13             0
true class VASC           0            3  ...            0             7

[8 rows x 8 columns]

Current validation loss: 1.162

Epoch 81:
Mean loss 0.500856615367936 - Correctly labeled training images 72.86%
Classified 58.68 % of validation images correctly.
Precision on validation set: [0.26 0.57 0.29 0.23 0.47 0.87 0.26 0.52]
Recall on validation set: [0.51 0.57 0.52 0.25 0.45 0.68 0.16 0.92]
F1-score on validation set: [0.34 0.57 0.37 0.24 0.46 0.76 0.2  0.67]
ROC AUC on validation set: {'AK': 0.69, 'BCC': 0.91, 'BKL': 0.57, 'DF': 0.71, 'MEL': 0.46, 'NV': 0.25, 'SCC': 0.82, 'VASC': 0.4}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            22           10  ...            0             0
true class BCC           18           96  ...            4             4
true class BKL           16           14  ...            1             1
true class DF             2            4  ...            1             0
true class MEL           13           15  ...            3             2
true class NV             8           18  ...            5             3
true class SCC            6           11  ...            5             1
true class VASC           0            1  ...            0            12

[8 rows x 8 columns]

Current validation loss: 1.188

Epoch 82:
Mean loss 0.5137895465555251 - Correctly labeled training images 72.09%
Classified 56.62 % of validation images correctly.
Precision on validation set: [0.27 0.54 0.28 0.26 0.43 0.88 0.21 0.59]
Recall on validation set: [0.51 0.52 0.5  0.42 0.46 0.64 0.25 0.77]
F1-score on validation set: [0.35 0.53 0.36 0.32 0.45 0.75 0.23 0.67]
ROC AUC on validation set: {'AK': 0.68, 'BCC': 0.91, 'BKL': 0.57, 'DF': 0.65, 'MEL': 0.45, 'NV': 0.26, 'SCC': 0.77, 'VASC': 0.53}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            22            7  ...            2             0
true class BCC           17           87  ...           12             2
true class BKL           17           14  ...            1             1
true class DF             1            3  ...            1             0
true class MEL            9           16  ...            6             1
true class NV            10           23  ...            8             2
true class SCC            6            9  ...            8             1
true class VASC           0            1  ...            0            10

[8 rows x 8 columns]

Current validation loss: 1.138

Epoch 83:
Mean loss 0.49665175299586184 - Correctly labeled training images 72.39%
Classified 61.67 % of validation images correctly.
Precision on validation set: [0.29 0.55 0.32 0.27 0.5  0.84 0.23 0.73]
Recall on validation set: [0.49 0.57 0.44 0.25 0.42 0.77 0.31 0.62]
F1-score on validation set: [0.36 0.56 0.37 0.26 0.46 0.8  0.26 0.67]
ROC AUC on validation set: {'AK': 0.7, 'BCC': 0.92, 'BKL': 0.59, 'DF': 0.74, 'MEL': 0.47, 'NV': 0.23, 'SCC': 0.81, 'VASC': 0.57}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            21           11  ...            2             0
true class BCC           14           96  ...           13             0
true class BKL           17           13  ...            4             1
true class DF             2            4  ...            1             0
true class MEL           12           17  ...            5             0
true class NV             3           17  ...            9             1
true class SCC            4           13  ...           10             1
true class VASC           0            2  ...            0             8

[8 rows x 8 columns]

Current validation loss: 1.042

Epoch 84:
Mean loss 0.4901358067331254 - Correctly labeled training images 73.23%
Classified 61.12 % of validation images correctly.
Precision on validation set: [0.26 0.59 0.31 0.38 0.47 0.84 0.28 0.82]
Recall on validation set: [0.44 0.53 0.47 0.5  0.48 0.74 0.25 0.69]
F1-score on validation set: [0.32 0.56 0.37 0.43 0.47 0.79 0.26 0.75]
ROC AUC on validation set: {'AK': 0.69, 'BCC': 0.91, 'BKL': 0.59, 'DF': 0.69, 'MEL': 0.45, 'NV': 0.25, 'SCC': 0.79, 'VASC': 0.53}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            19            9  ...            1             0
true class BCC           19           89  ...            9             0
true class BKL           11           12  ...            4             0
true class DF             0            2  ...            1             0
true class MEL           10           13  ...            2             0
true class NV             5           16  ...            4             2
true class SCC           10            8  ...            8             0
true class VASC           0            1  ...            0             9

[8 rows x 8 columns]

Current validation loss: 1.093

Epoch 85:
Mean loss 0.4655613794640788 - Correctly labeled training images 74.23%
Classified 60.96 % of validation images correctly.
Precision on validation set: [0.26 0.54 0.33 0.55 0.49 0.84 0.31 0.59]
Recall on validation set: [0.51 0.67 0.46 0.5  0.41 0.72 0.25 0.77]
F1-score on validation set: [0.34 0.6  0.38 0.52 0.45 0.78 0.28 0.67]
ROC AUC on validation set: {'AK': 0.65, 'BCC': 0.92, 'BKL': 0.57, 'DF': 0.63, 'MEL': 0.46, 'NV': 0.26, 'SCC': 0.75, 'VASC': 0.56}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            22            9  ...            1             0
true class BCC           19          112  ...            8             0
true class BKL           15           19  ...            1             1
true class DF             1            3  ...            1             0
true class MEL           16           19  ...            3             2
true class NV             7           32  ...            4             4
true class SCC            6           11  ...            8             0
true class VASC           0            3  ...            0            10

[8 rows x 8 columns]

Current validation loss: 1.112

Epoch 86:
Mean loss 0.470294235855905 - Correctly labeled training images 74.23%
Classified 53.23 % of validation images correctly.
Precision on validation set: [0.25 0.61 0.28 0.21 0.38 0.89 0.18 0.61]
Recall on validation set: [0.58 0.4  0.52 0.42 0.56 0.57 0.22 0.85]
F1-score on validation set: [0.35 0.49 0.37 0.28 0.45 0.69 0.2  0.71]
ROC AUC on validation set: {'AK': 0.68, 'BCC': 0.91, 'BKL': 0.57, 'DF': 0.69, 'MEL': 0.43, 'NV': 0.27, 'SCC': 0.75, 'VASC': 0.56}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            25            3  ...            2             0
true class BCC           28           67  ...           13             2
true class BKL           10            7  ...            3             1
true class DF             1            2  ...            1             0
true class MEL           15           10  ...            5             1
true class NV             7           16  ...            8             3
true class SCC           13            3  ...            7             0
true class VASC           0            1  ...            0            11

[8 rows x 8 columns]

Current validation loss: 1.332

Epoch 87:
Mean loss 0.43230493474833975 - Correctly labeled training images 75.04%
Classified 59.15 % of validation images correctly.
Precision on validation set: [0.28 0.61 0.29 0.47 0.47 0.85 0.18 0.67]
Recall on validation set: [0.42 0.51 0.52 0.58 0.5  0.69 0.22 0.77]
F1-score on validation set: [0.34 0.55 0.37 0.52 0.48 0.76 0.2  0.71]
ROC AUC on validation set: {'AK': 0.7, 'BCC': 0.92, 'BKL': 0.55, 'DF': 0.67, 'MEL': 0.47, 'NV': 0.25, 'SCC': 0.74, 'VASC': 0.46}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            18            7  ...            3             0
true class BCC           15           85  ...           16             1
true class BKL           11            8  ...            4             0
true class DF             0            2  ...            1             0
true class MEL            9            9  ...            4             1
true class NV             4           21  ...            3             3
true class SCC            7            7  ...            7             0
true class VASC           0            1  ...            0            10

[8 rows x 8 columns]

Current validation loss: 1.135

Epoch 88:
Mean loss 0.3995548568031389 - Correctly labeled training images 76.47%
Classified 59.23 % of validation images correctly.
Precision on validation set: [0.25 0.65 0.3  0.5  0.5  0.84 0.21 0.62]
Recall on validation set: [0.6  0.49 0.5  0.5  0.45 0.7  0.34 0.62]
F1-score on validation set: [0.36 0.56 0.37 0.5  0.47 0.76 0.26 0.62]
ROC AUC on validation set: {'AK': 0.66, 'BCC': 0.91, 'BKL': 0.57, 'DF': 0.72, 'MEL': 0.46, 'NV': 0.25, 'SCC': 0.74, 'VASC': 0.56}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            26            4  ...            4             0
true class BCC           25           82  ...           19             1
true class BKL           18            5  ...            4             0
true class DF             0            2  ...            1             0
true class MEL           14           11  ...            5             1
true class NV             8           18  ...            8             3
true class SCC           11            3  ...           11             0
true class VASC           0            2  ...            0             8

[8 rows x 8 columns]

Current validation loss: 1.211

Epoch 89:
Mean loss 0.3769887305255568 - Correctly labeled training images 77.47%
Classified 63.09 % of validation images correctly.
Precision on validation set: [0.32 0.65 0.34 0.5  0.51 0.81 0.31 0.56]
Recall on validation set: [0.37 0.58 0.54 0.42 0.4  0.78 0.31 0.69]
F1-score on validation set: [0.34 0.61 0.42 0.45 0.45 0.79 0.31 0.62]
ROC AUC on validation set: {'AK': 0.75, 'BCC': 0.93, 'BKL': 0.61, 'DF': 0.72, 'MEL': 0.46, 'NV': 0.22, 'SCC': 0.81, 'VASC': 0.47}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            16            7  ...            4             0
true class BCC           11           97  ...            8             2
true class BKL            9            8  ...            4             0
true class DF             0            4  ...            0             0
true class MEL            5           12  ...            4             1
true class NV             3           11  ...            2             4
true class SCC            6            9  ...           10             0
true class VASC           0            1  ...            0             9

[8 rows x 8 columns]

Current validation loss: 1.113

Epoch 90:
Mean loss 0.3798624986271471 - Correctly labeled training images 77.48%
Classified 55.36 % of validation images correctly.
Precision on validation set: [0.23 0.57 0.25 0.36 0.43 0.88 0.23 0.67]
Recall on validation set: [0.4  0.59 0.47 0.42 0.51 0.6  0.31 0.62]
F1-score on validation set: [0.29 0.58 0.33 0.38 0.47 0.71 0.27 0.64]
ROC AUC on validation set: {'AK': 0.71, 'BCC': 0.91, 'BKL': 0.56, 'DF': 0.7, 'MEL': 0.43, 'NV': 0.26, 'SCC': 0.76, 'VASC': 0.61}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            17           10  ...            2             0
true class BCC           19           99  ...           11             0
true class BKL           16           10  ...            6             0
true class DF             0            3  ...            1             0
true class MEL           10           14  ...            6             1
true class NV             6           25  ...            7             3
true class SCC            7            9  ...           10             0
true class VASC           0            3  ...            0             8

[8 rows x 8 columns]

Current validation loss: 1.278

Epoch 91:
Mean loss 0.3700850947351674 - Correctly labeled training images 77.67%
Classified 57.26 % of validation images correctly.
Precision on validation set: [0.25 0.56 0.34 0.24 0.45 0.92 0.15 0.53]
Recall on validation set: [0.63 0.61 0.42 0.33 0.56 0.61 0.34 0.77]
F1-score on validation set: [0.36 0.58 0.38 0.28 0.5  0.73 0.21 0.62]
ROC AUC on validation set: {'AK': 0.61, 'BCC': 0.9, 'BKL': 0.54, 'DF': 0.65, 'MEL': 0.45, 'NV': 0.29, 'SCC': 0.69, 'VASC': 0.43}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            27            8  ...            4             0
true class BCC           26          102  ...            9             1
true class BKL           15           14  ...            5             1
true class DF             1            3  ...            2             0
true class MEL           14           19  ...           19             2
true class NV            16           27  ...           22             5
true class SCC           10            7  ...           11             0
true class VASC           0            2  ...            0            10

/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
[8 rows x 8 columns]

Current validation loss: 1.359

Epoch 92:
Mean loss 0.3551454105846325 - Correctly labeled training images 78.96%
Classified 60.09 % of validation images correctly.
Precision on validation set: [0.25 0.6  0.29 0.45 0.48 0.85 0.27 0.45]
Recall on validation set: [0.58 0.6  0.42 0.42 0.46 0.71 0.12 0.77]
F1-score on validation set: [0.35 0.6  0.34 0.43 0.47 0.77 0.17 0.57]
ROC AUC on validation set: {'AK': 0.67, 'BCC': 0.92, 'BKL': 0.56, 'DF': 0.71, 'MEL': 0.48, 'NV': 0.24, 'SCC': 0.79, 'VASC': 0.4}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            25            8  ...            0             0
true class BCC           23          100  ...            5             2
true class BKL           17            9  ...            2             1
true class DF             3            3  ...            0             0
true class MEL           10           20  ...            3             1
true class NV            13           19  ...            1             8
true class SCC           10            7  ...            4             0
true class VASC           0            2  ...            0            10

[8 rows x 8 columns]

Current validation loss: 1.212

Epoch 93:
Mean loss 0.35225184647254765 - Correctly labeled training images 78.78%
Classified 57.33 % of validation images correctly.
Precision on validation set: [0.24 0.53 0.29 0.25 0.44 0.89 0.27 1.  ]
Recall on validation set: [0.33 0.56 0.55 0.33 0.54 0.63 0.25 0.62]
F1-score on validation set: [0.27 0.55 0.38 0.29 0.48 0.74 0.26 0.76]
ROC AUC on validation set: {'AK': 0.68, 'BCC': 0.9, 'BKL': 0.56, 'DF': 0.68, 'MEL': 0.46, 'NV': 0.26, 'SCC': 0.71, 'VASC': 0.6}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            14           11  ...            1             0
true class BCC           11           93  ...            9             0
true class BKL           11           14  ...            1             0
true class DF             1            4  ...            1             0
true class MEL            9           18  ...            3             0
true class NV             7           24  ...            7             0
true class SCC            6            7  ...            8             0
true class VASC           0            3  ...            0             8

[8 rows x 8 columns]

Current validation loss: 1.334

Epoch 94:
Mean loss 0.34157264611627963 - Correctly labeled training images 79.39%
Classified 59.54 % of validation images correctly.
Precision on validation set: [0.31 0.58 0.3  0.33 0.45 0.85 0.47 0.56]
Recall on validation set: [0.4  0.69 0.53 0.33 0.46 0.66 0.22 0.77]
F1-score on validation set: [0.35 0.63 0.38 0.33 0.46 0.75 0.3  0.65]
ROC AUC on validation set: {'AK': 0.69, 'BCC': 0.93, 'BKL': 0.57, 'DF': 0.74, 'MEL': 0.45, 'NV': 0.25, 'SCC': 0.76, 'VASC': 0.52}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            17           11  ...            1             0
true class BCC            9          115  ...            2             2
true class BKL           10           16  ...            1             0
true class DF             2            3  ...            1             0
true class MEL            7           18  ...            1             1
true class NV             4           25  ...            2             4
true class SCC            5            9  ...            7             1
true class VASC           0            2  ...            0            10

[8 rows x 8 columns]

Current validation loss: 1.190

Epoch 95:
Mean loss 0.3389722984636714 - Correctly labeled training images 79.44%
Classified 57.57 % of validation images correctly.
Precision on validation set: [0.29 0.52 0.26 0.31 0.48 0.86 0.4  0.69]
Recall on validation set: [0.37 0.58 0.54 0.33 0.43 0.66 0.44 0.69]
F1-score on validation set: [0.32 0.55 0.36 0.32 0.45 0.74 0.42 0.69]
ROC AUC on validation set: {'AK': 0.69, 'BCC': 0.91, 'BKL': 0.58, 'DF': 0.66, 'MEL': 0.47, 'NV': 0.25, 'SCC': 0.74, 'VASC': 0.55}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            16           11  ...            1             0
true class BCC           13           97  ...           11             0
true class BKL            9           17  ...            4             0
true class DF             1            2  ...            1             0
true class MEL            8           20  ...            1             1
true class NV             6           28  ...            3             3
true class SCC            3            9  ...           14             0
true class VASC           0            3  ...            0             9

[8 rows x 8 columns]

Current validation loss: 1.241

Epoch 96:
Mean loss 0.3335898454985596 - Correctly labeled training images 79.58%
Classified 61.99 % of validation images correctly.
Precision on validation set: [0.33 0.54 0.35 0.33 0.48 0.87 0.24 0.62]
Recall on validation set: [0.42 0.71 0.47 0.33 0.5  0.7  0.25 0.77]
F1-score on validation set: [0.37 0.61 0.4  0.33 0.49 0.78 0.24 0.69]
ROC AUC on validation set: {'AK': 0.72, 'BCC': 0.93, 'BKL': 0.59, 'DF': 0.66, 'MEL': 0.46, 'NV': 0.23, 'SCC': 0.76, 'VASC': 0.44}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            18           14  ...            0             0
true class BCC           13          119  ...            7             1
true class BKL            8           16  ...            5             1
true class DF             1            2  ...            1             0
true class MEL            7           25  ...            5             1
true class NV             5           32  ...            8             3
true class SCC            3           13  ...            8             0
true class VASC           0            1  ...            0            10

[8 rows x 8 columns]

Current validation loss: 1.196

Epoch 97:
Mean loss 0.289410902075587 - Correctly labeled training images 81.16%
Classified 60.96 % of validation images correctly.
Precision on validation set: [0.26 0.59 0.3  0.25 0.5  0.84 0.54 0.82]
Recall on validation set: [0.47 0.66 0.5  0.25 0.48 0.7  0.22 0.69]
F1-score on validation set: [0.33 0.63 0.38 0.25 0.49 0.76 0.31 0.75]
ROC AUC on validation set: {'AK': 0.71, 'BCC': 0.93, 'BKL': 0.56, 'DF': 0.75, 'MEL': 0.44, 'NV': 0.26, 'SCC': 0.78, 'VASC': 0.51}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            20           11  ...            0             0
true class BCC           20          111  ...            3             0
true class BKL           11           11  ...            0             1
true class DF             0            5  ...            1             0
true class MEL           13           16  ...            0             0
true class NV             6           23  ...            2             1
true class SCC            8            8  ...            7             0
true class VASC           0            2  ...            0             9

[8 rows x 8 columns]

Current validation loss: 1.262

Epoch 98:
Mean loss 0.27932239741039955 - Correctly labeled training images 81.74%
Classified 59.78 % of validation images correctly.
Precision on validation set: [0.3  0.54 0.32 0.56 0.49 0.85 0.21 0.67]
Recall on validation set: [0.47 0.63 0.52 0.42 0.47 0.67 0.25 0.92]
F1-score on validation set: [0.37 0.58 0.39 0.48 0.48 0.75 0.23 0.77]
ROC AUC on validation set: {'AK': 0.71, 'BCC': 0.92, 'BKL': 0.58, 'DF': 0.7, 'MEL': 0.45, 'NV': 0.24, 'SCC': 0.76, 'VASC': 0.52}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            20           12  ...            3             0
true class BCC           17          105  ...           10             0
true class BKL           10           14  ...            6             1
true class DF             1            3  ...            1             0
true class MEL            9           15  ...            5             0
true class NV             4           33  ...            6             5
true class SCC            5           11  ...            8             0
true class VASC           0            1  ...            0            12

/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
[8 rows x 8 columns]

Current validation loss: 1.303

Epoch 99:
Mean loss 0.28251858617323056 - Correctly labeled training images 82.24%
Classified 60.96 % of validation images correctly.
Precision on validation set: [0.2  0.54 0.36 0.55 0.53 0.83 0.24 0.5 ]
Recall on validation set: [0.6  0.56 0.36 0.5  0.43 0.76 0.34 0.46]
F1-score on validation set: [0.31 0.55 0.36 0.52 0.47 0.79 0.29 0.48]
ROC AUC on validation set: {'AK': 0.62, 'BCC': 0.9, 'BKL': 0.54, 'DF': 0.59, 'MEL': 0.47, 'NV': 0.28, 'SCC': 0.69, 'VASC': 0.55}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            26            7  ...            1             0
true class BCC           30           93  ...           16             0
true class BKL           25            9  ...            6             0
true class DF             2            2  ...            1             0
true class MEL           21           19  ...            6             0
true class NV            15           27  ...            4             6
true class SCC            8           10  ...           11             0
true class VASC           0            4  ...            0             6

[8 rows x 8 columns]

Current validation loss: 1.260

Epoch 100:
Mean loss 0.27947702290554904 - Correctly labeled training images 82.60%
Classified 59.46 % of validation images correctly.
Precision on validation set: [0.26 0.61 0.3  0.31 0.45 0.86 0.37 0.7 ]
Recall on validation set: [0.35 0.65 0.55 0.42 0.47 0.67 0.22 0.54]
F1-score on validation set: [0.3  0.63 0.39 0.36 0.46 0.75 0.27 0.61]
ROC AUC on validation set: {'AK': 0.69, 'BCC': 0.92, 'BKL': 0.53, 'DF': 0.66, 'MEL': 0.42, 'NV': 0.28, 'SCC': 0.74, 'VASC': 0.62}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            15            8  ...            1             0
true class BCC           10          109  ...            3             0
true class BKL            9           11  ...            2             0
true class DF             1            3  ...            1             0
true class MEL           11           18  ...            2             1
true class NV             6           19  ...            3             2
true class SCC            5            9  ...            7             0
true class VASC           0            3  ...            0             7

[8 rows x 8 columns]

Current validation loss: 1.296

Epoch 101:
Mean loss 0.277303516212557 - Correctly labeled training images 82.50%
Classified 58.28 % of validation images correctly.
Precision on validation set: [0.27 0.53 0.36 0.27 0.41 0.87 0.28 0.36]
Recall on validation set: [0.51 0.74 0.38 0.25 0.51 0.63 0.25 0.92]
F1-score on validation set: [0.35 0.62 0.37 0.26 0.46 0.73 0.26 0.52]
ROC AUC on validation set: {'AK': 0.68, 'BCC': 0.92, 'BKL': 0.55, 'DF': 0.62, 'MEL': 0.45, 'NV': 0.28, 'SCC': 0.71, 'VASC': 0.35}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            22           10  ...            2             0
true class BCC           15          123  ...            4             3
true class BKL           12           20  ...            2             2
true class DF             4            3  ...            1             0
true class MEL           14           26  ...            5             2
true class NV             8           38  ...            7            13
true class SCC            6           10  ...            8             1
true class VASC           0            1  ...            0            12

[8 rows x 8 columns]

Current validation loss: 1.419

Epoch 102:
Mean loss 0.26468723730921556 - Correctly labeled training images 83.09%
Classified 62.22 % of validation images correctly.
Precision on validation set: [0.33 0.56 0.34 0.29 0.49 0.85 0.35 0.64]
Recall on validation set: [0.42 0.75 0.5  0.42 0.43 0.72 0.22 0.69]
F1-score on validation set: [0.37 0.64 0.41 0.34 0.46 0.78 0.27 0.67]
ROC AUC on validation set: {'AK': 0.68, 'BCC': 0.92, 'BKL': 0.56, 'DF': 0.67, 'MEL': 0.46, 'NV': 0.25, 'SCC': 0.76, 'VASC': 0.6}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            18           11  ...            0             0
true class BCC            8          125  ...            5             0
true class BKL           10           15  ...            2             0
true class DF             1            2  ...            1             0
true class MEL            8           23  ...            2             1
true class NV             4           32  ...            3             4
true class SCC            6           13  ...            7             0
true class VASC           0            3  ...            0             9

[8 rows x 8 columns]

Current validation loss: 1.288

Epoch 103:
Mean loss 0.28042630399415736 - Correctly labeled training images 82.86%
Classified 59.31 % of validation images correctly.
Precision on validation set: [0.32 0.55 0.38 0.25 0.42 0.86 0.35 0.8 ]
Recall on validation set: [0.49 0.68 0.4  0.17 0.61 0.62 0.5  0.62]
F1-score on validation set: [0.39 0.61 0.39 0.2  0.5  0.72 0.41 0.7 ]
ROC AUC on validation set: {'AK': 0.66, 'BCC': 0.92, 'BKL': 0.56, 'DF': 0.72, 'MEL': 0.46, 'NV': 0.26, 'SCC': 0.69, 'VASC': 0.61}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            21           10  ...            1             0
true class BCC           12          114  ...           11             0
true class BKL           10           14  ...            5             0
true class DF             3            3  ...            1             0
true class MEL            9           22  ...            4             0
true class NV             6           32  ...            8             2
true class SCC            4            9  ...           16             0
true class VASC           0            4  ...            0             8

[8 rows x 8 columns]

Current validation loss: 1.356

Epoch 104:
Mean loss 0.2863837909599772 - Correctly labeled training images 82.83%
Classified 61.44 % of validation images correctly.
Precision on validation set: [0.31 0.59 0.38 0.19 0.43 0.84 0.24 0.88]
Recall on validation set: [0.42 0.62 0.35 0.5  0.56 0.72 0.22 0.54]
F1-score on validation set: [0.35 0.6  0.37 0.27 0.49 0.78 0.23 0.67]
ROC AUC on validation set: {'AK': 0.71, 'BCC': 0.92, 'BKL': 0.58, 'DF': 0.65, 'MEL': 0.45, 'NV': 0.24, 'SCC': 0.78, 'VASC': 0.62}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            18           11  ...            2             0
true class BCC           10          103  ...            9             0
true class BKL           12           12  ...            4             0
true class DF             0            2  ...            1             0
true class MEL            9           16  ...            3             0
true class NV             5           20  ...            3             1
true class SCC            5            8  ...            7             0
true class VASC           0            4  ...            0             7

[8 rows x 8 columns]

Current validation loss: 1.297

Epoch 105:
Mean loss 0.24622302786197384 - Correctly labeled training images 84.39%
Classified 61.51 % of validation images correctly.
Precision on validation set: [0.29 0.6  0.37 0.18 0.44 0.82 0.3  0.73]
Recall on validation set: [0.47 0.6  0.4  0.42 0.49 0.75 0.09 0.62]
F1-score on validation set: [0.36 0.6  0.39 0.25 0.46 0.78 0.14 0.67]
ROC AUC on validation set: {'AK': 0.68, 'BCC': 0.92, 'BKL': 0.58, 'DF': 0.68, 'MEL': 0.46, 'NV': 0.24, 'SCC': 0.82, 'VASC': 0.59}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            20            8  ...            2             0
true class BCC           14          100  ...            1             0
true class BKL           13            9  ...            2             0
true class DF             0            3  ...            1             0
true class MEL           14           19  ...            1             1
true class NV             4           10  ...            0             2
true class SCC            4           16  ...            3             0
true class VASC           0            3  ...            0             8

[8 rows x 8 columns]

Current validation loss: 1.303

Epoch 106:
Mean loss 0.22497843876951124 - Correctly labeled training images 85.64%
Classified 61.99 % of validation images correctly.
Precision on validation set: [0.35 0.63 0.35 0.38 0.45 0.85 0.2  0.62]
Recall on validation set: [0.42 0.61 0.44 0.25 0.56 0.72 0.28 0.77]
F1-score on validation set: [0.38 0.62 0.39 0.3  0.5  0.78 0.23 0.69]
ROC AUC on validation set: {'AK': 0.67, 'BCC': 0.92, 'BKL': 0.56, 'DF': 0.72, 'MEL': 0.45, 'NV': 0.25, 'SCC': 0.75, 'VASC': 0.58}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            18            9  ...            1             0
true class BCC            9          102  ...           12             0
true class BKL           10            7  ...            4             1
true class DF             1            3  ...            2             0
true class MEL            7           12  ...            7             0
true class NV             4           17  ...           11             5
true class SCC            3           11  ...            9             0
true class VASC           0            2  ...            0            10

[8 rows x 8 columns]

Current validation loss: 1.277

Epoch 107:
Mean loss 0.2147441867339404 - Correctly labeled training images 86.22%
Classified 61.83 % of validation images correctly.
Precision on validation set: [0.34 0.61 0.31 0.56 0.45 0.84 0.35 0.67]
Recall on validation set: [0.35 0.59 0.45 0.42 0.52 0.74 0.19 0.62]
F1-score on validation set: [0.34 0.6  0.37 0.48 0.48 0.78 0.24 0.64]
ROC AUC on validation set: {'AK': 0.71, 'BCC': 0.92, 'BKL': 0.57, 'DF': 0.72, 'MEL': 0.43, 'NV': 0.25, 'SCC': 0.8, 'VASC': 0.62}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            15           10  ...            1             0
true class BCC            9           99  ...            5             0
true class BKL            6            9  ...            4             0
true class DF             1            2  ...            1             0
true class MEL            6           16  ...            0             0
true class NV             2           15  ...            0             4
true class SCC            5            8  ...            6             0
true class VASC           0            4  ...            0             8

[8 rows x 8 columns]

Current validation loss: 1.299

Epoch 108:
Mean loss 0.2060276860494625 - Correctly labeled training images 86.80%
Classified 59.78 % of validation images correctly.
Precision on validation set: [0.33 0.52 0.31 0.33 0.46 0.84 0.3  0.47]
Recall on validation set: [0.4  0.65 0.47 0.33 0.47 0.69 0.22 0.69]
F1-score on validation set: [0.36 0.57 0.38 0.33 0.47 0.76 0.25 0.56]
ROC AUC on validation set: {'AK': 0.62, 'BCC': 0.92, 'BKL': 0.53, 'DF': 0.66, 'MEL': 0.46, 'NV': 0.28, 'SCC': 0.76, 'VASC': 0.49}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            17           11  ...            1             0
true class BCC            9          108  ...            7             0
true class BKL           10           11  ...            3             0
true class DF             1            3  ...            1             0
true class MEL            7           23  ...            2             1
true class NV             3           37  ...            2             8
true class SCC            4           13  ...            7             1
true class VASC           0            3  ...            0             9

[8 rows x 8 columns]

Current validation loss: 1.300

Epoch 109:
Mean loss 0.191559330877563 - Correctly labeled training images 87.30%
Classified 65.14 % of validation images correctly.
Precision on validation set: [0.39 0.56 0.49 0.35 0.49 0.78 0.38 0.64]
Recall on validation set: [0.37 0.66 0.34 0.5  0.44 0.83 0.25 0.54]
F1-score on validation set: [0.38 0.61 0.41 0.41 0.46 0.8  0.3  0.58]
ROC AUC on validation set: {'AK': 0.72, 'BCC': 0.91, 'BKL': 0.58, 'DF': 0.65, 'MEL': 0.45, 'NV': 0.24, 'SCC': 0.77, 'VASC': 0.56}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            16           16  ...            1             0
true class BCC            4          111  ...            6             0
true class BKL            7           11  ...            2             0
true class DF             1            2  ...            1             0
true class MEL            8           22  ...            1             0
true class NV             3           18  ...            2             4
true class SCC            2           14  ...            8             0
true class VASC           0            4  ...            0             7

[8 rows x 8 columns]

Current validation loss: 1.313

Epoch 110:
Mean loss 0.2004797957626051 - Correctly labeled training images 87.65%
Classified 61.04 % of validation images correctly.
Precision on validation set: [0.37 0.55 0.42 0.31 0.41 0.82 0.36 0.71]
Recall on validation set: [0.35 0.69 0.28 0.33 0.58 0.7  0.28 0.92]
F1-score on validation set: [0.36 0.61 0.34 0.32 0.48 0.75 0.32 0.8 ]
ROC AUC on validation set: {'AK': 0.72, 'BCC': 0.92, 'BKL': 0.58, 'DF': 0.72, 'MEL': 0.44, 'NV': 0.25, 'SCC': 0.78, 'VASC': 0.45}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            15           14  ...            2             0
true class BCC            4          116  ...            8             0
true class BKL            8           16  ...            3             1
true class DF             0            4  ...            2             0
true class MEL            7           22  ...            1             1
true class NV             5           27  ...            0             3
true class SCC            2           11  ...            9             0
true class VASC           0            1  ...            0            12

[8 rows x 8 columns]

Current validation loss: 1.416

Epoch 111:
Mean loss 0.20220590593169915 - Correctly labeled training images 87.44%
Classified 58.12 % of validation images correctly.
Precision on validation set: [0.3  0.59 0.31 0.2  0.4  0.84 0.24 0.86]
Recall on validation set: [0.44 0.65 0.31 0.33 0.57 0.65 0.31 0.46]
F1-score on validation set: [0.36 0.62 0.31 0.25 0.47 0.74 0.27 0.6 ]
ROC AUC on validation set: {'AK': 0.68, 'BCC': 0.92, 'BKL': 0.57, 'DF': 0.63, 'MEL': 0.41, 'NV': 0.27, 'SCC': 0.77, 'VASC': 0.69}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            19            8  ...            1             0
true class BCC           12          109  ...           13             0
true class BKL           12           11  ...            6             0
true class DF             1            3  ...            1             0
true class MEL           10           15  ...            5             0
true class NV             5           22  ...            6             1
true class SCC            4           12  ...           10             0
true class VASC           0            5  ...            0             6

[8 rows x 8 columns]

Current validation loss: 1.456

Epoch 112:
Mean loss 0.2008114918032279 - Correctly labeled training images 87.20%
Classified 64.43 % of validation images correctly.
Precision on validation set: [0.38 0.55 0.44 0.38 0.48 0.83 0.44 0.69]
Recall on validation set: [0.42 0.84 0.27 0.42 0.58 0.73 0.22 0.69]
F1-score on validation set: [0.4  0.66 0.33 0.4  0.52 0.78 0.29 0.69]
ROC AUC on validation set: {'AK': 0.68, 'BCC': 0.94, 'BKL': 0.58, 'DF': 0.69, 'MEL': 0.47, 'NV': 0.23, 'SCC': 0.78, 'VASC': 0.61}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            18           15  ...            0             0
true class BCC            3          140  ...            5             0
true class BKL           11           16  ...            2             0
true class DF             1            3  ...            1             0
true class MEL            8           28  ...            1             0
true class NV             4           34  ...            0             4
true class SCC            3           16  ...            7             0
true class VASC           0            4  ...            0             9

/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
[8 rows x 8 columns]

Current validation loss: 1.329

Epoch 113:
Mean loss 0.1898635659449108 - Correctly labeled training images 88.13%
Classified 64.91 % of validation images correctly.
Precision on validation set: [0.35 0.63 0.46 0.4  0.46 0.84 0.36 0.8 ]
Recall on validation set: [0.4  0.72 0.31 0.33 0.66 0.73 0.31 0.92]
F1-score on validation set: [0.37 0.67 0.37 0.36 0.54 0.78 0.33 0.86]
ROC AUC on validation set: {'AK': 0.68, 'BCC': 0.94, 'BKL': 0.58, 'DF': 0.72, 'MEL': 0.44, 'NV': 0.24, 'SCC': 0.74, 'VASC': 0.55}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            17           11  ...            1             0
true class BCC            4          121  ...            6             0
true class BKL           12           12  ...            6             1
true class DF             1            3  ...            1             0
true class MEL           10           15  ...            1             0
true class NV             2           20  ...            3             2
true class SCC            3           10  ...           10             0
true class VASC           0            1  ...            0            12

[8 rows x 8 columns]

Current validation loss: 1.417

Epoch 114:
Mean loss 0.182680023528565 - Correctly labeled training images 88.33%
Classified 62.30 % of validation images correctly.
Precision on validation set: [0.23 0.66 0.37 0.31 0.48 0.79 0.3  0.83]
Recall on validation set: [0.44 0.54 0.38 0.33 0.47 0.78 0.31 0.77]
F1-score on validation set: [0.3  0.59 0.37 0.32 0.48 0.78 0.31 0.8 ]
ROC AUC on validation set: {'AK': 0.7, 'BCC': 0.92, 'BKL': 0.59, 'DF': 0.69, 'MEL': 0.44, 'NV': 0.25, 'SCC': 0.78, 'VASC': 0.55}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            19            9  ...            1             0
true class BCC           20           90  ...           10             0
true class BKL           14            8  ...            4             1
true class DF             2            2  ...            1             0
true class MEL           12            7  ...            4             0
true class NV            11           11  ...            3             1
true class SCC            6            8  ...           10             0
true class VASC           0            2  ...            0            10

[8 rows x 8 columns]

Current validation loss: 1.344

Epoch 115:
Mean loss 0.16013256684004415 - Correctly labeled training images 89.67%
Classified 64.67 % of validation images correctly.
Precision on validation set: [0.46 0.61 0.38 0.44 0.45 0.85 0.54 0.46]
Recall on validation set: [0.4  0.78 0.36 0.33 0.59 0.73 0.22 0.92]
F1-score on validation set: [0.42 0.69 0.37 0.38 0.51 0.79 0.31 0.62]
ROC AUC on validation set: {'AK': 0.7, 'BCC': 0.94, 'BKL': 0.56, 'DF': 0.69, 'MEL': 0.45, 'NV': 0.25, 'SCC': 0.78, 'VASC': 0.43}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            17           12  ...            0             0
true class BCC            2          130  ...            2             2
true class BKL            6           12  ...            2             1
true class DF             0            2  ...            1             0
true class MEL            5           22  ...            0             1
true class NV             2           22  ...            1             9
true class SCC            5           11  ...            7             1
true class VASC           0            1  ...            0            12

[8 rows x 8 columns]

Current validation loss: 1.351

Epoch 116:
Mean loss 0.16691018355428608 - Correctly labeled training images 89.44%
Classified 64.27 % of validation images correctly.
Precision on validation set: [0.44 0.51 0.39 0.23 0.51 0.84 0.27 0.56]
Recall on validation set: [0.35 0.77 0.33 0.42 0.52 0.76 0.19 0.69]
F1-score on validation set: [0.39 0.62 0.36 0.29 0.52 0.8  0.22 0.62]
ROC AUC on validation set: {'AK': 0.67, 'BCC': 0.93, 'BKL': 0.56, 'DF': 0.67, 'MEL': 0.45, 'NV': 0.26, 'SCC': 0.74, 'VASC': 0.57}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            15           16  ...            0             0
true class BCC            4          129  ...            6             0
true class BKL            8           23  ...            2             0
true class DF             0            3  ...            1             0
true class MEL            4           25  ...            3             1
true class NV             0           36  ...            4             6
true class SCC            3           15  ...            6             0
true class VASC           0            4  ...            0             9

[8 rows x 8 columns]

Current validation loss: 1.358

Epoch 117:
Mean loss 0.14809497723161985 - Correctly labeled training images 90.23%
Classified 64.12 % of validation images correctly.
Precision on validation set: [0.3  0.62 0.34 0.31 0.55 0.81 0.29 0.86]
Recall on validation set: [0.44 0.63 0.54 0.33 0.36 0.81 0.16 0.46]
F1-score on validation set: [0.36 0.62 0.42 0.32 0.44 0.81 0.2  0.6 ]
ROC AUC on validation set: {'AK': 0.68, 'BCC': 0.92, 'BKL': 0.55, 'DF': 0.76, 'MEL': 0.5, 'NV': 0.23, 'SCC': 0.73, 'VASC': 0.69}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            19            7  ...            1             0
true class BCC           12          105  ...            7             0
true class BKL           12            7  ...            1             0
true class DF             0            4  ...            1             0
true class MEL           13           15  ...            1             1
true class NV             1           19  ...            1             0
true class SCC            7            8  ...            5             0
true class VASC           0            5  ...            0             6

[8 rows x 8 columns]

Current validation loss: 1.390

Epoch 118:
Mean loss 0.16592246437979985 - Correctly labeled training images 89.60%
Classified 63.33 % of validation images correctly.
Precision on validation set: [0.4  0.7  0.29 0.27 0.5  0.84 0.31 0.71]
Recall on validation set: [0.47 0.66 0.5  0.25 0.5  0.74 0.16 0.77]
F1-score on validation set: [0.43 0.68 0.36 0.26 0.5  0.79 0.21 0.74]
ROC AUC on validation set: {'AK': 0.7, 'BCC': 0.92, 'BKL': 0.56, 'DF': 0.73, 'MEL': 0.42, 'NV': 0.27, 'SCC': 0.78, 'VASC': 0.57}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            20            3  ...            0             0
true class BCC            4          110  ...            4             1
true class BKL           10           10  ...            2             0
true class DF             2            3  ...            1             0
true class MEL            8            9  ...            3             0
true class NV             1           12  ...            1             3
true class SCC            5           10  ...            5             0
true class VASC           0            1  ...            0            10

[8 rows x 8 columns]

Current validation loss: 1.503

Epoch 119:
Mean loss 0.15447028525385195 - Correctly labeled training images 90.49%
Classified 64.20 % of validation images correctly.
Precision on validation set: [0.47 0.68 0.39 0.33 0.46 0.82 0.33 0.79]
Recall on validation set: [0.4  0.57 0.44 0.33 0.61 0.75 0.34 0.85]
F1-score on validation set: [0.43 0.62 0.41 0.33 0.52 0.78 0.34 0.81]
ROC AUC on validation set: {'AK': 0.71, 'BCC': 0.93, 'BKL': 0.58, 'DF': 0.71, 'MEL': 0.45, 'NV': 0.24, 'SCC': 0.79, 'VASC': 0.59}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            17            5  ...            1             0
true class BCC            4           96  ...           10             1
true class BKL            5            6  ...            4             0
true class DF             1            3  ...            1             0
true class MEL            4           12  ...            2             0
true class NV             1           10  ...            4             2
true class SCC            4            8  ...           11             0
true class VASC           0            1  ...            0            11

/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
[8 rows x 8 columns]

Current validation loss: 1.368

Epoch 120:
Mean loss 0.15997274643932513 - Correctly labeled training images 90.22%
Classified 64.51 % of validation images correctly.
Precision on validation set: [0.33 0.6  0.37 0.43 0.51 0.84 0.23 0.85]
Recall on validation set: [0.4  0.71 0.47 0.25 0.48 0.76 0.25 0.85]
F1-score on validation set: [0.36 0.65 0.41 0.32 0.5  0.8  0.24 0.85]
ROC AUC on validation set: {'AK': 0.66, 'BCC': 0.93, 'BKL': 0.55, 'DF': 0.74, 'MEL': 0.48, 'NV': 0.24, 'SCC': 0.75, 'VASC': 0.55}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            17            7  ...            1             0
true class BCC            8          118  ...           11             0
true class BKL            9           14  ...            4             0
true class DF             1            2  ...            1             0
true class MEL            7           21  ...            4             0
true class NV             3           22  ...            6             2
true class SCC            6           10  ...            8             0
true class VASC           0            2  ...            0            11

[8 rows x 8 columns]

Current validation loss: 1.395

Epoch 121:
Mean loss 0.15977658933669048 - Correctly labeled training images 90.30%
Classified 62.46 % of validation images correctly.
Precision on validation set: [0.41 0.64 0.32 0.12 0.47 0.82 0.29 0.88]
Recall on validation set: [0.35 0.51 0.44 0.33 0.46 0.79 0.31 0.54]
F1-score on validation set: [0.38 0.57 0.37 0.18 0.46 0.81 0.3  0.67]
ROC AUC on validation set: {'AK': 0.72, 'BCC': 0.91, 'BKL': 0.58, 'DF': 0.71, 'MEL': 0.44, 'NV': 0.25, 'SCC': 0.77, 'VASC': 0.61}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            15            6  ...            2             0
true class BCC            2           85  ...           10             0
true class BKL            7           10  ...            3             0
true class DF             1            2  ...            0             0
true class MEL            7            9  ...            5             0
true class NV             3           10  ...            4             1
true class SCC            2            8  ...           10             0
true class VASC           0            3  ...            0             7

[8 rows x 8 columns]

Current validation loss: 1.432

Epoch 122:
Mean loss 0.15326444553475746 - Correctly labeled training images 90.59%
Classified 62.85 % of validation images correctly.
Precision on validation set: [0.31 0.63 0.4  0.14 0.46 0.84 0.36 0.9 ]
Recall on validation set: [0.47 0.57 0.41 0.25 0.57 0.73 0.5  0.69]
F1-score on validation set: [0.37 0.6  0.41 0.18 0.51 0.78 0.42 0.78]
ROC AUC on validation set: {'AK': 0.67, 'BCC': 0.91, 'BKL': 0.56, 'DF': 0.73, 'MEL': 0.41, 'NV': 0.29, 'SCC': 0.75, 'VASC': 0.63}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            20            8  ...            2             0
true class BCC           14           95  ...           13             0
true class BKL           10           10  ...            5             0
true class DF             0            3  ...            1             0
true class MEL           12           14  ...            3             1
true class NV             5           12  ...            5             0
true class SCC            3            6  ...           16             0
true class VASC           0            3  ...            0             9

[8 rows x 8 columns]

Current validation loss: 1.452

Epoch 123:
Mean loss 0.12925182268235022 - Correctly labeled training images 91.53%
Classified 63.33 % of validation images correctly.
Precision on validation set: [0.28 0.64 0.4  0.33 0.46 0.81 0.3  0.75]
Recall on validation set: [0.51 0.53 0.43 0.17 0.5  0.78 0.25 0.69]
F1-score on validation set: [0.36 0.58 0.41 0.22 0.48 0.8  0.27 0.72]
ROC AUC on validation set: {'AK': 0.63, 'BCC': 0.91, 'BKL': 0.53, 'DF': 0.75, 'MEL': 0.44, 'NV': 0.28, 'SCC': 0.74, 'VASC': 0.56}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            22            5  ...            2             0
true class BCC           19           88  ...           10             0
true class BKL           13            6  ...            2             0
true class DF             1            2  ...            1             0
true class MEL           10           14  ...            2             1
true class NV             7           12  ...            2             2
true class SCC            6            7  ...            8             0
true class VASC           0            3  ...            0             9

[8 rows x 8 columns]

Current validation loss: 1.423

Epoch 124:
Mean loss 0.11281021018527236 - Correctly labeled training images 92.52%
Classified 65.38 % of validation images correctly.
Precision on validation set: [0.43 0.56 0.34 0.17 0.55 0.84 0.46 0.75]
Recall on validation set: [0.28 0.78 0.44 0.33 0.45 0.79 0.19 0.69]
F1-score on validation set: [0.34 0.65 0.38 0.23 0.5  0.81 0.27 0.72]
ROC AUC on validation set: {'AK': 0.7, 'BCC': 0.93, 'BKL': 0.55, 'DF': 0.69, 'MEL': 0.47, 'NV': 0.24, 'SCC': 0.81, 'VASC': 0.59}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            12           17  ...            0             0
true class BCC            2          130  ...            2             0
true class BKL            6           18  ...            1             0
true class DF             0            4  ...            1             0
true class MEL            5           22  ...            2             1
true class NV             2           22  ...            1             2
true class SCC            1           17  ...            6             0
true class VASC           0            4  ...            0             9

[8 rows x 8 columns]

Current validation loss: 1.460

Epoch 125:
Mean loss 0.12540038422261268 - Correctly labeled training images 92.27%
Classified 65.38 % of validation images correctly.
Precision on validation set: [0.33 0.59 0.42 0.38 0.5  0.79 0.42 0.48]
Recall on validation set: [0.35 0.7  0.25 0.25 0.52 0.82 0.25 0.77]
F1-score on validation set: [0.34 0.64 0.32 0.3  0.51 0.8  0.31 0.59]
ROC AUC on validation set: {'AK': 0.69, 'BCC': 0.93, 'BKL': 0.59, 'DF': 0.71, 'MEL': 0.45, 'NV': 0.24, 'SCC': 0.78, 'VASC': 0.55}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            15           13  ...            0             0
true class BCC            5          117  ...            5             1
true class BKL           10           14  ...            1             1
true class DF             1            2  ...            1             0
true class MEL            8           17  ...            3             2
true class NV             3           19  ...            1             7
true class SCC            4           12  ...            8             0
true class VASC           0            3  ...            0            10

[8 rows x 8 columns]

Current validation loss: 1.501

Epoch 126:
Mean loss 0.17478095014265235 - Correctly labeled training images 89.79%
Classified 62.62 % of validation images correctly.
Precision on validation set: [0.47 0.64 0.39 0.43 0.42 0.82 0.4  0.75]
Recall on validation set: [0.4  0.57 0.5  0.25 0.57 0.73 0.25 0.69]
F1-score on validation set: [0.43 0.6  0.43 0.32 0.48 0.77 0.31 0.72]
ROC AUC on validation set: {'AK': 0.7, 'BCC': 0.93, 'BKL': 0.57, 'DF': 0.72, 'MEL': 0.44, 'NV': 0.24, 'SCC': 0.79, 'VASC': 0.63}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            17            6  ...            0             0
true class BCC            3           96  ...            6             1
true class BKL            6            6  ...            3             0
true class DF             2            2  ...            1             0
true class MEL            3           15  ...            0             0
true class NV             2           12  ...            2             2
true class SCC            3           11  ...            8             0
true class VASC           0            3  ...            0             9

[8 rows x 8 columns]

Current validation loss: 1.421

Epoch 127:
Mean loss 0.15440186898720565 - Correctly labeled training images 90.50%
Classified 61.75 % of validation images correctly.
Precision on validation set: [0.29 0.64 0.3  0.5  0.49 0.83 0.28 0.86]
Recall on validation set: [0.51 0.65 0.44 0.42 0.48 0.72 0.34 0.46]
F1-score on validation set: [0.37 0.65 0.36 0.45 0.48 0.77 0.31 0.6 ]
ROC AUC on validation set: {'AK': 0.63, 'BCC': 0.92, 'BKL': 0.55, 'DF': 0.69, 'MEL': 0.44, 'NV': 0.26, 'SCC': 0.78, 'VASC': 0.68}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            22            5  ...            3             0
true class BCC           10          109  ...            6             0
true class BKL           18            9  ...            6             0
true class DF             0            2  ...            2             0
true class MEL           15           15  ...            8             0
true class NV             5           15  ...            4             1
true class SCC            6            9  ...           11             0
true class VASC           0            5  ...            0             6

[8 rows x 8 columns]

Current validation loss: 1.424

Epoch 128:
Mean loss 0.12287518415711703 - Correctly labeled training images 92.43%
Classified 66.88 % of validation images correctly.
Precision on validation set: [0.43 0.58 0.46 0.5  0.52 0.81 0.36 0.69]
Recall on validation set: [0.49 0.73 0.34 0.25 0.53 0.81 0.25 0.69]
F1-score on validation set: [0.46 0.65 0.39 0.33 0.52 0.81 0.3  0.69]
ROC AUC on validation set: {'AK': 0.66, 'BCC': 0.93, 'BKL': 0.6, 'DF': 0.69, 'MEL': 0.47, 'NV': 0.23, 'SCC': 0.76, 'VASC': 0.53}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            21            7  ...            1             0
true class BCC            2          122  ...            4             1
true class BKL           12           18  ...            4             1
true class DF             2            3  ...            1             0
true class MEL            6           25  ...            3             0
true class NV             4           19  ...            1             2
true class SCC            2           13  ...            8             0
true class VASC           0            3  ...            0             9

[8 rows x 8 columns]

Current validation loss: 1.391

Epoch 129:
Mean loss 0.11105403476262506 - Correctly labeled training images 92.67%
Classified 65.54 % of validation images correctly.
Precision on validation set: [0.32 0.67 0.41 0.5  0.5  0.83 0.37 0.69]
Recall on validation set: [0.53 0.65 0.47 0.17 0.5  0.78 0.34 0.85]
F1-score on validation set: [0.4  0.66 0.44 0.25 0.5  0.8  0.35 0.76]
ROC AUC on validation set: {'AK': 0.62, 'BCC': 0.92, 'BKL': 0.55, 'DF': 0.71, 'MEL': 0.44, 'NV': 0.27, 'SCC': 0.72, 'VASC': 0.57}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            23            5  ...            0             0
true class BCC           12          109  ...            6             0
true class BKL           11           11  ...            4             1
true class DF             2            4  ...            1             0
true class MEL            9           14  ...            6             0
true class NV             9           13  ...            2             4
true class SCC            7            5  ...           11             0
true class VASC           0            2  ...            0            11

[8 rows x 8 columns]

Current validation loss: 1.386

Epoch 130:
Mean loss 0.10781344987175866 - Correctly labeled training images 93.21%
Classified 63.96 % of validation images correctly.
Precision on validation set: [0.35 0.57 0.39 0.14 0.52 0.82 0.42 0.64]
Recall on validation set: [0.47 0.62 0.4  0.33 0.5  0.78 0.31 0.54]
F1-score on validation set: [0.4  0.59 0.39 0.2  0.51 0.8  0.36 0.58]
ROC AUC on validation set: {'AK': 0.61, 'BCC': 0.91, 'BKL': 0.53, 'DF': 0.69, 'MEL': 0.44, 'NV': 0.28, 'SCC': 0.76, 'VASC': 0.6}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            20            9  ...            1             0
true class BCC            6          103  ...            4             1
true class BKL           13           14  ...            4             1
true class DF             0            4  ...            1             0
true class MEL            8           19  ...            1             0
true class NV             5           21  ...            3             2
true class SCC            5            9  ...           10             0
true class VASC           0            3  ...            0             7

[8 rows x 8 columns]

Current validation loss: 1.469

Epoch 131:
Mean loss 0.12558004707362422 - Correctly labeled training images 92.20%
Classified 64.83 % of validation images correctly.
Precision on validation set: [0.43 0.49 0.37 0.43 0.66 0.8  0.4  0.53]
Recall on validation set: [0.3  0.86 0.4  0.25 0.23 0.84 0.19 0.69]
F1-score on validation set: [0.36 0.62 0.39 0.32 0.34 0.82 0.26 0.6 ]
ROC AUC on validation set: {'AK': 0.68, 'BCC': 0.93, 'BKL': 0.55, 'DF': 0.66, 'MEL': 0.48, 'NV': 0.24, 'SCC': 0.77, 'VASC': 0.57}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            13           19  ...            0             0
true class BCC            1          144  ...            0             0
true class BKL            7           30  ...            1             1
true class DF             2            3  ...            1             0
true class MEL            4           41  ...            4             2
true class NV             2           35  ...            3             5
true class SCC            1           20  ...            6             0
true class VASC           0            4  ...            0             9

[8 rows x 8 columns]

Current validation loss: 1.651

Epoch 132:
Mean loss 0.10925793244535756 - Correctly labeled training images 93.26%
Classified 65.30 % of validation images correctly.
Precision on validation set: [0.33 0.6  0.47 0.31 0.49 0.82 0.32 0.75]
Recall on validation set: [0.42 0.72 0.41 0.42 0.5  0.78 0.31 0.69]
F1-score on validation set: [0.37 0.66 0.44 0.36 0.49 0.8  0.32 0.72]
ROC AUC on validation set: {'AK': 0.66, 'BCC': 0.94, 'BKL': 0.57, 'DF': 0.65, 'MEL': 0.44, 'NV': 0.25, 'SCC': 0.76, 'VASC': 0.64}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            18            9  ...            2             0
true class BCC            7          120  ...            7             0
true class BKL           11           14  ...            3             0
true class DF             0            3  ...            2             0
true class MEL            9           22  ...            3             0
true class NV             4           18  ...            4             3
true class SCC            5           11  ...           10             0
true class VASC           0            2  ...            0             9

[8 rows x 8 columns]

Current validation loss: 1.377

Epoch 133:
Mean loss 0.09005003027384366 - Correctly labeled training images 94.22%
Classified 64.12 % of validation images correctly.
Precision on validation set: [0.34 0.52 0.43 0.57 0.5  0.81 0.37 0.6 ]
Recall on validation set: [0.53 0.74 0.31 0.33 0.42 0.79 0.31 0.69]
F1-score on validation set: [0.41 0.61 0.36 0.42 0.46 0.8  0.34 0.64]
ROC AUC on validation set: {'AK': 0.6, 'BCC': 0.92, 'BKL': 0.55, 'DF': 0.66, 'MEL': 0.5, 'NV': 0.24, 'SCC': 0.74, 'VASC': 0.59}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            23            8  ...            0             0
true class BCC           10          123  ...            3             0
true class BKL           10           19  ...            5             1
true class DF             2            3  ...            1             0
true class MEL           11           32  ...            4             1
true class NV             8           39  ...            4             4
true class SCC            4           10  ...           10             0
true class VASC           0            4  ...            0             9

/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
[8 rows x 8 columns]

Current validation loss: 1.443

Epoch 134:
Mean loss 0.09498190921907569 - Correctly labeled training images 93.91%
Classified 64.35 % of validation images correctly.
Precision on validation set: [0.3  0.66 0.38 0.24 0.54 0.78 0.33 0.62]
Recall on validation set: [0.47 0.6  0.4  0.42 0.46 0.81 0.19 0.62]
F1-score on validation set: [0.37 0.63 0.39 0.3  0.49 0.79 0.24 0.62]
ROC AUC on validation set: {'AK': 0.68, 'BCC': 0.93, 'BKL': 0.55, 'DF': 0.68, 'MEL': 0.46, 'NV': 0.25, 'SCC': 0.75, 'VASC': 0.62}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            20            8  ...            0             0
true class BCC           11          101  ...            4             0
true class BKL           13            6  ...            2             0
true class DF             0            2  ...            2             0
true class MEL           12            8  ...            2             2
true class NV             4           17  ...            2             3
true class SCC            6            7  ...            6             0
true class VASC           0            3  ...            0             8

[8 rows x 8 columns]

Current validation loss: 1.430

Epoch 135:
Mean loss 0.0929907525152156 - Correctly labeled training images 94.19%
Classified 66.25 % of validation images correctly.
Precision on validation set: [0.39 0.56 0.44 0.43 0.54 0.79 0.41 0.82]
Recall on validation set: [0.37 0.72 0.41 0.25 0.37 0.84 0.34 0.69]
F1-score on validation set: [0.38 0.63 0.43 0.32 0.44 0.81 0.37 0.75]
ROC AUC on validation set: {'AK': 0.66, 'BCC': 0.92, 'BKL': 0.56, 'DF': 0.73, 'MEL': 0.47, 'NV': 0.25, 'SCC': 0.72, 'VASC': 0.63}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            16           12  ...            1             0
true class BCC            4          121  ...            6             0
true class BKL            7           14  ...            2             1
true class DF             2            4  ...            1             0
true class MEL            6           25  ...            3             1
true class NV             2           28  ...            3             0
true class SCC            4            9  ...           11             0
true class VASC           0            4  ...            0             9

[8 rows x 8 columns]

Current validation loss: 1.542

Epoch 136:
Mean loss 0.09575821689406427 - Correctly labeled training images 94.10%
Classified 66.80 % of validation images correctly.
Precision on validation set: [0.37 0.56 0.44 0.36 0.52 0.82 0.46 0.69]
Recall on validation set: [0.35 0.73 0.41 0.33 0.47 0.82 0.19 0.69]
F1-score on validation set: [0.36 0.64 0.43 0.35 0.5  0.82 0.27 0.69]
ROC AUC on validation set: {'AK': 0.67, 'BCC': 0.93, 'BKL': 0.57, 'DF': 0.74, 'MEL': 0.44, 'NV': 0.25, 'SCC': 0.79, 'VASC': 0.64}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            15           14  ...            0             0
true class BCC            4          122  ...            3             0
true class BKL            6           17  ...            2             1
true class DF             2            3  ...            1             0
true class MEL            7           23  ...            0             1
true class NV             4           19  ...            1             2
true class SCC            3           14  ...            6             0
true class VASC           0            4  ...            0             9

[8 rows x 8 columns]

Current validation loss: 1.487

Epoch 137:
Mean loss 0.08917661661896208 - Correctly labeled training images 94.48%
Classified 61.99 % of validation images correctly.
Precision on validation set: [0.4  0.66 0.32 0.44 0.44 0.86 0.33 0.77]
Recall on validation set: [0.42 0.62 0.52 0.33 0.59 0.69 0.16 0.77]
F1-score on validation set: [0.41 0.64 0.4  0.38 0.51 0.77 0.21 0.77]
ROC AUC on validation set: {'AK': 0.69, 'BCC': 0.92, 'BKL': 0.54, 'DF': 0.76, 'MEL': 0.42, 'NV': 0.27, 'SCC': 0.76, 'VASC': 0.63}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            18            7  ...            2             0
true class BCC            5          103  ...            6             0
true class BKL            9            8  ...            1             0
true class DF             1            3  ...            1             0
true class MEL            5           11  ...            0             1
true class NV             3           11  ...            0             2
true class SCC            4           11  ...            5             0
true class VASC           0            2  ...            0            10

[8 rows x 8 columns]

Current validation loss: 1.604

Epoch 138:
Mean loss 0.07322196249427033 - Correctly labeled training images 95.20%
Classified 64.12 % of validation images correctly.
Precision on validation set: [0.38 0.68 0.41 0.43 0.45 0.8  0.33 0.89]
Recall on validation set: [0.44 0.65 0.39 0.25 0.58 0.75 0.22 0.62]
F1-score on validation set: [0.41 0.66 0.4  0.32 0.51 0.78 0.26 0.73]
ROC AUC on validation set: {'AK': 0.66, 'BCC': 0.93, 'BKL': 0.57, 'DF': 0.73, 'MEL': 0.42, 'NV': 0.26, 'SCC': 0.76, 'VASC': 0.63}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            19            6  ...            2             0
true class BCC            6          108  ...            5             0
true class BKL            9            7  ...            2             0
true class DF             1            3  ...            1             0
true class MEL            8            9  ...            3             0
true class NV             4           11  ...            1             1
true class SCC            3           12  ...            7             0
true class VASC           0            2  ...            0             8

[8 rows x 8 columns]

Current validation loss: 1.497

Epoch 139:
Mean loss 0.07665144460355093 - Correctly labeled training images 95.02%
Classified 66.32 % of validation images correctly.
Precision on validation set: [0.37 0.64 0.48 0.25 0.48 0.81 0.36 0.8 ]
Recall on validation set: [0.37 0.66 0.44 0.17 0.54 0.8  0.31 0.62]
F1-score on validation set: [0.37 0.65 0.46 0.2  0.51 0.81 0.33 0.7 ]
ROC AUC on validation set: {'AK': 0.67, 'BCC': 0.92, 'BKL': 0.55, 'DF': 0.71, 'MEL': 0.45, 'NV': 0.26, 'SCC': 0.71, 'VASC': 0.63}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            16           10  ...            0             0
true class BCC            4          110  ...            5             1
true class BKL            8            7  ...            3             0
true class DF             1            2  ...            1             0
true class MEL            5           18  ...            4             0
true class NV             3           15  ...            4             1
true class SCC            6            7  ...           10             0
true class VASC           0            3  ...            1             8

[8 rows x 8 columns]

Current validation loss: 1.501

Epoch 140:
Mean loss 0.08692034013196238 - Correctly labeled training images 94.69%
Classified 66.09 % of validation images correctly.
Precision on validation set: [0.43 0.59 0.42 0.43 0.5  0.82 0.41 0.8 ]
Recall on validation set: [0.42 0.73 0.45 0.25 0.46 0.8  0.22 0.62]
F1-score on validation set: [0.42 0.65 0.43 0.32 0.48 0.81 0.29 0.7 ]
ROC AUC on validation set: {'AK': 0.69, 'BCC': 0.93, 'BKL': 0.55, 'DF': 0.69, 'MEL': 0.44, 'NV': 0.25, 'SCC': 0.79, 'VASC': 0.62}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            18           11  ...            0             0
true class BCC            6          122  ...            4             0
true class BKL            8           15  ...            2             0
true class DF             1            3  ...            1             0
true class MEL            3           21  ...            1             0
true class NV             1           19  ...            2             2
true class SCC            5           11  ...            7             0
true class VASC           0            4  ...            0             8

/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
[8 rows x 8 columns]

Current validation loss: 1.469

Epoch 141:
Mean loss 0.0990795775901303 - Correctly labeled training images 94.20%
Classified 65.38 % of validation images correctly.
Precision on validation set: [0.54 0.56 0.39 0.5  0.54 0.8  0.36 0.57]
Recall on validation set: [0.35 0.72 0.4  0.33 0.42 0.81 0.38 0.62]
F1-score on validation set: [0.42 0.63 0.39 0.4  0.47 0.8  0.37 0.59]
ROC AUC on validation set: {'AK': 0.69, 'BCC': 0.92, 'BKL': 0.58, 'DF': 0.72, 'MEL': 0.45, 'NV': 0.25, 'SCC': 0.76, 'VASC': 0.57}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            15           13  ...            5             0
true class BCC            4          120  ...            8             0
true class BKL            4           16  ...            3             1
true class DF             0            3  ...            1             0
true class MEL            3           25  ...            3             2
true class NV             1           21  ...            1             3
true class SCC            1           14  ...           12             0
true class VASC           0            4  ...            0             8

[8 rows x 8 columns]

Current validation loss: 1.507

Epoch 142:
Mean loss 0.08596873761423532 - Correctly labeled training images 94.72%
Classified 64.98 % of validation images correctly.
Precision on validation set: [0.39 0.66 0.36 0.5  0.52 0.79 0.28 0.8 ]
Recall on validation set: [0.49 0.59 0.39 0.25 0.53 0.8  0.28 0.62]
F1-score on validation set: [0.43 0.62 0.38 0.33 0.53 0.8  0.28 0.7 ]
ROC AUC on validation set: {'AK': 0.67, 'BCC': 0.93, 'BKL': 0.57, 'DF': 0.72, 'MEL': 0.44, 'NV': 0.25, 'SCC': 0.75, 'VASC': 0.63}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            21            5  ...            1             0
true class BCC            9           99  ...           11             0
true class BKL            8            9  ...            1             0
true class DF             0            3  ...            2             0
true class MEL            6           12  ...            4             1
true class NV             4           14  ...            4             1
true class SCC            6            5  ...            9             0
true class VASC           0            4  ...            0             8

[8 rows x 8 columns]

Current validation loss: 1.549

Epoch 143:
Mean loss 0.08364373330344162 - Correctly labeled training images 94.96%
Classified 64.67 % of validation images correctly.
Precision on validation set: [0.42 0.64 0.39 0.44 0.47 0.8  0.32 0.9 ]
Recall on validation set: [0.3  0.66 0.35 0.33 0.57 0.78 0.28 0.69]
F1-score on validation set: [0.35 0.65 0.37 0.38 0.52 0.79 0.3  0.78]
ROC AUC on validation set: {'AK': 0.7, 'BCC': 0.93, 'BKL': 0.58, 'DF': 0.73, 'MEL': 0.41, 'NV': 0.26, 'SCC': 0.79, 'VASC': 0.61}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            13           12  ...            1             0
true class BCC            4          110  ...            8             0
true class BKL            7           12  ...            4             0
true class DF             1            3  ...            1             0
true class MEL            2           13  ...            3             0
true class NV             0           13  ...            1             1
true class SCC            4            8  ...            9             0
true class VASC           0            1  ...            1             9

[8 rows x 8 columns]

Current validation loss: 1.514

Epoch 144:
Mean loss 0.07756766751599542 - Correctly labeled training images 95.20%
Classified 64.75 % of validation images correctly.
Precision on validation set: [0.39 0.62 0.36 0.25 0.54 0.8  0.26 0.73]
Recall on validation set: [0.51 0.59 0.43 0.25 0.43 0.82 0.28 0.62]
F1-score on validation set: [0.44 0.61 0.39 0.25 0.48 0.81 0.27 0.67]
ROC AUC on validation set: {'AK': 0.65, 'BCC': 0.92, 'BKL': 0.57, 'DF': 0.71, 'MEL': 0.47, 'NV': 0.24, 'SCC': 0.76, 'VASC': 0.64}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            22            7  ...            1             0
true class BCC           13           99  ...            8             2
true class BKL            8           10  ...            4             0
true class DF             1            2  ...            1             0
true class MEL            5           18  ...            3             0
true class NV             3           10  ...            8             1
true class SCC            4           10  ...            9             0
true class VASC           0            3  ...            0             8

[8 rows x 8 columns]

Current validation loss: 1.491

Epoch 145:
Mean loss 0.07656752022404859 - Correctly labeled training images 95.34%
Classified 62.07 % of validation images correctly.
Precision on validation set: [0.35 0.61 0.38 0.5  0.43 0.8  0.35 0.69]
Recall on validation set: [0.4  0.61 0.32 0.33 0.58 0.74 0.22 0.69]
F1-score on validation set: [0.37 0.61 0.35 0.4  0.49 0.77 0.27 0.69]
ROC AUC on validation set: {'AK': 0.71, 'BCC': 0.91, 'BKL': 0.57, 'DF': 0.73, 'MEL': 0.42, 'NV': 0.27, 'SCC': 0.77, 'VASC': 0.56}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            17           13  ...            0             0
true class BCC           10          102  ...            4             0
true class BKL            9           10  ...            1             1
true class DF             0            3  ...            2             0
true class MEL            5           15  ...            2             1
true class NV             2           15  ...            3             2
true class SCC            6            8  ...            7             0
true class VASC           0            2  ...            1             9

[8 rows x 8 columns]

Current validation loss: 1.639

Epoch 146:
Mean loss 0.0754126325882795 - Correctly labeled training images 95.48%
Classified 63.88 % of validation images correctly.
Precision on validation set: [0.36 0.5  0.36 0.29 0.64 0.79 0.3  0.78]
Recall on validation set: [0.42 0.69 0.38 0.33 0.33 0.82 0.31 0.54]
F1-score on validation set: [0.39 0.58 0.37 0.31 0.43 0.81 0.31 0.64]
ROC AUC on validation set: {'AK': 0.67, 'BCC': 0.91, 'BKL': 0.57, 'DF': 0.68, 'MEL': 0.48, 'NV': 0.24, 'SCC': 0.74, 'VASC': 0.56}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            18           16  ...            1             0
true class BCC            9          116  ...            7             0
true class BKL            8           18  ...            3             0
true class DF             1            3  ...            2             0
true class MEL            5           32  ...            7             0
true class NV             4           28  ...            3             2
true class SCC            5           15  ...           10             0
true class VASC           0            4  ...            0             7

[8 rows x 8 columns]

Current validation loss: 1.648

Epoch 147:
Mean loss 0.08396661048828498 - Correctly labeled training images 95.03%
Classified 63.64 % of validation images correctly.
Precision on validation set: [0.3  0.64 0.34 0.22 0.57 0.79 0.26 0.8 ]
Recall on validation set: [0.49 0.63 0.42 0.17 0.39 0.8  0.31 0.62]
F1-score on validation set: [0.37 0.63 0.37 0.19 0.46 0.8  0.28 0.7 ]
ROC AUC on validation set: {'AK': 0.61, 'BCC': 0.92, 'BKL': 0.55, 'DF': 0.73, 'MEL': 0.44, 'NV': 0.27, 'SCC': 0.74, 'VASC': 0.57}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            21            6  ...            2             0
true class BCC           14          105  ...            8             0
true class BKL           12           11  ...            1             0
true class DF             1            4  ...            2             0
true class MEL            9           18  ...            8             0
true class NV             4           11  ...            7             2
true class SCC            9            8  ...           10             0
true class VASC           0            2  ...            1             8

[8 rows x 8 columns]

Current validation loss: 1.603

Epoch 148:
Mean loss 0.07322967106260489 - Correctly labeled training images 95.63%
Classified 63.80 % of validation images correctly.
Precision on validation set: [0.4  0.61 0.39 0.36 0.46 0.8  0.35 0.89]
Recall on validation set: [0.4  0.66 0.37 0.33 0.54 0.77 0.22 0.62]
F1-score on validation set: [0.4  0.64 0.38 0.35 0.49 0.78 0.27 0.73]
ROC AUC on validation set: {'AK': 0.66, 'BCC': 0.92, 'BKL': 0.57, 'DF': 0.75, 'MEL': 0.43, 'NV': 0.25, 'SCC': 0.8, 'VASC': 0.6}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            17            7  ...            3             0
true class BCC            6          110  ...            3             0
true class BKL            6           11  ...            1             0
true class DF             0            3  ...            1             0
true class MEL            4           20  ...            3             0
true class NV             3           13  ...            2             1
true class SCC            6           12  ...            7             0
true class VASC           0            3  ...            0             8

[8 rows x 8 columns]

Current validation loss: 1.531

Epoch 149:
Mean loss 0.07030987408421993 - Correctly labeled training images 95.85%
Classified 65.46 % of validation images correctly.
Precision on validation set: [0.32 0.57 0.45 0.33 0.51 0.8  0.45 0.69]
Recall on validation set: [0.49 0.67 0.37 0.17 0.46 0.82 0.16 0.85]
F1-score on validation set: [0.39 0.62 0.41 0.22 0.49 0.81 0.23 0.76]
ROC AUC on validation set: {'AK': 0.63, 'BCC': 0.92, 'BKL': 0.56, 'DF': 0.72, 'MEL': 0.47, 'NV': 0.25, 'SCC': 0.75, 'VASC': 0.62}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            21            6  ...            1             0
true class BCC           13          112  ...            4             0
true class BKL           13            9  ...            1             1
true class DF             0            4  ...            0             0
true class MEL            3           28  ...            0             1
true class NV             5           23  ...            0             3
true class SCC           10           11  ...            5             0
true class VASC           0            2  ...            0            11

[8 rows x 8 columns]

Current validation loss: 1.617

Epoch 150:
Mean loss 0.07880747797259949 - Correctly labeled training images 95.52%
Classified 61.59 % of validation images correctly.
Precision on validation set: [0.3  0.61 0.41 0.67 0.43 0.81 0.26 0.75]
Recall on validation set: [0.47 0.55 0.28 0.33 0.58 0.73 0.44 0.69]
F1-score on validation set: [0.37 0.58 0.33 0.44 0.49 0.77 0.33 0.72]
ROC AUC on validation set: {'AK': 0.64, 'BCC': 0.9, 'BKL': 0.57, 'DF': 0.74, 'MEL': 0.43, 'NV': 0.28, 'SCC': 0.67, 'VASC': 0.58}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            20            7  ...            1             0
true class BCC            8           92  ...           17             0
true class BKL           11           10  ...            6             1
true class DF             1            2  ...            1             0
true class MEL           12           14  ...            7             0
true class NV             8           16  ...            6             2
true class SCC            6            8  ...           14             0
true class VASC           0            1  ...            1             9

[8 rows x 8 columns]

Current validation loss: 1.688

Epoch 151:
Mean loss 0.07358809725648785 - Correctly labeled training images 95.47%
Classified 65.62 % of validation images correctly.
Precision on validation set: [0.39 0.61 0.42 0.43 0.52 0.82 0.26 0.69]
Recall on validation set: [0.51 0.69 0.32 0.25 0.52 0.79 0.47 0.69]
F1-score on validation set: [0.44 0.65 0.36 0.32 0.52 0.81 0.33 0.69]
ROC AUC on validation set: {'AK': 0.66, 'BCC': 0.93, 'BKL': 0.6, 'DF': 0.72, 'MEL': 0.45, 'NV': 0.24, 'SCC': 0.73, 'VASC': 0.54}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            22            8  ...            5             0
true class BCC           10          116  ...           10             0
true class BKL            9           12  ...            9             1
true class DF             1            4  ...            1             0
true class MEL            6           24  ...           11             0
true class NV             4           17  ...            7             3
true class SCC            5            7  ...           15             0
true class VASC           0            3  ...            0             9

[8 rows x 8 columns]

Current validation loss: 1.553

Epoch 152:
Mean loss 0.0716564687231867 - Correctly labeled training images 95.83%
Classified 65.38 % of validation images correctly.
Precision on validation set: [0.43 0.55 0.4  0.75 0.6  0.77 0.27 0.73]
Recall on validation set: [0.42 0.69 0.41 0.25 0.33 0.85 0.22 0.62]
F1-score on validation set: [0.42 0.61 0.4  0.38 0.42 0.81 0.24 0.67]
ROC AUC on validation set: {'AK': 0.64, 'BCC': 0.92, 'BKL': 0.54, 'DF': 0.7, 'MEL': 0.49, 'NV': 0.25, 'SCC': 0.76, 'VASC': 0.63}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            18            7  ...            1             0
true class BCC            5          115  ...            7             0
true class BKL            5           10  ...            3             1
true class DF             0            4  ...            2             0
true class MEL            5           32  ...            3             0
true class NV             2           27  ...            3             2
true class SCC            7           10  ...            7             0
true class VASC           0            4  ...            0             8

[8 rows x 8 columns]

Current validation loss: 1.686

Epoch 153:
Mean loss 0.07455855175156487 - Correctly labeled training images 95.89%
Classified 66.40 % of validation images correctly.
Precision on validation set: [0.43 0.6  0.43 0.36 0.53 0.8  0.38 0.45]
Recall on validation set: [0.35 0.72 0.47 0.33 0.46 0.81 0.19 0.69]
F1-score on validation set: [0.38 0.66 0.45 0.35 0.49 0.81 0.25 0.55]
ROC AUC on validation set: {'AK': 0.68, 'BCC': 0.93, 'BKL': 0.55, 'DF': 0.65, 'MEL': 0.47, 'NV': 0.24, 'SCC': 0.77, 'VASC': 0.55}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            15           11  ...            0             1
true class BCC            6          120  ...            4             1
true class BKL            4           14  ...            1             0
true class DF             0            2  ...            1             0
true class MEL            7           16  ...            1             4
true class NV             1           20  ...            3             5
true class SCC            2           13  ...            6             0
true class VASC           0            3  ...            0             9

[8 rows x 8 columns]

Current validation loss: 1.499

Epoch 154:
Mean loss 0.0717733064058607 - Correctly labeled training images 96.01%
Classified 58.04 % of validation images correctly.
Precision on validation set: [0.25 0.47 0.28 0.29 0.58 0.81 0.18 0.8 ]
Recall on validation set: [0.35 0.72 0.4  0.17 0.26 0.73 0.38 0.31]
F1-score on validation set: [0.29 0.57 0.33 0.21 0.36 0.77 0.24 0.44]
ROC AUC on validation set: {'AK': 0.64, 'BCC': 0.91, 'BKL': 0.57, 'DF': 0.68, 'MEL': 0.49, 'NV': 0.24, 'SCC': 0.68, 'VASC': 0.66}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            15           12  ...            4             0
true class BCC           14          120  ...           14             0
true class BKL           10           25  ...            5             0
true class DF             0            5  ...            2             0
true class MEL           10           34  ...           16             0
true class NV             7           46  ...           13             1
true class SCC            4            9  ...           12             0
true class VASC           0            6  ...            0             4

/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
[8 rows x 8 columns]

Current validation loss: 1.984

Epoch 155:
Mean loss 0.05711905470621781 - Correctly labeled training images 96.54%
Classified 65.14 % of validation images correctly.
Precision on validation set: [0.34 0.55 0.4  0.44 0.53 0.79 0.35 0.6 ]
Recall on validation set: [0.26 0.72 0.34 0.33 0.45 0.82 0.19 0.69]
F1-score on validation set: [0.29 0.62 0.36 0.38 0.48 0.81 0.24 0.64]
ROC AUC on validation set: {'AK': 0.68, 'BCC': 0.92, 'BKL': 0.57, 'DF': 0.74, 'MEL': 0.46, 'NV': 0.24, 'SCC': 0.78, 'VASC': 0.56}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            11           13  ...            1             0
true class BCC            7          121  ...            5             0
true class BKL            5           17  ...            2             1
true class DF             0            4  ...            1             0
true class MEL            5           25  ...            1             2
true class NV             1           25  ...            1             3
true class SCC            3           14  ...            6             0
true class VASC           0            3  ...            0             9

[8 rows x 8 columns]

Current validation loss: 1.577

Epoch 156:
Mean loss 0.0665680332746862 - Correctly labeled training images 95.96%
Classified 65.30 % of validation images correctly.
Precision on validation set: [0.32 0.59 0.44 0.57 0.51 0.79 0.33 0.73]
Recall on validation set: [0.37 0.65 0.37 0.33 0.49 0.81 0.34 0.62]
F1-score on validation set: [0.34 0.62 0.4  0.42 0.5  0.8  0.34 0.67]
ROC AUC on validation set: {'AK': 0.65, 'BCC': 0.92, 'BKL': 0.55, 'DF': 0.66, 'MEL': 0.45, 'NV': 0.27, 'SCC': 0.74, 'VASC': 0.58}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            16            7  ...            3             0
true class BCC           10          108  ...           12             0
true class BKL            6           12  ...            2             1
true class DF             0            2  ...            1             0
true class MEL            9           23  ...            3             0
true class NV             4           19  ...            1             2
true class SCC            5            8  ...           11             0
true class VASC           0            4  ...            0             8

[8 rows x 8 columns]

Current validation loss: 1.622

Epoch 157:
Mean loss 0.06352426483162182 - Correctly labeled training images 96.13%
Classified 65.14 % of validation images correctly.
Precision on validation set: [0.38 0.59 0.37 0.38 0.52 0.8  0.43 0.71]
Recall on validation set: [0.3  0.69 0.44 0.25 0.45 0.8  0.38 0.77]
F1-score on validation set: [0.34 0.64 0.41 0.3  0.48 0.8  0.4  0.74]
ROC AUC on validation set: {'AK': 0.68, 'BCC': 0.93, 'BKL': 0.55, 'DF': 0.71, 'MEL': 0.45, 'NV': 0.25, 'SCC': 0.78, 'VASC': 0.54}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            13           12  ...            1             0
true class BCC            7          116  ...            8             0
true class BKL            4           13  ...            1             1
true class DF             0            5  ...            1             0
true class MEL            7           19  ...            2             1
true class NV             1           18  ...            3             2
true class SCC            2            9  ...           12             0
true class VASC           0            3  ...            0            10

[8 rows x 8 columns]

Current validation loss: 1.600

Epoch 158:
Mean loss 0.060812521615353554 - Correctly labeled training images 96.45%
Classified 64.51 % of validation images correctly.
Precision on validation set: [0.37 0.59 0.4  0.27 0.49 0.79 0.36 0.62]
Recall on validation set: [0.35 0.73 0.38 0.25 0.43 0.8  0.16 0.77]
F1-score on validation set: [0.36 0.65 0.39 0.26 0.46 0.79 0.22 0.69]
ROC AUC on validation set: {'AK': 0.66, 'BCC': 0.93, 'BKL': 0.57, 'DF': 0.7, 'MEL': 0.45, 'NV': 0.25, 'SCC': 0.75, 'VASC': 0.57}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            15           10  ...            0             0
true class BCC            5          122  ...            4             0
true class BKL            8           11  ...            0             1
true class DF             1            3  ...            2             0
true class MEL            5           28  ...            1             2
true class NV             3           19  ...            2             3
true class SCC            4           12  ...            5             0
true class VASC           0            3  ...            0            10

[8 rows x 8 columns]

Current validation loss: 1.644

Epoch 159:
Mean loss 0.04768508709640292 - Correctly labeled training images 96.92%
Classified 65.69 % of validation images correctly.
Precision on validation set: [0.45 0.62 0.39 0.43 0.5  0.78 0.42 0.8 ]
Recall on validation set: [0.4  0.63 0.38 0.25 0.42 0.84 0.31 0.62]
F1-score on validation set: [0.42 0.63 0.39 0.32 0.46 0.81 0.36 0.7 ]
ROC AUC on validation set: {'AK': 0.7, 'BCC': 0.93, 'BKL': 0.58, 'DF': 0.73, 'MEL': 0.45, 'NV': 0.24, 'SCC': 0.77, 'VASC': 0.6}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            17            8  ...            2             0
true class BCC            5          106  ...            5             0
true class BKL            5           13  ...            2             1
true class DF             1            3  ...            1             0
true class MEL            4           18  ...            3             0
true class NV             3           10  ...            1             1
true class SCC            3            8  ...           10             0
true class VASC           0            4  ...            0             8

[8 rows x 8 columns]

Current validation loss: 1.583

Epoch 160:
Mean loss 0.05265452743897931 - Correctly labeled training images 96.80%
Classified 65.14 % of validation images correctly.
Precision on validation set: [0.36 0.56 0.4  0.44 0.56 0.81 0.22 0.64]
Recall on validation set: [0.35 0.72 0.37 0.33 0.46 0.8  0.28 0.54]
F1-score on validation set: [0.35 0.63 0.38 0.38 0.51 0.8  0.25 0.58]
ROC AUC on validation set: {'AK': 0.68, 'BCC': 0.93, 'BKL': 0.56, 'DF': 0.68, 'MEL': 0.46, 'NV': 0.24, 'SCC': 0.76, 'VASC': 0.62}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            15           11  ...            2             0
true class BCC            5          120  ...           11             0
true class BKL            5           20  ...            3             1
true class DF             1            3  ...            2             0
true class MEL            6           20  ...            7             1
true class NV             5           23  ...            7             2
true class SCC            5           12  ...            9             0
true class VASC           0            5  ...            0             7

[8 rows x 8 columns]

Current validation loss: 1.586

Epoch 161:
Mean loss 0.056520157331146875 - Correctly labeled training images 96.69%
Classified 66.96 % of validation images correctly.
Precision on validation set: [0.37 0.62 0.44 0.62 0.55 0.77 0.44 0.64]
Recall on validation set: [0.4  0.63 0.36 0.42 0.44 0.86 0.38 0.54]
F1-score on validation set: [0.38 0.63 0.39 0.5  0.49 0.82 0.41 0.58]
ROC AUC on validation set: {'AK': 0.69, 'BCC': 0.93, 'BKL': 0.59, 'DF': 0.71, 'MEL': 0.48, 'NV': 0.22, 'SCC': 0.77, 'VASC': 0.61}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            17           10  ...            1             0
true class BCC            7          106  ...           10             0
true class BKL            8           10  ...            1             1
true class DF             0            3  ...            1             0
true class MEL            6           20  ...            1             0
true class NV             2           11  ...            1             3
true class SCC            6            8  ...           12             0
true class VASC           0            3  ...            0             7

/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
[8 rows x 8 columns]

Current validation loss: 1.634

Epoch 162:
Mean loss 0.06195809145579967 - Correctly labeled training images 96.20%
Classified 65.62 % of validation images correctly.
Precision on validation set: [0.38 0.55 0.48 0.55 0.5  0.8  0.33 0.6 ]
Recall on validation set: [0.35 0.75 0.34 0.5  0.49 0.8  0.19 0.69]
F1-score on validation set: [0.36 0.64 0.4  0.52 0.49 0.8  0.24 0.64]
ROC AUC on validation set: {'AK': 0.67, 'BCC': 0.93, 'BKL': 0.58, 'DF': 0.69, 'MEL': 0.46, 'NV': 0.23, 'SCC': 0.79, 'VASC': 0.61}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            15           14  ...            1             0
true class BCC            6          125  ...            6             0
true class BKL            6           17  ...            1             1
true class DF             0            3  ...            1             0
true class MEL            5           27  ...            1             0
true class NV             4           21  ...            2             5
true class SCC            4           16  ...            6             0
true class VASC           0            3  ...            0             9

[8 rows x 8 columns]

Current validation loss: 1.595

Epoch 163:
Mean loss 0.06543455305634131 - Correctly labeled training images 96.46%
Classified 64.20 % of validation images correctly.
Precision on validation set: [0.43 0.61 0.49 0.62 0.44 0.8  0.38 0.42]
Recall on validation set: [0.35 0.65 0.32 0.42 0.55 0.77 0.41 0.77]
F1-score on validation set: [0.38 0.63 0.39 0.5  0.49 0.78 0.39 0.54]
ROC AUC on validation set: {'AK': 0.68, 'BCC': 0.93, 'BKL': 0.55, 'DF': 0.65, 'MEL': 0.43, 'NV': 0.27, 'SCC': 0.77, 'VASC': 0.57}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            15           10  ...            1             1
true class BCC            7          108  ...            6             2
true class BKL            4           12  ...            2             1
true class DF             0            3  ...            2             0
true class MEL            4           18  ...            5             3
true class NV             4           13  ...            5             7
true class SCC            1           12  ...           13             0
true class VASC           0            2  ...            0            10

[8 rows x 8 columns]

Current validation loss: 1.660

Epoch 164:
Mean loss 0.0528357918370568 - Correctly labeled training images 96.76%
Classified 65.69 % of validation images correctly.
Precision on validation set: [0.35 0.59 0.46 0.57 0.5  0.8  0.29 0.67]
Recall on validation set: [0.4  0.72 0.38 0.33 0.44 0.82 0.25 0.62]
F1-score on validation set: [0.37 0.65 0.42 0.42 0.47 0.81 0.27 0.64]
ROC AUC on validation set: {'AK': 0.65, 'BCC': 0.92, 'BKL': 0.55, 'DF': 0.65, 'MEL': 0.44, 'NV': 0.26, 'SCC': 0.79, 'VASC': 0.62}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            17           10  ...            2             0
true class BCC            5          120  ...            6             0
true class BKL            8           15  ...            3             0
true class DF             0            2  ...            2             0
true class MEL            8           25  ...            3             2
true class NV             5           18  ...            4             2
true class SCC            5           11  ...            8             0
true class VASC           0            4  ...            0             8

[8 rows x 8 columns]

Current validation loss: 1.594

Epoch 165:
Mean loss 0.04573618958624115 - Correctly labeled training images 97.22%
Classified 65.06 % of validation images correctly.
Precision on validation set: [0.38 0.63 0.42 0.57 0.49 0.8  0.35 0.8 ]
Recall on validation set: [0.44 0.67 0.37 0.33 0.56 0.77 0.28 0.62]
F1-score on validation set: [0.41 0.65 0.4  0.42 0.52 0.79 0.31 0.7 ]
ROC AUC on validation set: {'AK': 0.68, 'BCC': 0.93, 'BKL': 0.57, 'DF': 0.73, 'MEL': 0.46, 'NV': 0.24, 'SCC': 0.77, 'VASC': 0.61}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            19            7  ...            3             0
true class BCC           11          112  ...            4             0
true class BKL            8           12  ...            2             1
true class DF             0            2  ...            2             0
true class MEL            7           14  ...            2             0
true class NV             2           17  ...            4             1
true class SCC            3           11  ...            9             0
true class VASC           0            4  ...            0             8

[8 rows x 8 columns]

Current validation loss: 1.645

Epoch 166:
Mean loss 0.054114889570185766 - Correctly labeled training images 96.82%
Classified 67.19 % of validation images correctly.
Precision on validation set: [0.39 0.61 0.51 0.5  0.51 0.79 0.43 0.58]
Recall on validation set: [0.37 0.71 0.38 0.5  0.47 0.83 0.28 0.85]
F1-score on validation set: [0.38 0.65 0.43 0.5  0.49 0.81 0.34 0.69]
ROC AUC on validation set: {'AK': 0.68, 'BCC': 0.93, 'BKL': 0.54, 'DF': 0.64, 'MEL': 0.47, 'NV': 0.25, 'SCC': 0.77, 'VASC': 0.54}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            16           13  ...            1             0
true class BCC            6          118  ...            6             0
true class BKL            8           12  ...            0             1
true class DF             0            2  ...            2             0
true class MEL            4           23  ...            2             2
true class NV             4           16  ...            1             4
true class SCC            3           10  ...            9             1
true class VASC           0            1  ...            0            11

[8 rows x 8 columns]

Current validation loss: 1.633

Epoch 167:
Mean loss 0.04194874310045582 - Correctly labeled training images 97.37%
Classified 66.25 % of validation images correctly.
Precision on validation set: [0.4  0.6  0.45 0.44 0.51 0.79 0.38 0.75]
Recall on validation set: [0.42 0.67 0.4  0.33 0.42 0.84 0.31 0.69]
F1-score on validation set: [0.41 0.63 0.43 0.38 0.46 0.81 0.34 0.72]
ROC AUC on validation set: {'AK': 0.67, 'BCC': 0.92, 'BKL': 0.56, 'DF': 0.7, 'MEL': 0.45, 'NV': 0.25, 'SCC': 0.77, 'VASC': 0.63}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            18            9  ...            1             0
true class BCC            7          112  ...            6             0
true class BKL            6           14  ...            0             0
true class DF             1            2  ...            2             0
true class MEL            6           25  ...            3             0
true class NV             2           14  ...            4             3
true class SCC            5            9  ...           10             0
true class VASC           0            3  ...            0             9

[8 rows x 8 columns]

Current validation loss: 1.696

Epoch 168:
Mean loss 0.04768851081244295 - Correctly labeled training images 96.89%
Classified 64.91 % of validation images correctly.
Precision on validation set: [0.31 0.66 0.41 0.44 0.49 0.79 0.3  0.78]
Recall on validation set: [0.42 0.64 0.36 0.33 0.54 0.8  0.19 0.54]
F1-score on validation set: [0.36 0.65 0.38 0.38 0.51 0.79 0.23 0.64]
ROC AUC on validation set: {'AK': 0.67, 'BCC': 0.92, 'BKL': 0.58, 'DF': 0.71, 'MEL': 0.44, 'NV': 0.25, 'SCC': 0.79, 'VASC': 0.66}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            18            7  ...            2             0
true class BCC           14          107  ...            4             0
true class BKL            9            8  ...            2             0
true class DF             0            2  ...            1             0
true class MEL            9           14  ...            3             0
true class NV             3            9  ...            2             1
true class SCC            5           12  ...            6             1
true class VASC           0            4  ...            0             7

[8 rows x 8 columns]

Current validation loss: 1.683

Epoch 169:
Mean loss 0.04261557899040173 - Correctly labeled training images 97.37%
Classified 65.30 % of validation images correctly.
Precision on validation set: [0.32 0.64 0.39 0.44 0.52 0.79 0.35 0.8 ]
Recall on validation set: [0.42 0.63 0.37 0.33 0.46 0.82 0.34 0.62]
F1-score on validation set: [0.36 0.63 0.38 0.38 0.49 0.8  0.35 0.7 ]
ROC AUC on validation set: {'AK': 0.65, 'BCC': 0.92, 'BKL': 0.55, 'DF': 0.68, 'MEL': 0.43, 'NV': 0.28, 'SCC': 0.77, 'VASC': 0.64}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            18            8  ...            2             0
true class BCC           12          105  ...            9             0
true class BKL            9            9  ...            3             0
true class DF             0            3  ...            1             0
true class MEL            9           14  ...            4             0
true class NV             6           15  ...            1             2
true class SCC            3            8  ...           11             0
true class VASC           0            3  ...            0             8

[8 rows x 8 columns]

Current validation loss: 1.620

Epoch 170:
Mean loss 0.050317372830106497 - Correctly labeled training images 97.14%
Classified 63.56 % of validation images correctly.
Precision on validation set: [0.33 0.63 0.48 0.56 0.44 0.8  0.32 0.64]
Recall on validation set: [0.42 0.71 0.31 0.42 0.57 0.75 0.22 0.69]
F1-score on validation set: [0.37 0.67 0.37 0.48 0.49 0.77 0.26 0.67]
ROC AUC on validation set: {'AK': 0.72, 'BCC': 0.93, 'BKL': 0.58, 'DF': 0.69, 'MEL': 0.44, 'NV': 0.24, 'SCC': 0.8, 'VASC': 0.59}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            18           11  ...            2             0
true class BCC            8          119  ...            4             1
true class BKL           15            7  ...            2             1
true class DF             0            2  ...            2             0
true class MEL            8           17  ...            4             0
true class NV             4           20  ...            1             2
true class SCC            2           11  ...            7             1
true class VASC           0            2  ...            0             9

[8 rows x 8 columns]

Current validation loss: 1.775

Epoch 171:
Mean loss 0.06743787359247977 - Correctly labeled training images 96.43%
Classified 65.69 % of validation images correctly.
Precision on validation set: [0.32 0.65 0.38 0.43 0.52 0.79 0.44 0.82]
Recall on validation set: [0.42 0.62 0.38 0.25 0.49 0.83 0.22 0.69]
F1-score on validation set: [0.36 0.63 0.38 0.32 0.51 0.81 0.29 0.75]
ROC AUC on validation set: {'AK': 0.69, 'BCC': 0.93, 'BKL': 0.55, 'DF': 0.68, 'MEL': 0.44, 'NV': 0.26, 'SCC': 0.79, 'VASC': 0.62}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            18            6  ...            0             0
true class BCC           11          103  ...            5             0
true class BKL           10           13  ...            0             0
true class DF             1            2  ...            1             0
true class MEL            9           10  ...            1             0
true class NV             3           12  ...            2             2
true class SCC            4           10  ...            7             0
true class VASC           0            3  ...            0             9

[8 rows x 8 columns]

Current validation loss: 1.624

Epoch 172:
Mean loss 0.05593456593320091 - Correctly labeled training images 97.00%
Classified 65.38 % of validation images correctly.
Precision on validation set: [0.62 0.62 0.41 0.6  0.46 0.79 0.37 0.69]
Recall on validation set: [0.3  0.66 0.36 0.25 0.5  0.82 0.22 0.69]
F1-score on validation set: [0.41 0.64 0.38 0.35 0.48 0.8  0.27 0.69]
ROC AUC on validation set: {'AK': 0.71, 'BCC': 0.93, 'BKL': 0.57, 'DF': 0.71, 'MEL': 0.42, 'NV': 0.26, 'SCC': 0.78, 'VASC': 0.6}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            13            9  ...            1             0
true class BCC            1          111  ...            5             0
true class BKL            3           15  ...            0             1
true class DF             1            2  ...            1             0
true class MEL            1           15  ...            3             1
true class NV             0           16  ...            2             2
true class SCC            2           10  ...            7             0
true class VASC           0            2  ...            0             9

[8 rows x 8 columns]

Current validation loss: 1.675

Epoch 173:
Mean loss 0.054377314949621905 - Correctly labeled training images 96.84%
Classified 66.01 % of validation images correctly.
Precision on validation set: [0.41 0.57 0.5  0.3  0.55 0.75 0.38 0.5 ]
Recall on validation set: [0.37 0.67 0.24 0.5  0.39 0.88 0.28 0.69]
F1-score on validation set: [0.39 0.62 0.32 0.37 0.46 0.81 0.32 0.58]
ROC AUC on validation set: {'AK': 0.7, 'BCC': 0.92, 'BKL': 0.58, 'DF': 0.61, 'MEL': 0.46, 'NV': 0.24, 'SCC': 0.76, 'VASC': 0.58}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            16           13  ...            2             0
true class BCC            4          112  ...            7             1
true class BKL            8           14  ...            1             1
true class DF             0            2  ...            1             0
true class MEL            6           22  ...            3             1
true class NV             2           18  ...            1             5
true class SCC            3           12  ...            9             1
true class VASC           0            3  ...            0             9

[8 rows x 8 columns]

Current validation loss: 1.762

Epoch 174:
Mean loss 0.04323058528247237 - Correctly labeled training images 97.50%
Classified 64.20 % of validation images correctly.
Precision on validation set: [0.35 0.67 0.35 0.4  0.49 0.84 0.41 0.75]
Recall on validation set: [0.37 0.63 0.56 0.33 0.52 0.75 0.22 0.46]
F1-score on validation set: [0.36 0.65 0.43 0.36 0.51 0.79 0.29 0.57]
ROC AUC on validation set: {'AK': 0.7, 'BCC': 0.92, 'BKL': 0.55, 'DF': 0.75, 'MEL': 0.42, 'NV': 0.26, 'SCC': 0.77, 'VASC': 0.72}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            16           10  ...            0             0
true class BCC            9          105  ...            5             0
true class BKL            6            7  ...            0             0
true class DF             1            3  ...            1             0
true class MEL            8            7  ...            2             0
true class NV             2           12  ...            2             2
true class SCC            4            9  ...            7             0
true class VASC           0            4  ...            0             6

[8 rows x 8 columns]

Current validation loss: 1.728

Epoch 175:
Mean loss 0.05898364544155705 - Correctly labeled training images 96.82%
Classified 67.51 % of validation images correctly.
Precision on validation set: [0.33 0.57 0.46 0.57 0.58 0.81 0.31 0.64]
Recall on validation set: [0.33 0.79 0.37 0.33 0.44 0.84 0.25 0.69]
F1-score on validation set: [0.33 0.66 0.41 0.42 0.5  0.82 0.28 0.67]
ROC AUC on validation set: {'AK': 0.71, 'BCC': 0.94, 'BKL': 0.6, 'DF': 0.68, 'MEL': 0.47, 'NV': 0.22, 'SCC': 0.74, 'VASC': 0.56}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            14           14  ...            1             0
true class BCC            3          132  ...            7             0
true class BKL           10           13  ...            3             1
true class DF             0            4  ...            1             0
true class MEL            8           25  ...            3             1
true class NV             3           28  ...            3             2
true class SCC            4           12  ...            8             1
true class VASC           0            3  ...            0             9

/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
[8 rows x 8 columns]

Current validation loss: 1.617

Epoch 176:
Mean loss 0.04394133067513561 - Correctly labeled training images 97.27%
Classified 66.72 % of validation images correctly.
Precision on validation set: [0.35 0.57 0.42 0.6  0.55 0.81 0.47 0.75]
Recall on validation set: [0.37 0.75 0.38 0.25 0.52 0.81 0.22 0.69]
F1-score on validation set: [0.36 0.65 0.4  0.35 0.53 0.81 0.3  0.72]
ROC AUC on validation set: {'AK': 0.7, 'BCC': 0.93, 'BKL': 0.56, 'DF': 0.73, 'MEL': 0.43, 'NV': 0.26, 'SCC': 0.77, 'VASC': 0.62}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            16           14  ...            1             0
true class BCC            5          125  ...            4             0
true class BKL            8           18  ...            0             1
true class DF             0            4  ...            1             0
true class MEL            8           20  ...            0             0
true class NV             4           24  ...            2             2
true class SCC            5           12  ...            7             0
true class VASC           0            3  ...            0             9

[8 rows x 8 columns]

Current validation loss: 1.678

Epoch 177:
Mean loss 0.05905826228552524 - Correctly labeled training images 96.91%
Classified 65.14 % of validation images correctly.
Precision on validation set: [0.43 0.6  0.31 0.75 0.6  0.79 0.5  0.82]
Recall on validation set: [0.28 0.72 0.47 0.25 0.38 0.82 0.09 0.69]
F1-score on validation set: [0.34 0.65 0.38 0.38 0.46 0.8  0.16 0.75]
ROC AUC on validation set: {'AK': 0.72, 'BCC': 0.93, 'BKL': 0.56, 'DF': 0.76, 'MEL': 0.46, 'NV': 0.23, 'SCC': 0.8, 'VASC': 0.62}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            12           13  ...            1             0
true class BCC            1          121  ...            1             0
true class BKL            4           15  ...            0             0
true class DF             0            3  ...            1             0
true class MEL            5           20  ...            0             0
true class NV             1           17  ...            0             2
true class SCC            5           12  ...            3             0
true class VASC           0            2  ...            0             9

[8 rows x 8 columns]

Current validation loss: 1.746

Epoch 178:
Mean loss 0.05336473093714054 - Correctly labeled training images 97.04%
Classified 65.06 % of validation images correctly.
Precision on validation set: [0.43 0.6  0.41 0.36 0.52 0.8  0.29 0.53]
Recall on validation set: [0.37 0.63 0.4  0.33 0.47 0.81 0.38 0.62]
F1-score on validation set: [0.4  0.62 0.4  0.35 0.49 0.8  0.33 0.57]
ROC AUC on validation set: {'AK': 0.71, 'BCC': 0.92, 'BKL': 0.57, 'DF': 0.71, 'MEL': 0.45, 'NV': 0.24, 'SCC': 0.77, 'VASC': 0.62}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            16            9  ...            3             0
true class BCC            7          106  ...           11             0
true class BKL            7           14  ...            5             1
true class DF             0            2  ...            2             0
true class MEL            4           16  ...            3             1
true class NV             1           16  ...            5             5
true class SCC            2           11  ...           12             0
true class VASC           0            3  ...            0             8

[8 rows x 8 columns]

Current validation loss: 1.689

Epoch 179:
Mean loss 0.044215036415930525 - Correctly labeled training images 97.42%
Classified 65.06 % of validation images correctly.
Precision on validation set: [0.41 0.62 0.39 0.67 0.52 0.8  0.26 0.7 ]
Recall on validation set: [0.37 0.57 0.51 0.33 0.48 0.81 0.22 0.54]
F1-score on validation set: [0.39 0.6  0.44 0.44 0.5  0.8  0.24 0.61]
ROC AUC on validation set: {'AK': 0.69, 'BCC': 0.92, 'BKL': 0.54, 'DF': 0.72, 'MEL': 0.45, 'NV': 0.26, 'SCC': 0.78, 'VASC': 0.63}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            16            7  ...            2             0
true class BCC            7           95  ...           11             0
true class BKL            6            9  ...            1             0
true class DF             0            2  ...            2             0
true class MEL            5           13  ...            1             0
true class NV             2           14  ...            3             3
true class SCC            3            9  ...            7             0
true class VASC           0            3  ...            0             7

[8 rows x 8 columns]

Current validation loss: 1.661

Epoch 180:
Mean loss 0.04593735713491874 - Correctly labeled training images 97.58%
Classified 64.83 % of validation images correctly.
Precision on validation set: [0.38 0.56 0.38 0.27 0.53 0.8  0.39 0.7 ]
Recall on validation set: [0.44 0.68 0.38 0.25 0.43 0.81 0.38 0.54]
F1-score on validation set: [0.41 0.61 0.38 0.26 0.48 0.8  0.38 0.61]
ROC AUC on validation set: {'AK': 0.68, 'BCC': 0.92, 'BKL': 0.58, 'DF': 0.7, 'MEL': 0.45, 'NV': 0.24, 'SCC': 0.78, 'VASC': 0.62}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            19           10  ...            2             0
true class BCC            8          113  ...            9             0
true class BKL           10           16  ...            1             1
true class DF             1            2  ...            1             0
true class MEL            7           25  ...            4             0
true class NV             2           18  ...            2             2
true class SCC            3           13  ...           12             0
true class VASC           0            5  ...            0             7

[8 rows x 8 columns]

Current validation loss: 1.695

Epoch 181:
Mean loss 0.052839450580941964 - Correctly labeled training images 97.13%
Classified 66.48 % of validation images correctly.
Precision on validation set: [0.3  0.63 0.41 0.33 0.55 0.8  0.39 0.69]
Recall on validation set: [0.4  0.65 0.38 0.33 0.5  0.83 0.22 0.69]
F1-score on validation set: [0.34 0.64 0.4  0.33 0.52 0.81 0.28 0.69]
ROC AUC on validation set: {'AK': 0.71, 'BCC': 0.92, 'BKL': 0.58, 'DF': 0.7, 'MEL': 0.43, 'NV': 0.25, 'SCC': 0.78, 'VASC': 0.56}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            17           12  ...            1             0
true class BCC           12          109  ...            3             0
true class BKL           10           14  ...            2             1
true class DF             1            3  ...            2             0
true class MEL            7           12  ...            1             0
true class NV             4           13  ...            2             3
true class SCC            5            7  ...            7             0
true class VASC           0            3  ...            0             9

[8 rows x 8 columns]

Current validation loss: 1.672

Epoch 182:
Mean loss 0.04716209242164821 - Correctly labeled training images 97.23%
Classified 66.40 % of validation images correctly.
Precision on validation set: [0.46 0.57 0.44 0.5  0.56 0.78 0.37 0.59]
Recall on validation set: [0.42 0.66 0.4  0.33 0.36 0.86 0.41 0.77]
F1-score on validation set: [0.44 0.61 0.42 0.4  0.44 0.82 0.39 0.67]
ROC AUC on validation set: {'AK': 0.69, 'BCC': 0.92, 'BKL': 0.56, 'DF': 0.68, 'MEL': 0.48, 'NV': 0.24, 'SCC': 0.76, 'VASC': 0.54}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            18           13  ...            1             0
true class BCC            6          111  ...            9             0
true class BKL            5           16  ...            3             1
true class DF             0            3  ...            2             0
true class MEL            7           24  ...            5             0
true class NV             0           17  ...            2             5
true class SCC            3            9  ...           13             1
true class VASC           0            3  ...            0            10

/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
[8 rows x 8 columns]

Current validation loss: 1.715

Epoch 183:
Mean loss 0.0465875397049249 - Correctly labeled training images 97.28%
Classified 65.22 % of validation images correctly.
Precision on validation set: [0.4  0.58 0.44 0.42 0.51 0.79 0.32 0.86]
Recall on validation set: [0.44 0.62 0.4  0.42 0.48 0.82 0.25 0.46]
F1-score on validation set: [0.42 0.6  0.42 0.42 0.49 0.8  0.28 0.6 ]
ROC AUC on validation set: {'AK': 0.68, 'BCC': 0.92, 'BKL': 0.57, 'DF': 0.7, 'MEL': 0.47, 'NV': 0.23, 'SCC': 0.79, 'VASC': 0.67}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            19            8  ...            2             0
true class BCC           10          103  ...            7             0
true class BKL            6           11  ...            0             0
true class DF             0            2  ...            2             0
true class MEL            6           20  ...            4             0
true class NV             3           19  ...            2             1
true class SCC            3           12  ...            8             0
true class VASC           0            4  ...            0             6

[8 rows x 8 columns]

Current validation loss: 1.684

Epoch 184:
Mean loss 0.03567136716795718 - Correctly labeled training images 98.08%
Classified 66.17 % of validation images correctly.
Precision on validation set: [0.42 0.59 0.39 0.57 0.61 0.79 0.3  0.64]
Recall on validation set: [0.33 0.68 0.54 0.33 0.33 0.84 0.25 0.69]
F1-score on validation set: [0.37 0.63 0.45 0.42 0.43 0.82 0.27 0.67]
ROC AUC on validation set: {'AK': 0.67, 'BCC': 0.92, 'BKL': 0.52, 'DF': 0.69, 'MEL': 0.46, 'NV': 0.26, 'SCC': 0.77, 'VASC': 0.62}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            14           11  ...            2             0
true class BCC            6          114  ...            6             0
true class BKL            4           13  ...            0             1
true class DF             0            3  ...            1             0
true class MEL            3           23  ...            4             1
true class NV             2           14  ...            6             2
true class SCC            4           12  ...            8             1
true class VASC           0            4  ...            0             9

[8 rows x 8 columns]

Current validation loss: 1.725

Epoch 185:
Mean loss 0.03747324501175275 - Correctly labeled training images 97.74%
Classified 67.43 % of validation images correctly.
Precision on validation set: [0.47 0.65 0.43 0.27 0.55 0.78 0.44 0.69]
Recall on validation set: [0.4  0.65 0.37 0.25 0.46 0.86 0.38 0.69]
F1-score on validation set: [0.43 0.65 0.4  0.26 0.5  0.82 0.41 0.69]
ROC AUC on validation set: {'AK': 0.7, 'BCC': 0.92, 'BKL': 0.56, 'DF': 0.74, 'MEL': 0.45, 'NV': 0.24, 'SCC': 0.79, 'VASC': 0.59}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            17           10  ...            1             0
true class BCC            3          108  ...            6             0
true class BKL            7            8  ...            2             0
true class DF             0            3  ...            1             0
true class MEL            4           14  ...            3             0
true class NV             2           11  ...            2             3
true class SCC            3            9  ...           12             1
true class VASC           0            3  ...            0             9

[8 rows x 8 columns]

Current validation loss: 1.646

Epoch 186:
Mean loss 0.031267185643504815 - Correctly labeled training images 98.05%
Classified 66.64 % of validation images correctly.
Precision on validation set: [0.36 0.68 0.45 0.67 0.51 0.78 0.41 0.88]
Recall on validation set: [0.44 0.55 0.4  0.33 0.5  0.85 0.28 0.54]
F1-score on validation set: [0.4  0.61 0.42 0.44 0.5  0.81 0.33 0.67]
ROC AUC on validation set: {'AK': 0.67, 'BCC': 0.92, 'BKL': 0.56, 'DF': 0.71, 'MEL': 0.44, 'NV': 0.26, 'SCC': 0.8, 'VASC': 0.66}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            19            7  ...            1             0
true class BCC           11           92  ...            6             0
true class BKL           10            3  ...            1             0
true class DF             0            2  ...            1             0
true class MEL            6           12  ...            2             0
true class NV             3            8  ...            1             1
true class SCC            4            8  ...            9             0
true class VASC           0            3  ...            1             7

[8 rows x 8 columns]

Current validation loss: 1.740

Epoch 187:
Mean loss 0.031462833847760954 - Correctly labeled training images 98.17%
Classified 66.56 % of validation images correctly.
Precision on validation set: [0.46 0.6  0.44 0.29 0.55 0.79 0.41 0.7 ]
Recall on validation set: [0.44 0.71 0.5  0.17 0.43 0.82 0.22 0.54]
F1-score on validation set: [0.45 0.65 0.47 0.21 0.48 0.8  0.29 0.61]
ROC AUC on validation set: {'AK': 0.7, 'BCC': 0.93, 'BKL': 0.56, 'DF': 0.74, 'MEL': 0.47, 'NV': 0.23, 'SCC': 0.77, 'VASC': 0.6}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            19           10  ...            1             0
true class BCC            4          119  ...            7             0
true class BKL            6           11  ...            0             0
true class DF             0            4  ...            1             0
true class MEL            5           20  ...            0             0
true class NV             3           20  ...            0             3
true class SCC            4           12  ...            7             0
true class VASC           0            3  ...            1             7

[8 rows x 8 columns]

Current validation loss: 1.651

Epoch 188:
Mean loss 0.03059884255137941 - Correctly labeled training images 98.25%
Classified 65.77 % of validation images correctly.
Precision on validation set: [0.45 0.57 0.46 0.33 0.51 0.78 0.39 0.75]
Recall on validation set: [0.42 0.74 0.34 0.17 0.4  0.83 0.41 0.46]
F1-score on validation set: [0.43 0.64 0.39 0.22 0.45 0.8  0.4  0.57]
ROC AUC on validation set: {'AK': 0.68, 'BCC': 0.93, 'BKL': 0.58, 'DF': 0.7, 'MEL': 0.46, 'NV': 0.24, 'SCC': 0.76, 'VASC': 0.6}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            18           10  ...            2             0
true class BCC            4          124  ...            7             0
true class BKL            6           15  ...            2             0
true class DF             0            5  ...            0             0
true class MEL            6           27  ...            6             1
true class NV             2           22  ...            2             1
true class SCC            4           11  ...           13             0
true class VASC           0            4  ...            1             6

[8 rows x 8 columns]

Current validation loss: 1.843

Epoch 189:
Mean loss 0.03979452631299675 - Correctly labeled training images 97.94%
Classified 66.17 % of validation images correctly.
Precision on validation set: [0.41 0.57 0.43 0.5  0.57 0.78 0.45 0.62]
Recall on validation set: [0.42 0.68 0.44 0.17 0.4  0.84 0.28 0.62]
F1-score on validation set: [0.41 0.62 0.43 0.25 0.47 0.81 0.35 0.62]
ROC AUC on validation set: {'AK': 0.65, 'BCC': 0.92, 'BKL': 0.54, 'DF': 0.7, 'MEL': 0.46, 'NV': 0.26, 'SCC': 0.76, 'VASC': 0.58}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            18            6  ...            2             0
true class BCC            8          114  ...            3             0
true class BKL            7           14  ...            0             1
true class DF             0            4  ...            1             0
true class MEL            7           20  ...            3             0
true class NV             2           26  ...            2             4
true class SCC            2           13  ...            9             0
true class VASC           0            4  ...            0             8

[8 rows x 8 columns]

Current validation loss: 1.779

Epoch 190:
Mean loss 0.060468021041547665 - Correctly labeled training images 96.95%
Classified 65.46 % of validation images correctly.
Precision on validation set: [0.49 0.56 0.47 0.33 0.54 0.76 0.28 0.7 ]
Recall on validation set: [0.42 0.72 0.32 0.33 0.38 0.85 0.22 0.54]
F1-score on validation set: [0.45 0.63 0.38 0.33 0.45 0.8  0.25 0.61]
ROC AUC on validation set: {'AK': 0.7, 'BCC': 0.92, 'BKL': 0.57, 'DF': 0.65, 'MEL': 0.45, 'NV': 0.25, 'SCC': 0.76, 'VASC': 0.6}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            18           10  ...            4             0
true class BCC            5          120  ...            6             0
true class BKL            4           19  ...            0             0
true class DF             0            2  ...            1             0
true class MEL            6           26  ...            5             1
true class NV             1           23  ...            2             2
true class SCC            3           13  ...            7             0
true class VASC           0            2  ...            0             7

[8 rows x 8 columns]

Current validation loss: 1.761

Epoch 191:
Mean loss 0.044454740502960444 - Correctly labeled training images 97.52%
Classified 60.65 % of validation images correctly.
Precision on validation set: [0.36 0.66 0.26 0.29 0.58 0.82 0.38 0.64]
Recall on validation set: [0.44 0.62 0.64 0.17 0.29 0.74 0.38 0.69]
F1-score on validation set: [0.4  0.64 0.38 0.21 0.39 0.78 0.38 0.67]
ROC AUC on validation set: {'AK': 0.69, 'BCC': 0.92, 'BKL': 0.51, 'DF': 0.74, 'MEL': 0.46, 'NV': 0.27, 'SCC': 0.71, 'VASC': 0.59}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            19            7  ...            3             0
true class BCC            5          103  ...           11             0
true class BKL            6           11  ...            1             0
true class DF             2            2  ...            1             0
true class MEL           11           14  ...            4             0
true class NV             5           11  ...            0             5
true class SCC            5            6  ...           12             0
true class VASC           0            3  ...            0             9

[8 rows x 8 columns]

Current validation loss: 2.135

Epoch 192:
Mean loss 0.04887537287742087 - Correctly labeled training images 97.16%
Classified 64.20 % of validation images correctly.
Precision on validation set: [0.29 0.61 0.44 0.6  0.47 0.81 0.28 0.8 ]
Recall on validation set: [0.33 0.62 0.37 0.25 0.54 0.78 0.44 0.62]
F1-score on validation set: [0.3  0.61 0.4  0.35 0.5  0.8  0.34 0.7 ]
ROC AUC on validation set: {'AK': 0.68, 'BCC': 0.91, 'BKL': 0.59, 'DF': 0.71, 'MEL': 0.46, 'NV': 0.24, 'SCC': 0.71, 'VASC': 0.6}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            14           11  ...            3             0
true class BCC            9          103  ...           16             0
true class BKL           10           10  ...            6             0
true class DF             0            3  ...            1             0
true class MEL            8           14  ...            7             0
true class NV             4           18  ...            3             2
true class SCC            4            6  ...           14             0
true class VASC           0            3  ...            0             8

[8 rows x 8 columns]

Current validation loss: 1.798

Epoch 193:
Mean loss 0.04417496732853306 - Correctly labeled training images 97.57%
Classified 65.85 % of validation images correctly.
Precision on validation set: [0.38 0.54 0.49 0.5  0.5  0.82 0.34 0.69]
Recall on validation set: [0.47 0.69 0.33 0.33 0.54 0.8  0.31 0.69]
F1-score on validation set: [0.42 0.61 0.39 0.4  0.52 0.81 0.33 0.69]
ROC AUC on validation set: {'AK': 0.67, 'BCC': 0.91, 'BKL': 0.55, 'DF': 0.67, 'MEL': 0.43, 'NV': 0.28, 'SCC': 0.74, 'VASC': 0.6}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            20           12  ...            2             0
true class BCC            7          116  ...            8             0
true class BKL           12           17  ...            2             1
true class DF             0            3  ...            1             0
true class MEL            7           23  ...            5             0
true class NV             2           24  ...            1             3
true class SCC            4           15  ...           10             0
true class VASC           0            4  ...            0             9

[8 rows x 8 columns]

Current validation loss: 1.760

Epoch 194:
Mean loss 0.04819262868097516 - Correctly labeled training images 97.37%
Classified 64.67 % of validation images correctly.
Precision on validation set: [0.39 0.64 0.4  0.17 0.48 0.81 0.31 0.69]
Recall on validation set: [0.37 0.64 0.37 0.08 0.55 0.78 0.34 0.69]
F1-score on validation set: [0.38 0.64 0.39 0.11 0.51 0.8  0.32 0.69]
ROC AUC on validation set: {'AK': 0.68, 'BCC': 0.92, 'BKL': 0.55, 'DF': 0.74, 'MEL': 0.44, 'NV': 0.27, 'SCC': 0.74, 'VASC': 0.59}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            16            6  ...            3             0
true class BCC            7          107  ...           10             0
true class BKL            5           10  ...            3             1
true class DF             0            4  ...            1             0
true class MEL            5           16  ...            4             1
true class NV             4           16  ...            4             2
true class SCC            4            6  ...           11             0
true class VASC           0            3  ...            0             9

[8 rows x 8 columns]

Current validation loss: 1.886

Epoch 195:
Mean loss 0.052282488259834996 - Correctly labeled training images 97.55%
Classified 65.62 % of validation images correctly.
Precision on validation set: [0.31 0.67 0.38 0.62 0.54 0.8  0.33 0.7 ]
Recall on validation set: [0.44 0.55 0.43 0.42 0.47 0.83 0.41 0.54]
F1-score on validation set: [0.37 0.61 0.4  0.5  0.51 0.81 0.37 0.61]
ROC AUC on validation set: {'AK': 0.72, 'BCC': 0.92, 'BKL': 0.56, 'DF': 0.73, 'MEL': 0.45, 'NV': 0.24, 'SCC': 0.74, 'VASC': 0.64}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            19            9  ...            2             0
true class BCC           11           92  ...           15             0
true class BKL           12            6  ...            2             0
true class DF             0            2  ...            1             0
true class MEL           10           10  ...            3             1
true class NV             3            9  ...            2             2
true class SCC            6            6  ...           13             0
true class VASC           0            3  ...            1             7

[8 rows x 8 columns]

Current validation loss: 1.730

Epoch 196:
Mean loss 0.040517640971778436 - Correctly labeled training images 97.86%
Classified 64.27 % of validation images correctly.
Precision on validation set: [0.4  0.65 0.37 0.43 0.46 0.8  0.38 0.7 ]
Recall on validation set: [0.4  0.59 0.38 0.25 0.54 0.79 0.25 0.54]
F1-score on validation set: [0.4  0.62 0.38 0.32 0.49 0.8  0.3  0.61]
ROC AUC on validation set: {'AK': 0.75, 'BCC': 0.91, 'BKL': 0.58, 'DF': 0.78, 'MEL': 0.41, 'NV': 0.26, 'SCC': 0.77, 'VASC': 0.62}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            17           10  ...            1             0
true class BCC           10           98  ...            4             0
true class BKL            6           10  ...            3             0
true class DF             0            4  ...            1             0
true class MEL            4           10  ...            2             1
true class NV             2           11  ...            1             2
true class SCC            4            6  ...            8             0
true class VASC           0            2  ...            1             7

/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
[8 rows x 8 columns]

Current validation loss: 1.894

Epoch 197:
Mean loss 0.04001292950133661 - Correctly labeled training images 97.85%
Classified 65.14 % of validation images correctly.
Precision on validation set: [0.38 0.59 0.39 0.4  0.5  0.79 0.37 0.78]
Recall on validation set: [0.42 0.69 0.36 0.17 0.46 0.82 0.22 0.54]
F1-score on validation set: [0.4  0.64 0.37 0.24 0.48 0.8  0.27 0.64]
ROC AUC on validation set: {'AK': 0.68, 'BCC': 0.93, 'BKL': 0.56, 'DF': 0.72, 'MEL': 0.45, 'NV': 0.25, 'SCC': 0.78, 'VASC': 0.63}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            18            9  ...            2             0
true class BCC            5          116  ...            6             0
true class BKL           11           12  ...            1             0
true class DF             0            2  ...            1             0
true class MEL            6           21  ...            1             0
true class NV             4           16  ...            1             2
true class SCC            3           15  ...            7             0
true class VASC           0            4  ...            0             7

[8 rows x 8 columns]

Current validation loss: 1.726

Epoch 198:
Mean loss 0.03710497332786795 - Correctly labeled training images 97.92%
Classified 65.69 % of validation images correctly.
Precision on validation set: [0.39 0.61 0.42 0.4  0.53 0.76 0.35 0.88]
Recall on validation set: [0.49 0.66 0.3  0.17 0.44 0.85 0.22 0.54]
F1-score on validation set: [0.43 0.64 0.35 0.24 0.48 0.8  0.27 0.67]
ROC AUC on validation set: {'AK': 0.71, 'BCC': 0.93, 'BKL': 0.58, 'DF': 0.73, 'MEL': 0.45, 'NV': 0.23, 'SCC': 0.8, 'VASC': 0.62}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            21           10  ...            1             0
true class BCC            5          111  ...            6             0
true class BKL           11           13  ...            1             0
true class DF             1            4  ...            1             0
true class MEL            9           12  ...            3             0
true class NV             4           15  ...            1             1
true class SCC            3           13  ...            7             0
true class VASC           0            3  ...            0             7

[8 rows x 8 columns]

Current validation loss: 1.765

Epoch 199:
Mean loss 0.0519223237468579 - Correctly labeled training images 97.50%
Classified 65.93 % of validation images correctly.
Precision on validation set: [0.38 0.61 0.41 0.67 0.52 0.78 0.32 0.73]
Recall on validation set: [0.35 0.62 0.44 0.17 0.41 0.85 0.25 0.62]
F1-score on validation set: [0.37 0.62 0.43 0.27 0.46 0.82 0.28 0.67]
ROC AUC on validation set: {'AK': 0.75, 'BCC': 0.92, 'BKL': 0.59, 'DF': 0.78, 'MEL': 0.46, 'NV': 0.22, 'SCC': 0.81, 'VASC': 0.51}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            15           11  ...            2             0
true class BCC            8          104  ...            9             0
true class BKL            5           10  ...            2             0
true class DF             0            4  ...            1             0
true class MEL            8           18  ...            2             0
true class NV             1           11  ...            1             3
true class SCC            2           11  ...            8             0
true class VASC           0            1  ...            0             8

[8 rows x 8 columns]

Current validation loss: 1.785

Epoch 200:
Mean loss 0.039129832160805296 - Correctly labeled training images 97.72%
Classified 64.91 % of validation images correctly.
Precision on validation set: [0.37 0.62 0.36 0.29 0.52 0.82 0.32 0.6 ]
Recall on validation set: [0.35 0.65 0.52 0.17 0.43 0.8  0.25 0.69]
F1-score on validation set: [0.36 0.64 0.43 0.21 0.47 0.81 0.28 0.64]
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
ROC AUC on validation set: {'AK': 0.7, 'BCC': 0.92, 'BKL': 0.53, 'DF': 0.71, 'MEL': 0.45, 'NV': 0.26, 'SCC': 0.75, 'VASC': 0.55}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            15            8  ...            0             0
true class BCC            6          109  ...            9             1
true class BKL            5           11  ...            2             1
true class DF             0            4  ...            1             0
true class MEL            8           15  ...            3             0
true class NV             3           15  ...            2             4
true class SCC            4           11  ...            8             0
true class VASC           0            3  ...            0             9

[8 rows x 8 columns]

Current validation loss: 1.804
Training finished. Time >23.0 hours.
Model succesfully saved to /scratch/work/hakkina7/melanoma/resnet50.pth
