File path is /scratch/work/hakkina7/melanoma/
Device is cuda
Training ResNet50 model.

Epoch 1:
Mean loss 1.4263273723870045 - Correctly labeled training images 50.80%
Classified 51.03 % of validation images correctly.
Precision on validation set: [0.   0.   0.   0.   0.36 0.52 0.   0.  ]
Recall on validation set: [0.   0.   0.   0.   0.09 0.97 0.   0.  ]
F1-score on validation set: [0.   0.   0.   0.   0.15 0.68 0.   0.  ]
ROC AUC on validation set: {'AK': 0.57, 'BCC': 0.64, 'BKL': 0.61, 'DF': 0.53, 'MEL': 0.47, 'NV': 0.39, 'SCC': 0.6, 'VASC': 0.68}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0            0  ...            0             0
true class BCC            0            0  ...            0             0
true class BKL            0            0  ...            0             0
true class DF             0            0  ...            0             0
true class MEL            0            0  ...            0             0
true class NV             0            0  ...            0             0
true class SCC            0            0  ...            0             0
true class VASC           0            0  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.411

Epoch 2:
Mean loss 1.3460125983325464 - Correctly labeled training images 51.57%
Classified 51.81 % of validation images correctly.
Precision on validation set: [0.   0.4  0.   0.   0.32 0.54 0.   0.  ]
Recall on validation set: [0.   0.08 0.   0.   0.15 0.95 0.   0.  ]
F1-score on validation set: [0.   0.14 0.   0.   0.21 0.69 0.   0.  ]
ROC AUC on validation set: {'AK': 0.74, 'BCC': 0.73, 'BKL': 0.62, 'DF': 0.58, 'MEL': 0.49, 'NV': 0.3, 'SCC': 0.7, 'VASC': 0.6}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0            4  ...            0             0
true class BCC            0           14  ...            0             0
true class BKL            0            6  ...            0             0
true class DF             0            0  ...            0             0
true class MEL            0            2  ...            0             0
true class NV             0            8  ...            0             0
true class SCC            0            1  ...            0             0
true class VASC           0            0  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.342

Epoch 3:
Mean loss 1.3204116212080705 - Correctly labeled training images 52.01%
Classified 51.26 % of validation images correctly.
Precision on validation set: [0.   0.33 0.5  0.   0.3  0.57 0.   0.  ]
Recall on validation set: [0.   0.12 0.01 0.   0.29 0.87 0.   0.  ]
F1-score on validation set: [0.   0.18 0.02 0.   0.3  0.69 0.   0.  ]
ROC AUC on validation set: {'AK': 0.72, 'BCC': 0.73, 'BKL': 0.62, 'DF': 0.58, 'MEL': 0.51, 'NV': 0.29, 'SCC': 0.72, 'VASC': 0.65}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0            9  ...            0             0
true class BCC            0           20  ...            0             0
true class BKL            0            9  ...            0             0
true class DF             0            0  ...            0             0
true class MEL            0            9  ...            0             0
true class NV             0           10  ...            0             0
true class SCC            0            3  ...            0             0
true class VASC           0            1  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.348

Epoch 4:
Mean loss 1.294547939996238 - Correctly labeled training images 53.10%
Classified 52.84 % of validation images correctly.
Precision on validation set: [0.   0.3  0.   0.   0.36 0.63 0.   0.  ]
Recall on validation set: [0.   0.55 0.   0.   0.15 0.84 0.   0.  ]
F1-score on validation set: [0.   0.39 0.   0.   0.22 0.72 0.   0.  ]
ROC AUC on validation set: {'AK': 0.77, 'BCC': 0.77, 'BKL': 0.63, 'DF': 0.62, 'MEL': 0.48, 'NV': 0.26, 'SCC': 0.77, 'VASC': 0.67}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           26  ...            0             0
true class BCC            0           92  ...            0             0
true class BKL            0           43  ...            0             0
true class DF             0            4  ...            0             0
true class MEL            0           44  ...            0             0
true class NV             0           75  ...            0             0
true class SCC            0           18  ...            0             0
true class VASC           0            4  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.301

Epoch 5:
Mean loss 1.257066397354806 - Correctly labeled training images 54.11%
Classified 53.00 % of validation images correctly.
Precision on validation set: [0.   0.29 0.   0.   0.38 0.63 0.   0.  ]
Recall on validation set: [0.   0.42 0.   0.   0.28 0.84 0.   0.  ]
F1-score on validation set: [0.   0.34 0.   0.   0.32 0.72 0.   0.  ]
ROC AUC on validation set: {'AK': 0.82, 'BCC': 0.79, 'BKL': 0.64, 'DF': 0.63, 'MEL': 0.5, 'NV': 0.24, 'SCC': 0.8, 'VASC': 0.63}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           22  ...            0             0
true class BCC            0           70  ...            0             0
true class BKL            0           33  ...            0             0
true class DF             0            3  ...            0             0
true class MEL            0           41  ...            0             0
true class NV             0           51  ...            0             0
true class SCC            0           16  ...            0             0
true class VASC           0            3  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.254

Epoch 6:
Mean loss 1.2306612113296798 - Correctly labeled training images 55.22%
Classified 54.89 % of validation images correctly.
Precision on validation set: [0.   0.31 0.   0.   0.41 0.64 0.   0.  ]
Recall on validation set: [0.   0.49 0.   0.   0.24 0.87 0.   0.  ]
F1-score on validation set: [0.   0.38 0.   0.   0.3  0.74 0.   0.  ]
ROC AUC on validation set: {'AK': 0.82, 'BCC': 0.79, 'BKL': 0.65, 'DF': 0.65, 'MEL': 0.52, 'NV': 0.22, 'SCC': 0.81, 'VASC': 0.62}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           26  ...            0             0
true class BCC            0           82  ...            0             0
true class BKL            0           43  ...            0             0
true class DF             0            3  ...            0             0
true class MEL            0           41  ...            0             0
true class NV             0           45  ...            0             0
true class SCC            0           17  ...            0             0
true class VASC           0            4  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.242

Epoch 7:
Mean loss 1.2187857341127064 - Correctly labeled training images 55.79%
Classified 54.81 % of validation images correctly.
Precision on validation set: [0.   0.34 0.   0.   0.42 0.59 0.   0.  ]
Recall on validation set: [0.   0.32 0.   0.   0.19 0.93 0.   0.  ]
F1-score on validation set: [0.   0.33 0.   0.   0.26 0.73 0.   0.  ]
ROC AUC on validation set: {'AK': 0.79, 'BCC': 0.8, 'BKL': 0.63, 'DF': 0.7, 'MEL': 0.51, 'NV': 0.22, 'SCC': 0.83, 'VASC': 0.67}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           18  ...            0             0
true class BCC            0           54  ...            0             0
true class BKL            0           24  ...            0             0
true class DF             0            1  ...            0             0
true class MEL            0           23  ...            0             0
true class NV             0           23  ...            0             0
true class SCC            0           14  ...            0             0
true class VASC           0            3  ...            0             0

/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
[8 rows x 8 columns]

Current validation loss: 1.238

Epoch 8:
Mean loss 1.2042106130521757 - Correctly labeled training images 56.63%
Classified 56.55 % of validation images correctly.
Precision on validation set: [0.   0.33 0.   0.   0.46 0.68 0.   0.  ]
Recall on validation set: [0.   0.61 0.   0.   0.32 0.84 0.   0.  ]
F1-score on validation set: [0.   0.43 0.   0.   0.38 0.75 0.   0.  ]
ROC AUC on validation set: {'AK': 0.8, 'BCC': 0.81, 'BKL': 0.64, 'DF': 0.71, 'MEL': 0.48, 'NV': 0.23, 'SCC': 0.85, 'VASC': 0.69}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           30  ...            0             0
true class BCC            0          102  ...            0             0
true class BKL            0           46  ...            0             0
true class DF             0            7  ...            0             0
true class MEL            0           43  ...            0             0
true class NV             0           57  ...            0             0
true class SCC            0           24  ...            0             0
true class VASC           0            4  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.227

Epoch 9:
Mean loss 1.19988462488734 - Correctly labeled training images 56.58%
Classified 55.36 % of validation images correctly.
Precision on validation set: [0.   0.35 0.23 0.   0.35 0.7  0.   0.  ]
Recall on validation set: [0.   0.57 0.04 0.   0.35 0.81 0.   0.  ]
F1-score on validation set: [0.   0.43 0.07 0.   0.35 0.75 0.   0.  ]
ROC AUC on validation set: {'AK': 0.81, 'BCC': 0.82, 'BKL': 0.65, 'DF': 0.73, 'MEL': 0.49, 'NV': 0.21, 'SCC': 0.83, 'VASC': 0.66}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           23  ...            0             0
true class BCC            0           96  ...            0             0
true class BKL            0           37  ...            0             0
true class DF             0            5  ...            0             0
true class MEL            0           44  ...            0             0
true class NV             0           45  ...            0             0
true class SCC            0           22  ...            0             0
true class VASC           0            4  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.208

Epoch 10:
Mean loss 1.1831894805566745 - Correctly labeled training images 57.25%
Classified 55.28 % of validation images correctly.
Precision on validation set: [0.   0.31 0.42 0.   0.41 0.72 0.   0.  ]
Recall on validation set: [0.   0.65 0.06 0.   0.4  0.77 0.   0.  ]
F1-score on validation set: [0.   0.42 0.11 0.   0.4  0.75 0.   0.  ]
ROC AUC on validation set: {'AK': 0.81, 'BCC': 0.82, 'BKL': 0.64, 'DF': 0.76, 'MEL': 0.51, 'NV': 0.21, 'SCC': 0.85, 'VASC': 0.67}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           31  ...            0             0
true class BCC            0          108  ...            0             0
true class BKL            0           45  ...            0             0
true class DF             0            7  ...            0             0
true class MEL            0           53  ...            0             0
true class NV             0           68  ...            0             0
true class SCC            0           27  ...            0             0
true class VASC           0            5  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.215

Epoch 11:
Mean loss 1.1704848400237808 - Correctly labeled training images 57.69%
Classified 56.23 % of validation images correctly.
Precision on validation set: [0.   0.31 0.29 0.   0.46 0.72 0.   0.  ]
Recall on validation set: [0.   0.66 0.1  0.   0.31 0.81 0.   0.  ]
F1-score on validation set: [0.   0.43 0.15 0.   0.37 0.76 0.   0.  ]
ROC AUC on validation set: {'AK': 0.83, 'BCC': 0.82, 'BKL': 0.63, 'DF': 0.76, 'MEL': 0.51, 'NV': 0.21, 'SCC': 0.84, 'VASC': 0.64}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           32  ...            0             0
true class BCC            0          111  ...            0             0
true class BKL            0           48  ...            0             0
true class DF             0            7  ...            0             0
true class MEL            0           53  ...            0             0
true class NV             0           71  ...            0             0
true class SCC            0           27  ...            0             0
true class VASC           0            4  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.207

Epoch 12:
Mean loss 1.164503087662748 - Correctly labeled training images 58.00%
Classified 56.94 % of validation images correctly.
Precision on validation set: [0.   0.34 0.5  0.   0.45 0.68 0.   0.  ]
Recall on validation set: [0.   0.63 0.01 0.   0.25 0.87 0.   0.  ]
F1-score on validation set: [0.   0.44 0.02 0.   0.32 0.76 0.   0.  ]
ROC AUC on validation set: {'AK': 0.81, 'BCC': 0.83, 'BKL': 0.65, 'DF': 0.78, 'MEL': 0.49, 'NV': 0.21, 'SCC': 0.84, 'VASC': 0.64}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           28  ...            0             0
true class BCC            0          105  ...            0             0
true class BKL            0           45  ...            0             0
true class DF             0            7  ...            0             0
true class MEL            0           46  ...            0             0
true class NV             0           51  ...            0             0
true class SCC            0           25  ...            0             0
true class VASC           0            4  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.174

Epoch 13:
Mean loss 1.1557267600617573 - Correctly labeled training images 58.06%
Classified 58.28 % of validation images correctly.
Precision on validation set: [0.   0.35 0.21 0.   0.48 0.7  0.   0.  ]
Recall on validation set: [0.   0.66 0.02 0.   0.29 0.87 0.   0.  ]
F1-score on validation set: [0.   0.46 0.04 0.   0.36 0.78 0.   0.  ]
ROC AUC on validation set: {'AK': 0.8, 'BCC': 0.83, 'BKL': 0.66, 'DF': 0.75, 'MEL': 0.49, 'NV': 0.21, 'SCC': 0.86, 'VASC': 0.66}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           28  ...            0             0
true class BCC            0          110  ...            0             0
true class BKL            0           48  ...            0             0
true class DF             0            6  ...            0             0
true class MEL            0           48  ...            0             0
true class NV             0           44  ...            0             0
true class SCC            0           28  ...            0             0
true class VASC           0            4  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.181

Epoch 14:
Mean loss 1.1534022223498166 - Correctly labeled training images 58.23%
Classified 58.52 % of validation images correctly.
Precision on validation set: [0.   0.38 0.29 0.   0.48 0.67 0.   0.  ]
Recall on validation set: [0.   0.55 0.09 0.   0.26 0.9  0.   0.  ]
F1-score on validation set: [0.   0.45 0.14 0.   0.34 0.77 0.   0.  ]
ROC AUC on validation set: {'AK': 0.81, 'BCC': 0.84, 'BKL': 0.64, 'DF': 0.82, 'MEL': 0.5, 'NV': 0.2, 'SCC': 0.85, 'VASC': 0.63}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           24  ...            0             0
true class BCC            0           92  ...            0             0
true class BKL            0           28  ...            0             0
true class DF             0            8  ...            0             0
true class MEL            0           30  ...            0             0
true class NV             0           30  ...            0             0
true class SCC            0           24  ...            0             0
true class VASC           0            3  ...            0             0

/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
[8 rows x 8 columns]

Current validation loss: 1.150

Epoch 15:
Mean loss 1.1423994271725133 - Correctly labeled training images 58.70%
Classified 58.83 % of validation images correctly.
Precision on validation set: [0.   0.35 0.33 0.   0.6  0.69 0.   0.  ]
Recall on validation set: [0.   0.71 0.05 0.   0.24 0.88 0.   0.  ]
F1-score on validation set: [0.   0.46 0.09 0.   0.35 0.78 0.   0.  ]
ROC AUC on validation set: {'AK': 0.82, 'BCC': 0.84, 'BKL': 0.65, 'DF': 0.77, 'MEL': 0.52, 'NV': 0.18, 'SCC': 0.86, 'VASC': 0.62}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           31  ...            0             0
true class BCC            0          118  ...            0             0
true class BKL            0           47  ...            0             0
true class DF             0            6  ...            0             0
true class MEL            0           56  ...            0             0
true class NV             0           52  ...            0             0
true class SCC            0           27  ...            0             0
true class VASC           0            4  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.164

Epoch 16:
Mean loss 1.138626763309214 - Correctly labeled training images 58.83%
Classified 57.18 % of validation images correctly.
Precision on validation set: [0.   0.37 0.31 0.   0.53 0.63 0.   0.  ]
Recall on validation set: [0.   0.56 0.04 0.   0.1  0.94 0.   0.  ]
F1-score on validation set: [0.   0.45 0.07 0.   0.17 0.75 0.   0.  ]
ROC AUC on validation set: {'AK': 0.82, 'BCC': 0.84, 'BKL': 0.65, 'DF': 0.79, 'MEL': 0.52, 'NV': 0.18, 'SCC': 0.87, 'VASC': 0.64}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           25  ...            0             0
true class BCC            0           93  ...            0             0
true class BKL            0           27  ...            0             0
true class DF             0            6  ...            0             0
true class MEL            0           40  ...            0             0
true class NV             0           27  ...            0             0
true class SCC            0           27  ...            0             0
true class VASC           0            4  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.176

Epoch 17:
Mean loss 1.1315924804481423 - Correctly labeled training images 59.29%
Classified 57.97 % of validation images correctly.
Precision on validation set: [0.   0.33 0.3  0.   0.58 0.7  0.   0.  ]
Recall on validation set: [0.   0.68 0.06 0.   0.23 0.87 0.   0.  ]
F1-score on validation set: [0.   0.44 0.1  0.   0.33 0.78 0.   0.  ]
ROC AUC on validation set: {'AK': 0.81, 'BCC': 0.84, 'BKL': 0.64, 'DF': 0.76, 'MEL': 0.51, 'NV': 0.19, 'SCC': 0.88, 'VASC': 0.7}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           32  ...            0             0
true class BCC            0          113  ...            0             0
true class BKL            0           48  ...            0             0
true class DF             0            7  ...            0             0
true class MEL            0           59  ...            0             0
true class NV             0           56  ...            0             0
true class SCC            0           28  ...            0             0
true class VASC           0            4  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.164

Epoch 18:
Mean loss 1.1237103434203175 - Correctly labeled training images 59.72%
Classified 59.38 % of validation images correctly.
Precision on validation set: [0.   0.39 0.25 0.   0.45 0.7  0.   0.  ]
Recall on validation set: [0.   0.54 0.1  0.   0.32 0.89 0.   0.  ]
F1-score on validation set: [0.   0.46 0.14 0.   0.38 0.79 0.   0.  ]
ROC AUC on validation set: {'AK': 0.83, 'BCC': 0.85, 'BKL': 0.63, 'DF': 0.78, 'MEL': 0.52, 'NV': 0.18, 'SCC': 0.88, 'VASC': 0.64}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           25  ...            0             0
true class BCC            0           91  ...            0             0
true class BKL            0           24  ...            0             0
true class DF             0            7  ...            0             0
true class MEL            0           37  ...            0             0
true class NV             0           20  ...            0             0
true class SCC            0           24  ...            0             0
true class VASC           0            4  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.125

Epoch 19:
Mean loss 1.1163166560209137 - Correctly labeled training images 59.53%
Classified 57.33 % of validation images correctly.
Precision on validation set: [0.   0.35 0.28 0.   0.43 0.73 0.   0.  ]
Recall on validation set: [0.   0.63 0.12 0.   0.36 0.81 0.   0.  ]
F1-score on validation set: [0.   0.45 0.17 0.   0.39 0.77 0.   0.  ]
ROC AUC on validation set: {'AK': 0.84, 'BCC': 0.85, 'BKL': 0.64, 'DF': 0.83, 'MEL': 0.51, 'NV': 0.19, 'SCC': 0.85, 'VASC': 0.66}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           32  ...            0             0
true class BCC            0          105  ...            0             0
true class BKL            0           36  ...            0             0
true class DF             0            9  ...            0             0
true class MEL            0           47  ...            0             0
true class NV             0           40  ...            0             0
true class SCC            0           25  ...            0             0
true class VASC           0            4  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.147

Epoch 20:
Mean loss 1.1111784862231004 - Correctly labeled training images 59.87%
Classified 59.54 % of validation images correctly.
Precision on validation set: [0.   0.37 0.29 0.   0.46 0.76 0.   0.  ]
Recall on validation set: [0.   0.72 0.11 0.   0.38 0.83 0.   0.  ]
F1-score on validation set: [0.   0.49 0.16 0.   0.42 0.79 0.   0.  ]
ROC AUC on validation set: {'AK': 0.83, 'BCC': 0.85, 'BKL': 0.65, 'DF': 0.8, 'MEL': 0.49, 'NV': 0.19, 'SCC': 0.88, 'VASC': 0.68}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           33  ...            0             0
true class BCC            0          120  ...            0             0
true class BKL            0           38  ...            0             0
true class DF             0            8  ...            0             0
true class MEL            0           51  ...            1             0
true class NV             0           43  ...            0             0
true class SCC            0           28  ...            0             0
true class VASC           0            4  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.126

Epoch 21:
Mean loss 1.1002778022635247 - Correctly labeled training images 60.44%
Classified 58.91 % of validation images correctly.
Precision on validation set: [0.   0.36 0.35 0.   0.53 0.69 0.   0.  ]
Recall on validation set: [0.   0.69 0.05 0.   0.22 0.89 0.   0.  ]
F1-score on validation set: [0.   0.47 0.09 0.   0.31 0.78 0.   0.  ]
ROC AUC on validation set: {'AK': 0.84, 'BCC': 0.86, 'BKL': 0.64, 'DF': 0.79, 'MEL': 0.5, 'NV': 0.19, 'SCC': 0.86, 'VASC': 0.66}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           34  ...            0             0
true class BCC            0          115  ...            0             0
true class BKL            0           43  ...            0             0
true class DF             0            8  ...            0             0
true class MEL            0           50  ...            0             0
true class NV             0           39  ...            0             0
true class SCC            0           27  ...            0             0
true class VASC           0            4  ...            0             0

/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
[8 rows x 8 columns]

Current validation loss: 1.134

Epoch 22:
Mean loss 1.09673688793408 - Correctly labeled training images 60.59%
Classified 59.15 % of validation images correctly.
Precision on validation set: [0.   0.37 0.44 0.   0.46 0.7  0.   0.  ]
Recall on validation set: [0.   0.69 0.05 0.   0.31 0.87 0.   0.  ]
F1-score on validation set: [0.   0.49 0.1  0.   0.37 0.78 0.   0.  ]
ROC AUC on validation set: {'AK': 0.84, 'BCC': 0.86, 'BKL': 0.63, 'DF': 0.79, 'MEL': 0.52, 'NV': 0.18, 'SCC': 0.85, 'VASC': 0.62}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           33  ...            0             0
true class BCC            0          115  ...            0             0
true class BKL            0           37  ...            0             0
true class DF             0            8  ...            0             0
true class MEL            0           48  ...            0             0
true class NV             0           36  ...            0             0
true class SCC            0           26  ...            0             0
true class VASC           0            4  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.129

Epoch 23:
Mean loss 1.094328561603835 - Correctly labeled training images 60.60%
Classified 58.91 % of validation images correctly.
Precision on validation set: [0.   0.35 0.34 0.   0.51 0.71 0.   0.  ]
Recall on validation set: [0.   0.67 0.12 0.   0.24 0.88 0.   0.  ]
F1-score on validation set: [0.   0.46 0.18 0.   0.33 0.79 0.   0.  ]
ROC AUC on validation set: {'AK': 0.81, 'BCC': 0.85, 'BKL': 0.65, 'DF': 0.74, 'MEL': 0.5, 'NV': 0.19, 'SCC': 0.86, 'VASC': 0.69}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           31  ...            0             0
true class BCC            0          112  ...            0             0
true class BKL            0           43  ...            0             0
true class DF             0            5  ...            0             0
true class MEL            0           57  ...            1             0
true class NV             0           42  ...            0             0
true class SCC            0           28  ...            0             0
true class VASC           0            4  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.151

Epoch 24:
Mean loss 1.0863823372670904 - Correctly labeled training images 60.80%
Classified 59.46 % of validation images correctly.
Precision on validation set: [0.   0.37 0.3  0.   0.44 0.73 0.   0.  ]
Recall on validation set: [0.   0.7  0.02 0.   0.33 0.87 0.   0.  ]
F1-score on validation set: [0.   0.48 0.04 0.   0.38 0.79 0.   0.  ]
ROC AUC on validation set: {'AK': 0.82, 'BCC': 0.86, 'BKL': 0.65, 'DF': 0.85, 'MEL': 0.5, 'NV': 0.18, 'SCC': 0.86, 'VASC': 0.66}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           33  ...            0             0
true class BCC            0          117  ...            0             0
true class BKL            0           45  ...            0             0
true class DF             0           10  ...            0             0
true class MEL            0           42  ...            0             0
true class NV             0           41  ...            0             0
true class SCC            0           26  ...            0             0
true class VASC           0            4  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.114

Epoch 25:
Mean loss 1.077078620624091 - Correctly labeled training images 61.17%
Classified 60.09 % of validation images correctly.
Precision on validation set: [0.   0.37 0.34 0.   0.52 0.72 0.   0.  ]
Recall on validation set: [0.   0.71 0.12 0.   0.26 0.88 0.   0.  ]
F1-score on validation set: [0.   0.49 0.18 0.   0.35 0.79 0.   0.  ]
ROC AUC on validation set: {'AK': 0.82, 'BCC': 0.87, 'BKL': 0.64, 'DF': 0.82, 'MEL': 0.51, 'NV': 0.18, 'SCC': 0.86, 'VASC': 0.67}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           33  ...            1             0
true class BCC            0          118  ...            0             0
true class BKL            0           42  ...            0             0
true class DF             0            9  ...            0             0
true class MEL            0           47  ...            1             0
true class NV             0           35  ...            0             0
true class SCC            0           27  ...            0             0
true class VASC           0            5  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.099

Epoch 26:
Mean loss 1.077796595329742 - Correctly labeled training images 61.26%
Classified 60.41 % of validation images correctly.
Precision on validation set: [0.   0.38 0.41 0.   0.46 0.72 0.   0.  ]
Recall on validation set: [0.   0.68 0.05 0.   0.34 0.89 0.   0.  ]
F1-score on validation set: [0.   0.49 0.09 0.   0.39 0.79 0.   0.  ]
ROC AUC on validation set: {'AK': 0.81, 'BCC': 0.87, 'BKL': 0.65, 'DF': 0.81, 'MEL': 0.52, 'NV': 0.17, 'SCC': 0.87, 'VASC': 0.68}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           29  ...            0             0
true class BCC            0          113  ...            0             0
true class BKL            0           37  ...            0             0
true class DF             0            9  ...            0             0
true class MEL            0           47  ...            0             0
true class NV             0           29  ...            0             0
true class SCC            0           26  ...            0             0
true class VASC           0            4  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.098

Epoch 27:
Mean loss 1.072748735218018 - Correctly labeled training images 61.77%
Classified 60.41 % of validation images correctly.
Precision on validation set: [0.   0.37 0.43 0.   0.47 0.74 0.   0.  ]
Recall on validation set: [0.   0.8  0.11 0.   0.24 0.88 0.   0.  ]
F1-score on validation set: [0.   0.5  0.18 0.   0.32 0.8  0.   0.  ]
ROC AUC on validation set: {'AK': 0.81, 'BCC': 0.88, 'BKL': 0.65, 'DF': 0.82, 'MEL': 0.5, 'NV': 0.18, 'SCC': 0.86, 'VASC': 0.67}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           34  ...            0             0
true class BCC            0          133  ...            0             0
true class BKL            0           54  ...            0             0
true class DF             0            9  ...            0             0
true class MEL            0           55  ...            1             0
true class NV             0           43  ...            0             0
true class SCC            0           28  ...            0             0
true class VASC           0            4  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.102

Epoch 28:
Mean loss 1.0565889328248117 - Correctly labeled training images 62.10%
Classified 60.09 % of validation images correctly.
Precision on validation set: [0.   0.35 0.48 0.   0.59 0.71 0.   0.  ]
Recall on validation set: [0.   0.76 0.08 0.   0.2  0.9  0.   0.  ]
F1-score on validation set: [0.   0.48 0.13 0.   0.3  0.8  0.   0.  ]
ROC AUC on validation set: {'AK': 0.83, 'BCC': 0.87, 'BKL': 0.64, 'DF': 0.79, 'MEL': 0.51, 'NV': 0.18, 'SCC': 0.85, 'VASC': 0.65}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           35  ...            0             0
true class BCC            0          127  ...            0             0
true class BKL            0           51  ...            0             0
true class DF             0            8  ...            0             0
true class MEL            0           60  ...            0             0
true class NV             0           46  ...            0             0
true class SCC            0           28  ...            0             0
true class VASC           0            4  ...            0             0

/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
[8 rows x 8 columns]

Current validation loss: 1.136

Epoch 29:
Mean loss 1.0579761686009188 - Correctly labeled training images 62.14%
Classified 60.17 % of validation images correctly.
Precision on validation set: [0.   0.38 0.38 0.   0.44 0.75 0.33 0.  ]
Recall on validation set: [0.   0.71 0.13 0.   0.36 0.85 0.03 0.  ]
F1-score on validation set: [0.   0.5  0.19 0.   0.39 0.8  0.06 0.  ]
ROC AUC on validation set: {'AK': 0.83, 'BCC': 0.87, 'BKL': 0.64, 'DF': 0.81, 'MEL': 0.51, 'NV': 0.17, 'SCC': 0.85, 'VASC': 0.71}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           34  ...            0             0
true class BCC            0          119  ...            1             0
true class BKL            0           40  ...            0             0
true class DF             0            9  ...            0             0
true class MEL            0           44  ...            1             0
true class NV             0           37  ...            0             0
true class SCC            0           24  ...            1             0
true class VASC           0            4  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.093

Epoch 30:
Mean loss 1.0538321860393138 - Correctly labeled training images 62.22%
Classified 60.65 % of validation images correctly.
Precision on validation set: [0.   0.39 0.32 0.   0.5  0.72 0.   0.  ]
Recall on validation set: [0.   0.71 0.11 0.   0.27 0.89 0.   0.  ]
F1-score on validation set: [0.   0.5  0.17 0.   0.35 0.8  0.   0.  ]
ROC AUC on validation set: {'AK': 0.81, 'BCC': 0.88, 'BKL': 0.64, 'DF': 0.79, 'MEL': 0.52, 'NV': 0.17, 'SCC': 0.85, 'VASC': 0.71}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           32  ...            0             0
true class BCC            0          118  ...            0             0
true class BKL            0           44  ...            0             0
true class DF             0            8  ...            0             0
true class MEL            0           41  ...            1             0
true class NV             0           29  ...            0             0
true class SCC            0           25  ...            0             0
true class VASC           0            4  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.084

Epoch 31:
Mean loss 1.049771720020553 - Correctly labeled training images 62.24%
Classified 60.25 % of validation images correctly.
Precision on validation set: [0.   0.41 0.37 0.   0.53 0.68 0.   0.  ]
Recall on validation set: [0.   0.65 0.13 0.   0.22 0.91 0.   0.  ]
F1-score on validation set: [0.   0.5  0.19 0.   0.31 0.78 0.   0.  ]
ROC AUC on validation set: {'AK': 0.82, 'BCC': 0.88, 'BKL': 0.64, 'DF': 0.82, 'MEL': 0.5, 'NV': 0.18, 'SCC': 0.85, 'VASC': 0.7}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           28  ...            0             0
true class BCC            0          109  ...            0             0
true class BKL            0           30  ...            0             0
true class DF             0            9  ...            0             0
true class MEL            0           35  ...            1             0
true class NV             0           27  ...            0             0
true class SCC            0           26  ...            0             0
true class VASC           0            4  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.102

Epoch 32:
Mean loss 1.044747083345046 - Correctly labeled training images 62.47%
Classified 59.94 % of validation images correctly.
Precision on validation set: [0.   0.41 0.55 0.   0.5  0.67 0.   0.  ]
Recall on validation set: [0.   0.63 0.05 0.   0.27 0.91 0.   0.  ]
F1-score on validation set: [0.   0.5  0.08 0.   0.35 0.77 0.   0.  ]
ROC AUC on validation set: {'AK': 0.83, 'BCC': 0.87, 'BKL': 0.65, 'DF': 0.83, 'MEL': 0.51, 'NV': 0.17, 'SCC': 0.86, 'VASC': 0.69}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           28  ...            0             0
true class BCC            0          106  ...            0             0
true class BKL            0           34  ...            0             0
true class DF             0            7  ...            0             0
true class MEL            1           33  ...            0             0
true class NV             0           26  ...            0             0
true class SCC            0           23  ...            0             0
true class VASC           0            4  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.098

Epoch 33:
Mean loss 1.0431985592804496 - Correctly labeled training images 62.66%
Classified 60.25 % of validation images correctly.
Precision on validation set: [0.   0.38 0.38 0.   0.45 0.73 0.   0.  ]
Recall on validation set: [0.   0.71 0.07 0.   0.31 0.88 0.   0.  ]
F1-score on validation set: [0.   0.5  0.12 0.   0.37 0.79 0.   0.  ]
ROC AUC on validation set: {'AK': 0.83, 'BCC': 0.88, 'BKL': 0.64, 'DF': 0.82, 'MEL': 0.5, 'NV': 0.18, 'SCC': 0.87, 'VASC': 0.71}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           35  ...            0             0
true class BCC            0          119  ...            0             0
true class BKL            0           43  ...            0             0
true class DF             0            9  ...            0             0
true class MEL            0           42  ...            0             0
true class NV             0           33  ...            0             0
true class SCC            0           25  ...            0             0
true class VASC           0            4  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.078

Epoch 34:
Mean loss 1.0341117581358468 - Correctly labeled training images 62.76%
Classified 59.31 % of validation images correctly.
Precision on validation set: [0.   0.35 0.67 0.   0.5  0.74 0.   0.  ]
Recall on validation set: [0.   0.83 0.08 0.   0.28 0.84 0.   0.  ]
F1-score on validation set: [0.   0.49 0.14 0.   0.36 0.79 0.   0.  ]
ROC AUC on validation set: {'AK': 0.81, 'BCC': 0.87, 'BKL': 0.64, 'DF': 0.81, 'MEL': 0.5, 'NV': 0.18, 'SCC': 0.84, 'VASC': 0.76}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           37  ...            0             0
true class BCC            0          139  ...            0             0
true class BKL            0           56  ...            0             0
true class DF             0            8  ...            0             0
true class MEL            0           55  ...            0             0
true class NV             0           68  ...            0             0
true class SCC            0           29  ...            0             0
true class VASC           0            8  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.121

Epoch 35:
Mean loss 1.0311873527919457 - Correctly labeled training images 63.05%
Classified 61.67 % of validation images correctly.
Precision on validation set: [0.   0.38 0.5  0.   0.49 0.75 0.   0.  ]
Recall on validation set: [0.   0.75 0.15 0.   0.34 0.87 0.   0.  ]
F1-score on validation set: [0.   0.51 0.22 0.   0.4  0.81 0.   0.  ]
ROC AUC on validation set: {'AK': 0.81, 'BCC': 0.89, 'BKL': 0.63, 'DF': 0.83, 'MEL': 0.51, 'NV': 0.17, 'SCC': 0.86, 'VASC': 0.75}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           32  ...            0             0
true class BCC            0          125  ...            0             0
true class BKL            0           45  ...            0             0
true class DF             0            9  ...            0             0
true class MEL            0           48  ...            1             0
true class NV             0           33  ...            0             0
true class SCC            0           28  ...            0             0
true class VASC           0            5  ...            0             0

/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
[8 rows x 8 columns]

Current validation loss: 1.068

Epoch 36:
Mean loss 1.021432607989958 - Correctly labeled training images 63.74%
Classified 60.09 % of validation images correctly.
Precision on validation set: [0.   0.42 0.31 0.   0.43 0.76 0.17 0.  ]
Recall on validation set: [0.   0.68 0.21 0.   0.38 0.83 0.03 0.  ]
F1-score on validation set: [0.   0.52 0.25 0.   0.4  0.79 0.05 0.  ]
ROC AUC on validation set: {'AK': 0.82, 'BCC': 0.88, 'BKL': 0.62, 'DF': 0.82, 'MEL': 0.51, 'NV': 0.18, 'SCC': 0.85, 'VASC': 0.71}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           28  ...            1             0
true class BCC            0          114  ...            1             0
true class BKL            0           31  ...            2             0
true class DF             0            9  ...            0             0
true class MEL            0           35  ...            1             0
true class NV             0           27  ...            0             0
true class SCC            0           23  ...            1             0
true class VASC           0            5  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.074

Epoch 37:
Mean loss 1.0186688211814086 - Correctly labeled training images 63.31%
Classified 62.38 % of validation images correctly.
Precision on validation set: [0.   0.42 0.4  0.   0.58 0.71 0.   0.  ]
Recall on validation set: [0.   0.71 0.13 0.   0.27 0.92 0.   0.  ]
F1-score on validation set: [0.   0.53 0.2  0.   0.37 0.8  0.   0.  ]
ROC AUC on validation set: {'AK': 0.83, 'BCC': 0.89, 'BKL': 0.64, 'DF': 0.85, 'MEL': 0.51, 'NV': 0.16, 'SCC': 0.86, 'VASC': 0.71}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           33  ...            0             0
true class BCC            0          118  ...            0             0
true class BKL            0           31  ...            0             0
true class DF             0            9  ...            0             0
true class MEL            0           40  ...            0             0
true class NV             0           19  ...            0             0
true class SCC            0           27  ...            0             0
true class VASC           0            5  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.065

Epoch 38:
Mean loss 1.0138217439222788 - Correctly labeled training images 63.69%
Classified 61.59 % of validation images correctly.
Precision on validation set: [0.   0.39 0.46 0.   0.47 0.78 0.   0.  ]
Recall on validation set: [0.   0.8  0.12 0.   0.4  0.84 0.   0.  ]
F1-score on validation set: [0.   0.53 0.19 0.   0.43 0.81 0.   0.  ]
ROC AUC on validation set: {'AK': 0.79, 'BCC': 0.89, 'BKL': 0.63, 'DF': 0.84, 'MEL': 0.5, 'NV': 0.18, 'SCC': 0.86, 'VASC': 0.72}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           33  ...            1             0
true class BCC            0          133  ...            3             0
true class BKL            0           44  ...            0             0
true class DF             0            9  ...            0             0
true class MEL            0           44  ...            1             0
true class NV             0           44  ...            0             0
true class SCC            0           27  ...            0             0
true class VASC           0            5  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.068

Epoch 39:
Mean loss 1.0087280483087906 - Correctly labeled training images 63.79%
Classified 61.51 % of validation images correctly.
Precision on validation set: [0.   0.41 0.37 0.   0.51 0.72 0.   0.  ]
Recall on validation set: [0.   0.72 0.08 0.   0.31 0.9  0.   0.  ]
F1-score on validation set: [0.   0.52 0.14 0.   0.39 0.8  0.   0.  ]
ROC AUC on validation set: {'AK': 0.81, 'BCC': 0.89, 'BKL': 0.65, 'DF': 0.83, 'MEL': 0.51, 'NV': 0.17, 'SCC': 0.85, 'VASC': 0.7}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           31  ...            0             0
true class BCC            0          121  ...            0             0
true class BKL            0           42  ...            0             0
true class DF             0            8  ...            0             0
true class MEL            0           34  ...            1             0
true class NV             0           27  ...            0             0
true class SCC            0           26  ...            0             0
true class VASC           0            5  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.071

Epoch 40:
Mean loss 1.0005479461575155 - Correctly labeled training images 64.11%
Classified 61.83 % of validation images correctly.
Precision on validation set: [0.   0.44 0.39 0.   0.45 0.73 0.   0.  ]
Recall on validation set: [0.   0.7  0.14 0.   0.37 0.88 0.   0.  ]
F1-score on validation set: [0.   0.54 0.2  0.   0.4  0.8  0.   0.  ]
ROC AUC on validation set: {'AK': 0.82, 'BCC': 0.89, 'BKL': 0.64, 'DF': 0.84, 'MEL': 0.5, 'NV': 0.17, 'SCC': 0.86, 'VASC': 0.69}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           26  ...            0             0
true class BCC            0          117  ...            0             0
true class BKL            0           30  ...            1             0
true class DF             0            9  ...            0             0
true class MEL            0           35  ...            1             0
true class NV             0           19  ...            0             0
true class SCC            0           24  ...            0             0
true class VASC           0            5  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.045

Epoch 41:
Mean loss 0.9947427986924204 - Correctly labeled training images 64.48%
Classified 62.78 % of validation images correctly.
Precision on validation set: [0.   0.43 0.32 0.   0.57 0.72 0.   0.  ]
Recall on validation set: [0.   0.76 0.05 0.   0.32 0.92 0.   0.  ]
F1-score on validation set: [0.   0.55 0.09 0.   0.41 0.81 0.   0.  ]
ROC AUC on validation set: {'AK': 0.82, 'BCC': 0.9, 'BKL': 0.65, 'DF': 0.86, 'MEL': 0.5, 'NV': 0.17, 'SCC': 0.86, 'VASC': 0.68}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           32  ...            0             0
true class BCC            0          127  ...            1             0
true class BKL            0           41  ...            0             0
true class DF             0            9  ...            0             0
true class MEL            0           36  ...            1             0
true class NV             1           23  ...            0             0
true class SCC            0           25  ...            0             0
true class VASC           0            4  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.051

Epoch 42:
Mean loss 0.9916651369269338 - Correctly labeled training images 64.56%
Classified 61.75 % of validation images correctly.
Precision on validation set: [0.   0.43 0.44 0.   0.46 0.76 0.   0.  ]
Recall on validation set: [0.   0.71 0.24 0.   0.41 0.84 0.   0.  ]
F1-score on validation set: [0.   0.53 0.31 0.   0.43 0.8  0.   0.  ]
ROC AUC on validation set: {'AK': 0.82, 'BCC': 0.89, 'BKL': 0.63, 'DF': 0.82, 'MEL': 0.51, 'NV': 0.17, 'SCC': 0.86, 'VASC': 0.71}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           27  ...            0             0
true class BCC            0          118  ...            0             0
true class BKL            0           31  ...            0             0
true class DF             0            8  ...            0             0
true class MEL            0           36  ...            1             0
true class NV             1           28  ...            0             0
true class SCC            0           25  ...            0             0
true class VASC           0            4  ...            0             0

/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
[8 rows x 8 columns]

Current validation loss: 1.063

Epoch 43:
Mean loss 0.9829965995313241 - Correctly labeled training images 64.73%
Classified 61.91 % of validation images correctly.
Precision on validation set: [0.   0.42 0.4  0.   0.58 0.7  0.   0.  ]
Recall on validation set: [0.   0.72 0.13 0.   0.23 0.92 0.   0.  ]
F1-score on validation set: [0.   0.53 0.2  0.   0.33 0.8  0.   0.  ]
ROC AUC on validation set: {'AK': 0.81, 'BCC': 0.89, 'BKL': 0.63, 'DF': 0.82, 'MEL': 0.5, 'NV': 0.18, 'SCC': 0.86, 'VASC': 0.72}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           31  ...            0             0
true class BCC            0          121  ...            0             0
true class BKL            0           38  ...            0             0
true class DF             0            7  ...            0             0
true class MEL            0           36  ...            1             0
true class NV             0           23  ...            0             0
true class SCC            0           26  ...            0             0
true class VASC           0            5  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.067

Epoch 44:
Mean loss 0.9775721450521366 - Correctly labeled training images 64.91%
Classified 62.85 % of validation images correctly.
Precision on validation set: [0.   0.43 0.4  0.   0.57 0.73 0.   0.  ]
Recall on validation set: [0.   0.74 0.21 0.   0.27 0.91 0.   0.  ]
F1-score on validation set: [0.   0.54 0.28 0.   0.37 0.81 0.   0.  ]
ROC AUC on validation set: {'AK': 0.82, 'BCC': 0.9, 'BKL': 0.63, 'DF': 0.83, 'MEL': 0.49, 'NV': 0.18, 'SCC': 0.86, 'VASC': 0.73}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           29  ...            0             0
true class BCC            0          123  ...            0             0
true class BKL            1           32  ...            0             0
true class DF             0            8  ...            0             0
true class MEL            0           36  ...            0             0
true class NV             0           26  ...            0             0
true class SCC            0           26  ...            0             0
true class VASC           0            6  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.052

Epoch 45:
Mean loss 0.9685081093093199 - Correctly labeled training images 65.60%
Classified 62.15 % of validation images correctly.
Precision on validation set: [0.   0.4  0.36 0.   0.54 0.76 0.   0.  ]
Recall on validation set: [0.   0.78 0.19 0.   0.35 0.86 0.   0.  ]
F1-score on validation set: [0.   0.53 0.25 0.   0.42 0.81 0.   0.  ]
ROC AUC on validation set: {'AK': 0.81, 'BCC': 0.89, 'BKL': 0.63, 'DF': 0.81, 'MEL': 0.5, 'NV': 0.17, 'SCC': 0.86, 'VASC': 0.73}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           32  ...            0             0
true class BCC            0          130  ...            0             0
true class BKL            0           41  ...            0             0
true class DF             0            8  ...            0             0
true class MEL            0           42  ...            1             0
true class NV             1           34  ...            0             0
true class SCC            0           27  ...            0             0
true class VASC           0            7  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.046

Epoch 46:
Mean loss 0.9624385944676324 - Correctly labeled training images 65.76%
Classified 63.80 % of validation images correctly.
Precision on validation set: [0.   0.45 0.43 0.   0.53 0.73 0.   0.  ]
Recall on validation set: [0.   0.72 0.18 0.   0.32 0.92 0.   0.  ]
F1-score on validation set: [0.   0.55 0.25 0.   0.4  0.82 0.   0.  ]
ROC AUC on validation set: {'AK': 0.82, 'BCC': 0.9, 'BKL': 0.65, 'DF': 0.84, 'MEL': 0.51, 'NV': 0.16, 'SCC': 0.86, 'VASC': 0.73}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           29  ...            0             0
true class BCC            0          120  ...            0             0
true class BKL            1           32  ...            0             0
true class DF             0            8  ...            0             0
true class MEL            0           28  ...            1             0
true class NV             0           19  ...            0             0
true class SCC            0           25  ...            0             0
true class VASC           0            5  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.026

Epoch 47:
Mean loss 0.9604351074913698 - Correctly labeled training images 65.57%
Classified 62.46 % of validation images correctly.
Precision on validation set: [0.33 0.42 0.39 0.   0.51 0.75 0.   0.  ]
Recall on validation set: [0.02 0.68 0.2  0.   0.38 0.88 0.   0.  ]
F1-score on validation set: [0.04 0.52 0.26 0.   0.43 0.81 0.   0.  ]
ROC AUC on validation set: {'AK': 0.82, 'BCC': 0.9, 'BKL': 0.62, 'DF': 0.84, 'MEL': 0.49, 'NV': 0.18, 'SCC': 0.86, 'VASC': 0.75}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             1           29  ...            0             0
true class BCC            0          113  ...            2             0
true class BKL            1           29  ...            0             0
true class DF             0            9  ...            0             0
true class MEL            0           31  ...            1             0
true class NV             1           27  ...            0             0
true class SCC            0           26  ...            0             0
true class VASC           0            6  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.017

Epoch 48:
Mean loss 0.9472026396248995 - Correctly labeled training images 66.18%
Classified 62.70 % of validation images correctly.
Precision on validation set: [0.   0.46 0.48 0.   0.44 0.8  0.   0.  ]
Recall on validation set: [0.   0.75 0.24 0.   0.53 0.81 0.   0.  ]
F1-score on validation set: [0.   0.57 0.32 0.   0.48 0.8  0.   0.  ]
ROC AUC on validation set: {'AK': 0.79, 'BCC': 0.9, 'BKL': 0.62, 'DF': 0.86, 'MEL': 0.49, 'NV': 0.18, 'SCC': 0.85, 'VASC': 0.76}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           28  ...            0             0
true class BCC            0          125  ...            0             0
true class BKL            2           29  ...            1             0
true class DF             0            9  ...            0             0
true class MEL            0           23  ...            1             0
true class NV             0           27  ...            0             0
true class SCC            0           24  ...            0             0
true class VASC           0            8  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.042

Epoch 49:
Mean loss 0.9440461965013378 - Correctly labeled training images 66.21%
Classified 63.49 % of validation images correctly.
Precision on validation set: [0.2  0.44 0.51 0.   0.5  0.75 0.   0.  ]
Recall on validation set: [0.02 0.74 0.21 0.   0.38 0.88 0.   0.  ]
F1-score on validation set: [0.04 0.55 0.3  0.   0.43 0.81 0.   0.  ]
ROC AUC on validation set: {'AK': 0.79, 'BCC': 0.91, 'BKL': 0.63, 'DF': 0.87, 'MEL': 0.5, 'NV': 0.17, 'SCC': 0.85, 'VASC': 0.74}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             1           27  ...            0             0
true class BCC            0          123  ...            0             0
true class BKL            3           26  ...            0             0
true class DF             0           10  ...            0             0
true class MEL            0           27  ...            1             0
true class NV             1           34  ...            0             0
true class SCC            0           27  ...            0             0
true class VASC           0            6  ...            0             0

/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
[8 rows x 8 columns]

Current validation loss: 1.028

Epoch 50:
Mean loss 0.9372410149980419 - Correctly labeled training images 66.60%
Classified 62.85 % of validation images correctly.
Precision on validation set: [0.   0.44 0.39 0.   0.5  0.75 0.   0.  ]
Recall on validation set: [0.   0.74 0.18 0.   0.36 0.88 0.   0.  ]
F1-score on validation set: [0.   0.55 0.24 0.   0.42 0.81 0.   0.  ]
ROC AUC on validation set: {'AK': 0.82, 'BCC': 0.9, 'BKL': 0.62, 'DF': 0.84, 'MEL': 0.48, 'NV': 0.18, 'SCC': 0.87, 'VASC': 0.75}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           31  ...            0             0
true class BCC            0          124  ...            1             0
true class BKL            1           34  ...            0             0
true class DF             0            9  ...            0             0
true class MEL            0           32  ...            1             0
true class NV             0           22  ...            0             0
true class SCC            0           25  ...            0             0
true class VASC           0            5  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.024

Epoch 51:
Mean loss 0.9270630758079444 - Correctly labeled training images 66.95%
Classified 63.96 % of validation images correctly.
Precision on validation set: [1.   0.48 0.35 0.   0.52 0.77 0.   0.  ]
Recall on validation set: [0.02 0.73 0.27 0.   0.44 0.86 0.   0.  ]
F1-score on validation set: [0.05 0.58 0.3  0.   0.48 0.81 0.   0.  ]
ROC AUC on validation set: {'AK': 0.79, 'BCC': 0.91, 'BKL': 0.62, 'DF': 0.8, 'MEL': 0.5, 'NV': 0.18, 'SCC': 0.86, 'VASC': 0.72}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             1           25  ...            0             0
true class BCC            0          122  ...            0             0
true class BKL            0           28  ...            0             0
true class DF             0            8  ...            0             0
true class MEL            0           26  ...            1             0
true class NV             0           18  ...            0             0
true class SCC            0           23  ...            0             0
true class VASC           0            5  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.025

Epoch 52:
Mean loss 0.92438394541056 - Correctly labeled training images 66.90%
Classified 63.09 % of validation images correctly.
Precision on validation set: [0.5  0.43 0.49 0.   0.51 0.75 0.   0.  ]
Recall on validation set: [0.02 0.77 0.19 0.   0.35 0.88 0.   0.  ]
F1-score on validation set: [0.04 0.55 0.27 0.   0.41 0.81 0.   0.  ]
ROC AUC on validation set: {'AK': 0.81, 'BCC': 0.9, 'BKL': 0.62, 'DF': 0.85, 'MEL': 0.49, 'NV': 0.18, 'SCC': 0.86, 'VASC': 0.77}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             1           31  ...            0             0
true class BCC            0          128  ...            0             0
true class BKL            1           35  ...            0             0
true class DF             0           10  ...            0             0
true class MEL            0           31  ...            1             0
true class NV             0           30  ...            0             0
true class SCC            0           27  ...            0             0
true class VASC           0            6  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.014

Epoch 53:
Mean loss 0.9222300259942888 - Correctly labeled training images 67.14%
Classified 62.38 % of validation images correctly.
Precision on validation set: [0.   0.39 0.53 0.   0.63 0.72 0.   0.  ]
Recall on validation set: [0.   0.75 0.15 0.   0.23 0.92 0.   0.  ]
F1-score on validation set: [0.   0.52 0.23 0.   0.34 0.81 0.   0.  ]
ROC AUC on validation set: {'AK': 0.81, 'BCC': 0.89, 'BKL': 0.64, 'DF': 0.77, 'MEL': 0.5, 'NV': 0.17, 'SCC': 0.87, 'VASC': 0.79}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           31  ...            0             0
true class BCC            0          126  ...            0             0
true class BKL            1           42  ...            0             0
true class DF             0            8  ...            0             0
true class MEL            0           43  ...            1             0
true class NV             0           35  ...            0             0
true class SCC            0           29  ...            0             0
true class VASC           0            8  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.074

Epoch 54:
Mean loss 0.9111018006451874 - Correctly labeled training images 67.26%
Classified 63.33 % of validation images correctly.
Precision on validation set: [0.   0.44 0.38 0.   0.52 0.77 0.   0.  ]
Recall on validation set: [0.   0.79 0.23 0.   0.39 0.86 0.   0.  ]
F1-score on validation set: [0.   0.57 0.28 0.   0.45 0.81 0.   0.  ]
ROC AUC on validation set: {'AK': 0.79, 'BCC': 0.9, 'BKL': 0.62, 'DF': 0.83, 'MEL': 0.48, 'NV': 0.19, 'SCC': 0.85, 'VASC': 0.73}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           29  ...            0             0
true class BCC            0          132  ...            0             0
true class BKL            1           32  ...            0             0
true class DF             0            8  ...            0             0
true class MEL            0           34  ...            1             0
true class NV             0           31  ...            0             0
true class SCC            0           26  ...            0             0
true class VASC           0            6  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.031

Epoch 55:
Mean loss 0.9004010162330952 - Correctly labeled training images 67.84%
Classified 63.88 % of validation images correctly.
Precision on validation set: [0.62 0.41 0.53 0.   0.54 0.77 0.22 0.  ]
Recall on validation set: [0.12 0.77 0.18 0.   0.4  0.87 0.06 0.  ]
F1-score on validation set: [0.2  0.54 0.27 0.   0.46 0.82 0.1  0.  ]
ROC AUC on validation set: {'AK': 0.8, 'BCC': 0.9, 'BKL': 0.63, 'DF': 0.83, 'MEL': 0.49, 'NV': 0.17, 'SCC': 0.86, 'VASC': 0.77}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             5           26  ...            0             0
true class BCC            1          129  ...            5             0
true class BKL            1           39  ...            1             0
true class DF             0            9  ...            0             0
true class MEL            0           38  ...            1             0
true class NV             1           38  ...            0             0
true class SCC            0           26  ...            2             0
true class VASC           0            8  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.026

Epoch 56:
Mean loss 0.8967193570986908 - Correctly labeled training images 67.98%
Classified 64.91 % of validation images correctly.
Precision on validation set: [0.18 0.49 0.58 0.   0.5  0.76 0.3  0.  ]
Recall on validation set: [0.07 0.67 0.25 0.   0.46 0.88 0.09 0.  ]
F1-score on validation set: [0.1  0.57 0.35 0.   0.48 0.82 0.14 0.  ]
ROC AUC on validation set: {'AK': 0.81, 'BCC': 0.91, 'BKL': 0.63, 'DF': 0.83, 'MEL': 0.49, 'NV': 0.18, 'SCC': 0.86, 'VASC': 0.75}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             3           26  ...            1             0
true class BCC            3          112  ...            4             0
true class BKL            6           19  ...            1             0
true class DF             0            8  ...            0             0
true class MEL            2           25  ...            1             0
true class NV             2           16  ...            0             0
true class SCC            1           19  ...            3             0
true class VASC           0            4  ...            0             0

/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
[8 rows x 8 columns]

Current validation loss: 1.002

Epoch 57:
Mean loss 0.8911845645975991 - Correctly labeled training images 68.06%
Classified 64.12 % of validation images correctly.
Precision on validation set: [0.38 0.45 0.43 0.   0.54 0.77 0.   0.  ]
Recall on validation set: [0.07 0.79 0.29 0.   0.34 0.87 0.   0.  ]
F1-score on validation set: [0.12 0.57 0.35 0.   0.42 0.82 0.   0.  ]
ROC AUC on validation set: {'AK': 0.77, 'BCC': 0.91, 'BKL': 0.63, 'DF': 0.8, 'MEL': 0.51, 'NV': 0.17, 'SCC': 0.84, 'VASC': 0.8}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             3           25  ...            0             0
true class BCC            0          132  ...            1             0
true class BKL            3           28  ...            0             0
true class DF             0            8  ...            0             0
true class MEL            1           35  ...            1             0
true class NV             1           33  ...            0             0
true class SCC            0           25  ...            0             0
true class VASC           0            8  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.014

Epoch 58:
Mean loss 0.8826166962975583 - Correctly labeled training images 68.60%
Classified 64.43 % of validation images correctly.
Precision on validation set: [0.23 0.47 0.48 0.   0.5  0.77 0.   0.  ]
Recall on validation set: [0.07 0.72 0.21 0.   0.49 0.86 0.   0.  ]
F1-score on validation set: [0.11 0.57 0.3  0.   0.5  0.81 0.   0.  ]
ROC AUC on validation set: {'AK': 0.79, 'BCC': 0.91, 'BKL': 0.62, 'DF': 0.81, 'MEL': 0.49, 'NV': 0.18, 'SCC': 0.85, 'VASC': 0.78}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             3           25  ...            0             0
true class BCC            1          121  ...            1             0
true class BKL            4           24  ...            0             0
true class DF             0            8  ...            0             0
true class MEL            3           23  ...            1             0
true class NV             1           26  ...            0             0
true class SCC            1           21  ...            0             0
true class VASC           0            7  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.016

Epoch 59:
Mean loss 0.8725148194031761 - Correctly labeled training images 68.88%
Classified 64.43 % of validation images correctly.
Precision on validation set: [0.2  0.48 0.48 0.   0.55 0.73 0.25 0.  ]
Recall on validation set: [0.05 0.72 0.24 0.   0.36 0.9  0.03 0.  ]
F1-score on validation set: [0.08 0.58 0.32 0.   0.44 0.81 0.06 0.  ]
ROC AUC on validation set: {'AK': 0.79, 'BCC': 0.92, 'BKL': 0.62, 'DF': 0.83, 'MEL': 0.49, 'NV': 0.17, 'SCC': 0.84, 'VASC': 0.8}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             2           23  ...            0             0
true class BCC            2          121  ...            2             0
true class BKL            3           26  ...            0             0
true class DF             0            8  ...            0             0
true class MEL            1           24  ...            1             0
true class NV             2           20  ...            0             0
true class SCC            0           22  ...            1             0
true class VASC           0            8  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.021

Epoch 60:
Mean loss 0.8692295539548345 - Correctly labeled training images 69.09%
Classified 64.43 % of validation images correctly.
Precision on validation set: [0.1  0.49 0.4  0.   0.51 0.79 0.   0.  ]
Recall on validation set: [0.05 0.71 0.34 0.   0.43 0.86 0.   0.  ]
F1-score on validation set: [0.06 0.58 0.37 0.   0.47 0.82 0.   0.  ]
ROC AUC on validation set: {'AK': 0.78, 'BCC': 0.91, 'BKL': 0.59, 'DF': 0.83, 'MEL': 0.48, 'NV': 0.2, 'SCC': 0.83, 'VASC': 0.79}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             2           22  ...            0             0
true class BCC            7          118  ...            0             0
true class BKL            5           19  ...            0             0
true class DF             0            9  ...            0             0
true class MEL            3           21  ...            0             0
true class NV             2           25  ...            0             0
true class SCC            2           19  ...            0             0
true class VASC           0            7  ...            0             0

[8 rows x 8 columns]

Current validation loss: 0.996

Epoch 61:
Mean loss 0.85426596169028 - Correctly labeled training images 69.56%
Classified 64.83 % of validation images correctly.
Precision on validation set: [0.   0.47 0.44 0.   0.53 0.78 0.   0.  ]
Recall on validation set: [0.   0.81 0.27 0.   0.43 0.86 0.   0.  ]
F1-score on validation set: [0.   0.59 0.33 0.   0.48 0.82 0.   0.  ]
ROC AUC on validation set: {'AK': 0.81, 'BCC': 0.92, 'BKL': 0.63, 'DF': 0.8, 'MEL': 0.48, 'NV': 0.17, 'SCC': 0.85, 'VASC': 0.79}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           30  ...            0             0
true class BCC            0          136  ...            0             0
true class BKL            1           31  ...            1             0
true class DF             0            8  ...            0             0
true class MEL            1           28  ...            1             0
true class NV             0           25  ...            0             0
true class SCC            0           26  ...            0             0
true class VASC           0            8  ...            0             0

[8 rows x 8 columns]

Current validation loss: 0.989

Epoch 62:
Mean loss 0.851187269911405 - Correctly labeled training images 69.48%
Classified 64.59 % of validation images correctly.
Precision on validation set: [0.3  0.5  0.44 0.   0.54 0.74 0.29 0.  ]
Recall on validation set: [0.14 0.74 0.22 0.   0.38 0.89 0.06 0.  ]
F1-score on validation set: [0.19 0.6  0.29 0.   0.45 0.81 0.1  0.  ]
ROC AUC on validation set: {'AK': 0.79, 'BCC': 0.92, 'BKL': 0.61, 'DF': 0.81, 'MEL': 0.5, 'NV': 0.17, 'SCC': 0.86, 'VASC': 0.78}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             6           22  ...            0             0
true class BCC            3          123  ...            4             0
true class BKL            6           20  ...            0             0
true class DF             0            7  ...            0             0
true class MEL            2           23  ...            1             0
true class NV             1           20  ...            0             0
true class SCC            2           22  ...            2             0
true class VASC           0            7  ...            0             0

[8 rows x 8 columns]

Current validation loss: 0.986

Epoch 63:
Mean loss 0.8429666027097672 - Correctly labeled training images 69.93%
Classified 64.35 % of validation images correctly.
Precision on validation set: [0.17 0.5  0.42 0.   0.53 0.75 0.2  0.  ]
Recall on validation set: [0.02 0.68 0.29 0.   0.41 0.89 0.03 0.  ]
F1-score on validation set: [0.04 0.57 0.34 0.   0.46 0.81 0.05 0.  ]
ROC AUC on validation set: {'AK': 0.81, 'BCC': 0.92, 'BKL': 0.63, 'DF': 0.79, 'MEL': 0.49, 'NV': 0.17, 'SCC': 0.86, 'VASC': 0.79}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             1           24  ...            0             0
true class BCC            1          114  ...            3             0
true class BKL            2           20  ...            0             0
true class DF             0            6  ...            0             0
true class MEL            0           18  ...            1             0
true class NV             2           20  ...            0             0
true class SCC            0           22  ...            1             0
true class VASC           0            6  ...            0             0

/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
[8 rows x 8 columns]

Current validation loss: 0.983

Epoch 64:
Mean loss 0.8195072322237755 - Correctly labeled training images 70.79%
Classified 63.88 % of validation images correctly.
Precision on validation set: [0.31 0.45 0.44 0.   0.53 0.77 0.27 0.  ]
Recall on validation set: [0.09 0.77 0.27 0.   0.38 0.86 0.09 0.  ]
F1-score on validation set: [0.14 0.57 0.33 0.   0.44 0.81 0.14 0.  ]
ROC AUC on validation set: {'AK': 0.78, 'BCC': 0.92, 'BKL': 0.62, 'DF': 0.82, 'MEL': 0.5, 'NV': 0.17, 'SCC': 0.84, 'VASC': 0.79}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             4           25  ...            1             0
true class BCC            3          129  ...            4             0
true class BKL            5           27  ...            0             0
true class DF             0            8  ...            1             0
true class MEL            0           35  ...            2             0
true class NV             1           32  ...            0             0
true class SCC            0           24  ...            3             0
true class VASC           0            8  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.011

Epoch 65:
Mean loss 0.8212285190820694 - Correctly labeled training images 70.70%
Classified 63.88 % of validation images correctly.
Precision on validation set: [0.25 0.53 0.37 0.   0.55 0.74 0.   0.  ]
Recall on validation set: [0.12 0.69 0.33 0.   0.35 0.88 0.   0.  ]
F1-score on validation set: [0.16 0.6  0.35 0.   0.42 0.8  0.   0.  ]
ROC AUC on validation set: {'AK': 0.76, 'BCC': 0.92, 'BKL': 0.62, 'DF': 0.82, 'MEL': 0.48, 'NV': 0.18, 'SCC': 0.86, 'VASC': 0.84}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             5           16  ...            0             0
true class BCC            5          115  ...            0             0
true class BKL            4           14  ...            0             0
true class DF             1            7  ...            0             0
true class MEL            3           18  ...            1             0
true class NV             2           18  ...            0             0
true class SCC            0           22  ...            0             0
true class VASC           0            7  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.004

Epoch 66:
Mean loss 0.8171439444417081 - Correctly labeled training images 70.91%
Classified 64.91 % of validation images correctly.
Precision on validation set: [0.38 0.49 0.45 0.   0.51 0.77 0.5  0.  ]
Recall on validation set: [0.07 0.75 0.23 0.   0.47 0.86 0.09 0.  ]
F1-score on validation set: [0.12 0.59 0.3  0.   0.49 0.81 0.16 0.  ]
ROC AUC on validation set: {'AK': 0.79, 'BCC': 0.92, 'BKL': 0.61, 'DF': 0.81, 'MEL': 0.49, 'NV': 0.17, 'SCC': 0.86, 'VASC': 0.8}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             3           26  ...            0             0
true class BCC            2          125  ...            2             0
true class BKL            2           24  ...            0             0
true class DF             1            6  ...            0             0
true class MEL            0           21  ...            1             0
true class NV             0           22  ...            0             0
true class SCC            0           23  ...            3             0
true class VASC           0            7  ...            0             0

[8 rows x 8 columns]

Current validation loss: 0.988

Epoch 67:
Mean loss 0.7976897817680888 - Correctly labeled training images 71.64%
Classified 64.04 % of validation images correctly.
Precision on validation set: [0.25 0.51 0.39 0.   0.48 0.78 0.   0.  ]
Recall on validation set: [0.05 0.69 0.31 0.   0.5  0.84 0.   0.  ]
F1-score on validation set: [0.08 0.59 0.35 0.   0.49 0.81 0.   0.  ]
ROC AUC on validation set: {'AK': 0.79, 'BCC': 0.92, 'BKL': 0.62, 'DF': 0.81, 'MEL': 0.48, 'NV': 0.18, 'SCC': 0.85, 'VASC': 0.79}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             2           21  ...            0             0
true class BCC            1          115  ...            0             0
true class BKL            1           19  ...            0             0
true class DF             1            7  ...            0             0
true class MEL            2           17  ...            1             0
true class NV             0           17  ...            0             0
true class SCC            1           21  ...            0             0
true class VASC           0            7  ...            0             0

[8 rows x 8 columns]

Current validation loss: 0.994

Epoch 68:
Mean loss 0.7874837904604451 - Correctly labeled training images 71.83%
Classified 65.22 % of validation images correctly.
Precision on validation set: [0.33 0.48 0.46 0.   0.51 0.76 0.5  0.  ]
Recall on validation set: [0.12 0.75 0.24 0.   0.37 0.9  0.03 0.  ]
F1-score on validation set: [0.17 0.59 0.31 0.   0.43 0.83 0.06 0.  ]
ROC AUC on validation set: {'AK': 0.79, 'BCC': 0.91, 'BKL': 0.63, 'DF': 0.81, 'MEL': 0.48, 'NV': 0.18, 'SCC': 0.85, 'VASC': 0.81}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             5           27  ...            0             0
true class BCC            2          126  ...            0             0
true class BKL            3           27  ...            0             0
true class DF             0            8  ...            0             0
true class MEL            2           22  ...            1             0
true class NV             2           19  ...            0             0
true class SCC            1           23  ...            1             0
true class VASC           0            8  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.010

Epoch 69:
Mean loss 0.7799065983163822 - Correctly labeled training images 72.09%
Classified 65.30 % of validation images correctly.
Precision on validation set: [0.14 0.51 0.45 0.   0.51 0.78 0.4  0.  ]
Recall on validation set: [0.02 0.71 0.33 0.   0.51 0.85 0.06 0.  ]
F1-score on validation set: [0.04 0.59 0.38 0.   0.51 0.81 0.11 0.  ]
ROC AUC on validation set: {'AK': 0.8, 'BCC': 0.92, 'BKL': 0.62, 'DF': 0.83, 'MEL': 0.46, 'NV': 0.19, 'SCC': 0.86, 'VASC': 0.78}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             1           26  ...            0             0
true class BCC            1          119  ...            2             0
true class BKL            2           21  ...            0             0
true class DF             0            8  ...            0             0
true class MEL            1           17  ...            1             0
true class NV             1           16  ...            0             0
true class SCC            1           22  ...            2             0
true class VASC           0            6  ...            0             0

[8 rows x 8 columns]

Current validation loss: 0.998

Epoch 70:
Mean loss 0.7673871416586807 - Correctly labeled training images 72.81%
Classified 65.30 % of validation images correctly.
Precision on validation set: [0.17 0.51 0.47 0.   0.56 0.74 0.   0.  ]
Recall on validation set: [0.07 0.8  0.27 0.   0.3  0.92 0.   0.  ]
F1-score on validation set: [0.1  0.62 0.34 0.   0.39 0.82 0.   0.  ]
ROC AUC on validation set: {'AK': 0.78, 'BCC': 0.93, 'BKL': 0.62, 'DF': 0.8, 'MEL': 0.51, 'NV': 0.16, 'SCC': 0.86, 'VASC': 0.78}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             3           21  ...            0             0
true class BCC            1          133  ...            0             0
true class BKL            5           24  ...            0             0
true class DF             0            7  ...            0             0
true class MEL            5           28  ...            0             0
true class NV             3           15  ...            0             0
true class SCC            1           24  ...            0             0
true class VASC           0            7  ...            0             0

/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
[8 rows x 8 columns]

Current validation loss: 1.002

Epoch 71:
Mean loss 0.7610355948424113 - Correctly labeled training images 73.06%
Classified 64.43 % of validation images correctly.
Precision on validation set: [0.31 0.49 0.4  0.   0.49 0.78 0.   0.  ]
Recall on validation set: [0.09 0.76 0.25 0.   0.47 0.85 0.   0.  ]
F1-score on validation set: [0.14 0.6  0.31 0.   0.48 0.81 0.   0.  ]
ROC AUC on validation set: {'AK': 0.78, 'BCC': 0.92, 'BKL': 0.61, 'DF': 0.82, 'MEL': 0.47, 'NV': 0.19, 'SCC': 0.86, 'VASC': 0.8}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             4           23  ...            0             0
true class BCC            0          127  ...            0             0
true class BKL            4           27  ...            0             0
true class DF             0            8  ...            0             0
true class MEL            2           24  ...            0             0
true class NV             2           19  ...            0             0
true class SCC            1           24  ...            0             0
true class VASC           0            7  ...            0             0

[8 rows x 8 columns]

Current validation loss: 0.972

Epoch 72:
Mean loss 0.7506095033949858 - Correctly labeled training images 73.62%
Classified 64.43 % of validation images correctly.
Precision on validation set: [0.18 0.5  0.37 0.   0.61 0.75 0.33 0.  ]
Recall on validation set: [0.16 0.76 0.23 0.   0.35 0.89 0.03 0.  ]
F1-score on validation set: [0.17 0.6  0.28 0.   0.45 0.82 0.06 0.  ]
ROC AUC on validation set: {'AK': 0.79, 'BCC': 0.93, 'BKL': 0.62, 'DF': 0.81, 'MEL': 0.49, 'NV': 0.17, 'SCC': 0.86, 'VASC': 0.82}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             7           24  ...            0             0
true class BCC            7          127  ...            1             0
true class BKL           12           22  ...            0             0
true class DF             0            8  ...            0             0
true class MEL           10           24  ...            1             0
true class NV             2           19  ...            0             1
true class SCC            2           22  ...            1             0
true class VASC           0            7  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.000

Epoch 73:
Mean loss 0.7400794115728384 - Correctly labeled training images 73.73%
Classified 63.88 % of validation images correctly.
Precision on validation set: [0.22 0.52 0.38 0.   0.49 0.76 0.5  0.  ]
Recall on validation set: [0.16 0.66 0.27 0.   0.39 0.88 0.03 0.  ]
F1-score on validation set: [0.19 0.58 0.32 0.   0.44 0.82 0.06 0.  ]
ROC AUC on validation set: {'AK': 0.78, 'BCC': 0.92, 'BKL': 0.6, 'DF': 0.83, 'MEL': 0.49, 'NV': 0.17, 'SCC': 0.87, 'VASC': 0.79}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             7           17  ...            0             0
true class BCC           10          110  ...            0             0
true class BKL            6           15  ...            0             0
true class DF             1            8  ...            0             0
true class MEL            4           14  ...            1             0
true class NV             2           15  ...            0             0
true class SCC            2           23  ...            1             0
true class VASC           0            8  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.005

Epoch 74:
Mean loss 0.7243004669244357 - Correctly labeled training images 74.49%
Classified 65.69 % of validation images correctly.
Precision on validation set: [0.33 0.51 0.42 0.   0.54 0.77 0.   0.  ]
Recall on validation set: [0.16 0.78 0.18 0.   0.45 0.89 0.   0.  ]
F1-score on validation set: [0.22 0.61 0.26 0.   0.49 0.82 0.   0.  ]
ROC AUC on validation set: {'AK': 0.77, 'BCC': 0.93, 'BKL': 0.63, 'DF': 0.8, 'MEL': 0.47, 'NV': 0.18, 'SCC': 0.87, 'VASC': 0.82}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             7           19  ...            0             0
true class BCC            3          130  ...            0             0
true class BKL            7           22  ...            0             0
true class DF             0            7  ...            0             0
true class MEL            3           19  ...            1             0
true class NV             1           24  ...            0             0
true class SCC            0           28  ...            0             0
true class VASC           0            8  ...            0             0

[8 rows x 8 columns]

Current validation loss: 0.990

Epoch 75:
Mean loss 0.7108676528987072 - Correctly labeled training images 74.70%
Classified 64.98 % of validation images correctly.
Precision on validation set: [0.35 0.55 0.37 0.   0.55 0.75 0.   0.  ]
Recall on validation set: [0.3  0.74 0.27 0.   0.37 0.88 0.   0.  ]
F1-score on validation set: [0.32 0.63 0.31 0.   0.44 0.81 0.   0.  ]
ROC AUC on validation set: {'AK': 0.79, 'BCC': 0.93, 'BKL': 0.61, 'DF': 0.77, 'MEL': 0.49, 'NV': 0.18, 'SCC': 0.86, 'VASC': 0.79}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            13           16  ...            0             0
true class BCC            4          123  ...            1             0
true class BKL            9           17  ...            0             0
true class DF             2            4  ...            0             0
true class MEL            4           18  ...            0             0
true class NV             1           18  ...            0             0
true class SCC            4           22  ...            0             0
true class VASC           0            7  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.011

Epoch 76:
Mean loss 0.70082331115045 - Correctly labeled training images 75.46%
Classified 62.85 % of validation images correctly.
Precision on validation set: [0.31 0.51 0.34 0.   0.47 0.8  0.33 0.  ]
Recall on validation set: [0.09 0.72 0.34 0.   0.46 0.81 0.12 0.  ]
F1-score on validation set: [0.14 0.59 0.34 0.   0.47 0.8  0.18 0.  ]
ROC AUC on validation set: {'AK': 0.78, 'BCC': 0.92, 'BKL': 0.61, 'DF': 0.8, 'MEL': 0.48, 'NV': 0.18, 'SCC': 0.87, 'VASC': 0.82}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             4           20  ...            2             0
true class BCC            2          120  ...            2             0
true class BKL            4           23  ...            0             0
true class DF             0            8  ...            0             0
true class MEL            1           15  ...            4             0
true class NV             2           21  ...            0             0
true class SCC            0           22  ...            4             0
true class VASC           0            8  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.021

Epoch 77:
Mean loss 0.6907034180705856 - Correctly labeled training images 75.43%
Classified 64.67 % of validation images correctly.
Precision on validation set: [0.26 0.5  0.4  0.   0.52 0.79 0.25 0.  ]
Recall on validation set: [0.16 0.77 0.31 0.   0.43 0.84 0.06 0.  ]
F1-score on validation set: [0.2  0.61 0.35 0.   0.47 0.82 0.1  0.  ]
ROC AUC on validation set: {'AK': 0.77, 'BCC': 0.93, 'BKL': 0.61, 'DF': 0.8, 'MEL': 0.51, 'NV': 0.17, 'SCC': 0.86, 'VASC': 0.77}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             7           23  ...            0             0
true class BCC            3          129  ...            2             0
true class BKL            8           24  ...            1             0
true class DF             0            8  ...            1             0
true class MEL            4           24  ...            2             0
true class NV             4           21  ...            0             0
true class SCC            1           23  ...            2             0
true class VASC           0            6  ...            0             0

/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
[8 rows x 8 columns]

Current validation loss: 1.003

Epoch 78:
Mean loss 0.6751803504273719 - Correctly labeled training images 75.98%
Classified 63.25 % of validation images correctly.
Precision on validation set: [0.19 0.46 0.39 0.   0.5  0.78 0.43 0.  ]
Recall on validation set: [0.12 0.78 0.22 0.   0.39 0.85 0.09 0.  ]
F1-score on validation set: [0.14 0.58 0.28 0.   0.44 0.81 0.15 0.  ]
ROC AUC on validation set: {'AK': 0.77, 'BCC': 0.92, 'BKL': 0.62, 'DF': 0.81, 'MEL': 0.47, 'NV': 0.19, 'SCC': 0.86, 'VASC': 0.8}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             5           23  ...            1             0
true class BCC            4          131  ...            1             0
true class BKL            8           30  ...            0             0
true class DF             0            9  ...            0             0
true class MEL            7           25  ...            2             0
true class NV             2           31  ...            0             1
true class SCC            0           26  ...            3             0
true class VASC           0            8  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.048

Epoch 79:
Mean loss 0.6651430751435012 - Correctly labeled training images 76.60%
Classified 64.98 % of validation images correctly.
Precision on validation set: [0.22 0.51 0.42 0.   0.54 0.78 0.43 0.5 ]
Recall on validation set: [0.12 0.73 0.4  0.   0.37 0.86 0.19 0.08]
F1-score on validation set: [0.15 0.6  0.41 0.   0.44 0.82 0.26 0.13]
ROC AUC on validation set: {'AK': 0.76, 'BCC': 0.92, 'BKL': 0.6, 'DF': 0.77, 'MEL': 0.45, 'NV': 0.21, 'SCC': 0.86, 'VASC': 0.79}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             5           20  ...            2             0
true class BCC            3          122  ...            4             0
true class BKL            6           22  ...            1             0
true class DF             1            6  ...            0             0
true class MEL            5           22  ...            1             0
true class NV             3           18  ...            0             1
true class SCC            0           22  ...            6             0
true class VASC           0            7  ...            0             1

[8 rows x 8 columns]

Current validation loss: 1.029

Epoch 80:
Mean loss 0.6461138257562926 - Correctly labeled training images 77.40%
Classified 66.17 % of validation images correctly.
Precision on validation set: [0.28 0.6  0.39 0.   0.53 0.78 0.5  0.  ]
Recall on validation set: [0.16 0.67 0.42 0.   0.44 0.88 0.03 0.  ]
F1-score on validation set: [0.21 0.63 0.4  0.   0.48 0.82 0.06 0.  ]
ROC AUC on validation set: {'AK': 0.78, 'BCC': 0.93, 'BKL': 0.61, 'DF': 0.77, 'MEL': 0.46, 'NV': 0.19, 'SCC': 0.88, 'VASC': 0.78}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             7           12  ...            0             0
true class BCC            5          112  ...            1             0
true class BKL            6           12  ...            0             0
true class DF             1            5  ...            0             0
true class MEL            3           10  ...            0             0
true class NV             2            9  ...            0             0
true class SCC            1           19  ...            1             0
true class VASC           0            7  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.010

Epoch 81:
Mean loss 0.6370441415802538 - Correctly labeled training images 77.69%
Classified 62.93 % of validation images correctly.
Precision on validation set: [0.5  0.57 0.39 0.   0.44 0.8  0.57 0.  ]
Recall on validation set: [0.09 0.7  0.42 0.   0.57 0.76 0.12 0.  ]
F1-score on validation set: [0.16 0.63 0.41 0.   0.49 0.78 0.21 0.  ]
ROC AUC on validation set: {'AK': 0.78, 'BCC': 0.92, 'BKL': 0.59, 'DF': 0.8, 'MEL': 0.46, 'NV': 0.2, 'SCC': 0.87, 'VASC': 0.77}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             4           17  ...            0             0
true class BCC            1          117  ...            2             0
true class BKL            0           13  ...            1             0
true class DF             1            5  ...            0             0
true class MEL            0           12  ...            0             0
true class NV             1           17  ...            0             0
true class SCC            1           19  ...            4             0
true class VASC           0            6  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.120

Epoch 82:
Mean loss 0.6299313514108538 - Correctly labeled training images 78.14%
Classified 66.48 % of validation images correctly.
Precision on validation set: [0.25 0.63 0.52 0.   0.58 0.74 1.   1.  ]
Recall on validation set: [0.37 0.63 0.34 0.   0.41 0.91 0.06 0.08]
F1-score on validation set: [0.3  0.63 0.41 0.   0.48 0.81 0.12 0.14]
ROC AUC on validation set: {'AK': 0.76, 'BCC': 0.92, 'BKL': 0.6, 'DF': 0.8, 'MEL': 0.51, 'NV': 0.17, 'SCC': 0.83, 'VASC': 0.8}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            16            9  ...            0             0
true class BCC           19          105  ...            0             0
true class BKL           10            9  ...            0             0
true class DF             2            4  ...            0             0
true class MEL            7           15  ...            0             0
true class NV             3           12  ...            0             0
true class SCC            7            9  ...            2             0
true class VASC           0            4  ...            0             1

[8 rows x 8 columns]

Current validation loss: 1.049

Epoch 83:
Mean loss 0.6136628151504023 - Correctly labeled training images 78.59%
Classified 66.09 % of validation images correctly.
Precision on validation set: [0.29 0.51 0.47 0.   0.54 0.78 0.17 1.  ]
Recall on validation set: [0.19 0.71 0.31 0.   0.41 0.89 0.03 0.08]
F1-score on validation set: [0.23 0.59 0.37 0.   0.47 0.83 0.05 0.14]
ROC AUC on validation set: {'AK': 0.78, 'BCC': 0.91, 'BKL': 0.62, 'DF': 0.79, 'MEL': 0.49, 'NV': 0.18, 'SCC': 0.88, 'VASC': 0.78}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             8           19  ...            0             0
true class BCC            4          118  ...            3             0
true class BKL            7           23  ...            0             0
true class DF             1            7  ...            0             0
true class MEL            5           21  ...            2             0
true class NV             2           14  ...            0             0
true class SCC            1           24  ...            1             0
true class VASC           0            6  ...            0             1

[8 rows x 8 columns]

Current validation loss: 1.056

Epoch 84:
Mean loss 0.6037235236976425 - Correctly labeled training images 78.97%
Classified 61.75 % of validation images correctly.
Precision on validation set: [0.34 0.52 0.34 0.   0.49 0.82 0.29 1.  ]
Recall on validation set: [0.23 0.72 0.45 0.   0.5  0.73 0.22 0.23]
F1-score on validation set: [0.28 0.6  0.39 0.   0.49 0.77 0.25 0.38]
ROC AUC on validation set: {'AK': 0.76, 'BCC': 0.92, 'BKL': 0.58, 'DF': 0.79, 'MEL': 0.5, 'NV': 0.19, 'SCC': 0.85, 'VASC': 0.74}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            10           18  ...            1             0
true class BCC            3          120  ...            8             0
true class BKL            5           18  ...            2             0
true class DF             2            7  ...            2             0
true class MEL            4           22  ...            3             0
true class NV             4           22  ...            1             0
true class SCC            1           19  ...            7             0
true class VASC           0            5  ...            0             3

/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
[8 rows x 8 columns]

Current validation loss: 1.147

Epoch 85:
Mean loss 0.5845446725278999 - Correctly labeled training images 79.61%
Classified 64.43 % of validation images correctly.
Precision on validation set: [0.29 0.5  0.37 0.   0.58 0.76 0.   1.  ]
Recall on validation set: [0.16 0.74 0.3  0.   0.4  0.86 0.   0.08]
F1-score on validation set: [0.21 0.6  0.33 0.   0.47 0.81 0.   0.14]
ROC AUC on validation set: {'AK': 0.77, 'BCC': 0.92, 'BKL': 0.6, 'DF': 0.81, 'MEL': 0.49, 'NV': 0.18, 'SCC': 0.87, 'VASC': 0.76}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             7           19  ...            1             0
true class BCC            2          124  ...            2             0
true class BKL            8           21  ...            0             0
true class DF             2            6  ...            1             0
true class MEL            2           21  ...            1             0
true class NV             3           25  ...            0             0
true class SCC            0           26  ...            0             0
true class VASC           0            5  ...            0             1

[8 rows x 8 columns]

Current validation loss: 1.110

Epoch 86:
Mean loss 0.5715797381352175 - Correctly labeled training images 80.30%
Classified 63.56 % of validation images correctly.
Precision on validation set: [0.22 0.53 0.31 0.   0.51 0.8  0.42 0.5 ]
Recall on validation set: [0.14 0.71 0.29 0.   0.51 0.81 0.16 0.08]
F1-score on validation set: [0.17 0.61 0.3  0.   0.51 0.8  0.23 0.13]
ROC AUC on validation set: {'AK': 0.77, 'BCC': 0.92, 'BKL': 0.59, 'DF': 0.78, 'MEL': 0.49, 'NV': 0.19, 'SCC': 0.85, 'VASC': 0.78}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             6           18  ...            1             0
true class BCC            3          118  ...            4             0
true class BKL            8           19  ...            1             0
true class DF             0            6  ...            1             0
true class MEL            5           19  ...            0             0
true class NV             3           19  ...            0             1
true class SCC            2           17  ...            5             0
true class VASC           0            6  ...            0             1

[8 rows x 8 columns]

Current validation loss: 1.100

Epoch 87:
Mean loss 0.5606675186790878 - Correctly labeled training images 80.39%
Classified 65.06 % of validation images correctly.
Precision on validation set: [0.36 0.48 0.41 0.   0.62 0.75 0.44 1.  ]
Recall on validation set: [0.09 0.78 0.31 0.   0.31 0.89 0.12 0.15]
F1-score on validation set: [0.15 0.59 0.35 0.   0.42 0.82 0.2  0.27]
ROC AUC on validation set: {'AK': 0.78, 'BCC': 0.92, 'BKL': 0.62, 'DF': 0.78, 'MEL': 0.49, 'NV': 0.18, 'SCC': 0.84, 'VASC': 0.81}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             4           22  ...            1             0
true class BCC            2          130  ...            1             0
true class BKL            3           28  ...            1             0
true class DF             0            7  ...            0             0
true class MEL            0           33  ...            2             0
true class NV             2           23  ...            0             0
true class SCC            0           23  ...            4             0
true class VASC           0            7  ...            0             2

[8 rows x 8 columns]

Current validation loss: 1.157

Epoch 88:
Mean loss 0.5335013904500083 - Correctly labeled training images 81.48%
Classified 60.41 % of validation images correctly.
Precision on validation set: [0.31 0.53 0.38 0.   0.4  0.85 0.35 0.67]
Recall on validation set: [0.23 0.74 0.33 0.   0.63 0.68 0.19 0.15]
F1-score on validation set: [0.27 0.61 0.35 0.   0.49 0.76 0.24 0.25]
ROC AUC on validation set: {'AK': 0.74, 'BCC': 0.92, 'BKL': 0.59, 'DF': 0.81, 'MEL': 0.48, 'NV': 0.21, 'SCC': 0.81, 'VASC': 0.74}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            10           15  ...            1             0
true class BCC            7          123  ...            7             0
true class BKL            6           21  ...            2             0
true class DF             1            7  ...            0             0
true class MEL            4           22  ...            0             0
true class NV             2           24  ...            1             1
true class SCC            2           16  ...            6             0
true class VASC           0            6  ...            0             2

[8 rows x 8 columns]

Current validation loss: 1.270

Epoch 89:
Mean loss 0.5257568963647641 - Correctly labeled training images 81.97%
Classified 66.09 % of validation images correctly.
Precision on validation set: [0.3  0.56 0.44 0.   0.62 0.75 0.5  0.5 ]
Recall on validation set: [0.3  0.72 0.35 0.   0.29 0.91 0.22 0.15]
F1-score on validation set: [0.3  0.63 0.39 0.   0.39 0.82 0.3  0.24]
ROC AUC on validation set: {'AK': 0.77, 'BCC': 0.91, 'BKL': 0.62, 'DF': 0.82, 'MEL': 0.5, 'NV': 0.17, 'SCC': 0.85, 'VASC': 0.78}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            13           17  ...            1             0
true class BCC            4          121  ...            3             0
true class BKL           10           16  ...            0             0
true class DF             0            7  ...            1             0
true class MEL            7           21  ...            2             0
true class NV             5           13  ...            0             2
true class SCC            4           16  ...            7             0
true class VASC           0            5  ...            0             2

[8 rows x 8 columns]

Current validation loss: 1.161

Epoch 90:
Mean loss 0.5183248800058095 - Correctly labeled training images 81.98%
Classified 64.59 % of validation images correctly.
Precision on validation set: [0.32 0.57 0.38 0.   0.54 0.73 0.56 0.5 ]
Recall on validation set: [0.28 0.6  0.28 0.   0.4  0.89 0.16 0.08]
F1-score on validation set: [0.3  0.59 0.32 0.   0.46 0.8  0.24 0.13]
ROC AUC on validation set: {'AK': 0.78, 'BCC': 0.93, 'BKL': 0.61, 'DF': 0.81, 'MEL': 0.5, 'NV': 0.17, 'SCC': 0.87, 'VASC': 0.77}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            12           14  ...            0             0
true class BCC            8          101  ...            4             0
true class BKL            8            9  ...            0             0
true class DF             0            7  ...            0             0
true class MEL            2           11  ...            0             0
true class NV             4           14  ...            0             1
true class SCC            3           17  ...            5             0
true class VASC           0            3  ...            0             1

[8 rows x 8 columns]

Current validation loss: 1.165

Epoch 91:
Mean loss 0.49696722699546664 - Correctly labeled training images 82.87%
Classified 64.51 % of validation images correctly.
Precision on validation set: [0.21 0.52 0.39 0.   0.56 0.79 0.33 1.  ]
Recall on validation set: [0.16 0.74 0.4  0.   0.42 0.83 0.12 0.08]
F1-score on validation set: [0.18 0.61 0.4  0.   0.48 0.81 0.18 0.14]
ROC AUC on validation set: {'AK': 0.76, 'BCC': 0.92, 'BKL': 0.59, 'DF': 0.81, 'MEL': 0.48, 'NV': 0.19, 'SCC': 0.87, 'VASC': 0.78}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             7           20  ...            2             0
true class BCC            4          123  ...            4             0
true class BKL            8           19  ...            1             0
true class DF             2            5  ...            0             0
true class MEL            8           18  ...            1             0
true class NV             4           24  ...            0             0
true class SCC            1           22  ...            4             0
true class VASC           0            7  ...            0             1

/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
[8 rows x 8 columns]

Current validation loss: 1.138

Epoch 92:
Mean loss 0.47294143630832153 - Correctly labeled training images 84.01%
Classified 64.51 % of validation images correctly.
Precision on validation set: [0.22 0.54 0.34 0.   0.62 0.75 0.44 1.  ]
Recall on validation set: [0.12 0.71 0.37 0.   0.3  0.89 0.12 0.08]
F1-score on validation set: [0.15 0.61 0.35 0.   0.4  0.82 0.2  0.14]
ROC AUC on validation set: {'AK': 0.78, 'BCC': 0.93, 'BKL': 0.6, 'DF': 0.81, 'MEL': 0.5, 'NV': 0.18, 'SCC': 0.86, 'VASC': 0.72}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             5           18  ...            2             0
true class BCC            3          118  ...            2             0
true class BKL            7           17  ...            0             0
true class DF             1            8  ...            0             0
true class MEL            5           18  ...            1             0
true class NV             1           15  ...            0             0
true class SCC            1           21  ...            4             0
true class VASC           0            5  ...            0             1

[8 rows x 8 columns]

Current validation loss: 1.174

Epoch 93:
Mean loss 0.47380941209591904 - Correctly labeled training images 83.75%
Classified 60.96 % of validation images correctly.
Precision on validation set: [0.24 0.51 0.36 0.   0.45 0.83 0.44 1.  ]
Recall on validation set: [0.16 0.77 0.36 0.   0.59 0.7  0.12 0.08]
F1-score on validation set: [0.19 0.61 0.36 0.   0.51 0.76 0.2  0.14]
ROC AUC on validation set: {'AK': 0.75, 'BCC': 0.92, 'BKL': 0.59, 'DF': 0.81, 'MEL': 0.48, 'NV': 0.2, 'SCC': 0.83, 'VASC': 0.74}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             7           20  ...            1             0
true class BCC            4          129  ...            2             0
true class BKL            6           21  ...            1             0
true class DF             1            7  ...            1             0
true class MEL            5           20  ...            0             0
true class NV             3           31  ...            0             0
true class SCC            3           19  ...            4             0
true class VASC           0            7  ...            0             1

[8 rows x 8 columns]

Current validation loss: 1.273

Epoch 94:
Mean loss 0.4517399896559091 - Correctly labeled training images 84.69%
Classified 62.85 % of validation images correctly.
Precision on validation set: [0.3  0.52 0.33 0.   0.51 0.81 0.29 0.33]
Recall on validation set: [0.3  0.71 0.41 0.   0.41 0.8  0.12 0.08]
F1-score on validation set: [0.3  0.6  0.37 0.   0.45 0.8  0.17 0.12]
ROC AUC on validation set: {'AK': 0.77, 'BCC': 0.93, 'BKL': 0.59, 'DF': 0.75, 'MEL': 0.48, 'NV': 0.19, 'SCC': 0.87, 'VASC': 0.79}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            13           17  ...            3             0
true class BCC            7          119  ...            4             0
true class BKL           12           15  ...            0             0
true class DF             3            4  ...            0             0
true class MEL            4           23  ...            3             1
true class NV             4           20  ...            0             1
true class SCC            1           23  ...            4             0
true class VASC           0            7  ...            0             1

[8 rows x 8 columns]

Current validation loss: 1.133

Epoch 95:
Mean loss 0.451445239352221 - Correctly labeled training images 84.67%
Classified 62.38 % of validation images correctly.
Precision on validation set: [0.29 0.56 0.34 0.   0.44 0.82 0.38 1.  ]
Recall on validation set: [0.21 0.72 0.34 0.   0.55 0.76 0.09 0.23]
F1-score on validation set: [0.24 0.63 0.34 0.   0.49 0.79 0.15 0.38]
ROC AUC on validation set: {'AK': 0.79, 'BCC': 0.93, 'BKL': 0.61, 'DF': 0.79, 'MEL': 0.45, 'NV': 0.2, 'SCC': 0.86, 'VASC': 0.77}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             9           16  ...            0             0
true class BCC            6          120  ...            3             0
true class BKL            6           20  ...            0             0
true class DF             1            6  ...            0             0
true class MEL            5           13  ...            2             0
true class NV             2           15  ...            0             0
true class SCC            2           21  ...            3             0
true class VASC           0            5  ...            0             3

[8 rows x 8 columns]

Current validation loss: 1.242

Epoch 96:
Mean loss 0.42891456984712123 - Correctly labeled training images 85.22%
Classified 64.35 % of validation images correctly.
Precision on validation set: [0.25 0.56 0.34 0.   0.55 0.74 0.4  1.  ]
Recall on validation set: [0.16 0.72 0.22 0.   0.36 0.89 0.19 0.08]
F1-score on validation set: [0.2  0.63 0.27 0.   0.44 0.8  0.26 0.14]
ROC AUC on validation set: {'AK': 0.78, 'BCC': 0.92, 'BKL': 0.61, 'DF': 0.78, 'MEL': 0.5, 'NV': 0.17, 'SCC': 0.86, 'VASC': 0.74}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             7           20  ...            2             0
true class BCC            4          121  ...            4             0
true class BKL            7           20  ...            0             0
true class DF             2            6  ...            0             0
true class MEL            3           16  ...            3             0
true class NV             4           10  ...            0             0
true class SCC            1           18  ...            6             0
true class VASC           0            4  ...            0             1

[8 rows x 8 columns]

Current validation loss: 1.246

Epoch 97:
Mean loss 0.41295730167476913 - Correctly labeled training images 85.69%
Classified 65.54 % of validation images correctly.
Precision on validation set: [0.26 0.59 0.41 0.   0.5  0.77 0.42 1.  ]
Recall on validation set: [0.16 0.67 0.31 0.   0.46 0.87 0.25 0.08]
F1-score on validation set: [0.2  0.63 0.35 0.   0.48 0.82 0.31 0.14]
ROC AUC on validation set: {'AK': 0.76, 'BCC': 0.92, 'BKL': 0.6, 'DF': 0.77, 'MEL': 0.47, 'NV': 0.2, 'SCC': 0.85, 'VASC': 0.78}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             7           14  ...            1             0
true class BCC            6          112  ...            7             0
true class BKL            5           11  ...            1             0
true class DF             2            4  ...            0             0
true class MEL            4           15  ...            2             0
true class NV             1           15  ...            0             0
true class SCC            2           14  ...            8             0
true class VASC           0            6  ...            0             1

[8 rows x 8 columns]

Current validation loss: 1.196

Epoch 98:
Mean loss 0.3984186273150452 - Correctly labeled training images 86.60%
Classified 62.38 % of validation images correctly.
Precision on validation set: [0.22 0.6  0.35 0.   0.47 0.8  0.5  1.  ]
Recall on validation set: [0.3  0.52 0.42 0.   0.57 0.78 0.06 0.08]
F1-score on validation set: [0.26 0.56 0.38 0.   0.52 0.79 0.11 0.14]
ROC AUC on validation set: {'AK': 0.75, 'BCC': 0.91, 'BKL': 0.59, 'DF': 0.8, 'MEL': 0.46, 'NV': 0.21, 'SCC': 0.84, 'VASC': 0.81}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            13           10  ...            0             0
true class BCC           18           87  ...            2             0
true class BKL            7            9  ...            0             0
true class DF             4            3  ...            0             0
true class MEL            6            9  ...            0             0
true class NV             3           15  ...            0             0
true class SCC            7            9  ...            2             0
true class VASC           0            4  ...            0             1

/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
[8 rows x 8 columns]

Current validation loss: 1.343

Epoch 99:
Mean loss 0.38415048365431254 - Correctly labeled training images 86.90%
Classified 62.46 % of validation images correctly.
Precision on validation set: [0.26 0.6  0.31 0.   0.51 0.79 0.38 1.  ]
Recall on validation set: [0.4  0.54 0.45 0.   0.42 0.82 0.09 0.08]
F1-score on validation set: [0.31 0.57 0.37 0.   0.46 0.81 0.15 0.14]
ROC AUC on validation set: {'AK': 0.73, 'BCC': 0.91, 'BKL': 0.58, 'DF': 0.81, 'MEL': 0.48, 'NV': 0.21, 'SCC': 0.82, 'VASC': 0.74}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            17            9  ...            1             0
true class BCC           18           90  ...            2             0
true class BKL            9           10  ...            0             0
true class DF             5            4  ...            0             0
true class MEL            6           14  ...            2             0
true class NV             5           10  ...            0             0
true class SCC            6           10  ...            3             0
true class VASC           0            4  ...            0             1

[8 rows x 8 columns]

Current validation loss: 1.329

Epoch 100:
Mean loss 0.3889681595827127 - Correctly labeled training images 86.90%
Classified 64.27 % of validation images correctly.
Precision on validation set: [0.26 0.53 0.39 0.   0.54 0.81 0.45 1.  ]
Recall on validation set: [0.23 0.63 0.5  0.   0.52 0.79 0.16 0.08]
F1-score on validation set: [0.25 0.58 0.44 0.   0.53 0.8  0.23 0.14]
ROC AUC on validation set: {'AK': 0.77, 'BCC': 0.91, 'BKL': 0.58, 'DF': 0.82, 'MEL': 0.44, 'NV': 0.23, 'SCC': 0.84, 'VASC': 0.79}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            10           16  ...            1             0
true class BCC            9          106  ...            2             0
true class BKL            6           14  ...            1             0
true class DF             0            6  ...            1             0
true class MEL            4           19  ...            1             0
true class NV             3           18  ...            0             0
true class SCC            6           13  ...            5             0
true class VASC           0            7  ...            0             1

[8 rows x 8 columns]

Current validation loss: 1.360

Epoch 101:
Mean loss 0.37817679577116337 - Correctly labeled training images 87.11%
Classified 64.75 % of validation images correctly.
Precision on validation set: [0.29 0.58 0.39 0.   0.51 0.8  0.36 0.67]
Recall on validation set: [0.3  0.68 0.41 0.   0.46 0.81 0.31 0.15]
F1-score on validation set: [0.3  0.63 0.4  0.   0.49 0.81 0.33 0.25]
ROC AUC on validation set: {'AK': 0.76, 'BCC': 0.92, 'BKL': 0.6, 'DF': 0.81, 'MEL': 0.44, 'NV': 0.21, 'SCC': 0.86, 'VASC': 0.77}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            13           12  ...            1             0
true class BCC            7          114  ...            7             1
true class BKL            9           17  ...            3             0
true class DF             1            6  ...            1             0
true class MEL            6           14  ...            6             0
true class NV             4           12  ...            0             0
true class SCC            5           14  ...           10             0
true class VASC           0            6  ...            0             2

[8 rows x 8 columns]

Current validation loss: 1.308

Epoch 102:
Mean loss 0.36393123999096993 - Correctly labeled training images 87.66%
Classified 62.85 % of validation images correctly.
Precision on validation set: [0.26 0.56 0.38 0.   0.46 0.81 0.33 1.  ]
Recall on validation set: [0.3  0.69 0.41 0.   0.47 0.77 0.28 0.15]
F1-score on validation set: [0.28 0.62 0.39 0.   0.47 0.79 0.31 0.27]
ROC AUC on validation set: {'AK': 0.71, 'BCC': 0.92, 'BKL': 0.56, 'DF': 0.79, 'MEL': 0.44, 'NV': 0.24, 'SCC': 0.8, 'VASC': 0.78}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            13           12  ...            3             0
true class BCC           10          116  ...            6             0
true class BKL            8           13  ...            2             0
true class DF             3            6  ...            0             0
true class MEL            5           22  ...            7             0
true class NV             7           21  ...            0             0
true class SCC            4           10  ...            9             0
true class VASC           0            7  ...            0             2

[8 rows x 8 columns]

Current validation loss: 1.340

Epoch 103:
Mean loss 0.3407564321268432 - Correctly labeled training images 88.54%
Classified 64.83 % of validation images correctly.
Precision on validation set: [0.31 0.6  0.37 0.   0.55 0.77 0.47 0.83]
Recall on validation set: [0.47 0.66 0.38 0.   0.42 0.83 0.22 0.38]
F1-score on validation set: [0.37 0.63 0.38 0.   0.48 0.8  0.3  0.53]
ROC AUC on validation set: {'AK': 0.75, 'BCC': 0.93, 'BKL': 0.6, 'DF': 0.81, 'MEL': 0.49, 'NV': 0.19, 'SCC': 0.84, 'VASC': 0.77}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            20           10  ...            1             0
true class BCC           14          110  ...            5             0
true class BKL            8           10  ...            0             0
true class DF             2            6  ...            0             0
true class MEL           10           12  ...            2             0
true class NV             5           18  ...            0             1
true class SCC            6           14  ...            7             0
true class VASC           0            4  ...            0             5

[8 rows x 8 columns]

Current validation loss: 1.261

Epoch 104:
Mean loss 0.34341337585275294 - Correctly labeled training images 88.38%
Classified 61.12 % of validation images correctly.
Precision on validation set: [0.27 0.51 0.38 0.   0.46 0.79 0.24 0.33]
Recall on validation set: [0.42 0.74 0.28 0.   0.44 0.76 0.16 0.15]
F1-score on validation set: [0.33 0.6  0.32 0.   0.45 0.78 0.19 0.21]
ROC AUC on validation set: {'AK': 0.72, 'BCC': 0.92, 'BKL': 0.57, 'DF': 0.81, 'MEL': 0.47, 'NV': 0.22, 'SCC': 0.82, 'VASC': 0.77}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            18           16  ...            1             0
true class BCC            7          123  ...            4             0
true class BKL           14           19  ...            0             0
true class DF             1            9  ...            0             0
true class MEL           15           24  ...            9             4
true class NV             9           24  ...            2             0
true class SCC            2           20  ...            5             0
true class VASC           0            6  ...            0             2

[8 rows x 8 columns]

Current validation loss: 1.346

Epoch 105:
Mean loss 0.32883809616184007 - Correctly labeled training images 88.84%
Classified 67.51 % of validation images correctly.
Precision on validation set: [0.3  0.58 0.46 0.   0.56 0.8  0.36 1.  ]
Recall on validation set: [0.3  0.72 0.32 0.   0.52 0.86 0.16 0.08]
F1-score on validation set: [0.3  0.64 0.38 0.   0.54 0.83 0.22 0.14]
ROC AUC on validation set: {'AK': 0.78, 'BCC': 0.93, 'BKL': 0.62, 'DF': 0.8, 'MEL': 0.46, 'NV': 0.19, 'SCC': 0.85, 'VASC': 0.77}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            13           14  ...            1             0
true class BCC            6          120  ...            4             0
true class BKL            9           17  ...            0             0
true class DF             1            5  ...            0             0
true class MEL            8           13  ...            4             0
true class NV             3           16  ...            0             0
true class SCC            3           17  ...            5             0
true class VASC           0            6  ...            0             1

/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
[8 rows x 8 columns]

Current validation loss: 1.250

Epoch 106:
Mean loss 0.3148457834596984 - Correctly labeled training images 89.44%
Classified 65.06 % of validation images correctly.
Precision on validation set: [0.27 0.58 0.45 0.   0.49 0.78 0.43 0.8 ]
Recall on validation set: [0.4  0.66 0.29 0.   0.46 0.85 0.19 0.31]
F1-score on validation set: [0.32 0.62 0.35 0.   0.47 0.81 0.26 0.44]
ROC AUC on validation set: {'AK': 0.76, 'BCC': 0.92, 'BKL': 0.61, 'DF': 0.81, 'MEL': 0.46, 'NV': 0.2, 'SCC': 0.82, 'VASC': 0.78}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            17           12  ...            1             0
true class BCC           14          111  ...            5             0
true class BKL           11           16  ...            0             0
true class DF             1            7  ...            0             0
true class MEL            8           15  ...            2             0
true class NV             5           13  ...            0             1
true class SCC            8           13  ...            6             0
true class VASC           0            5  ...            0             4

[8 rows x 8 columns]

Current validation loss: 1.321

Epoch 107:
Mean loss 0.3076993857542705 - Correctly labeled training images 89.81%
Classified 65.06 % of validation images correctly.
Precision on validation set: [0.33 0.56 0.41 0.   0.49 0.83 0.41 1.  ]
Recall on validation set: [0.3  0.74 0.48 0.   0.48 0.78 0.28 0.31]
F1-score on validation set: [0.32 0.64 0.44 0.   0.48 0.8  0.33 0.47]
ROC AUC on validation set: {'AK': 0.77, 'BCC': 0.93, 'BKL': 0.59, 'DF': 0.79, 'MEL': 0.48, 'NV': 0.19, 'SCC': 0.85, 'VASC': 0.76}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            13           16  ...            1             0
true class BCC            6          124  ...            7             0
true class BKL            6           15  ...            1             0
true class DF             1            6  ...            0             0
true class MEL            6           20  ...            4             0
true class NV             6           17  ...            0             0
true class SCC            1           18  ...            9             0
true class VASC           0            5  ...            0             4

[8 rows x 8 columns]

Current validation loss: 1.291

Epoch 108:
Mean loss 0.2939546727325638 - Correctly labeled training images 90.27%
Classified 63.41 % of validation images correctly.
Precision on validation set: [0.29 0.62 0.39 0.   0.45 0.8  0.33 0.5 ]
Recall on validation set: [0.33 0.6  0.33 0.   0.57 0.79 0.19 0.15]
F1-score on validation set: [0.31 0.61 0.36 0.   0.5  0.8  0.24 0.24]
ROC AUC on validation set: {'AK': 0.75, 'BCC': 0.93, 'BKL': 0.58, 'DF': 0.8, 'MEL': 0.43, 'NV': 0.22, 'SCC': 0.84, 'VASC': 0.83}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            14            9  ...            1             0
true class BCC           13          100  ...            6             0
true class BKL            8           10  ...            0             0
true class DF             1            6  ...            0             0
true class MEL            6            9  ...            4             0
true class NV             4            9  ...            1             2
true class SCC            2           11  ...            6             0
true class VASC           0            6  ...            0             2

[8 rows x 8 columns]

Current validation loss: 1.364

Epoch 109:
Mean loss 0.28700921371908217 - Correctly labeled training images 90.42%
Classified 64.67 % of validation images correctly.
Precision on validation set: [0.28 0.53 0.41 0.   0.58 0.76 0.44 0.8 ]
Recall on validation set: [0.4  0.7  0.25 0.   0.4  0.86 0.22 0.31]
F1-score on validation set: [0.33 0.6  0.31 0.   0.48 0.8  0.29 0.44]
ROC AUC on validation set: {'AK': 0.77, 'BCC': 0.92, 'BKL': 0.61, 'DF': 0.79, 'MEL': 0.48, 'NV': 0.19, 'SCC': 0.86, 'VASC': 0.77}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            17           18  ...            0             0
true class BCC           10          117  ...            4             0
true class BKL           15           16  ...            1             0
true class DF             2            5  ...            0             0
true class MEL            9           16  ...            4             0
true class NV             8           22  ...            0             1
true class SCC            0           23  ...            7             0
true class VASC           0            5  ...            0             4

[8 rows x 8 columns]

Current validation loss: 1.474

Epoch 110:
Mean loss 0.28221518594524836 - Correctly labeled training images 90.48%
Classified 65.38 % of validation images correctly.
Precision on validation set: [0.31 0.59 0.36 0.   0.56 0.76 0.38 1.  ]
Recall on validation set: [0.4  0.63 0.3  0.   0.38 0.89 0.19 0.08]
F1-score on validation set: [0.35 0.61 0.33 0.   0.46 0.82 0.25 0.14]
ROC AUC on validation set: {'AK': 0.77, 'BCC': 0.93, 'BKL': 0.6, 'DF': 0.79, 'MEL': 0.46, 'NV': 0.2, 'SCC': 0.84, 'VASC': 0.79}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            17            9  ...            2             0
true class BCC           11          106  ...            3             0
true class BKL            6           14  ...            0             0
true class DF             3            4  ...            0             0
true class MEL            6           12  ...            5             0
true class NV             3           15  ...            0             0
true class SCC            8           14  ...            6             0
true class VASC           0            6  ...            0             1

[8 rows x 8 columns]

Current validation loss: 1.540

Epoch 111:
Mean loss 0.27507481719323135 - Correctly labeled training images 90.84%
Classified 63.96 % of validation images correctly.
Precision on validation set: [0.31 0.54 0.44 0.   0.48 0.8  0.3  0.75]
Recall on validation set: [0.35 0.69 0.37 0.   0.49 0.79 0.22 0.23]
F1-score on validation set: [0.33 0.61 0.4  0.   0.49 0.8  0.25 0.35]
ROC AUC on validation set: {'AK': 0.73, 'BCC': 0.92, 'BKL': 0.59, 'DF': 0.78, 'MEL': 0.45, 'NV': 0.22, 'SCC': 0.83, 'VASC': 0.74}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            15           12  ...            1             0
true class BCC            7          116  ...            7             0
true class BKL           10           15  ...            1             0
true class DF             1            6  ...            1             0
true class MEL            8           19  ...            6             0
true class NV             7           21  ...            0             1
true class SCC            1           19  ...            7             0
true class VASC           0            5  ...            0             3

[8 rows x 8 columns]

Current validation loss: 1.369

Epoch 112:
Mean loss 0.2562619147334565 - Correctly labeled training images 91.56%
Classified 64.67 % of validation images correctly.
Precision on validation set: [0.29 0.54 0.42 0.   0.5  0.79 0.35 0.8 ]
Recall on validation set: [0.4  0.72 0.26 0.   0.45 0.83 0.25 0.31]
F1-score on validation set: [0.33 0.62 0.32 0.   0.47 0.81 0.29 0.44]
ROC AUC on validation set: {'AK': 0.74, 'BCC': 0.92, 'BKL': 0.58, 'DF': 0.74, 'MEL': 0.45, 'NV': 0.22, 'SCC': 0.83, 'VASC': 0.76}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            17           14  ...            3             0
true class BCC            5          121  ...            6             0
true class BKL           14           20  ...            1             0
true class DF             1            6  ...            0             0
true class MEL           12           22  ...            4             0
true class NV             5           22  ...            1             1
true class SCC            5           14  ...            8             0
true class VASC           0            4  ...            0             4

/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
[8 rows x 8 columns]

Current validation loss: 1.428

Epoch 113:
Mean loss 0.2561286808952266 - Correctly labeled training images 91.54%
Classified 66.09 % of validation images correctly.
Precision on validation set: [0.33 0.64 0.46 0.   0.58 0.72 0.39 0.33]
Recall on validation set: [0.4  0.57 0.25 0.   0.33 0.95 0.22 0.08]
F1-score on validation set: [0.36 0.61 0.33 0.   0.42 0.82 0.28 0.12]
ROC AUC on validation set: {'AK': 0.78, 'BCC': 0.93, 'BKL': 0.63, 'DF': 0.78, 'MEL': 0.48, 'NV': 0.18, 'SCC': 0.86, 'VASC': 0.75}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            17            9  ...            0             0
true class BCC           11           96  ...            5             0
true class BKL            9           11  ...            2             0
true class DF             2            4  ...            0             0
true class MEL            6            5  ...            4             1
true class NV             2            9  ...            0             1
true class SCC            4           13  ...            7             0
true class VASC           0            3  ...            0             1

[8 rows x 8 columns]

Current validation loss: 1.755

Epoch 114:
Mean loss 0.2332503060965978 - Correctly labeled training images 92.22%
Classified 63.96 % of validation images correctly.
Precision on validation set: [0.24 0.62 0.37 0.   0.51 0.79 0.25 1.  ]
Recall on validation set: [0.28 0.65 0.47 0.   0.41 0.82 0.16 0.23]
F1-score on validation set: [0.26 0.63 0.41 0.   0.45 0.8  0.19 0.38]
ROC AUC on validation set: {'AK': 0.73, 'BCC': 0.92, 'BKL': 0.56, 'DF': 0.81, 'MEL': 0.44, 'NV': 0.24, 'SCC': 0.83, 'VASC': 0.76}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            12           10  ...            1             0
true class BCC            7          108  ...            8             0
true class BKL            8           10  ...            1             0
true class DF             0            5  ...            0             0
true class MEL           10           11  ...            5             0
true class NV             7           14  ...            0             0
true class SCC            6           13  ...            5             0
true class VASC           0            4  ...            0             3

[8 rows x 8 columns]

Current validation loss: 1.469

Epoch 115:
Mean loss 0.22234905645110253 - Correctly labeled training images 92.90%
Classified 65.14 % of validation images correctly.
Precision on validation set: [0.3  0.58 0.42 0.   0.56 0.76 0.37 0.67]
Recall on validation set: [0.42 0.6  0.39 0.   0.39 0.87 0.22 0.15]
F1-score on validation set: [0.35 0.59 0.41 0.   0.46 0.81 0.27 0.25]
ROC AUC on validation set: {'AK': 0.75, 'BCC': 0.92, 'BKL': 0.59, 'DF': 0.78, 'MEL': 0.48, 'NV': 0.2, 'SCC': 0.84, 'VASC': 0.78}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            18            8  ...            1             0
true class BCC            9          100  ...            7             0
true class BKL           13            7  ...            1             0
true class DF             2            4  ...            0             0
true class MEL            7           19  ...            3             0
true class NV             6           15  ...            0             1
true class SCC            5           14  ...            7             0
true class VASC           0            5  ...            0             2

[8 rows x 8 columns]

Current validation loss: 1.452

Epoch 116:
Mean loss 0.22317995569941937 - Correctly labeled training images 92.61%
Classified 64.51 % of validation images correctly.
Precision on validation set: [0.32 0.57 0.41 0.   0.5  0.79 0.29 0.67]
Recall on validation set: [0.35 0.67 0.47 0.   0.43 0.81 0.19 0.31]
F1-score on validation set: [0.33 0.62 0.44 0.   0.46 0.8  0.23 0.42]
ROC AUC on validation set: {'AK': 0.73, 'BCC': 0.92, 'BKL': 0.58, 'DF': 0.79, 'MEL': 0.48, 'NV': 0.21, 'SCC': 0.82, 'VASC': 0.77}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            15           13  ...            2             0
true class BCC            9          112  ...            6             1
true class BKL            8           10  ...            1             0
true class DF             2            6  ...            0             0
true class MEL            5           20  ...            5             0
true class NV             3           15  ...            1             1
true class SCC            5           15  ...            6             0
true class VASC           0            4  ...            0             4

[8 rows x 8 columns]

Current validation loss: 1.426

Epoch 117:
Mean loss 0.22803192271348618 - Correctly labeled training images 92.53%
Classified 65.93 % of validation images correctly.
Precision on validation set: [0.24 0.59 0.43 0.   0.53 0.78 0.42 1.  ]
Recall on validation set: [0.35 0.75 0.33 0.   0.36 0.86 0.31 0.23]
F1-score on validation set: [0.28 0.66 0.37 0.   0.43 0.82 0.36 0.38]
ROC AUC on validation set: {'AK': 0.73, 'BCC': 0.93, 'BKL': 0.59, 'DF': 0.8, 'MEL': 0.44, 'NV': 0.22, 'SCC': 0.81, 'VASC': 0.79}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            15           13  ...            2             0
true class BCC            9          126  ...            6             0
true class BKL           14           16  ...            0             0
true class DF             2            7  ...            0             0
true class MEL           10           13  ...            4             0
true class NV             8           19  ...            2             0
true class SCC            5           12  ...           10             0
true class VASC           0            6  ...            0             3

[8 rows x 8 columns]

Current validation loss: 1.452

Epoch 118:
Mean loss 0.2351872408850712 - Correctly labeled training images 92.13%
Classified 66.72 % of validation images correctly.
Precision on validation set: [0.24 0.62 0.48 0.   0.52 0.82 0.35 0.8 ]
Recall on validation set: [0.44 0.68 0.32 0.   0.51 0.84 0.25 0.31]
F1-score on validation set: [0.31 0.65 0.39 0.   0.51 0.83 0.29 0.44]
ROC AUC on validation set: {'AK': 0.73, 'BCC': 0.92, 'BKL': 0.59, 'DF': 0.76, 'MEL': 0.47, 'NV': 0.21, 'SCC': 0.82, 'VASC': 0.75}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            19           11  ...            1             0
true class BCC           10          114  ...            7             0
true class BKL           16           15  ...            1             0
true class DF             3            3  ...            0             0
true class MEL            9           15  ...            4             0
true class NV            11           12  ...            2             1
true class SCC           10           10  ...            8             0
true class VASC           1            4  ...            0             4

[8 rows x 8 columns]

Current validation loss: 1.477

Epoch 119:
Mean loss 0.21410059721770253 - Correctly labeled training images 92.75%
Classified 65.85 % of validation images correctly.
Precision on validation set: [0.22 0.58 0.45 0.   0.59 0.78 0.3  0.57]
Recall on validation set: [0.3  0.69 0.28 0.   0.41 0.86 0.44 0.62]
F1-score on validation set: [0.26 0.63 0.35 0.   0.48 0.82 0.35 0.59]
ROC AUC on validation set: {'AK': 0.72, 'BCC': 0.92, 'BKL': 0.6, 'DF': 0.78, 'MEL': 0.48, 'NV': 0.21, 'SCC': 0.8, 'VASC': 0.73}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            13           13  ...            3             1
true class BCC            4          115  ...           11             1
true class BKL           18           14  ...            7             0
true class DF             1            4  ...            1             0
true class MEL           12           23  ...            8             1
true class NV             9           15  ...            3             3
true class SCC            1           12  ...           14             0
true class VASC           0            2  ...            0             8

[8 rows x 8 columns]

Current validation loss: 1.431

Epoch 120:
Mean loss 0.20045029351264473 - Correctly labeled training images 93.22%
Classified 65.14 % of validation images correctly.
Precision on validation set: [0.25 0.58 0.47 0.   0.57 0.77 0.25 0.56]
Recall on validation set: [0.42 0.65 0.34 0.   0.39 0.86 0.22 0.38]
F1-score on validation set: [0.32 0.61 0.39 0.   0.46 0.81 0.23 0.45]
ROC AUC on validation set: {'AK': 0.72, 'BCC': 0.91, 'BKL': 0.59, 'DF': 0.79, 'MEL': 0.48, 'NV': 0.2, 'SCC': 0.85, 'VASC': 0.73}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            18           12  ...            1             0
true class BCC           12          108  ...            9             0
true class BKL           14           13  ...            2             1
true class DF             3            4  ...            0             0
true class MEL           14           14  ...            8             1
true class NV             6           17  ...            1             2
true class SCC            4           16  ...            7             0
true class VASC           0            3  ...            0             5

[8 rows x 8 columns]

Current validation loss: 1.475

Epoch 121:
Mean loss 0.19652860597281332 - Correctly labeled training images 93.43%
Classified 64.75 % of validation images correctly.
Precision on validation set: [0.33 0.66 0.38 0.33 0.49 0.77 0.34 0.5 ]
Recall on validation set: [0.49 0.53 0.34 0.08 0.38 0.87 0.38 0.31]
F1-score on validation set: [0.39 0.59 0.36 0.13 0.43 0.82 0.36 0.38]
ROC AUC on validation set: {'AK': 0.73, 'BCC': 0.93, 'BKL': 0.59, 'DF': 0.78, 'MEL': 0.48, 'NV': 0.2, 'SCC': 0.83, 'VASC': 0.79}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            21            2  ...            2             0
true class BCC           13           89  ...           13             0
true class BKL            8            7  ...            1             0
true class DF             2            3  ...            1             0
true class MEL           10           10  ...            4             1
true class NV             2           10  ...            2             3
true class SCC            8            9  ...           12             0
true class VASC           0            4  ...            0             4

[8 rows x 8 columns]

Current validation loss: 1.570

Epoch 122:
Mean loss 0.1790646085051426 - Correctly labeled training images 93.90%
Classified 66.96 % of validation images correctly.
Precision on validation set: [0.27 0.62 0.48 0.5  0.52 0.77 0.39 0.6 ]
Recall on validation set: [0.3  0.66 0.33 0.08 0.43 0.89 0.22 0.46]
F1-score on validation set: [0.29 0.64 0.39 0.14 0.47 0.83 0.28 0.52]
ROC AUC on validation set: {'AK': 0.74, 'BCC': 0.93, 'BKL': 0.61, 'DF': 0.78, 'MEL': 0.45, 'NV': 0.2, 'SCC': 0.84, 'VASC': 0.75}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            13           11  ...            1             0
true class BCC            9          111  ...            4             0
true class BKL            7           12  ...            0             0
true class DF             2            5  ...            1             0
true class MEL            8           12  ...            4             1
true class NV             6           11  ...            1             3
true class SCC            3           14  ...            7             0
true class VASC           0            2  ...            0             6

[8 rows x 8 columns]

Current validation loss: 1.445

Epoch 123:
Mean loss 0.19306079206006949 - Correctly labeled training images 93.54%
Classified 65.06 % of validation images correctly.
Precision on validation set: [0.24 0.49 0.48 0.   0.68 0.79 0.33 0.75]
Recall on validation set: [0.44 0.72 0.29 0.   0.31 0.87 0.38 0.23]
F1-score on validation set: [0.31 0.58 0.36 0.   0.42 0.83 0.35 0.35]
ROC AUC on validation set: {'AK': 0.69, 'BCC': 0.91, 'BKL': 0.57, 'DF': 0.76, 'MEL': 0.49, 'NV': 0.22, 'SCC': 0.79, 'VASC': 0.74}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            19           12  ...            2             0
true class BCC           11          121  ...            7             0
true class BKL           18           19  ...            6             0
true class DF             3            5  ...            1             0
true class MEL           15           36  ...            7             0
true class NV             9           34  ...            0             1
true class SCC            3           16  ...           12             0
true class VASC           0            6  ...            1             3

[8 rows x 8 columns]

Current validation loss: 1.616

Epoch 124:
Mean loss 0.1835338407099153 - Correctly labeled training images 94.10%
Classified 62.78 % of validation images correctly.
Precision on validation set: [0.2  0.52 0.42 0.   0.5  0.84 0.29 0.36]
Recall on validation set: [0.3  0.72 0.37 0.   0.47 0.76 0.34 0.31]
F1-score on validation set: [0.24 0.61 0.4  0.   0.48 0.8  0.31 0.33]
ROC AUC on validation set: {'AK': 0.67, 'BCC': 0.91, 'BKL': 0.54, 'DF': 0.74, 'MEL': 0.44, 'NV': 0.26, 'SCC': 0.79, 'VASC': 0.72}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            13           13  ...            3             0
true class BCC           10          121  ...            7             0
true class BKL           14           16  ...            4             0
true class DF             3            5  ...            0             0
true class MEL           13           22  ...           10             2
true class NV            10           33  ...            3             5
true class SCC            2           17  ...           11             0
true class VASC           0            5  ...            0             4

[8 rows x 8 columns]

Current validation loss: 1.620

Epoch 125:
Mean loss 0.1877393488028918 - Correctly labeled training images 93.87%
Classified 65.46 % of validation images correctly.
Precision on validation set: [0.32 0.58 0.41 0.   0.54 0.77 0.56 0.71]
Recall on validation set: [0.35 0.64 0.39 0.   0.39 0.86 0.28 0.38]
F1-score on validation set: [0.33 0.61 0.4  0.   0.45 0.81 0.38 0.5 ]
ROC AUC on validation set: {'AK': 0.75, 'BCC': 0.91, 'BKL': 0.6, 'DF': 0.76, 'MEL': 0.49, 'NV': 0.19, 'SCC': 0.85, 'VASC': 0.75}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            15           14  ...            0             0
true class BCC            6          107  ...            3             0
true class BKL            8           13  ...            0             0
true class DF             2            4  ...            0             0
true class MEL            6           18  ...            4             0
true class NV             9           11  ...            0             2
true class SCC            1           16  ...            9             0
true class VASC           0            3  ...            0             5

[8 rows x 8 columns]

Current validation loss: 1.537

Epoch 126:
Mean loss 0.17313518397633446 - Correctly labeled training images 94.36%
Classified 65.54 % of validation images correctly.
Precision on validation set: [0.33 0.56 0.46 0.   0.52 0.79 0.29 0.57]
Recall on validation set: [0.37 0.64 0.38 0.   0.42 0.86 0.28 0.31]
F1-score on validation set: [0.35 0.6  0.42 0.   0.46 0.82 0.29 0.4 ]
ROC AUC on validation set: {'AK': 0.71, 'BCC': 0.92, 'BKL': 0.59, 'DF': 0.77, 'MEL': 0.47, 'NV': 0.22, 'SCC': 0.83, 'VASC': 0.76}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            16           13  ...            2             0
true class BCC            8          107  ...           11             0
true class BKL            8           15  ...            2             0
true class DF             1            5  ...            0             0
true class MEL            8           14  ...            4             1
true class NV             4           18  ...            3             2
true class SCC            3           16  ...            9             0
true class VASC           0            4  ...            0             4

/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
[8 rows x 8 columns]

Current validation loss: 1.563

Epoch 127:
Mean loss 0.16891959248615976 - Correctly labeled training images 94.33%
Classified 66.40 % of validation images correctly.
Precision on validation set: [0.29 0.59 0.49 0.2  0.54 0.79 0.43 0.46]
Recall on validation set: [0.47 0.68 0.27 0.17 0.47 0.85 0.28 0.46]
F1-score on validation set: [0.36 0.63 0.35 0.18 0.5  0.82 0.34 0.46]
ROC AUC on validation set: {'AK': 0.72, 'BCC': 0.93, 'BKL': 0.61, 'DF': 0.8, 'MEL': 0.47, 'NV': 0.2, 'SCC': 0.82, 'VASC': 0.73}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            20           10  ...            1             0
true class BCC           11          113  ...            6             2
true class BKL           17           16  ...            0             0
true class DF             1            5  ...            0             0
true class MEL           12           13  ...            5             1
true class NV             4           17  ...            0             4
true class SCC            3           15  ...            9             0
true class VASC           0            3  ...            0             6

[8 rows x 8 columns]

Current validation loss: 1.509

Epoch 128:
Mean loss 0.15505966630085644 - Correctly labeled training images 94.79%
Classified 67.03 % of validation images correctly.
Precision on validation set: [0.3  0.59 0.51 0.   0.57 0.78 0.33 0.56]
Recall on validation set: [0.37 0.69 0.36 0.   0.45 0.86 0.31 0.38]
F1-score on validation set: [0.33 0.64 0.42 0.   0.5  0.82 0.32 0.45]
ROC AUC on validation set: {'AK': 0.73, 'BCC': 0.93, 'BKL': 0.58, 'DF': 0.81, 'MEL': 0.44, 'NV': 0.23, 'SCC': 0.82, 'VASC': 0.77}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            16           13  ...            2             0
true class BCC            5          116  ...           10             0
true class BKL           13           12  ...            1             1
true class DF             3            3  ...            0             0
true class MEL           11           10  ...            5             2
true class NV             3           22  ...            2             1
true class SCC            2           15  ...           10             0
true class VASC           0            4  ...            0             5

[8 rows x 8 columns]

Current validation loss: 1.542

Epoch 129:
Mean loss 0.1640533303154474 - Correctly labeled training images 94.65%
Classified 66.72 % of validation images correctly.
Precision on validation set: [0.29 0.65 0.47 0.   0.54 0.75 0.41 1.  ]
Recall on validation set: [0.35 0.61 0.34 0.   0.4  0.9  0.28 0.23]
F1-score on validation set: [0.32 0.63 0.39 0.   0.46 0.82 0.33 0.38]
ROC AUC on validation set: {'AK': 0.75, 'BCC': 0.92, 'BKL': 0.59, 'DF': 0.81, 'MEL': 0.47, 'NV': 0.2, 'SCC': 0.84, 'VASC': 0.82}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            15            9  ...            3             0
true class BCC           10          102  ...            5             0
true class BKL           10            9  ...            1             0
true class DF             2            4  ...            0             0
true class MEL            9            7  ...            4             0
true class NV             2           10  ...            0             0
true class SCC            4           12  ...            9             0
true class VASC           0            4  ...            0             3

[8 rows x 8 columns]

Current validation loss: 1.655

Epoch 130:
Mean loss 0.13984711187500917 - Correctly labeled training images 95.48%
Classified 64.91 % of validation images correctly.
Precision on validation set: [0.28 0.58 0.46 0.   0.5  0.78 0.34 0.57]
Recall on validation set: [0.37 0.61 0.25 0.   0.47 0.86 0.34 0.31]
F1-score on validation set: [0.32 0.59 0.33 0.   0.48 0.82 0.34 0.4 ]
ROC AUC on validation set: {'AK': 0.74, 'BCC': 0.91, 'BKL': 0.58, 'DF': 0.8, 'MEL': 0.46, 'NV': 0.22, 'SCC': 0.82, 'VASC': 0.73}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            16           11  ...            2             0
true class BCC           11          102  ...           11             0
true class BKL           11           15  ...            1             0
true class DF             2            3  ...            1             0
true class MEL            8           13  ...            6             1
true class NV             6           14  ...            0             2
true class SCC            4           14  ...           11             0
true class VASC           0            4  ...            0             4

[8 rows x 8 columns]

Current validation loss: 1.670

Epoch 131:
Mean loss 0.15327331113955153 - Correctly labeled training images 95.10%
Classified 65.30 % of validation images correctly.
Precision on validation set: [0.3  0.57 0.4  0.   0.56 0.8  0.35 0.5 ]
Recall on validation set: [0.42 0.67 0.44 0.   0.39 0.84 0.22 0.31]
F1-score on validation set: [0.35 0.62 0.42 0.   0.46 0.82 0.27 0.38]
ROC AUC on validation set: {'AK': 0.72, 'BCC': 0.93, 'BKL': 0.57, 'DF': 0.78, 'MEL': 0.49, 'NV': 0.2, 'SCC': 0.84, 'VASC': 0.71}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            18            7  ...            2             0
true class BCC           12          112  ...            5             0
true class BKL           11           13  ...            0             0
true class DF             1            5  ...            0             0
true class MEL            8           19  ...            6             1
true class NV             6           18  ...            0             3
true class SCC            5           17  ...            7             0
true class VASC           0            4  ...            0             4

[8 rows x 8 columns]

Current validation loss: 1.616

Epoch 132:
Mean loss 0.13409074943010293 - Correctly labeled training images 95.66%
Classified 64.91 % of validation images correctly.
Precision on validation set: [0.26 0.58 0.4  0.5  0.54 0.78 0.37 0.33]
Recall on validation set: [0.35 0.66 0.37 0.08 0.36 0.86 0.31 0.31]
F1-score on validation set: [0.3  0.61 0.38 0.14 0.43 0.82 0.34 0.32]
ROC AUC on validation set: {'AK': 0.68, 'BCC': 0.92, 'BKL': 0.56, 'DF': 0.76, 'MEL': 0.48, 'NV': 0.23, 'SCC': 0.81, 'VASC': 0.73}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            15           13  ...            0             0
true class BCC            6          110  ...           11             0
true class BKL           12           15  ...            0             1
true class DF             1            2  ...            0             0
true class MEL           12           17  ...            5             1
true class NV             6           17  ...            1             6
true class SCC            5           13  ...           10             0
true class VASC           0            4  ...            0             4

[8 rows x 8 columns]

Current validation loss: 1.587

Epoch 133:
Mean loss 0.13267909415794849 - Correctly labeled training images 95.61%
Classified 66.48 % of validation images correctly.
Precision on validation set: [0.29 0.64 0.4  0.17 0.53 0.8  0.44 0.67]
Recall on validation set: [0.4  0.6  0.4  0.08 0.46 0.86 0.34 0.31]
F1-score on validation set: [0.34 0.62 0.4  0.11 0.49 0.83 0.39 0.42]
ROC AUC on validation set: {'AK': 0.7, 'BCC': 0.93, 'BKL': 0.56, 'DF': 0.8, 'MEL': 0.46, 'NV': 0.22, 'SCC': 0.84, 'VASC': 0.79}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            17            9  ...            1             0
true class BCC           13          100  ...            5             0
true class BKL            8           11  ...            3             0
true class DF             1            6  ...            0             0
true class MEL           10            9  ...            5             0
true class NV             6            6  ...            0             2
true class SCC            3           11  ...           11             0
true class VASC           0            5  ...            0             4

/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
[8 rows x 8 columns]

Current validation loss: 1.553

Epoch 134:
Mean loss 0.1292573809638408 - Correctly labeled training images 95.85%
Classified 65.93 % of validation images correctly.
Precision on validation set: [0.25 0.6  0.46 0.15 0.51 0.8  0.37 0.42]
Recall on validation set: [0.3  0.71 0.39 0.17 0.37 0.86 0.34 0.38]
F1-score on validation set: [0.28 0.65 0.42 0.16 0.43 0.83 0.35 0.4 ]
ROC AUC on validation set: {'AK': 0.68, 'BCC': 0.93, 'BKL': 0.57, 'DF': 0.78, 'MEL': 0.48, 'NV': 0.21, 'SCC': 0.78, 'VASC': 0.75}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            13           12  ...            1             0
true class BCC            7          118  ...            8             0
true class BKL           11           14  ...            2             1
true class DF             2            5  ...            0             0
true class MEL            9           16  ...            7             2
true class NV             6           17  ...            1             4
true class SCC            3           10  ...           11             0
true class VASC           0            4  ...            0             5

[8 rows x 8 columns]

Current validation loss: 1.632

Epoch 135:
Mean loss 0.13852517387010038 - Correctly labeled training images 95.49%
Classified 66.96 % of validation images correctly.
Precision on validation set: [0.3  0.62 0.46 0.2  0.58 0.77 0.54 0.5 ]
Recall on validation set: [0.37 0.69 0.36 0.08 0.42 0.87 0.41 0.31]
F1-score on validation set: [0.33 0.65 0.4  0.12 0.48 0.82 0.46 0.38]
ROC AUC on validation set: {'AK': 0.7, 'BCC': 0.92, 'BKL': 0.56, 'DF': 0.78, 'MEL': 0.48, 'NV': 0.22, 'SCC': 0.8, 'VASC': 0.77}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            16            9  ...            2             0
true class BCC           10          115  ...            3             0
true class BKL            7           13  ...            1             0
true class DF             2            4  ...            0             0
true class MEL            9           11  ...            5             1
true class NV             7           19  ...            0             3
true class SCC            2           10  ...           13             0
true class VASC           0            5  ...            0             4

[8 rows x 8 columns]

Current validation loss: 1.562

Epoch 136:
Mean loss 0.12543189370775543 - Correctly labeled training images 95.89%
Classified 64.83 % of validation images correctly.
Precision on validation set: [0.24 0.65 0.42 0.   0.5  0.8  0.35 0.6 ]
Recall on validation set: [0.4  0.6  0.4  0.   0.49 0.82 0.34 0.23]
F1-score on validation set: [0.3  0.62 0.41 0.   0.5  0.81 0.35 0.33]
ROC AUC on validation set: {'AK': 0.72, 'BCC': 0.92, 'BKL': 0.55, 'DF': 0.79, 'MEL': 0.45, 'NV': 0.24, 'SCC': 0.79, 'VASC': 0.79}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            17            9  ...            2             0
true class BCC           16          100  ...           10             0
true class BKL           11           11  ...            1             0
true class DF             3            4  ...            0             0
true class MEL            7            9  ...            6             0
true class NV            10            9  ...            1             2
true class SCC            6            7  ...           11             0
true class VASC           0            4  ...            0             3

[8 rows x 8 columns]

Current validation loss: 1.660

Epoch 137:
Mean loss 0.11393191825381072 - Correctly labeled training images 96.24%
Classified 64.83 % of validation images correctly.
Precision on validation set: [0.25 0.6  0.42 0.06 0.52 0.83 0.33 0.55]
Recall on validation set: [0.33 0.68 0.39 0.08 0.51 0.79 0.41 0.46]
F1-score on validation set: [0.29 0.64 0.4  0.07 0.52 0.81 0.37 0.5 ]
ROC AUC on validation set: {'AK': 0.72, 'BCC': 0.92, 'BKL': 0.56, 'DF': 0.79, 'MEL': 0.47, 'NV': 0.22, 'SCC': 0.79, 'VASC': 0.77}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            14           13  ...            1             0
true class BCC           12          114  ...            7             0
true class BKL           12           15  ...            4             1
true class DF             0            5  ...            1             0
true class MEL            7           14  ...           10             1
true class NV             9           12  ...            3             3
true class SCC            1           12  ...           13             0
true class VASC           0            4  ...            0             6

[8 rows x 8 columns]

Current validation loss: 1.637

Epoch 138:
Mean loss 0.10235460606081946 - Correctly labeled training images 96.80%
Classified 65.85 % of validation images correctly.
Precision on validation set: [0.34 0.59 0.38 0.2  0.55 0.81 0.41 0.5 ]
Recall on validation set: [0.37 0.69 0.45 0.17 0.39 0.84 0.28 0.31]
F1-score on validation set: [0.36 0.63 0.41 0.18 0.46 0.82 0.33 0.38]
ROC AUC on validation set: {'AK': 0.72, 'BCC': 0.92, 'BKL': 0.56, 'DF': 0.8, 'MEL': 0.47, 'NV': 0.22, 'SCC': 0.81, 'VASC': 0.78}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            16            9  ...            2             0
true class BCC           11          115  ...            6             0
true class BKL            7           15  ...            1             0
true class DF             1            5  ...            0             0
true class MEL            4           18  ...            4             1
true class NV             5           17  ...            0             3
true class SCC            3           13  ...            9             0
true class VASC           0            4  ...            0             4

[8 rows x 8 columns]

Current validation loss: 1.624

Epoch 139:
Mean loss 0.11201649089600914 - Correctly labeled training images 96.46%
Classified 66.40 % of validation images correctly.
Precision on validation set: [0.22 0.58 0.45 0.1  0.59 0.78 0.48 0.88]
Recall on validation set: [0.35 0.68 0.36 0.08 0.35 0.88 0.38 0.54]
F1-score on validation set: [0.27 0.63 0.4  0.09 0.44 0.83 0.42 0.67]
ROC AUC on validation set: {'AK': 0.74, 'BCC': 0.93, 'BKL': 0.59, 'DF': 0.81, 'MEL': 0.48, 'NV': 0.2, 'SCC': 0.81, 'VASC': 0.74}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            15           12  ...            1             0
true class BCC           16          114  ...            5             0
true class BKL           11           16  ...            1             0
true class DF             2            5  ...            1             0
true class MEL           13           18  ...            4             0
true class NV             5           17  ...            1             1
true class SCC            5           11  ...           12             0
true class VASC           0            2  ...            0             7

[8 rows x 8 columns]

Current validation loss: 1.693

Epoch 140:
Mean loss 0.11849542813998433 - Correctly labeled training images 96.12%
Classified 65.93 % of validation images correctly.
Precision on validation set: [0.38 0.59 0.43 0.09 0.58 0.77 0.41 0.5 ]
Recall on validation set: [0.42 0.65 0.41 0.08 0.37 0.86 0.34 0.31]
F1-score on validation set: [0.4  0.62 0.42 0.09 0.45 0.81 0.37 0.38]
ROC AUC on validation set: {'AK': 0.72, 'BCC': 0.92, 'BKL': 0.57, 'DF': 0.76, 'MEL': 0.49, 'NV': 0.21, 'SCC': 0.83, 'VASC': 0.78}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            18           11  ...            1             0
true class BCC            8          109  ...            5             1
true class BKL            8           14  ...            1             0
true class DF             1            4  ...            1             0
true class MEL            6           15  ...            5             1
true class NV             5           12  ...            3             2
true class SCC            1           16  ...           11             0
true class VASC           0            5  ...            0             4

[8 rows x 8 columns]

Current validation loss: 1.678

Epoch 141:
Mean loss 0.10589914374297327 - Correctly labeled training images 96.62%
Classified 65.06 % of validation images correctly.
Precision on validation set: [0.23 0.61 0.4  0.25 0.64 0.78 0.38 0.67]
Recall on validation set: [0.49 0.53 0.46 0.17 0.28 0.89 0.31 0.31]
F1-score on validation set: [0.32 0.57 0.43 0.2  0.39 0.83 0.34 0.42]
ROC AUC on validation set: {'AK': 0.69, 'BCC': 0.91, 'BKL': 0.56, 'DF': 0.83, 'MEL': 0.5, 'NV': 0.22, 'SCC': 0.8, 'VASC': 0.77}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            21            9  ...            2             0
true class BCC           24           89  ...            9             0
true class BKL           12            5  ...            1             0
true class DF             3            5  ...            0             0
true class MEL           15           14  ...            3             1
true class NV             5           13  ...            1             1
true class SCC            9            8  ...           10             0
true class VASC           1            4  ...            0             4

[8 rows x 8 columns]

Current validation loss: 1.846

Epoch 142:
Mean loss 0.10606720361914426 - Correctly labeled training images 96.68%
Classified 65.69 % of validation images correctly.
Precision on validation set: [0.35 0.62 0.41 0.   0.49 0.82 0.58 0.67]
Recall on validation set: [0.44 0.64 0.39 0.   0.52 0.81 0.34 0.31]
F1-score on validation set: [0.39 0.63 0.4  0.   0.5  0.81 0.43 0.42]
ROC AUC on validation set: {'AK': 0.75, 'BCC': 0.92, 'BKL': 0.56, 'DF': 0.79, 'MEL': 0.45, 'NV': 0.23, 'SCC': 0.83, 'VASC': 0.79}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            19            8  ...            1             0
true class BCC           12          107  ...            5             0
true class BKL            5           12  ...            0             0
true class DF             1            4  ...            0             0
true class MEL           11           10  ...            2             1
true class NV             5           14  ...            0             1
true class SCC            2           14  ...           11             0
true class VASC           0            4  ...            0             4

[8 rows x 8 columns]

Current validation loss: 1.690

Epoch 143:
Mean loss 0.10330988380584971 - Correctly labeled training images 96.74%
Classified 66.40 % of validation images correctly.
Precision on validation set: [0.25 0.6  0.46 0.33 0.56 0.81 0.32 0.44]
Recall on validation set: [0.42 0.67 0.42 0.08 0.38 0.86 0.41 0.31]
F1-score on validation set: [0.31 0.63 0.44 0.13 0.46 0.83 0.36 0.36]
ROC AUC on validation set: {'AK': 0.71, 'BCC': 0.93, 'BKL': 0.57, 'DF': 0.77, 'MEL': 0.49, 'NV': 0.2, 'SCC': 0.8, 'VASC': 0.78}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            18            7  ...            7             0
true class BCC           12          112  ...            8             0
true class BKL           14           12  ...            4             0
true class DF             4            3  ...            1             0
true class MEL           15           18  ...            3             2
true class NV             6           21  ...            4             3
true class SCC            4            9  ...           13             0
true class VASC           0            5  ...            0             4

[8 rows x 8 columns]

Current validation loss: 1.724

Epoch 144:
Mean loss 0.09789675813754403 - Correctly labeled training images 96.82%
Classified 65.85 % of validation images correctly.
Precision on validation set: [0.25 0.57 0.43 0.17 0.52 0.8  0.38 0.67]
Recall on validation set: [0.28 0.7  0.35 0.08 0.46 0.84 0.28 0.31]
F1-score on validation set: [0.26 0.63 0.39 0.11 0.49 0.82 0.32 0.42]
ROC AUC on validation set: {'AK': 0.74, 'BCC': 0.93, 'BKL': 0.58, 'DF': 0.8, 'MEL': 0.47, 'NV': 0.21, 'SCC': 0.82, 'VASC': 0.78}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            12           14  ...            2             0
true class BCC            7          117  ...            7             0
true class BKL            9           14  ...            0             0
true class DF             2            7  ...            0             0
true class MEL           11           16  ...            4             1
true class NV             5           17  ...            2             1
true class SCC            2           16  ...            9             0
true class VASC           0            5  ...            0             4

[8 rows x 8 columns]

Current validation loss: 1.697

Epoch 145:
Mean loss 0.09067355591380728 - Correctly labeled training images 97.05%
Classified 64.27 % of validation images correctly.
Precision on validation set: [0.3  0.59 0.38 0.   0.48 0.83 0.29 0.6 ]
Recall on validation set: [0.49 0.71 0.37 0.   0.49 0.79 0.19 0.23]
F1-score on validation set: [0.37 0.65 0.38 0.   0.48 0.81 0.23 0.33]
ROC AUC on validation set: {'AK': 0.7, 'BCC': 0.93, 'BKL': 0.55, 'DF': 0.79, 'MEL': 0.47, 'NV': 0.23, 'SCC': 0.8, 'VASC': 0.79}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            21            9  ...            0             0
true class BCC           11          119  ...            5             0
true class BKL           13           13  ...            1             0
true class DF             1            6  ...            1             0
true class MEL           11           20  ...            5             0
true class NV             7           17  ...            3             2
true class SCC            7           11  ...            6             0
true class VASC           0            6  ...            0             3

[8 rows x 8 columns]

Current validation loss: 1.736

Epoch 146:
Mean loss 0.08427521404817595 - Correctly labeled training images 97.35%
Classified 67.51 % of validation images correctly.
Precision on validation set: [0.38 0.63 0.43 0.25 0.54 0.82 0.39 0.67]
Recall on validation set: [0.47 0.71 0.44 0.08 0.46 0.84 0.34 0.46]
F1-score on validation set: [0.42 0.67 0.43 0.12 0.5  0.83 0.37 0.55]
ROC AUC on validation set: {'AK': 0.7, 'BCC': 0.93, 'BKL': 0.54, 'DF': 0.76, 'MEL': 0.47, 'NV': 0.23, 'SCC': 0.84, 'VASC': 0.75}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            20           10  ...            2             0
true class BCC            6          119  ...            7             0
true class BKL            8           11  ...            0             0
true class DF             4            3  ...            0             0
true class MEL            9           13  ...            7             1
true class NV             4           14  ...            1             2
true class SCC            2           15  ...           11             0
true class VASC           0            3  ...            0             6

[8 rows x 8 columns]

Current validation loss: 1.674

Epoch 147:
Mean loss 0.08975178910689634 - Correctly labeled training images 97.11%
Classified 66.09 % of validation images correctly.
Precision on validation set: [0.32 0.59 0.49 0.33 0.48 0.82 0.41 0.6 ]
Recall on validation set: [0.26 0.65 0.42 0.17 0.57 0.81 0.34 0.23]
F1-score on validation set: [0.29 0.62 0.45 0.22 0.52 0.82 0.37 0.33]
ROC AUC on validation set: {'AK': 0.73, 'BCC': 0.92, 'BKL': 0.56, 'DF': 0.8, 'MEL': 0.42, 'NV': 0.24, 'SCC': 0.84, 'VASC': 0.78}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            11           12  ...            2             0
true class BCC            5          108  ...            4             0
true class BKL            6           12  ...            0             0
true class DF             0            7  ...            0             0
true class MEL            7           11  ...            8             0
true class NV             3           13  ...            2             2
true class SCC            2           15  ...           11             0
true class VASC           0            5  ...            0             3

/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
[8 rows x 8 columns]

Current validation loss: 1.763

Epoch 148:
Mean loss 0.08718283850867124 - Correctly labeled training images 97.32%
Classified 65.06 % of validation images correctly.
Precision on validation set: [0.3  0.64 0.43 0.15 0.48 0.85 0.44 0.56]
Recall on validation set: [0.56 0.63 0.38 0.17 0.57 0.77 0.44 0.38]
F1-score on validation set: [0.39 0.64 0.4  0.16 0.52 0.81 0.44 0.45]
ROC AUC on validation set: {'AK': 0.69, 'BCC': 0.93, 'BKL': 0.55, 'DF': 0.78, 'MEL': 0.45, 'NV': 0.24, 'SCC': 0.82, 'VASC': 0.77}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            24            6  ...            2             0
true class BCC           17          106  ...            6             1
true class BKL           12           11  ...            1             0
true class DF             3            3  ...            1             0
true class MEL           11           12  ...            6             0
true class NV             8           14  ...            2             3
true class SCC            5           10  ...           14             0
true class VASC           0            4  ...            0             5

[8 rows x 8 columns]

Current validation loss: 1.816

Epoch 149:
Mean loss 0.08629866028961077 - Correctly labeled training images 97.19%
Classified 64.98 % of validation images correctly.
Precision on validation set: [0.25 0.62 0.42 0.08 0.52 0.83 0.28 0.36]
Recall on validation set: [0.44 0.59 0.44 0.08 0.47 0.82 0.31 0.31]
F1-score on validation set: [0.32 0.6  0.43 0.08 0.49 0.83 0.29 0.33]
ROC AUC on validation set: {'AK': 0.67, 'BCC': 0.92, 'BKL': 0.54, 'DF': 0.77, 'MEL': 0.47, 'NV': 0.24, 'SCC': 0.81, 'VASC': 0.76}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            19            6  ...            1             0
true class BCC           15           98  ...           13             2
true class BKL           13            7  ...            4             1
true class DF             4            4  ...            0             0
true class MEL           13           14  ...            5             0
true class NV             8           12  ...            3             4
true class SCC            3           13  ...           10             0
true class VASC           1            5  ...            0             4

[8 rows x 8 columns]

Current validation loss: 1.746

Epoch 150:
Mean loss 0.08292970981827881 - Correctly labeled training images 97.37%
Classified 67.19 % of validation images correctly.
Precision on validation set: [0.32 0.62 0.47 0.   0.57 0.79 0.54 0.71]
Recall on validation set: [0.47 0.62 0.38 0.   0.47 0.87 0.22 0.38]
F1-score on validation set: [0.38 0.62 0.42 0.   0.51 0.83 0.31 0.5 ]
ROC AUC on validation set: {'AK': 0.73, 'BCC': 0.93, 'BKL': 0.58, 'DF': 0.78, 'MEL': 0.46, 'NV': 0.21, 'SCC': 0.84, 'VASC': 0.78}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            20            8  ...            0             0
true class BCC           14          103  ...            3             0
true class BKL            9           13  ...            0             0
true class DF             3            3  ...            0             0
true class MEL            8            9  ...            3             0
true class NV             6           12  ...            0             2
true class SCC            3           15  ...            7             0
true class VASC           0            4  ...            0             5

[8 rows x 8 columns]

Current validation loss: 1.752

Epoch 151:
Mean loss 0.07803345942680286 - Correctly labeled training images 97.61%
Classified 67.19 % of validation images correctly.
Precision on validation set: [0.43 0.63 0.47 0.14 0.52 0.78 0.47 0.43]
Recall on validation set: [0.47 0.63 0.36 0.08 0.45 0.88 0.28 0.23]
F1-score on validation set: [0.45 0.63 0.41 0.11 0.48 0.83 0.35 0.3 ]
ROC AUC on validation set: {'AK': 0.71, 'BCC': 0.93, 'BKL': 0.59, 'DF': 0.76, 'MEL': 0.46, 'NV': 0.21, 'SCC': 0.82, 'VASC': 0.77}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            20            9  ...            0             0
true class BCC            6          106  ...            8             1
true class BKL            8           11  ...            0             1
true class DF             2            4  ...            0             0
true class MEL            5           11  ...            2             0
true class NV             3           11  ...            0             2
true class SCC            2           11  ...            9             0
true class VASC           0            4  ...            0             3

[8 rows x 8 columns]

Current validation loss: 1.693

Epoch 152:
Mean loss 0.09466955476137148 - Correctly labeled training images 96.95%
Classified 65.14 % of validation images correctly.
Precision on validation set: [0.29 0.62 0.4  0.15 0.54 0.8  0.39 0.57]
Recall on validation set: [0.51 0.64 0.45 0.25 0.37 0.84 0.22 0.31]
F1-score on validation set: [0.37 0.63 0.42 0.19 0.44 0.82 0.28 0.4 ]
ROC AUC on validation set: {'AK': 0.68, 'BCC': 0.92, 'BKL': 0.57, 'DF': 0.75, 'MEL': 0.47, 'NV': 0.22, 'SCC': 0.78, 'VASC': 0.78}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            22            6  ...            1             0
true class BCC           14          107  ...            4             0
true class BKL            8           14  ...            1             0
true class DF             1            2  ...            0             0
true class MEL           13           15  ...            4             0
true class NV             9           15  ...            1             3
true class SCC            7           10  ...            7             0
true class VASC           1            4  ...            0             4

[8 rows x 8 columns]

Current validation loss: 1.843

Epoch 153:
Mean loss 0.08301907980246087 - Correctly labeled training images 97.38%
Classified 66.72 % of validation images correctly.
Precision on validation set: [0.35 0.64 0.43 0.29 0.5  0.8  0.48 0.67]
Recall on validation set: [0.42 0.65 0.38 0.17 0.46 0.85 0.34 0.46]
F1-score on validation set: [0.38 0.64 0.4  0.21 0.48 0.82 0.4  0.55]
ROC AUC on validation set: {'AK': 0.75, 'BCC': 0.93, 'BKL': 0.59, 'DF': 0.78, 'MEL': 0.45, 'NV': 0.22, 'SCC': 0.82, 'VASC': 0.75}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            18           11  ...            0             0
true class BCC            7          109  ...            7             0
true class BKL            9           11  ...            0             0
true class DF             1            4  ...            0             0
true class MEL            5            8  ...            5             0
true class NV             8           14  ...            0             3
true class SCC            4           11  ...           11             0
true class VASC           0            3  ...            0             6

[8 rows x 8 columns]

Current validation loss: 1.755

Epoch 154:
Mean loss 0.07335863461092185 - Correctly labeled training images 97.68%
Classified 67.90 % of validation images correctly.
Precision on validation set: [0.41 0.63 0.46 0.29 0.55 0.78 0.48 0.57]
Recall on validation set: [0.49 0.68 0.4  0.17 0.38 0.88 0.38 0.31]
F1-score on validation set: [0.45 0.66 0.43 0.21 0.45 0.83 0.42 0.4 ]
ROC AUC on validation set: {'AK': 0.71, 'BCC': 0.93, 'BKL': 0.56, 'DF': 0.73, 'MEL': 0.49, 'NV': 0.21, 'SCC': 0.81, 'VASC': 0.75}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            21           10  ...            0             0
true class BCC            9          114  ...            5             0
true class BKL            6           13  ...            0             0
true class DF             1            2  ...            2             0
true class MEL            8           11  ...            5             0
true class NV             5           16  ...            1             3
true class SCC            1           12  ...           12             0
true class VASC           0            3  ...            0             4

/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
[8 rows x 8 columns]

Current validation loss: 1.716

Epoch 155:
Mean loss 0.0744157533109194 - Correctly labeled training images 97.68%
Classified 66.32 % of validation images correctly.
Precision on validation set: [0.33 0.58 0.45 0.38 0.5  0.82 0.39 0.3 ]
Recall on validation set: [0.37 0.7  0.38 0.25 0.48 0.83 0.28 0.23]
F1-score on validation set: [0.35 0.63 0.41 0.3  0.49 0.83 0.33 0.26]
ROC AUC on validation set: {'AK': 0.68, 'BCC': 0.92, 'BKL': 0.55, 'DF': 0.77, 'MEL': 0.43, 'NV': 0.26, 'SCC': 0.81, 'VASC': 0.74}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            16           12  ...            1             0
true class BCC            8          117  ...            5             1
true class BKL            8           14  ...            2             1
true class DF             1            5  ...            0             0
true class MEL            9           17  ...            5             1
true class NV             5           17  ...            1             4
true class SCC            2           16  ...            9             0
true class VASC           0            4  ...            0             3

[8 rows x 8 columns]

Current validation loss: 1.677

Epoch 156:
Mean loss 0.07227954566324488 - Correctly labeled training images 97.75%
Classified 65.62 % of validation images correctly.
Precision on validation set: [0.27 0.61 0.45 0.16 0.54 0.79 0.43 0.5 ]
Recall on validation set: [0.4  0.63 0.33 0.25 0.45 0.85 0.38 0.23]
F1-score on validation set: [0.32 0.62 0.38 0.19 0.49 0.82 0.4  0.32]
ROC AUC on validation set: {'AK': 0.72, 'BCC': 0.92, 'BKL': 0.58, 'DF': 0.78, 'MEL': 0.46, 'NV': 0.22, 'SCC': 0.8, 'VASC': 0.75}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            17           13  ...            1             0
true class BCC           14          106  ...            6             0
true class BKL           12           13  ...            1             1
true class DF             0            4  ...            0             0
true class MEL           12           10  ...            6             0
true class NV             6           13  ...            2             2
true class SCC            3           12  ...           12             0
true class VASC           0            4  ...            0             3

[8 rows x 8 columns]

Current validation loss: 1.760

Epoch 157:
Mean loss 0.06375307471756544 - Correctly labeled training images 98.01%
Classified 63.96 % of validation images correctly.
Precision on validation set: [0.29 0.62 0.44 0.36 0.45 0.83 0.39 0.5 ]
Recall on validation set: [0.37 0.63 0.41 0.33 0.56 0.76 0.38 0.23]
F1-score on validation set: [0.32 0.63 0.43 0.35 0.5  0.79 0.38 0.32]
ROC AUC on validation set: {'AK': 0.68, 'BCC': 0.93, 'BKL': 0.53, 'DF': 0.75, 'MEL': 0.42, 'NV': 0.27, 'SCC': 0.82, 'VASC': 0.78}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            16           10  ...            1             0
true class BCC           15          106  ...            9             0
true class BKL            9           11  ...            0             0
true class DF             0            2  ...            1             0
true class MEL            8           10  ...            6             0
true class NV             5           14  ...            2             3
true class SCC            3           12  ...           12             0
true class VASC           0            5  ...            0             3

[8 rows x 8 columns]

Current validation loss: 1.761

Epoch 158:
Mean loss 0.06733050482433542 - Correctly labeled training images 97.86%
Classified 67.19 % of validation images correctly.
Precision on validation set: [0.37 0.59 0.4  0.36 0.6  0.79 0.5  0.57]
Recall on validation set: [0.4  0.7  0.42 0.33 0.37 0.87 0.34 0.31]
F1-score on validation set: [0.38 0.64 0.41 0.35 0.46 0.83 0.41 0.4 ]
ROC AUC on validation set: {'AK': 0.71, 'BCC': 0.93, 'BKL': 0.56, 'DF': 0.79, 'MEL': 0.47, 'NV': 0.22, 'SCC': 0.82, 'VASC': 0.77}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            17           10  ...            1             0
true class BCC            8          117  ...            4             0
true class BKL            8           15  ...            0             1
true class DF             0            4  ...            0             0
true class MEL            5           14  ...            6             1
true class NV             5           18  ...            0             1
true class SCC            3           14  ...           11             0
true class VASC           0            5  ...            0             4

[8 rows x 8 columns]

Current validation loss: 1.775

Epoch 159:
Mean loss 0.07127452618001787 - Correctly labeled training images 97.73%
Classified 66.40 % of validation images correctly.
Precision on validation set: [0.35 0.61 0.42 0.27 0.58 0.76 0.44 0.71]
Recall on validation set: [0.42 0.61 0.43 0.25 0.32 0.9  0.25 0.38]
F1-score on validation set: [0.38 0.61 0.43 0.26 0.42 0.82 0.32 0.5 ]
ROC AUC on validation set: {'AK': 0.74, 'BCC': 0.92, 'BKL': 0.58, 'DF': 0.78, 'MEL': 0.48, 'NV': 0.2, 'SCC': 0.86, 'VASC': 0.76}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            18           12  ...            1             0
true class BCC           10          102  ...            4             0
true class BKL            5           11  ...            1             1
true class DF             1            3  ...            0             0
true class MEL            7           11  ...            4             0
true class NV             7           12  ...            0             1
true class SCC            4           12  ...            8             0
true class VASC           0            4  ...            0             5

[8 rows x 8 columns]

Current validation loss: 1.845

Epoch 160:
Mean loss 0.0648883938501451 - Correctly labeled training images 97.98%
Classified 66.72 % of validation images correctly.
Precision on validation set: [0.32 0.63 0.51 0.23 0.54 0.79 0.28 0.56]
Recall on validation set: [0.49 0.63 0.39 0.25 0.4  0.87 0.31 0.38]
F1-score on validation set: [0.39 0.63 0.44 0.24 0.46 0.83 0.29 0.45]
ROC AUC on validation set: {'AK': 0.71, 'BCC': 0.92, 'BKL': 0.58, 'DF': 0.76, 'MEL': 0.47, 'NV': 0.21, 'SCC': 0.81, 'VASC': 0.78}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            21            9  ...            1             0
true class BCC           11          106  ...           12             0
true class BKL           10           10  ...            2             1
true class DF             1            3  ...            0             0
true class MEL           10           14  ...            8             1
true class NV            10           12  ...            3             2
true class SCC            3           10  ...           10             0
true class VASC           0            4  ...            0             5

[8 rows x 8 columns]

Current validation loss: 1.750

Epoch 161:
Mean loss 0.06784798282717151 - Correctly labeled training images 97.89%
Classified 65.14 % of validation images correctly.
Precision on validation set: [0.4  0.64 0.46 0.14 0.47 0.82 0.31 0.5 ]
Recall on validation set: [0.4  0.63 0.36 0.17 0.55 0.8  0.41 0.23]
F1-score on validation set: [0.4  0.64 0.4  0.15 0.51 0.81 0.35 0.32]
ROC AUC on validation set: {'AK': 0.7, 'BCC': 0.93, 'BKL': 0.57, 'DF': 0.79, 'MEL': 0.45, 'NV': 0.23, 'SCC': 0.82, 'VASC': 0.78}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            17           10  ...            1             0
true class BCC            7          105  ...           13             0
true class BKL            7           10  ...            3             0
true class DF             0            3  ...            2             0
true class MEL            5           10  ...            8             0
true class NV             6            8  ...            2             3
true class SCC            1           13  ...           13             0
true class VASC           0            4  ...            0             3

[8 rows x 8 columns]

Current validation loss: 1.748

Epoch 162:
Mean loss 0.05913249167644166 - Correctly labeled training images 98.26%
Classified 67.98 % of validation images correctly.
Precision on validation set: [0.29 0.66 0.45 0.25 0.54 0.83 0.39 0.71]
Recall on validation set: [0.42 0.68 0.4  0.17 0.5  0.85 0.34 0.38]
F1-score on validation set: [0.34 0.67 0.42 0.2  0.52 0.84 0.37 0.5 ]
ROC AUC on validation set: {'AK': 0.72, 'BCC': 0.93, 'BKL': 0.58, 'DF': 0.78, 'MEL': 0.47, 'NV': 0.21, 'SCC': 0.82, 'VASC': 0.79}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            18            8  ...            1             0
true class BCC           14          113  ...            7             0
true class BKL            9           12  ...            1             1
true class DF             2            3  ...            0             0
true class MEL           10            9  ...            8             0
true class NV             6           12  ...            0             1
true class SCC            3           11  ...           11             0
true class VASC           0            4  ...            0             5

[8 rows x 8 columns]

Current validation loss: 1.679

Epoch 163:
Mean loss 0.05437414716210874 - Correctly labeled training images 98.36%
Classified 64.91 % of validation images correctly.
Precision on validation set: [0.37 0.61 0.41 0.25 0.47 0.8  0.42 0.71]
Recall on validation set: [0.4  0.64 0.29 0.33 0.54 0.81 0.34 0.38]
F1-score on validation set: [0.38 0.62 0.34 0.29 0.5  0.8  0.38 0.5 ]
ROC AUC on validation set: {'AK': 0.73, 'BCC': 0.92, 'BKL': 0.57, 'DF': 0.78, 'MEL': 0.43, 'NV': 0.24, 'SCC': 0.84, 'VASC': 0.75}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            17            9  ...            2             0
true class BCC            6          107  ...            7             0
true class BKL            9           13  ...            1             0
true class DF             0            4  ...            0             0
true class MEL           11           11  ...            4             0
true class NV             2           13  ...            1             2
true class SCC            1           16  ...           11             0
true class VASC           0            3  ...            0             5

[8 rows x 8 columns]

Current validation loss: 1.876

Epoch 164:
Mean loss 0.05313098980888742 - Correctly labeled training images 98.34%
Classified 66.80 % of validation images correctly.
Precision on validation set: [0.33 0.54 0.47 0.13 0.59 0.79 0.33 0.83]
Recall on validation set: [0.37 0.68 0.34 0.17 0.41 0.88 0.28 0.38]
F1-score on validation set: [0.35 0.6  0.39 0.15 0.48 0.83 0.31 0.53]
ROC AUC on validation set: {'AK': 0.73, 'BCC': 0.92, 'BKL': 0.6, 'DF': 0.77, 'MEL': 0.49, 'NV': 0.2, 'SCC': 0.82, 'VASC': 0.77}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            16           15  ...            2             0
true class BCC            9          113  ...            7             0
true class BKL            9           20  ...            2             0
true class DF             0            7  ...            0             0
true class MEL            9           15  ...            5             0
true class NV             5           18  ...            2             1
true class SCC            1           16  ...            9             0
true class VASC           0            4  ...            0             5

[8 rows x 8 columns]

Current validation loss: 1.852

Epoch 165:
Mean loss 0.05369285023139572 - Correctly labeled training images 98.32%
Classified 67.59 % of validation images correctly.
Precision on validation set: [0.36 0.61 0.44 0.2  0.57 0.79 0.37 0.86]
Recall on validation set: [0.33 0.69 0.4  0.25 0.4  0.88 0.22 0.46]
F1-score on validation set: [0.34 0.65 0.42 0.22 0.47 0.83 0.27 0.6 ]
ROC AUC on validation set: {'AK': 0.73, 'BCC': 0.92, 'BKL': 0.58, 'DF': 0.78, 'MEL': 0.48, 'NV': 0.21, 'SCC': 0.84, 'VASC': 0.73}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            14           12  ...            0             0
true class BCC            5          116  ...            3             0
true class BKL            9           12  ...            0             0
true class DF             0            6  ...            0             0
true class MEL            8            8  ...            7             0
true class NV             2           16  ...            2             1
true class SCC            1           16  ...            7             0
true class VASC           0            3  ...            0             6

[8 rows x 8 columns]

Current validation loss: 1.822

Epoch 166:
Mean loss 0.04825842278871439 - Correctly labeled training images 98.52%
Classified 66.80 % of validation images correctly.
Precision on validation set: [0.38 0.55 0.42 0.18 0.55 0.81 0.47 0.6 ]
Recall on validation set: [0.33 0.71 0.35 0.17 0.44 0.85 0.47 0.23]
F1-score on validation set: [0.35 0.62 0.38 0.17 0.49 0.83 0.47 0.33]
ROC AUC on validation set: {'AK': 0.72, 'BCC': 0.92, 'BKL': 0.57, 'DF': 0.76, 'MEL': 0.47, 'NV': 0.22, 'SCC': 0.81, 'VASC': 0.73}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            14           14  ...            1             0
true class BCC            7          119  ...            6             1
true class BKL            7           19  ...            2             0
true class DF             1            5  ...            0             0
true class MEL            6           18  ...            7             0
true class NV             2           21  ...            1             1
true class SCC            0           14  ...           15             0
true class VASC           0            5  ...            0             3

[8 rows x 8 columns]

Current validation loss: 1.754

Epoch 167:
Mean loss 0.05490924395460706 - Correctly labeled training images 98.39%
Classified 65.69 % of validation images correctly.
Precision on validation set: [0.35 0.61 0.43 0.16 0.49 0.82 0.32 0.67]
Recall on validation set: [0.28 0.63 0.3  0.25 0.55 0.82 0.41 0.46]
F1-score on validation set: [0.31 0.62 0.35 0.19 0.52 0.82 0.36 0.55]
ROC AUC on validation set: {'AK': 0.72, 'BCC': 0.92, 'BKL': 0.59, 'DF': 0.76, 'MEL': 0.47, 'NV': 0.21, 'SCC': 0.8, 'VASC': 0.75}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            12           11  ...            3             0
true class BCC            5          105  ...           11             1
true class BKL            7           17  ...            4             1
true class DF             0            2  ...            2             0
true class MEL            4           10  ...            7             0
true class NV             5           11  ...            1             1
true class SCC            1           12  ...           13             0
true class VASC           0            3  ...            0             6

[8 rows x 8 columns]

Current validation loss: 1.817

Epoch 168:
Mean loss 0.053511140320695386 - Correctly labeled training images 98.40%
Classified 67.27 % of validation images correctly.
Precision on validation set: [0.29 0.59 0.43 0.13 0.63 0.79 0.4  0.71]
Recall on validation set: [0.42 0.66 0.38 0.17 0.37 0.89 0.31 0.38]
F1-score on validation set: [0.34 0.63 0.4  0.15 0.47 0.84 0.35 0.5 ]
ROC AUC on validation set: {'AK': 0.69, 'BCC': 0.92, 'BKL': 0.56, 'DF': 0.77, 'MEL': 0.48, 'NV': 0.22, 'SCC': 0.81, 'VASC': 0.74}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            18           14  ...            0             0
true class BCC           14          111  ...            6             0
true class BKL           12           12  ...            3             0
true class DF             1            4  ...            0             0
true class MEL            8           11  ...            6             1
true class NV             6           18  ...            0             1
true class SCC            3           14  ...           10             0
true class VASC           0            4  ...            0             5

/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
[8 rows x 8 columns]

Current validation loss: 1.830

Epoch 169:
Mean loss 0.05405500111550574 - Correctly labeled training images 98.41%
Classified 67.27 % of validation images correctly.
Precision on validation set: [0.32 0.61 0.48 0.57 0.56 0.79 0.35 0.62]
Recall on validation set: [0.42 0.69 0.34 0.33 0.44 0.87 0.25 0.38]
F1-score on validation set: [0.36 0.64 0.4  0.42 0.49 0.82 0.29 0.48]
ROC AUC on validation set: {'AK': 0.71, 'BCC': 0.92, 'BKL': 0.58, 'DF': 0.78, 'MEL': 0.48, 'NV': 0.21, 'SCC': 0.8, 'VASC': 0.77}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            18           10  ...            1             0
true class BCC           11          115  ...            5             0
true class BKL           10           11  ...            2             0
true class DF             0            3  ...            1             0
true class MEL            7           16  ...            6             0
true class NV             6           17  ...            0             3
true class SCC            4           13  ...            8             0
true class VASC           0            5  ...            0             5

[8 rows x 8 columns]

Current validation loss: 1.856

Epoch 170:
Mean loss 0.048526375624094134 - Correctly labeled training images 98.52%
Classified 66.32 % of validation images correctly.
Precision on validation set: [0.33 0.58 0.41 0.18 0.58 0.79 0.29 0.57]
Recall on validation set: [0.26 0.71 0.37 0.25 0.42 0.86 0.19 0.31]
F1-score on validation set: [0.29 0.63 0.39 0.21 0.49 0.82 0.23 0.4 ]
ROC AUC on validation set: {'AK': 0.73, 'BCC': 0.92, 'BKL': 0.58, 'DF': 0.79, 'MEL': 0.48, 'NV': 0.21, 'SCC': 0.84, 'VASC': 0.74}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            11           18  ...            0             0
true class BCC            5          118  ...            7             0
true class BKL            6           15  ...            0             0
true class DF             0            5  ...            0             0
true class MEL            4           12  ...            7             0
true class NV             5           17  ...            1             3
true class SCC            2           16  ...            6             0
true class VASC           0            4  ...            0             4

[8 rows x 8 columns]

Current validation loss: 1.865

Epoch 171:
Mean loss 0.04935390761367057 - Correctly labeled training images 98.58%
Classified 64.04 % of validation images correctly.
Precision on validation set: [0.24 0.58 0.43 0.21 0.51 0.84 0.28 0.56]
Recall on validation set: [0.28 0.62 0.46 0.25 0.54 0.77 0.41 0.38]
F1-score on validation set: [0.26 0.6  0.44 0.23 0.52 0.8  0.33 0.45]
ROC AUC on validation set: {'AK': 0.69, 'BCC': 0.9, 'BKL': 0.53, 'DF': 0.76, 'MEL': 0.43, 'NV': 0.27, 'SCC': 0.77, 'VASC': 0.75}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            12           10  ...            4             0
true class BCC           10          104  ...           12             0
true class BKL            9           14  ...            4             0
true class DF             0            5  ...            1             0
true class MEL            9           13  ...           10             0
true class NV             7           20  ...            3             4
true class SCC            3           10  ...           13             0
true class VASC           0            4  ...            0             5

[8 rows x 8 columns]

Current validation loss: 1.877

Epoch 172:
Mean loss 0.05253558972507439 - Correctly labeled training images 98.43%
Classified 66.72 % of validation images correctly.
Precision on validation set: [0.3  0.57 0.53 0.22 0.53 0.77 0.39 0.5 ]
Recall on validation set: [0.26 0.69 0.31 0.17 0.42 0.89 0.22 0.23]
F1-score on validation set: [0.28 0.63 0.39 0.19 0.47 0.83 0.28 0.32]
ROC AUC on validation set: {'AK': 0.73, 'BCC': 0.92, 'BKL': 0.59, 'DF': 0.78, 'MEL': 0.49, 'NV': 0.2, 'SCC': 0.83, 'VASC': 0.76}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            11           16  ...            0             0
true class BCC            9          115  ...            5             0
true class BKL            7           14  ...            0             0
true class DF             0            5  ...            0             0
true class MEL            4           16  ...            5             0
true class NV             4           14  ...            1             3
true class SCC            2           15  ...            7             0
true class VASC           0            5  ...            0             3

[8 rows x 8 columns]

Current validation loss: 1.838

Epoch 173:
Mean loss 0.05605500021968507 - Correctly labeled training images 98.25%
Classified 66.64 % of validation images correctly.
Precision on validation set: [0.25 0.56 0.48 0.13 0.59 0.8  0.36 0.5 ]
Recall on validation set: [0.37 0.73 0.34 0.17 0.38 0.87 0.25 0.38]
F1-score on validation set: [0.3  0.63 0.39 0.15 0.46 0.84 0.3  0.43]
ROC AUC on validation set: {'AK': 0.71, 'BCC': 0.92, 'BKL': 0.57, 'DF': 0.77, 'MEL': 0.49, 'NV': 0.21, 'SCC': 0.81, 'VASC': 0.74}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            16           15  ...            0             0
true class BCC           11          122  ...            5             0
true class BKL           14           15  ...            1             0
true class DF             0            5  ...            0             0
true class MEL           12           22  ...            6             0
true class NV             5           20  ...            2             5
true class SCC            5           15  ...            8             0
true class VASC           0            4  ...            0             5

[8 rows x 8 columns]

Current validation loss: 1.870

Epoch 174:
Mean loss 0.05156911015808024 - Correctly labeled training images 98.46%
Classified 64.27 % of validation images correctly.
Precision on validation set: [0.28 0.7  0.35 0.12 0.5  0.83 0.4  0.67]
Recall on validation set: [0.42 0.6  0.48 0.08 0.53 0.77 0.31 0.31]
F1-score on validation set: [0.34 0.65 0.41 0.1  0.51 0.8  0.35 0.42]
ROC AUC on validation set: {'AK': 0.69, 'BCC': 0.92, 'BKL': 0.54, 'DF': 0.77, 'MEL': 0.44, 'NV': 0.25, 'SCC': 0.78, 'VASC': 0.78}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            18            5  ...            1             0
true class BCC           16          101  ...            4             0
true class BKL            9            8  ...            1             0
true class DF             1            3  ...            1             0
true class MEL            6            6  ...            7             0
true class NV             8           10  ...            1             2
true class SCC            6            7  ...           10             0
true class VASC           0            4  ...            0             4

[8 rows x 8 columns]

Current validation loss: 1.953

Epoch 175:
Mean loss 0.05271331372866201 - Correctly labeled training images 98.35%
Classified 66.09 % of validation images correctly.
Precision on validation set: [0.38 0.58 0.43 0.25 0.5  0.81 0.41 0.75]
Recall on validation set: [0.3  0.71 0.4  0.33 0.45 0.82 0.34 0.46]
F1-score on validation set: [0.34 0.64 0.41 0.29 0.48 0.82 0.37 0.57]
ROC AUC on validation set: {'AK': 0.73, 'BCC': 0.92, 'BKL': 0.57, 'DF': 0.81, 'MEL': 0.48, 'NV': 0.21, 'SCC': 0.82, 'VASC': 0.73}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            13           16  ...            1             0
true class BCC            7          119  ...            5             0
true class BKL            6           16  ...            2             0
true class DF             0            5  ...            0             0
true class MEL            7           16  ...            7             0
true class NV             1           15  ...            1             2
true class SCC            0           16  ...           11             0
true class VASC           0            3  ...            0             6

/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
[8 rows x 8 columns]

Current validation loss: 1.805

Epoch 176:
Mean loss 0.049272432926989365 - Correctly labeled training images 98.43%
Classified 65.54 % of validation images correctly.
Precision on validation set: [0.33 0.56 0.45 0.33 0.49 0.82 0.36 0.5 ]
Recall on validation set: [0.23 0.74 0.42 0.33 0.47 0.81 0.28 0.23]
F1-score on validation set: [0.27 0.64 0.43 0.33 0.48 0.81 0.32 0.32]
ROC AUC on validation set: {'AK': 0.71, 'BCC': 0.92, 'BKL': 0.55, 'DF': 0.78, 'MEL': 0.47, 'NV': 0.23, 'SCC': 0.79, 'VASC': 0.75}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            10           15  ...            2             0
true class BCC            5          123  ...            6             0
true class BKL            5           16  ...            0             0
true class DF             0            5  ...            0             0
true class MEL            3           21  ...            7             0
true class NV             5           21  ...            0             3
true class SCC            2           14  ...            9             0
true class VASC           0            5  ...            1             3

[8 rows x 8 columns]

Current validation loss: 1.804

Epoch 177:
Mean loss 0.049435421736501096 - Correctly labeled training images 98.48%
Classified 66.56 % of validation images correctly.
Precision on validation set: [0.34 0.7  0.45 0.21 0.54 0.74 0.4  0.83]
Recall on validation set: [0.37 0.59 0.31 0.25 0.38 0.91 0.19 0.38]
F1-score on validation set: [0.36 0.64 0.37 0.23 0.45 0.82 0.26 0.53]
ROC AUC on validation set: {'AK': 0.75, 'BCC': 0.93, 'BKL': 0.62, 'DF': 0.8, 'MEL': 0.48, 'NV': 0.19, 'SCC': 0.81, 'VASC': 0.75}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            16            5  ...            0             0
true class BCC           10           99  ...            6             0
true class BKL            8           10  ...            0             0
true class DF             0            3  ...            0             0
true class MEL            5            7  ...            3             0
true class NV             4            8  ...            0             1
true class SCC            4            8  ...            6             0
true class VASC           0            2  ...            0             5

[8 rows x 8 columns]

Current validation loss: 1.975

Epoch 178:
Mean loss 0.04590621400741664 - Correctly labeled training images 98.72%
Classified 66.80 % of validation images correctly.
Precision on validation set: [0.31 0.59 0.46 0.22 0.5  0.85 0.38 0.75]
Recall on validation set: [0.4  0.74 0.35 0.17 0.56 0.8  0.28 0.46]
F1-score on validation set: [0.35 0.66 0.4  0.19 0.52 0.83 0.32 0.57]
ROC AUC on validation set: {'AK': 0.69, 'BCC': 0.92, 'BKL': 0.56, 'DF': 0.76, 'MEL': 0.44, 'NV': 0.25, 'SCC': 0.79, 'VASC': 0.77}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            17           13  ...            0             0
true class BCC            7          123  ...            5             0
true class BKL           12           15  ...            1             0
true class DF             2            5  ...            0             0
true class MEL            6           16  ...            8             0
true class NV             7           18  ...            1             2
true class SCC            4           13  ...            9             0
true class VASC           0            5  ...            0             6

[8 rows x 8 columns]

Current validation loss: 1.790

Epoch 179:
Mean loss 0.04728900353644228 - Correctly labeled training images 98.52%
Classified 66.72 % of validation images correctly.
Precision on validation set: [0.31 0.69 0.4  0.28 0.53 0.83 0.32 0.8 ]
Recall on validation set: [0.4  0.63 0.46 0.42 0.54 0.81 0.28 0.31]
F1-score on validation set: [0.35 0.66 0.43 0.33 0.54 0.82 0.3  0.44]
ROC AUC on validation set: {'AK': 0.69, 'BCC': 0.92, 'BKL': 0.56, 'DF': 0.79, 'MEL': 0.43, 'NV': 0.25, 'SCC': 0.8, 'VASC': 0.79}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            17            6  ...            1             0
true class BCC           12          105  ...            8             0
true class BKL            9            7  ...            2             0
true class DF             0            2  ...            1             0
true class MEL            7            8  ...            6             0
true class NV             5            9  ...            1             1
true class SCC            3           11  ...            9             0
true class VASC           1            4  ...            0             4

[8 rows x 8 columns]

Current validation loss: 1.847

Epoch 180:
Mean loss 0.05079209559117091 - Correctly labeled training images 98.43%
Classified 65.62 % of validation images correctly.
Precision on validation set: [0.33 0.6  0.4  0.29 0.51 0.83 0.32 0.57]
Recall on validation set: [0.35 0.65 0.4  0.33 0.5  0.81 0.41 0.31]
F1-score on validation set: [0.34 0.62 0.4  0.31 0.51 0.82 0.36 0.4 ]
ROC AUC on validation set: {'AK': 0.67, 'BCC': 0.91, 'BKL': 0.54, 'DF': 0.76, 'MEL': 0.42, 'NV': 0.28, 'SCC': 0.77, 'VASC': 0.74}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            15            8  ...            4             0
true class BCC            7          109  ...           11             0
true class BKL            8           15  ...            3             0
true class DF             1            3  ...            1             0
true class MEL            7           14  ...            8             0
true class NV             7           16  ...            1             3
true class SCC            1           12  ...           13             0
true class VASC           0            5  ...            0             4

[8 rows x 8 columns]

Current validation loss: 1.872

Epoch 181:
Mean loss 0.04907662453782107 - Correctly labeled training images 98.48%
Classified 67.03 % of validation images correctly.
Precision on validation set: [0.33 0.64 0.44 0.36 0.57 0.78 0.34 0.8 ]
Recall on validation set: [0.42 0.59 0.4  0.33 0.41 0.88 0.34 0.31]
F1-score on validation set: [0.37 0.61 0.42 0.35 0.48 0.83 0.34 0.44]
ROC AUC on validation set: {'AK': 0.69, 'BCC': 0.93, 'BKL': 0.57, 'DF': 0.77, 'MEL': 0.48, 'NV': 0.21, 'SCC': 0.79, 'VASC': 0.78}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            18            5  ...            2             0
true class BCC           13           99  ...           11             0
true class BKL            9           10  ...            2             0
true class DF             1            2  ...            1             0
true class MEL            5           12  ...            5             0
true class NV             6           13  ...            0             1
true class SCC            3            9  ...           11             0
true class VASC           0            5  ...            0             4

[8 rows x 8 columns]

Current validation loss: 1.840

Epoch 182:
Mean loss 0.041877085938116926 - Correctly labeled training images 98.82%
Classified 65.54 % of validation images correctly.
Precision on validation set: [0.25 0.59 0.42 0.14 0.54 0.83 0.42 0.57]
Recall on validation set: [0.33 0.65 0.41 0.25 0.5  0.82 0.31 0.31]
F1-score on validation set: [0.28 0.62 0.41 0.18 0.51 0.82 0.36 0.4 ]
ROC AUC on validation set: {'AK': 0.7, 'BCC': 0.92, 'BKL': 0.56, 'DF': 0.79, 'MEL': 0.47, 'NV': 0.22, 'SCC': 0.8, 'VASC': 0.73}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            14           11  ...            0             0
true class BCC           14          109  ...            3             0
true class BKL            9           13  ...            4             0
true class DF             1            3  ...            1             0
true class MEL            8           16  ...            6             0
true class NV             6           16  ...            0             3
true class SCC            4           12  ...           10             0
true class VASC           0            5  ...            0             4

[8 rows x 8 columns]

Current validation loss: 1.828

Epoch 183:
Mean loss 0.042235745812071436 - Correctly labeled training images 98.77%
Classified 67.35 % of validation images correctly.
Precision on validation set: [0.29 0.6  0.43 0.22 0.61 0.79 0.41 0.6 ]
Recall on validation set: [0.4  0.62 0.39 0.17 0.46 0.88 0.28 0.23]
F1-score on validation set: [0.34 0.61 0.41 0.19 0.52 0.83 0.33 0.33]
ROC AUC on validation set: {'AK': 0.71, 'BCC': 0.92, 'BKL': 0.58, 'DF': 0.8, 'MEL': 0.48, 'NV': 0.21, 'SCC': 0.81, 'VASC': 0.75}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            17            9  ...            0             0
true class BCC           17          103  ...            8             0
true class BKL           10           13  ...            0             0
true class DF             1            4  ...            0             0
true class MEL            7           12  ...            5             0
true class NV             4           12  ...            0             2
true class SCC            2           13  ...            9             0
true class VASC           0            5  ...            0             3

[8 rows x 8 columns]

Current validation loss: 1.822

Epoch 184:
Mean loss 0.03811678273740301 - Correctly labeled training images 98.85%
Classified 67.43 % of validation images correctly.
Precision on validation set: [0.28 0.6  0.46 0.24 0.59 0.82 0.36 0.62]
Recall on validation set: [0.44 0.65 0.44 0.33 0.42 0.86 0.38 0.38]
F1-score on validation set: [0.34 0.63 0.45 0.28 0.49 0.84 0.37 0.48]
ROC AUC on validation set: {'AK': 0.7, 'BCC': 0.92, 'BKL': 0.57, 'DF': 0.77, 'MEL': 0.48, 'NV': 0.22, 'SCC': 0.8, 'VASC': 0.76}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            19            9  ...            2             0
true class BCC           16          109  ...            7             0
true class BKL           11           16  ...            2             0
true class DF             1            3  ...            1             0
true class MEL           12           16  ...            9             1
true class NV             8           13  ...            0             2
true class SCC            2           11  ...           12             0
true class VASC           0            4  ...            0             5

[8 rows x 8 columns]

Current validation loss: 1.804

Epoch 185:
Mean loss 0.03493162427912466 - Correctly labeled training images 99.05%
Classified 66.48 % of validation images correctly.
Precision on validation set: [0.28 0.63 0.44 0.3  0.52 0.8  0.4  0.67]
Recall on validation set: [0.33 0.63 0.35 0.25 0.5  0.85 0.38 0.31]
F1-score on validation set: [0.3  0.63 0.39 0.27 0.51 0.82 0.39 0.42]
ROC AUC on validation set: {'AK': 0.7, 'BCC': 0.92, 'BKL': 0.56, 'DF': 0.77, 'MEL': 0.46, 'NV': 0.23, 'SCC': 0.81, 'VASC': 0.76}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            14            7  ...            2             0
true class BCC           12          106  ...            6             0
true class BKL            6           13  ...            2             0
true class DF             0            2  ...            1             0
true class MEL            9           12  ...            6             0
true class NV             7           14  ...            1             2
true class SCC            2           10  ...           12             0
true class VASC           0            4  ...            0             4

[8 rows x 8 columns]

Current validation loss: 1.857

Epoch 186:
Mean loss 0.03506692263920393 - Correctly labeled training images 99.07%
Classified 68.69 % of validation images correctly.
Precision on validation set: [0.56 0.58 0.49 0.29 0.59 0.79 0.39 0.62]
Recall on validation set: [0.23 0.73 0.34 0.17 0.47 0.89 0.34 0.38]
F1-score on validation set: [0.33 0.65 0.4  0.21 0.52 0.83 0.37 0.48]
ROC AUC on validation set: {'AK': 0.74, 'BCC': 0.92, 'BKL': 0.59, 'DF': 0.79, 'MEL': 0.48, 'NV': 0.2, 'SCC': 0.81, 'VASC': 0.74}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            10           16  ...            1             0
true class BCC            2          122  ...            5             0
true class BKL            2           19  ...            3             0
true class DF             0            5  ...            2             0
true class MEL            3           11  ...            5             0
true class NV             1           17  ...            1             3
true class SCC            0           16  ...           11             0
true class VASC           0            4  ...            0             5

[8 rows x 8 columns]

Current validation loss: 1.963

Epoch 187:
Mean loss 0.04040890425630575 - Correctly labeled training images 98.74%
Classified 66.48 % of validation images correctly.
Precision on validation set: [0.36 0.59 0.46 0.25 0.52 0.79 0.36 0.44]
Recall on validation set: [0.33 0.68 0.31 0.33 0.45 0.86 0.31 0.31]
F1-score on validation set: [0.34 0.63 0.37 0.29 0.48 0.83 0.33 0.36]
ROC AUC on validation set: {'AK': 0.71, 'BCC': 0.92, 'BKL': 0.57, 'DF': 0.72, 'MEL': 0.47, 'NV': 0.23, 'SCC': 0.82, 'VASC': 0.7}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            14           12  ...            2             0
true class BCC            7          113  ...            7             1
true class BKL            6           17  ...            2             0
true class DF             1            2  ...            0             0
true class MEL            4           21  ...            6             0
true class NV             4           11  ...            1             4
true class SCC            3           12  ...           10             0
true class VASC           0            3  ...            0             4

[8 rows x 8 columns]

Current validation loss: 1.853

Epoch 188:
Mean loss 0.04187977744378583 - Correctly labeled training images 98.61%
Classified 66.40 % of validation images correctly.
Precision on validation set: [0.35 0.61 0.41 0.22 0.51 0.8  0.38 0.57]
Recall on validation set: [0.3  0.69 0.32 0.17 0.46 0.86 0.31 0.31]
F1-score on validation set: [0.32 0.64 0.36 0.19 0.48 0.83 0.34 0.4 ]
ROC AUC on validation set: {'AK': 0.71, 'BCC': 0.92, 'BKL': 0.56, 'DF': 0.78, 'MEL': 0.46, 'NV': 0.23, 'SCC': 0.79, 'VASC': 0.72}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            13           12  ...            2             0
true class BCC            3          115  ...            5             0
true class BKL            8           17  ...            1             0
true class DF             0            4  ...            1             0
true class MEL            9           16  ...            5             1
true class NV             2           12  ...            2             2
true class SCC            2           11  ...           10             0
true class VASC           0            3  ...            0             4

[8 rows x 8 columns]

Current validation loss: 1.839

Epoch 189:
Mean loss 0.03181433628637517 - Correctly labeled training images 99.08%
Classified 67.27 % of validation images correctly.
Precision on validation set: [0.25 0.6  0.46 0.24 0.57 0.79 0.29 0.6 ]
Recall on validation set: [0.3  0.69 0.34 0.33 0.38 0.9  0.22 0.46]
F1-score on validation set: [0.28 0.65 0.39 0.28 0.46 0.84 0.25 0.52]
ROC AUC on validation set: {'AK': 0.72, 'BCC': 0.92, 'BKL': 0.59, 'DF': 0.77, 'MEL': 0.48, 'NV': 0.2, 'SCC': 0.83, 'VASC': 0.73}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            13           10  ...            1             0
true class BCC            9          116  ...            5             1
true class BKL           12           15  ...            2             0
true class DF             0            4  ...            0             0
true class MEL            9           21  ...            7             1
true class NV             4            9  ...            2             2
true class SCC            3           14  ...            7             0
true class VASC           1            3  ...            0             6

/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
[8 rows x 8 columns]

Current validation loss: 1.934

Epoch 190:
Mean loss 0.03638951810189209 - Correctly labeled training images 98.89%
Classified 64.91 % of validation images correctly.
Precision on validation set: [0.32 0.6  0.44 0.3  0.47 0.79 0.33 0.67]
Recall on validation set: [0.35 0.56 0.38 0.25 0.45 0.85 0.22 0.31]
F1-score on validation set: [0.33 0.58 0.41 0.27 0.46 0.82 0.26 0.42]
ROC AUC on validation set: {'AK': 0.67, 'BCC': 0.91, 'BKL': 0.55, 'DF': 0.77, 'MEL': 0.45, 'NV': 0.25, 'SCC': 0.82, 'VASC': 0.76}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            15            7  ...            1             0
true class BCC            9           94  ...            7             0
true class BKL            8           13  ...            0             0
true class DF             0            4  ...            0             0
true class MEL            8            8  ...            4             1
true class NV             4           14  ...            2             1
true class SCC            3           12  ...            7             0
true class VASC           0            4  ...            0             4

[8 rows x 8 columns]

Current validation loss: 1.920

Epoch 191:
Mean loss 0.032553456746963916 - Correctly labeled training images 99.02%
Classified 66.17 % of validation images correctly.
Precision on validation set: [0.31 0.66 0.38 0.57 0.56 0.79 0.36 0.8 ]
Recall on validation set: [0.35 0.62 0.47 0.33 0.43 0.84 0.28 0.31]
F1-score on validation set: [0.33 0.64 0.42 0.42 0.49 0.82 0.32 0.44]
ROC AUC on validation set: {'AK': 0.72, 'BCC': 0.93, 'BKL': 0.55, 'DF': 0.77, 'MEL': 0.47, 'NV': 0.22, 'SCC': 0.81, 'VASC': 0.75}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            15            8  ...            1             0
true class BCC           12          104  ...            8             0
true class BKL            8            9  ...            0             0
true class DF             0            3  ...            1             0
true class MEL            7           13  ...            3             0
true class NV             4            6  ...            3             1
true class SCC            2           10  ...            9             0
true class VASC           0            5  ...            0             4

[8 rows x 8 columns]

Current validation loss: 1.914

Epoch 192:
Mean loss 0.025716878310520178 - Correctly labeled training images 99.28%
Classified 66.72 % of validation images correctly.
Precision on validation set: [0.35 0.62 0.47 0.6  0.51 0.81 0.39 0.57]
Recall on validation set: [0.35 0.72 0.37 0.25 0.56 0.81 0.28 0.31]
F1-score on validation set: [0.35 0.67 0.42 0.35 0.53 0.81 0.33 0.4 ]
ROC AUC on validation set: {'AK': 0.7, 'BCC': 0.93, 'BKL': 0.57, 'DF': 0.77, 'MEL': 0.44, 'NV': 0.24, 'SCC': 0.84, 'VASC': 0.73}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            15           10  ...            1             0
true class BCC            6          121  ...            5             0
true class BKL            7           14  ...            3             0
true class DF             1            4  ...            0             0
true class MEL            7           15  ...            4             1
true class NV             4           14  ...            1             2
true class SCC            3           14  ...            9             0
true class VASC           0            4  ...            0             4

[8 rows x 8 columns]

Current validation loss: 1.916

Epoch 193:
Mean loss 0.03301732909269095 - Correctly labeled training images 99.07%
Classified 67.27 % of validation images correctly.
Precision on validation set: [0.34 0.6  0.43 0.38 0.58 0.8  0.28 0.75]
Recall on validation set: [0.4  0.7  0.37 0.42 0.42 0.87 0.25 0.46]
F1-score on validation set: [0.37 0.65 0.4  0.4  0.48 0.83 0.26 0.57]
ROC AUC on validation set: {'AK': 0.7, 'BCC': 0.92, 'BKL': 0.57, 'DF': 0.77, 'MEL': 0.47, 'NV': 0.23, 'SCC': 0.81, 'VASC': 0.71}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            17           10  ...            3             0
true class BCC            7          117  ...            8             0
true class BKL            9           15  ...            3             0
true class DF             1            2  ...            1             0
true class MEL            9           15  ...            5             0
true class NV             7           16  ...            1             2
true class SCC            0           16  ...            8             0
true class VASC           0            3  ...            0             6

[8 rows x 8 columns]

Current validation loss: 1.919

Epoch 194:
Mean loss 0.03192587605731162 - Correctly labeled training images 99.08%
Classified 66.96 % of validation images correctly.
Precision on validation set: [0.28 0.61 0.5  0.23 0.51 0.81 0.46 0.88]
Recall on validation set: [0.33 0.69 0.4  0.25 0.49 0.83 0.38 0.54]
F1-score on validation set: [0.3  0.65 0.45 0.24 0.5  0.82 0.41 0.67]
ROC AUC on validation set: {'AK': 0.68, 'BCC': 0.92, 'BKL': 0.57, 'DF': 0.75, 'MEL': 0.47, 'NV': 0.23, 'SCC': 0.82, 'VASC': 0.67}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            14           10  ...            1             0
true class BCC           10          116  ...            5             0
true class BKL           10           14  ...            1             0
true class DF             1            4  ...            1             0
true class MEL           12           13  ...            5             0
true class NV             2           17  ...            1             1
true class SCC            1           14  ...           12             0
true class VASC           0            1  ...            0             7

[8 rows x 8 columns]

Current validation loss: 1.851

Epoch 195:
Mean loss 0.033052596515744166 - Correctly labeled training images 99.09%
Classified 66.32 % of validation images correctly.
Precision on validation set: [0.25 0.65 0.46 0.21 0.54 0.79 0.36 0.83]
Recall on validation set: [0.37 0.62 0.37 0.25 0.43 0.87 0.31 0.38]
F1-score on validation set: [0.3  0.63 0.41 0.23 0.48 0.82 0.33 0.53]
ROC AUC on validation set: {'AK': 0.67, 'BCC': 0.93, 'BKL': 0.57, 'DF': 0.76, 'MEL': 0.49, 'NV': 0.22, 'SCC': 0.8, 'VASC': 0.74}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            16            9  ...            0             0
true class BCC           14          104  ...            7             0
true class BKL           11           11  ...            0             0
true class DF             1            4  ...            1             0
true class MEL           10            8  ...            8             0
true class NV             8           10  ...            2             1
true class SCC            4           11  ...           10             0
true class VASC           0            4  ...            0             5

[8 rows x 8 columns]

Current validation loss: 1.797

Epoch 196:
Mean loss 0.039827875431890716 - Correctly labeled training images 98.88%
Classified 65.85 % of validation images correctly.
Precision on validation set: [0.29 0.58 0.43 0.11 0.53 0.84 0.39 0.64]
Recall on validation set: [0.35 0.65 0.43 0.17 0.52 0.8  0.41 0.54]
F1-score on validation set: [0.32 0.62 0.43 0.13 0.52 0.82 0.4  0.58]
ROC AUC on validation set: {'AK': 0.67, 'BCC': 0.92, 'BKL': 0.58, 'DF': 0.78, 'MEL': 0.46, 'NV': 0.23, 'SCC': 0.8, 'VASC': 0.72}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            15           11  ...            1             0
true class BCC            9          109  ...            8             0
true class BKL            8           16  ...            3             0
true class DF             3            3  ...            1             0
true class MEL           10           13  ...            5             1
true class NV             6           20  ...            2             3
true class SCC            1           13  ...           13             0
true class VASC           0            2  ...            0             7

[8 rows x 8 columns]

Current validation loss: 1.836

Epoch 197:
Mean loss 0.03321805354991813 - Correctly labeled training images 99.01%
Classified 66.40 % of validation images correctly.
Precision on validation set: [0.39 0.63 0.42 0.33 0.5  0.8  0.38 0.55]
Recall on validation set: [0.37 0.64 0.29 0.25 0.55 0.83 0.34 0.46]
F1-score on validation set: [0.38 0.63 0.34 0.29 0.52 0.82 0.36 0.5 ]
ROC AUC on validation set: {'AK': 0.72, 'BCC': 0.92, 'BKL': 0.59, 'DF': 0.77, 'MEL': 0.46, 'NV': 0.21, 'SCC': 0.81, 'VASC': 0.78}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            16            9  ...            0             0
true class BCC            7          107  ...            5             1
true class BKL            6           15  ...            3             0
true class DF             0            3  ...            0             0
true class MEL            7            9  ...            9             1
true class NV             5           12  ...            1             3
true class SCC            0           12  ...           11             0
true class VASC           0            4  ...            0             6

[8 rows x 8 columns]

Current validation loss: 1.853

Epoch 198:
Mean loss 0.036774157623351664 - Correctly labeled training images 98.88%
Classified 67.59 % of validation images correctly.
Precision on validation set: [0.43 0.63 0.45 0.29 0.52 0.81 0.42 0.7 ]
Recall on validation set: [0.3  0.65 0.39 0.33 0.51 0.85 0.41 0.54]
F1-score on validation set: [0.36 0.64 0.42 0.31 0.51 0.83 0.41 0.61]
ROC AUC on validation set: {'AK': 0.72, 'BCC': 0.93, 'BKL': 0.56, 'DF': 0.75, 'MEL': 0.45, 'NV': 0.23, 'SCC': 0.82, 'VASC': 0.77}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            13           10  ...            1             0
true class BCC            5          108  ...            6             0
true class BKL            2           15  ...            3             0
true class DF             1            2  ...            1             0
true class MEL            3           12  ...            7             1
true class NV             6           10  ...            0             2
true class SCC            0           12  ...           13             0
true class VASC           0            2  ...            0             7

[8 rows x 8 columns]

Current validation loss: 1.777

Epoch 199:
Mean loss 0.03503527743468276 - Correctly labeled training images 98.95%
Classified 67.19 % of validation images correctly.
Precision on validation set: [0.29 0.65 0.4  0.43 0.6  0.78 0.46 0.67]
Recall on validation set: [0.33 0.7  0.41 0.25 0.37 0.88 0.38 0.31]
F1-score on validation set: [0.3  0.68 0.41 0.32 0.45 0.82 0.41 0.42]
ROC AUC on validation set: {'AK': 0.7, 'BCC': 0.93, 'BKL': 0.58, 'DF': 0.77, 'MEL': 0.5, 'NV': 0.2, 'SCC': 0.82, 'VASC': 0.78}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            14            7  ...            1             0
true class BCC            7          117  ...            5             0
true class BKL            8           11  ...            2             0
true class DF             1            3  ...            1             0
true class MEL           11           12  ...            4             0
true class NV             6           13  ...            1             2
true class SCC            2           11  ...           12             0
true class VASC           0            5  ...            0             4

[8 rows x 8 columns]

Current validation loss: 1.892

Epoch 200:
Mean loss 0.02648411163165453 - Correctly labeled training images 99.23%
Classified 67.11 % of validation images correctly.
Precision on validation set: [0.33 0.62 0.43 0.3  0.53 0.79 0.42 0.64]
Recall on validation set: [0.33 0.69 0.34 0.25 0.45 0.86 0.31 0.54]
F1-score on validation set: [0.33 0.65 0.38 0.27 0.49 0.83 0.36 0.58]
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
ROC AUC on validation set: {'AK': 0.73, 'BCC': 0.93, 'BKL': 0.6, 'DF': 0.76, 'MEL': 0.48, 'NV': 0.2, 'SCC': 0.84, 'VASC': 0.75}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            14           11  ...            3             0
true class BCC            5          115  ...            4             0
true class BKL            7           16  ...            1             0
true class DF             1            2  ...            1             0
true class MEL            9           12  ...            5             1
true class NV             5           12  ...            0             3
true class SCC            1           16  ...           10             0
true class VASC           0            2  ...            0             7

[8 rows x 8 columns]

Current validation loss: 1.815
Training finished. Time >23.0 hours.
Model succesfully saved to /scratch/work/hakkina7/melanoma/resnet50_nonweighted.pth
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
