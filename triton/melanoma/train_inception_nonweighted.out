File path is /scratch/work/hakkina7/melanoma/
Device is cuda
Training InceptionV3 model.

Epoch 1:
Mean loss 1.4603022891640287 - Correctly labeled training images 50.38%
Classified 51.03 % of validation images correctly.
Precision on validation set: [0.   0.   0.   0.   0.39 0.52 0.   0.  ]
Recall on validation set: [0.   0.   0.   0.   0.08 0.98 0.   0.  ]
F1-score on validation set: [0.   0.   0.   0.   0.14 0.67 0.   0.  ]
ROC AUC on validation set: {'AK': 0.6, 'BCC': 0.68, 'BKL': 0.61, 'DF': 0.68, 'MEL': 0.44, 'NV': 0.37, 'SCC': 0.66, 'VASC': 0.66}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0            0  ...            0             0
true class BCC            0            0  ...            0             0
true class BKL            0            0  ...            0             0
true class DF             0            0  ...            0             0
true class MEL            0            0  ...            0             0
true class NV             0            0  ...            0             0
true class SCC            0            0  ...            0             0
true class VASC           0            0  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.393

Epoch 2:
Mean loss 1.368652422157372 - Correctly labeled training images 51.14%
Classified 51.42 % of validation images correctly.
Precision on validation set: [0.   0.   0.   0.   0.53 0.51 0.   0.  ]
Recall on validation set: [0.   0.   0.   0.   0.08 0.98 0.   0.  ]
F1-score on validation set: [0.   0.   0.   0.   0.14 0.68 0.   0.  ]
ROC AUC on validation set: {'AK': 0.73, 'BCC': 0.73, 'BKL': 0.62, 'DF': 0.64, 'MEL': 0.47, 'NV': 0.3, 'SCC': 0.76, 'VASC': 0.6}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0            0  ...            0             0
true class BCC            0            0  ...            0             0
true class BKL            0            0  ...            0             0
true class DF             0            0  ...            0             0
true class MEL            0            0  ...            0             0
true class NV             0            0  ...            0             0
true class SCC            0            0  ...            0             0
true class VASC           0            0  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.331

Epoch 3:
Mean loss 1.329042274305121 - Correctly labeled training images 51.85%
Classified 52.13 % of validation images correctly.
Precision on validation set: [0.   0.36 0.   0.   0.53 0.52 0.   0.  ]
Recall on validation set: [0.   0.02 0.   0.   0.12 0.98 0.   0.  ]
F1-score on validation set: [0.   0.04 0.   0.   0.19 0.68 0.   0.  ]
ROC AUC on validation set: {'AK': 0.71, 'BCC': 0.73, 'BKL': 0.66, 'DF': 0.65, 'MEL': 0.48, 'NV': 0.29, 'SCC': 0.71, 'VASC': 0.58}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0            2  ...            0             0
true class BCC            0            4  ...            0             0
true class BKL            0            1  ...            0             0
true class DF             0            0  ...            0             0
true class MEL            0            2  ...            0             0
true class NV             0            2  ...            0             0
true class SCC            0            0  ...            0             0
true class VASC           0            0  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.304

Epoch 4:
Mean loss 1.3055225544923488 - Correctly labeled training images 52.62%
Classified 52.37 % of validation images correctly.
Precision on validation set: [0.   0.19 0.   0.   0.51 0.54 0.   0.  ]
Recall on validation set: [0.   0.06 0.   0.   0.14 0.97 0.   0.  ]
F1-score on validation set: [0.   0.09 0.   0.   0.22 0.69 0.   0.  ]
ROC AUC on validation set: {'AK': 0.73, 'BCC': 0.72, 'BKL': 0.64, 'DF': 0.65, 'MEL': 0.51, 'NV': 0.28, 'SCC': 0.74, 'VASC': 0.55}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0            8  ...            0             0
true class BCC            0           10  ...            0             0
true class BKL            0           10  ...            0             0
true class DF             0            1  ...            0             0
true class MEL            0           13  ...            0             0
true class NV             0            8  ...            0             0
true class SCC            0            1  ...            0             0
true class VASC           0            1  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.311

Epoch 5:
Mean loss 1.2755468860033559 - Correctly labeled training images 54.10%
Classified 54.02 % of validation images correctly.
Precision on validation set: [0.   0.3  0.   0.   0.48 0.58 0.   0.  ]
Recall on validation set: [0.   0.25 0.   0.   0.21 0.92 0.   0.  ]
F1-score on validation set: [0.   0.27 0.   0.   0.29 0.71 0.   0.  ]
ROC AUC on validation set: {'AK': 0.79, 'BCC': 0.75, 'BKL': 0.64, 'DF': 0.68, 'MEL': 0.5, 'NV': 0.26, 'SCC': 0.78, 'VASC': 0.57}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           19  ...            0             0
true class BCC            0           42  ...            0             0
true class BKL            0           24  ...            0             0
true class DF             0            1  ...            0             0
true class MEL            0           20  ...            0             0
true class NV             0           28  ...            0             0
true class SCC            0            5  ...            0             0
true class VASC           0            1  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.270

Epoch 6:
Mean loss 1.2620586259319955 - Correctly labeled training images 54.49%
Classified 54.89 % of validation images correctly.
Precision on validation set: [0.   0.29 0.   0.   0.5  0.6  0.   0.  ]
Recall on validation set: [0.   0.27 0.   0.   0.24 0.93 0.   0.  ]
F1-score on validation set: [0.   0.28 0.   0.   0.32 0.72 0.   0.  ]
ROC AUC on validation set: {'AK': 0.75, 'BCC': 0.75, 'BKL': 0.66, 'DF': 0.67, 'MEL': 0.51, 'NV': 0.26, 'SCC': 0.72, 'VASC': 0.56}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           16  ...            0             0
true class BCC            0           45  ...            0             0
true class BKL            0           33  ...            0             0
true class DF             0            1  ...            0             0
true class MEL            0           25  ...            0             0
true class NV             0           29  ...            0             0
true class SCC            0            6  ...            0             0
true class VASC           0            2  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.262

Epoch 7:
Mean loss 1.2371098370958202 - Correctly labeled training images 55.08%
Classified 56.07 % of validation images correctly.
Precision on validation set: [0.   0.3  0.   0.   0.51 0.62 0.   0.  ]
Recall on validation set: [0.   0.35 0.   0.   0.31 0.9  0.   0.  ]
F1-score on validation set: [0.   0.33 0.   0.   0.39 0.74 0.   0.  ]
ROC AUC on validation set: {'AK': 0.8, 'BCC': 0.77, 'BKL': 0.66, 'DF': 0.65, 'MEL': 0.5, 'NV': 0.24, 'SCC': 0.8, 'VASC': 0.62}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           22  ...            0             0
true class BCC            0           59  ...            0             0
true class BKL            0           33  ...            0             0
true class DF             0            1  ...            0             0
true class MEL            0           32  ...            0             0
true class NV             0           34  ...            0             0
true class SCC            0           13  ...            0             0
true class VASC           0            1  ...            0             0

/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
[8 rows x 8 columns]

Current validation loss: 1.228

Epoch 8:
Mean loss 1.2349618363079589 - Correctly labeled training images 55.42%
Classified 56.39 % of validation images correctly.
Precision on validation set: [0.   0.3  0.   0.   0.53 0.64 0.   0.  ]
Recall on validation set: [0.   0.46 0.   0.   0.25 0.91 0.   0.  ]
F1-score on validation set: [0.   0.36 0.   0.   0.34 0.75 0.   0.  ]
ROC AUC on validation set: {'AK': 0.8, 'BCC': 0.78, 'BKL': 0.67, 'DF': 0.63, 'MEL': 0.51, 'NV': 0.23, 'SCC': 0.8, 'VASC': 0.58}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           27  ...            0             0
true class BCC            0           76  ...            0             0
true class BKL            0           43  ...            0             0
true class DF             0            2  ...            0             0
true class MEL            0           47  ...            0             0
true class NV             0           39  ...            0             0
true class SCC            0           18  ...            0             0
true class VASC           0            1  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.221

Epoch 9:
Mean loss 1.226966294204399 - Correctly labeled training images 55.59%
Classified 55.84 % of validation images correctly.
Precision on validation set: [0.   0.3  0.   0.   0.56 0.62 0.   0.  ]
Recall on validation set: [0.   0.41 0.   0.   0.22 0.91 0.   0.  ]
F1-score on validation set: [0.   0.34 0.   0.   0.32 0.74 0.   0.  ]
ROC AUC on validation set: {'AK': 0.81, 'BCC': 0.77, 'BKL': 0.65, 'DF': 0.69, 'MEL': 0.5, 'NV': 0.24, 'SCC': 0.8, 'VASC': 0.57}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           25  ...            0             0
true class BCC            0           69  ...            0             0
true class BKL            0           41  ...            0             0
true class DF             0            2  ...            0             0
true class MEL            0           39  ...            0             0
true class NV             0           42  ...            0             0
true class SCC            0           14  ...            0             0
true class VASC           0            1  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.234

Epoch 10:
Mean loss 1.209427895888169 - Correctly labeled training images 56.44%
Classified 57.73 % of validation images correctly.
Precision on validation set: [0.   0.34 0.   0.   0.5  0.65 0.   0.  ]
Recall on validation set: [0.   0.47 0.   0.   0.32 0.9  0.   0.  ]
F1-score on validation set: [0.   0.39 0.   0.   0.39 0.76 0.   0.  ]
ROC AUC on validation set: {'AK': 0.8, 'BCC': 0.79, 'BKL': 0.66, 'DF': 0.71, 'MEL': 0.49, 'NV': 0.22, 'SCC': 0.84, 'VASC': 0.62}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           25  ...            0             0
true class BCC            0           79  ...            0             0
true class BKL            0           38  ...            0             0
true class DF             0            2  ...            0             0
true class MEL            0           33  ...            0             0
true class NV             0           35  ...            0             0
true class SCC            0           20  ...            0             0
true class VASC           0            2  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.194

Epoch 11:
Mean loss 1.203908082720609 - Correctly labeled training images 56.70%
Classified 57.10 % of validation images correctly.
Precision on validation set: [0.   0.38 0.   0.   0.52 0.6  0.   0.  ]
Recall on validation set: [0.   0.29 0.   0.   0.33 0.93 0.   0.  ]
F1-score on validation set: [0.   0.33 0.   0.   0.41 0.73 0.   0.  ]
ROC AUC on validation set: {'AK': 0.76, 'BCC': 0.78, 'BKL': 0.66, 'DF': 0.73, 'MEL': 0.48, 'NV': 0.25, 'SCC': 0.76, 'VASC': 0.72}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           13  ...            0             0
true class BCC            0           48  ...            0             0
true class BKL            0           23  ...            0             0
true class DF             0            2  ...            0             0
true class MEL            0           19  ...            0             0
true class NV             0           15  ...            0             0
true class SCC            0            7  ...            0             0
true class VASC           0            1  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.230

Epoch 12:
Mean loss 1.1925610656429917 - Correctly labeled training images 57.12%
Classified 57.73 % of validation images correctly.
Precision on validation set: [0.   0.33 0.5  0.   0.51 0.65 0.   0.  ]
Recall on validation set: [0.   0.46 0.02 0.   0.31 0.91 0.   0.  ]
F1-score on validation set: [0.   0.38 0.03 0.   0.39 0.76 0.   0.  ]
ROC AUC on validation set: {'AK': 0.82, 'BCC': 0.8, 'BKL': 0.66, 'DF': 0.69, 'MEL': 0.5, 'NV': 0.22, 'SCC': 0.85, 'VASC': 0.64}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           27  ...            0             0
true class BCC            0           76  ...            0             0
true class BKL            0           40  ...            0             0
true class DF             0            2  ...            0             0
true class MEL            0           33  ...            0             0
true class NV             0           30  ...            0             0
true class SCC            0           20  ...            0             0
true class VASC           0            4  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.193

Epoch 13:
Mean loss 1.1902130862891862 - Correctly labeled training images 57.27%
Classified 58.68 % of validation images correctly.
Precision on validation set: [0.   0.35 0.   0.   0.52 0.66 0.   0.  ]
Recall on validation set: [0.   0.48 0.   0.   0.35 0.91 0.   0.  ]
F1-score on validation set: [0.   0.41 0.   0.   0.41 0.76 0.   0.  ]
ROC AUC on validation set: {'AK': 0.82, 'BCC': 0.8, 'BKL': 0.67, 'DF': 0.68, 'MEL': 0.5, 'NV': 0.21, 'SCC': 0.85, 'VASC': 0.64}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           29  ...            0             0
true class BCC            0           80  ...            0             0
true class BKL            0           40  ...            0             0
true class DF             0            1  ...            0             0
true class MEL            0           26  ...            0             0
true class NV             0           29  ...            0             0
true class SCC            0           18  ...            0             0
true class VASC           0            3  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.186

Epoch 14:
Mean loss 1.1885187359826421 - Correctly labeled training images 57.12%
Classified 57.81 % of validation images correctly.
Precision on validation set: [0.   0.32 0.   0.   0.5  0.68 0.   0.  ]
Recall on validation set: [0.   0.56 0.   0.   0.28 0.9  0.   0.  ]
F1-score on validation set: [0.   0.41 0.   0.   0.36 0.77 0.   0.  ]
ROC AUC on validation set: {'AK': 0.83, 'BCC': 0.8, 'BKL': 0.67, 'DF': 0.68, 'MEL': 0.51, 'NV': 0.2, 'SCC': 0.86, 'VASC': 0.62}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           33  ...            0             0
true class BCC            0           93  ...            0             0
true class BKL            0           54  ...            0             0
true class DF             0            4  ...            0             0
true class MEL            0           41  ...            0             0
true class NV             0           39  ...            0             0
true class SCC            0           23  ...            0             0
true class VASC           0            3  ...            0             0

/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
[8 rows x 8 columns]

Current validation loss: 1.181

Epoch 15:
Mean loss 1.181415500136956 - Correctly labeled training images 57.63%
Classified 58.20 % of validation images correctly.
Precision on validation set: [0.   0.32 0.33 0.   0.48 0.69 0.   0.  ]
Recall on validation set: [0.   0.53 0.01 0.   0.33 0.89 0.   0.  ]
F1-score on validation set: [0.   0.4  0.01 0.   0.39 0.78 0.   0.  ]
ROC AUC on validation set: {'AK': 0.83, 'BCC': 0.8, 'BKL': 0.67, 'DF': 0.72, 'MEL': 0.5, 'NV': 0.21, 'SCC': 0.85, 'VASC': 0.63}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           29  ...            0             0
true class BCC            0           88  ...            0             0
true class BKL            0           48  ...            0             0
true class DF             0            6  ...            0             0
true class MEL            0           43  ...            0             0
true class NV             0           33  ...            0             0
true class SCC            0           25  ...            0             0
true class VASC           0            4  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.173

Epoch 16:
Mean loss 1.172844660488965 - Correctly labeled training images 57.61%
Classified 57.65 % of validation images correctly.
Precision on validation set: [0.   0.32 0.   0.   0.5  0.67 0.   0.  ]
Recall on validation set: [0.   0.53 0.   0.   0.25 0.91 0.   0.  ]
F1-score on validation set: [0.   0.4  0.   0.   0.34 0.77 0.   0.  ]
ROC AUC on validation set: {'AK': 0.83, 'BCC': 0.81, 'BKL': 0.67, 'DF': 0.72, 'MEL': 0.53, 'NV': 0.19, 'SCC': 0.86, 'VASC': 0.57}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           32  ...            0             0
true class BCC            0           89  ...            0             0
true class BKL            0           51  ...            0             0
true class DF             0            3  ...            0             0
true class MEL            0           43  ...            0             0
true class NV             0           35  ...            0             0
true class SCC            0           24  ...            0             0
true class VASC           0            3  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.170

Epoch 17:
Mean loss 1.1699437403152417 - Correctly labeled training images 57.67%
Classified 57.89 % of validation images correctly.
Precision on validation set: [0.   0.33 0.   0.   0.5  0.66 0.   0.  ]
Recall on validation set: [0.   0.48 0.   0.   0.28 0.92 0.   0.  ]
F1-score on validation set: [0.   0.39 0.   0.   0.36 0.76 0.   0.  ]
ROC AUC on validation set: {'AK': 0.84, 'BCC': 0.81, 'BKL': 0.67, 'DF': 0.76, 'MEL': 0.52, 'NV': 0.19, 'SCC': 0.85, 'VASC': 0.56}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           31  ...            0             0
true class BCC            0           80  ...            0             0
true class BKL            0           40  ...            0             0
true class DF             0            6  ...            0             0
true class MEL            0           35  ...            0             0
true class NV             0           25  ...            0             0
true class SCC            0           22  ...            0             0
true class VASC           0            2  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.168

Epoch 18:
Mean loss 1.1653421931086279 - Correctly labeled training images 57.90%
Classified 58.04 % of validation images correctly.
Precision on validation set: [0.   0.32 0.   0.   0.5  0.69 0.   0.  ]
Recall on validation set: [0.   0.56 0.   0.   0.32 0.89 0.   0.  ]
F1-score on validation set: [0.   0.41 0.   0.   0.39 0.77 0.   0.  ]
ROC AUC on validation set: {'AK': 0.82, 'BCC': 0.82, 'BKL': 0.67, 'DF': 0.71, 'MEL': 0.51, 'NV': 0.2, 'SCC': 0.86, 'VASC': 0.55}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           30  ...            0             0
true class BCC            0           93  ...            0             0
true class BKL            0           50  ...            0             0
true class DF             0            5  ...            0             0
true class MEL            0           42  ...            0             0
true class NV             0           42  ...            0             0
true class SCC            0           26  ...            0             0
true class VASC           0            2  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.161

Epoch 19:
Mean loss 1.1586802141147456 - Correctly labeled training images 58.10%
Classified 57.73 % of validation images correctly.
Precision on validation set: [0.   0.33 0.   0.   0.48 0.67 0.   0.  ]
Recall on validation set: [0.   0.52 0.   0.   0.29 0.9  0.   0.  ]
F1-score on validation set: [0.   0.4  0.   0.   0.36 0.77 0.   0.  ]
ROC AUC on validation set: {'AK': 0.84, 'BCC': 0.82, 'BKL': 0.66, 'DF': 0.74, 'MEL': 0.51, 'NV': 0.19, 'SCC': 0.87, 'VASC': 0.6}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           31  ...            0             0
true class BCC            0           87  ...            0             0
true class BKL            0           45  ...            0             0
true class DF             0            5  ...            0             0
true class MEL            0           38  ...            0             0
true class NV             0           34  ...            0             0
true class SCC            0           24  ...            0             0
true class VASC           0            2  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.155

Epoch 20:
Mean loss 1.1544039406422937 - Correctly labeled training images 58.45%
Classified 57.89 % of validation images correctly.
Precision on validation set: [0.   0.33 0.   0.   0.47 0.68 0.   0.  ]
Recall on validation set: [0.   0.54 0.   0.   0.33 0.89 0.   0.  ]
F1-score on validation set: [0.   0.41 0.   0.   0.39 0.77 0.   0.  ]
ROC AUC on validation set: {'AK': 0.83, 'BCC': 0.83, 'BKL': 0.67, 'DF': 0.77, 'MEL': 0.51, 'NV': 0.19, 'SCC': 0.85, 'VASC': 0.62}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           31  ...            0             0
true class BCC            0           90  ...            0             0
true class BKL            0           47  ...            0             0
true class DF             0            7  ...            0             0
true class MEL            0           38  ...            0             0
true class NV             0           36  ...            0             0
true class SCC            0           22  ...            0             0
true class VASC           0            5  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.139

Epoch 21:
Mean loss 1.149802094096265 - Correctly labeled training images 58.43%
Classified 58.20 % of validation images correctly.
Precision on validation set: [0.   0.33 0.   0.   0.49 0.69 0.   0.  ]
Recall on validation set: [0.   0.62 0.   0.   0.27 0.89 0.   0.  ]
F1-score on validation set: [0.   0.43 0.   0.   0.35 0.78 0.   0.  ]
ROC AUC on validation set: {'AK': 0.85, 'BCC': 0.83, 'BKL': 0.68, 'DF': 0.72, 'MEL': 0.52, 'NV': 0.18, 'SCC': 0.84, 'VASC': 0.59}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           35  ...            0             0
true class BCC            0          104  ...            0             0
true class BKL            0           55  ...            0             0
true class DF             0            6  ...            0             0
true class MEL            0           47  ...            0             0
true class NV             0           43  ...            0             0
true class SCC            0           22  ...            0             0
true class VASC           0            4  ...            0             0

/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
[8 rows x 8 columns]

Current validation loss: 1.153

Epoch 22:
Mean loss 1.1469472992683434 - Correctly labeled training images 58.39%
Classified 59.46 % of validation images correctly.
Precision on validation set: [0.   0.34 0.33 0.   0.52 0.68 0.   0.  ]
Recall on validation set: [0.   0.5  0.02 0.   0.33 0.92 0.   0.  ]
F1-score on validation set: [0.   0.41 0.04 0.   0.4  0.78 0.   0.  ]
ROC AUC on validation set: {'AK': 0.84, 'BCC': 0.83, 'BKL': 0.68, 'DF': 0.72, 'MEL': 0.53, 'NV': 0.18, 'SCC': 0.85, 'VASC': 0.56}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           31  ...            0             0
true class BCC            0           84  ...            0             0
true class BKL            0           41  ...            0             0
true class DF             0            4  ...            0             0
true class MEL            0           41  ...            0             0
true class NV             0           22  ...            0             0
true class SCC            0           21  ...            0             0
true class VASC           0            2  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.141

Epoch 23:
Mean loss 1.140574202552579 - Correctly labeled training images 58.65%
Classified 59.07 % of validation images correctly.
Precision on validation set: [0.   0.34 0.   0.   0.52 0.69 0.   0.  ]
Recall on validation set: [0.   0.6  0.   0.   0.26 0.92 0.   0.  ]
F1-score on validation set: [0.   0.43 0.   0.   0.34 0.79 0.   0.  ]
ROC AUC on validation set: {'AK': 0.84, 'BCC': 0.84, 'BKL': 0.68, 'DF': 0.76, 'MEL': 0.5, 'NV': 0.18, 'SCC': 0.87, 'VASC': 0.59}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           33  ...            0             0
true class BCC            0          100  ...            0             0
true class BKL            0           53  ...            0             0
true class DF             0            7  ...            0             0
true class MEL            0           44  ...            0             0
true class NV             0           33  ...            0             0
true class SCC            0           23  ...            0             0
true class VASC           0            4  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.129

Epoch 24:
Mean loss 1.1405703868211632 - Correctly labeled training images 58.88%
Classified 58.60 % of validation images correctly.
Precision on validation set: [0.   0.33 0.   0.   0.49 0.7  0.   0.  ]
Recall on validation set: [0.   0.59 0.   0.   0.31 0.89 0.   0.  ]
F1-score on validation set: [0.   0.42 0.   0.   0.38 0.78 0.   0.  ]
ROC AUC on validation set: {'AK': 0.84, 'BCC': 0.83, 'BKL': 0.69, 'DF': 0.75, 'MEL': 0.52, 'NV': 0.17, 'SCC': 0.86, 'VASC': 0.59}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           31  ...            0             0
true class BCC            0           99  ...            0             0
true class BKL            0           56  ...            0             0
true class DF             0            6  ...            0             0
true class MEL            0           47  ...            0             0
true class NV             0           37  ...            0             0
true class SCC            0           23  ...            0             0
true class VASC           0            2  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.131

Epoch 25:
Mean loss 1.1380585395387295 - Correctly labeled training images 58.81%
Classified 58.91 % of validation images correctly.
Precision on validation set: [0.   0.32 0.   0.   0.49 0.71 0.   0.  ]
Recall on validation set: [0.   0.59 0.   0.   0.37 0.88 0.   0.  ]
F1-score on validation set: [0.   0.42 0.   0.   0.42 0.79 0.   0.  ]
ROC AUC on validation set: {'AK': 0.84, 'BCC': 0.83, 'BKL': 0.68, 'DF': 0.73, 'MEL': 0.51, 'NV': 0.18, 'SCC': 0.86, 'VASC': 0.59}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           34  ...            0             0
true class BCC            0           99  ...            0             0
true class BKL            0           55  ...            0             0
true class DF             0            7  ...            0             0
true class MEL            0           45  ...            0             0
true class NV             0           40  ...            0             0
true class SCC            0           23  ...            0             0
true class VASC           0            4  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.136

Epoch 26:
Mean loss 1.1329106055787685 - Correctly labeled training images 59.06%
Classified 58.68 % of validation images correctly.
Precision on validation set: [0.   0.34 0.   0.   0.5  0.68 0.   0.  ]
Recall on validation set: [0.   0.57 0.   0.   0.3  0.9  0.   0.  ]
F1-score on validation set: [0.   0.43 0.   0.   0.37 0.78 0.   0.  ]
ROC AUC on validation set: {'AK': 0.85, 'BCC': 0.83, 'BKL': 0.67, 'DF': 0.75, 'MEL': 0.52, 'NV': 0.18, 'SCC': 0.84, 'VASC': 0.57}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           33  ...            0             0
true class BCC            0           95  ...            0             0
true class BKL            0           48  ...            0             0
true class DF             0            5  ...            0             0
true class MEL            0           43  ...            0             0
true class NV             0           30  ...            0             0
true class SCC            0           22  ...            0             0
true class VASC           0            3  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.139

Epoch 27:
Mean loss 1.1276507710432782 - Correctly labeled training images 59.42%
Classified 58.52 % of validation images correctly.
Precision on validation set: [0.   0.34 0.33 0.   0.5  0.68 0.   0.  ]
Recall on validation set: [0.   0.59 0.02 0.   0.27 0.9  0.   0.  ]
F1-score on validation set: [0.   0.43 0.03 0.   0.35 0.78 0.   0.  ]
ROC AUC on validation set: {'AK': 0.83, 'BCC': 0.84, 'BKL': 0.68, 'DF': 0.74, 'MEL': 0.51, 'NV': 0.18, 'SCC': 0.85, 'VASC': 0.61}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           30  ...            0             0
true class BCC            0           98  ...            0             0
true class BKL            0           55  ...            0             0
true class DF             0            6  ...            0             0
true class MEL            0           38  ...            0             0
true class NV             0           38  ...            0             0
true class SCC            0           23  ...            0             0
true class VASC           0            3  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.131

Epoch 28:
Mean loss 1.1244411842680129 - Correctly labeled training images 59.21%
Classified 59.78 % of validation images correctly.
Precision on validation set: [0.   0.35 0.5  0.   0.49 0.69 0.   0.  ]
Recall on validation set: [0.   0.55 0.01 0.   0.36 0.91 0.   0.  ]
F1-score on validation set: [0.   0.43 0.02 0.   0.41 0.79 0.   0.  ]
ROC AUC on validation set: {'AK': 0.84, 'BCC': 0.84, 'BKL': 0.68, 'DF': 0.72, 'MEL': 0.5, 'NV': 0.19, 'SCC': 0.86, 'VASC': 0.63}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           29  ...            0             0
true class BCC            0           92  ...            0             0
true class BKL            0           45  ...            0             0
true class DF             0            5  ...            0             0
true class MEL            0           38  ...            0             0
true class NV             0           25  ...            0             0
true class SCC            0           22  ...            0             0
true class VASC           0            4  ...            0             0

/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
[8 rows x 8 columns]

Current validation loss: 1.119

Epoch 29:
Mean loss 1.1139165140476888 - Correctly labeled training images 59.65%
Classified 58.28 % of validation images correctly.
Precision on validation set: [0.   0.33 0.33 0.   0.47 0.69 0.   0.  ]
Recall on validation set: [0.   0.57 0.01 0.   0.31 0.89 0.   0.  ]
F1-score on validation set: [0.   0.41 0.01 0.   0.37 0.78 0.   0.  ]
ROC AUC on validation set: {'AK': 0.84, 'BCC': 0.84, 'BKL': 0.68, 'DF': 0.72, 'MEL': 0.51, 'NV': 0.18, 'SCC': 0.86, 'VASC': 0.61}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           34  ...            0             0
true class BCC            0           95  ...            0             0
true class BKL            0           52  ...            0             0
true class DF             0            6  ...            0             0
true class MEL            0           42  ...            0             0
true class NV             0           35  ...            0             0
true class SCC            0           23  ...            0             0
true class VASC           0            4  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.126

Epoch 30:
Mean loss 1.1166608469907418 - Correctly labeled training images 59.46%
Classified 57.97 % of validation images correctly.
Precision on validation set: [0.   0.32 0.5  0.   0.44 0.71 0.   0.  ]
Recall on validation set: [0.   0.58 0.01 0.   0.35 0.87 0.   0.  ]
F1-score on validation set: [0.   0.41 0.02 0.   0.39 0.78 0.   0.  ]
ROC AUC on validation set: {'AK': 0.85, 'BCC': 0.84, 'BKL': 0.67, 'DF': 0.75, 'MEL': 0.49, 'NV': 0.19, 'SCC': 0.85, 'VASC': 0.6}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           34  ...            0             0
true class BCC            0           97  ...            0             0
true class BKL            0           53  ...            0             0
true class DF             0            7  ...            0             0
true class MEL            0           41  ...            0             0
true class NV             0           43  ...            0             0
true class SCC            0           24  ...            0             0
true class VASC           0            4  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.116

Epoch 31:
Mean loss 1.1075782797502043 - Correctly labeled training images 60.05%
Classified 60.33 % of validation images correctly.
Precision on validation set: [0.   0.36 0.57 0.   0.49 0.7  0.   0.  ]
Recall on validation set: [0.   0.58 0.06 0.   0.34 0.91 0.   0.  ]
F1-score on validation set: [0.   0.44 0.11 0.   0.4  0.79 0.   0.  ]
ROC AUC on validation set: {'AK': 0.84, 'BCC': 0.85, 'BKL': 0.69, 'DF': 0.78, 'MEL': 0.51, 'NV': 0.17, 'SCC': 0.85, 'VASC': 0.63}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           32  ...            0             0
true class BCC            0           97  ...            0             0
true class BKL            0           44  ...            0             0
true class DF             0            6  ...            0             0
true class MEL            0           36  ...            0             0
true class NV             0           28  ...            0             0
true class SCC            0           23  ...            0             0
true class VASC           0            3  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.104

Epoch 32:
Mean loss 1.1088614040744793 - Correctly labeled training images 59.81%
Classified 59.38 % of validation images correctly.
Precision on validation set: [0.   0.35 0.33 0.   0.46 0.72 0.   0.  ]
Recall on validation set: [0.   0.62 0.05 0.   0.37 0.87 0.   0.  ]
F1-score on validation set: [0.   0.45 0.08 0.   0.41 0.79 0.   0.  ]
ROC AUC on validation set: {'AK': 0.84, 'BCC': 0.85, 'BKL': 0.69, 'DF': 0.79, 'MEL': 0.5, 'NV': 0.18, 'SCC': 0.85, 'VASC': 0.62}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           33  ...            0             0
true class BCC            0          103  ...            0             0
true class BKL            0           48  ...            0             0
true class DF             0            8  ...            0             0
true class MEL            0           41  ...            0             0
true class NV             0           34  ...            0             0
true class SCC            0           23  ...            0             0
true class VASC           0            4  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.098

Epoch 33:
Mean loss 1.1061610791021341 - Correctly labeled training images 60.05%
Classified 58.52 % of validation images correctly.
Precision on validation set: [0.   0.34 0.23 0.   0.47 0.7  0.   0.  ]
Recall on validation set: [0.   0.59 0.02 0.   0.32 0.88 0.   0.  ]
F1-score on validation set: [0.   0.43 0.04 0.   0.38 0.78 0.   0.  ]
ROC AUC on validation set: {'AK': 0.85, 'BCC': 0.85, 'BKL': 0.68, 'DF': 0.8, 'MEL': 0.52, 'NV': 0.17, 'SCC': 0.86, 'VASC': 0.61}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           33  ...            0             0
true class BCC            0           98  ...            0             0
true class BKL            0           48  ...            0             0
true class DF             0            7  ...            0             0
true class MEL            0           42  ...            0             0
true class NV             0           33  ...            0             0
true class SCC            0           24  ...            0             0
true class VASC           0            4  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.099

Epoch 34:
Mean loss 1.1005416591460773 - Correctly labeled training images 59.97%
Classified 59.31 % of validation images correctly.
Precision on validation set: [0.   0.34 0.22 0.   0.48 0.75 0.   0.  ]
Recall on validation set: [0.   0.7  0.05 0.   0.35 0.86 0.   0.  ]
F1-score on validation set: [0.   0.46 0.08 0.   0.4  0.8  0.   0.  ]
ROC AUC on validation set: {'AK': 0.83, 'BCC': 0.85, 'BKL': 0.68, 'DF': 0.79, 'MEL': 0.51, 'NV': 0.17, 'SCC': 0.86, 'VASC': 0.65}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           32  ...            0             0
true class BCC            0          117  ...            0             0
true class BKL            0           62  ...            0             0
true class DF             0            9  ...            0             0
true class MEL            0           46  ...            0             0
true class NV             0           46  ...            0             0
true class SCC            0           26  ...            0             0
true class VASC           0            5  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.103

Epoch 35:
Mean loss 1.0985135116411684 - Correctly labeled training images 60.27%
Classified 58.83 % of validation images correctly.
Precision on validation set: [0.   0.33 0.25 0.   0.5  0.71 0.   0.  ]
Recall on validation set: [0.   0.6  0.02 0.   0.32 0.88 0.   0.  ]
F1-score on validation set: [0.   0.43 0.04 0.   0.39 0.79 0.   0.  ]
ROC AUC on validation set: {'AK': 0.85, 'BCC': 0.85, 'BKL': 0.68, 'DF': 0.76, 'MEL': 0.52, 'NV': 0.17, 'SCC': 0.85, 'VASC': 0.63}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           33  ...            0             0
true class BCC            0          101  ...            0             0
true class BKL            0           52  ...            0             0
true class DF             0            8  ...            0             0
true class MEL            0           44  ...            0             0
true class NV             0           39  ...            0             0
true class SCC            0           23  ...            0             0
true class VASC           0            5  ...            0             0

/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
[8 rows x 8 columns]

Current validation loss: 1.098

Epoch 36:
Mean loss 1.0990267749464475 - Correctly labeled training images 60.25%
Classified 59.70 % of validation images correctly.
Precision on validation set: [0.   0.37 0.22 0.   0.51 0.7  0.   0.  ]
Recall on validation set: [0.   0.57 0.05 0.   0.31 0.91 0.   0.  ]
F1-score on validation set: [0.   0.45 0.09 0.   0.38 0.79 0.   0.  ]
ROC AUC on validation set: {'AK': 0.83, 'BCC': 0.85, 'BKL': 0.67, 'DF': 0.78, 'MEL': 0.52, 'NV': 0.17, 'SCC': 0.86, 'VASC': 0.66}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           28  ...            0             0
true class BCC            0           96  ...            0             0
true class BKL            0           45  ...            0             0
true class DF             0            7  ...            0             0
true class MEL            0           37  ...            0             0
true class NV             0           23  ...            0             0
true class SCC            0           23  ...            0             0
true class VASC           0            4  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.100

Epoch 37:
Mean loss 1.0951250957953818 - Correctly labeled training images 60.42%
Classified 60.02 % of validation images correctly.
Precision on validation set: [0.   0.35 0.33 0.   0.55 0.69 0.   0.  ]
Recall on validation set: [0.   0.57 0.03 0.   0.3  0.92 0.   0.  ]
F1-score on validation set: [0.   0.43 0.06 0.   0.39 0.79 0.   0.  ]
ROC AUC on validation set: {'AK': 0.85, 'BCC': 0.84, 'BKL': 0.68, 'DF': 0.8, 'MEL': 0.53, 'NV': 0.16, 'SCC': 0.86, 'VASC': 0.64}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           32  ...            0             0
true class BCC            0           96  ...            0             0
true class BKL            0           46  ...            0             0
true class DF             0            8  ...            0             0
true class MEL            0           40  ...            0             0
true class NV             0           26  ...            0             0
true class SCC            0           23  ...            0             0
true class VASC           0            5  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.103

Epoch 38:
Mean loss 1.0923657485927316 - Correctly labeled training images 60.57%
Classified 60.09 % of validation images correctly.
Precision on validation set: [0.   0.39 0.25 0.   0.5  0.7  0.   0.  ]
Recall on validation set: [0.   0.63 0.05 0.   0.29 0.91 0.   0.  ]
F1-score on validation set: [0.   0.48 0.08 0.   0.37 0.79 0.   0.  ]
ROC AUC on validation set: {'AK': 0.84, 'BCC': 0.86, 'BKL': 0.67, 'DF': 0.78, 'MEL': 0.51, 'NV': 0.17, 'SCC': 0.85, 'VASC': 0.65}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           27  ...            0             0
true class BCC            0          105  ...            0             0
true class BKL            0           45  ...            0             0
true class DF             0            5  ...            0             0
true class MEL            0           37  ...            0             0
true class NV             0           26  ...            0             0
true class SCC            0           22  ...            0             0
true class VASC           0            5  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.094

Epoch 39:
Mean loss 1.0868034285701789 - Correctly labeled training images 61.12%
Classified 60.49 % of validation images correctly.
Precision on validation set: [0.   0.37 0.35 0.   0.49 0.72 0.   0.  ]
Recall on validation set: [0.   0.59 0.09 0.   0.39 0.88 0.   0.  ]
F1-score on validation set: [0.   0.45 0.15 0.   0.43 0.8  0.   0.  ]
ROC AUC on validation set: {'AK': 0.84, 'BCC': 0.85, 'BKL': 0.68, 'DF': 0.82, 'MEL': 0.52, 'NV': 0.16, 'SCC': 0.84, 'VASC': 0.65}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           29  ...            0             0
true class BCC            0           98  ...            0             0
true class BKL            0           42  ...            0             0
true class DF             0            8  ...            0             0
true class MEL            0           35  ...            0             0
true class NV             0           30  ...            0             0
true class SCC            0           22  ...            0             0
true class VASC           0            4  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.083

Epoch 40:
Mean loss 1.0831888908467457 - Correctly labeled training images 61.01%
Classified 60.33 % of validation images correctly.
Precision on validation set: [0.   0.35 0.29 0.   0.5  0.73 0.   0.  ]
Recall on validation set: [0.   0.64 0.05 0.   0.35 0.89 0.   0.  ]
F1-score on validation set: [0.   0.45 0.09 0.   0.41 0.8  0.   0.  ]
ROC AUC on validation set: {'AK': 0.83, 'BCC': 0.85, 'BKL': 0.68, 'DF': 0.81, 'MEL': 0.51, 'NV': 0.17, 'SCC': 0.85, 'VASC': 0.63}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           32  ...            0             0
true class BCC            0          107  ...            0             0
true class BKL            0           52  ...            0             0
true class DF             0            9  ...            0             0
true class MEL            0           41  ...            0             0
true class NV             0           35  ...            0             0
true class SCC            0           23  ...            0             0
true class VASC           0            5  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.091

Epoch 41:
Mean loss 1.085650569726992 - Correctly labeled training images 60.82%
Classified 60.25 % of validation images correctly.
Precision on validation set: [0.   0.37 0.31 0.   0.49 0.71 0.   0.  ]
Recall on validation set: [0.   0.61 0.08 0.   0.32 0.9  0.   0.  ]
F1-score on validation set: [0.   0.46 0.13 0.   0.39 0.79 0.   0.  ]
ROC AUC on validation set: {'AK': 0.84, 'BCC': 0.87, 'BKL': 0.67, 'DF': 0.83, 'MEL': 0.52, 'NV': 0.16, 'SCC': 0.85, 'VASC': 0.64}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           29  ...            0             0
true class BCC            0          102  ...            0             0
true class BKL            0           42  ...            0             0
true class DF             0            9  ...            0             0
true class MEL            0           39  ...            0             0
true class NV             0           25  ...            0             0
true class SCC            0           23  ...            0             0
true class VASC           0            4  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.082

Epoch 42:
Mean loss 1.0825206829170324 - Correctly labeled training images 61.06%
Classified 59.62 % of validation images correctly.
Precision on validation set: [0.   0.38 0.26 0.   0.42 0.72 0.   0.  ]
Recall on validation set: [0.   0.6  0.04 0.   0.38 0.88 0.   0.  ]
F1-score on validation set: [0.   0.46 0.07 0.   0.4  0.79 0.   0.  ]
ROC AUC on validation set: {'AK': 0.82, 'BCC': 0.86, 'BKL': 0.67, 'DF': 0.84, 'MEL': 0.5, 'NV': 0.18, 'SCC': 0.86, 'VASC': 0.67}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           27  ...            0             0
true class BCC            0          100  ...            0             0
true class BKL            0           45  ...            0             0
true class DF             0            7  ...            0             0
true class MEL            0           39  ...            0             0
true class NV             0           23  ...            0             0
true class SCC            0           21  ...            0             0
true class VASC           0            4  ...            0             0

/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
[8 rows x 8 columns]

Current validation loss: 1.087

Epoch 43:
Mean loss 1.0844171940340228 - Correctly labeled training images 60.96%
Classified 59.70 % of validation images correctly.
Precision on validation set: [0.   0.35 0.29 0.   0.49 0.71 0.   0.  ]
Recall on validation set: [0.   0.62 0.05 0.   0.3  0.9  0.   0.  ]
F1-score on validation set: [0.   0.45 0.09 0.   0.37 0.79 0.   0.  ]
ROC AUC on validation set: {'AK': 0.83, 'BCC': 0.86, 'BKL': 0.66, 'DF': 0.82, 'MEL': 0.51, 'NV': 0.17, 'SCC': 0.86, 'VASC': 0.66}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           32  ...            0             0
true class BCC            0          104  ...            0             0
true class BKL            0           47  ...            0             0
true class DF             0            8  ...            0             0
true class MEL            0           46  ...            0             0
true class NV             0           26  ...            0             0
true class SCC            0           26  ...            0             0
true class VASC           0            4  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.085

Epoch 44:
Mean loss 1.0775388836484603 - Correctly labeled training images 61.28%
Classified 61.04 % of validation images correctly.
Precision on validation set: [0.   0.37 0.3  0.   0.52 0.72 0.   0.  ]
Recall on validation set: [0.   0.63 0.05 0.   0.35 0.91 0.   0.  ]
F1-score on validation set: [0.   0.46 0.08 0.   0.41 0.8  0.   0.  ]
ROC AUC on validation set: {'AK': 0.84, 'BCC': 0.86, 'BKL': 0.66, 'DF': 0.82, 'MEL': 0.54, 'NV': 0.16, 'SCC': 0.84, 'VASC': 0.68}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           35  ...            0             0
true class BCC            0          105  ...            0             0
true class BKL            0           45  ...            0             0
true class DF             0            7  ...            0             0
true class MEL            0           43  ...            0             0
true class NV             0           25  ...            0             0
true class SCC            0           22  ...            0             0
true class VASC           0            5  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.085

Epoch 45:
Mean loss 1.073513761679833 - Correctly labeled training images 61.41%
Classified 60.96 % of validation images correctly.
Precision on validation set: [0.   0.37 0.32 0.   0.55 0.71 0.   0.  ]
Recall on validation set: [0.   0.62 0.06 0.   0.36 0.9  0.   0.  ]
F1-score on validation set: [0.   0.46 0.1  0.   0.44 0.8  0.   0.  ]
ROC AUC on validation set: {'AK': 0.83, 'BCC': 0.86, 'BKL': 0.67, 'DF': 0.81, 'MEL': 0.53, 'NV': 0.16, 'SCC': 0.84, 'VASC': 0.69}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           33  ...            0             0
true class BCC            0          103  ...            0             0
true class BKL            0           42  ...            0             0
true class DF             0            7  ...            0             0
true class MEL            0           38  ...            0             0
true class NV             0           28  ...            0             0
true class SCC            0           24  ...            0             0
true class VASC           0            5  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.075

Epoch 46:
Mean loss 1.0624545119726319 - Correctly labeled training images 61.84%
Classified 61.20 % of validation images correctly.
Precision on validation set: [0.   0.38 0.33 0.   0.53 0.71 0.   0.  ]
Recall on validation set: [0.   0.61 0.08 0.   0.32 0.92 0.   0.  ]
F1-score on validation set: [0.   0.47 0.12 0.   0.4  0.8  0.   0.  ]
ROC AUC on validation set: {'AK': 0.84, 'BCC': 0.86, 'BKL': 0.67, 'DF': 0.79, 'MEL': 0.53, 'NV': 0.16, 'SCC': 0.85, 'VASC': 0.68}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           31  ...            0             0
true class BCC            0          102  ...            0             0
true class BKL            0           35  ...            0             0
true class DF             0            8  ...            0             0
true class MEL            0           40  ...            0             0
true class NV             0           22  ...            0             0
true class SCC            0           22  ...            0             0
true class VASC           0            5  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.076

Epoch 47:
Mean loss 1.0634829589997181 - Correctly labeled training images 61.47%
Classified 60.96 % of validation images correctly.
Precision on validation set: [0.   0.4  0.3  0.   0.54 0.71 0.   0.  ]
Recall on validation set: [0.   0.62 0.11 0.   0.33 0.9  0.   0.  ]
F1-score on validation set: [0.   0.49 0.17 0.   0.41 0.79 0.   0.  ]
ROC AUC on validation set: {'AK': 0.82, 'BCC': 0.87, 'BKL': 0.67, 'DF': 0.82, 'MEL': 0.51, 'NV': 0.17, 'SCC': 0.84, 'VASC': 0.65}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           26  ...            0             0
true class BCC            0          104  ...            0             0
true class BKL            0           38  ...            0             0
true class DF             0            7  ...            0             0
true class MEL            0           33  ...            0             0
true class NV             0           28  ...            0             0
true class SCC            0           21  ...            0             0
true class VASC           0            4  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.073

Epoch 48:
Mean loss 1.0629045558088586 - Correctly labeled training images 61.43%
Classified 61.67 % of validation images correctly.
Precision on validation set: [0.   0.41 0.31 0.   0.51 0.73 0.   0.  ]
Recall on validation set: [0.   0.65 0.15 0.   0.36 0.89 0.   0.  ]
F1-score on validation set: [0.   0.51 0.21 0.   0.42 0.8  0.   0.  ]
ROC AUC on validation set: {'AK': 0.83, 'BCC': 0.87, 'BKL': 0.66, 'DF': 0.82, 'MEL': 0.52, 'NV': 0.16, 'SCC': 0.84, 'VASC': 0.67}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           28  ...            0             0
true class BCC            0          109  ...            0             0
true class BKL            0           36  ...            0             0
true class DF             0            8  ...            0             0
true class MEL            0           32  ...            0             0
true class NV             0           27  ...            0             0
true class SCC            0           20  ...            0             0
true class VASC           0            4  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.062

Epoch 49:
Mean loss 1.061667075856627 - Correctly labeled training images 61.89%
Classified 61.51 % of validation images correctly.
Precision on validation set: [0.   0.39 0.29 0.   0.53 0.72 0.   0.  ]
Recall on validation set: [0.   0.65 0.08 0.   0.31 0.92 0.   0.  ]
F1-score on validation set: [0.   0.49 0.12 0.   0.4  0.8  0.   0.  ]
ROC AUC on validation set: {'AK': 0.82, 'BCC': 0.87, 'BKL': 0.66, 'DF': 0.82, 'MEL': 0.52, 'NV': 0.16, 'SCC': 0.84, 'VASC': 0.69}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           30  ...            0             0
true class BCC            0          108  ...            0             0
true class BKL            0           44  ...            0             0
true class DF             0            7  ...            0             0
true class MEL            0           32  ...            0             0
true class NV             0           26  ...            0             0
true class SCC            0           23  ...            0             0
true class VASC           0            5  ...            0             0

/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
[8 rows x 8 columns]

Current validation loss: 1.062

Epoch 50:
Mean loss 1.06134177664477 - Correctly labeled training images 61.65%
Classified 62.07 % of validation images correctly.
Precision on validation set: [0.   0.4  0.41 0.   0.49 0.73 0.   0.  ]
Recall on validation set: [0.   0.65 0.08 0.   0.37 0.91 0.   0.  ]
F1-score on validation set: [0.   0.49 0.14 0.   0.42 0.81 0.   0.  ]
ROC AUC on validation set: {'AK': 0.84, 'BCC': 0.87, 'BKL': 0.66, 'DF': 0.81, 'MEL': 0.5, 'NV': 0.17, 'SCC': 0.85, 'VASC': 0.66}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           31  ...            0             0
true class BCC            0          108  ...            0             0
true class BKL            0           38  ...            0             0
true class DF             0            7  ...            0             0
true class MEL            0           34  ...            0             0
true class NV             0           25  ...            0             0
true class SCC            0           25  ...            0             0
true class VASC           0            4  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.055

Epoch 51:
Mean loss 1.0596618232102801 - Correctly labeled training images 61.85%
Classified 61.36 % of validation images correctly.
Precision on validation set: [0.   0.38 0.44 0.   0.48 0.74 0.   0.  ]
Recall on validation set: [0.   0.69 0.13 0.   0.33 0.89 0.   0.  ]
F1-score on validation set: [0.   0.49 0.2  0.   0.39 0.81 0.   0.  ]
ROC AUC on validation set: {'AK': 0.84, 'BCC': 0.87, 'BKL': 0.68, 'DF': 0.8, 'MEL': 0.52, 'NV': 0.16, 'SCC': 0.84, 'VASC': 0.67}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           32  ...            0             0
true class BCC            0          116  ...            0             0
true class BKL            0           47  ...            0             0
true class DF             0            8  ...            0             0
true class MEL            0           44  ...            0             0
true class NV             0           29  ...            0             0
true class SCC            0           24  ...            0             0
true class VASC           0            4  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.059

Epoch 52:
Mean loss 1.0521130925661382 - Correctly labeled training images 62.05%
Classified 61.36 % of validation images correctly.
Precision on validation set: [0.   0.38 0.42 0.   0.51 0.73 0.   0.  ]
Recall on validation set: [0.   0.7  0.08 0.   0.33 0.89 0.   0.  ]
F1-score on validation set: [0.   0.49 0.14 0.   0.4  0.8  0.   0.  ]
ROC AUC on validation set: {'AK': 0.84, 'BCC': 0.88, 'BKL': 0.67, 'DF': 0.82, 'MEL': 0.51, 'NV': 0.16, 'SCC': 0.83, 'VASC': 0.65}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           34  ...            0             0
true class BCC            0          117  ...            0             0
true class BKL            0           46  ...            0             0
true class DF             0            8  ...            0             0
true class MEL            0           45  ...            0             0
true class NV             0           34  ...            0             0
true class SCC            0           23  ...            0             0
true class VASC           0            4  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.057

Epoch 53:
Mean loss 1.0508305886378424 - Correctly labeled training images 62.41%
Classified 61.44 % of validation images correctly.
Precision on validation set: [0.   0.4  0.37 0.   0.49 0.74 0.   0.  ]
Recall on validation set: [0.   0.63 0.17 0.   0.38 0.88 0.   0.  ]
F1-score on validation set: [0.   0.49 0.23 0.   0.43 0.8  0.   0.  ]
ROC AUC on validation set: {'AK': 0.83, 'BCC': 0.87, 'BKL': 0.67, 'DF': 0.83, 'MEL': 0.51, 'NV': 0.16, 'SCC': 0.85, 'VASC': 0.65}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           29  ...            0             0
true class BCC            0          106  ...            0             0
true class BKL            0           36  ...            0             0
true class DF             0            7  ...            0             0
true class MEL            0           38  ...            0             0
true class NV             0           23  ...            0             0
true class SCC            0           22  ...            0             0
true class VASC           0            4  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.055

Epoch 54:
Mean loss 1.0493455068546138 - Correctly labeled training images 62.34%
Classified 61.99 % of validation images correctly.
Precision on validation set: [0.   0.39 0.4  0.   0.52 0.74 0.   0.  ]
Recall on validation set: [0.   0.68 0.18 0.   0.34 0.89 0.   0.  ]
F1-score on validation set: [0.   0.5  0.25 0.   0.41 0.81 0.   0.  ]
ROC AUC on validation set: {'AK': 0.83, 'BCC': 0.88, 'BKL': 0.67, 'DF': 0.82, 'MEL': 0.52, 'NV': 0.15, 'SCC': 0.84, 'VASC': 0.69}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           31  ...            0             0
true class BCC            0          113  ...            0             0
true class BKL            0           38  ...            0             0
true class DF             0            7  ...            0             0
true class MEL            0           41  ...            0             0
true class NV             0           29  ...            0             0
true class SCC            0           23  ...            0             0
true class VASC           0            5  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.041

Epoch 55:
Mean loss 1.0447977127901011 - Correctly labeled training images 62.30%
Classified 61.83 % of validation images correctly.
Precision on validation set: [0.   0.39 0.44 0.   0.51 0.74 0.   0.  ]
Recall on validation set: [0.   0.72 0.12 0.   0.37 0.87 0.   0.  ]
F1-score on validation set: [0.   0.51 0.19 0.   0.43 0.8  0.   0.  ]
ROC AUC on validation set: {'AK': 0.85, 'BCC': 0.87, 'BKL': 0.66, 'DF': 0.86, 'MEL': 0.53, 'NV': 0.15, 'SCC': 0.84, 'VASC': 0.63}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           33  ...            0             0
true class BCC            0          121  ...            0             0
true class BKL            0           44  ...            0             0
true class DF             0            8  ...            0             0
true class MEL            0           45  ...            0             0
true class NV             0           32  ...            0             0
true class SCC            0           23  ...            0             0
true class VASC           0            4  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.056

Epoch 56:
Mean loss 1.042525155875209 - Correctly labeled training images 62.53%
Classified 60.73 % of validation images correctly.
Precision on validation set: [0.   0.37 0.38 0.   0.47 0.74 0.   0.  ]
Recall on validation set: [0.   0.66 0.14 0.   0.33 0.88 0.   0.  ]
F1-score on validation set: [0.   0.48 0.2  0.   0.39 0.8  0.   0.  ]
ROC AUC on validation set: {'AK': 0.83, 'BCC': 0.87, 'BKL': 0.67, 'DF': 0.81, 'MEL': 0.51, 'NV': 0.16, 'SCC': 0.85, 'VASC': 0.66}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           30  ...            0             0
true class BCC            0          110  ...            0             0
true class BKL            0           46  ...            0             0
true class DF             0            9  ...            0             0
true class MEL            0           43  ...            0             0
true class NV             0           30  ...            0             0
true class SCC            0           24  ...            0             0
true class VASC           0            4  ...            0             0

/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
[8 rows x 8 columns]

Current validation loss: 1.047

Epoch 57:
Mean loss 1.0464316880101285 - Correctly labeled training images 62.56%
Classified 61.51 % of validation images correctly.
Precision on validation set: [0.   0.37 0.43 0.   0.52 0.74 0.   0.  ]
Recall on validation set: [0.   0.68 0.11 0.   0.33 0.89 0.   0.  ]
F1-score on validation set: [0.   0.48 0.18 0.   0.41 0.81 0.   0.  ]
ROC AUC on validation set: {'AK': 0.83, 'BCC': 0.87, 'BKL': 0.68, 'DF': 0.83, 'MEL': 0.53, 'NV': 0.15, 'SCC': 0.85, 'VASC': 0.64}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           33  ...            0             0
true class BCC            0          114  ...            0             0
true class BKL            0           48  ...            0             0
true class DF             0            8  ...            0             0
true class MEL            0           43  ...            0             0
true class NV             0           34  ...            0             0
true class SCC            0           24  ...            0             0
true class VASC           0            4  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.053

Epoch 58:
Mean loss 1.0384376447659562 - Correctly labeled training images 62.31%
Classified 62.38 % of validation images correctly.
Precision on validation set: [0.   0.41 0.34 0.   0.53 0.74 0.   0.  ]
Recall on validation set: [0.   0.69 0.15 0.   0.33 0.9  0.   0.  ]
F1-score on validation set: [0.   0.51 0.2  0.   0.41 0.81 0.   0.  ]
ROC AUC on validation set: {'AK': 0.83, 'BCC': 0.88, 'BKL': 0.66, 'DF': 0.83, 'MEL': 0.5, 'NV': 0.17, 'SCC': 0.85, 'VASC': 0.66}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           27  ...            0             0
true class BCC            0          116  ...            0             0
true class BKL            0           41  ...            0             0
true class DF             0            8  ...            0             0
true class MEL            0           38  ...            0             0
true class NV             0           30  ...            0             0
true class SCC            0           23  ...            0             0
true class VASC           0            3  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.050

Epoch 59:
Mean loss 1.0410186215906112 - Correctly labeled training images 62.51%
Classified 61.75 % of validation images correctly.
Precision on validation set: [0.   0.41 0.38 0.   0.53 0.72 0.   0.  ]
Recall on validation set: [0.   0.64 0.18 0.   0.34 0.9  0.   0.  ]
F1-score on validation set: [0.   0.5  0.24 0.   0.41 0.8  0.   0.  ]
ROC AUC on validation set: {'AK': 0.83, 'BCC': 0.88, 'BKL': 0.67, 'DF': 0.82, 'MEL': 0.53, 'NV': 0.15, 'SCC': 0.85, 'VASC': 0.65}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           27  ...            0             0
true class BCC            0          107  ...            0             0
true class BKL            0           37  ...            0             0
true class DF             0            7  ...            0             0
true class MEL            0           30  ...            0             0
true class NV             0           24  ...            0             0
true class SCC            0           24  ...            0             0
true class VASC           0            3  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.037

Epoch 60:
Mean loss 1.0373667478561401 - Correctly labeled training images 62.70%
Classified 61.83 % of validation images correctly.
Precision on validation set: [0.   0.41 0.35 0.   0.52 0.73 0.   0.  ]
Recall on validation set: [0.   0.72 0.13 0.   0.31 0.9  0.   0.  ]
F1-score on validation set: [0.   0.52 0.19 0.   0.38 0.81 0.   0.  ]
ROC AUC on validation set: {'AK': 0.83, 'BCC': 0.88, 'BKL': 0.66, 'DF': 0.83, 'MEL': 0.51, 'NV': 0.16, 'SCC': 0.84, 'VASC': 0.68}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           31  ...            0             0
true class BCC            0          121  ...            0             0
true class BKL            0           40  ...            0             0
true class DF             0            8  ...            0             0
true class MEL            0           37  ...            0             0
true class NV             0           33  ...            0             0
true class SCC            0           24  ...            0             0
true class VASC           0            4  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.042

Epoch 61:
Mean loss 1.036152393847986 - Correctly labeled training images 62.76%
Classified 62.30 % of validation images correctly.
Precision on validation set: [0.   0.42 0.37 0.   0.55 0.71 0.   0.  ]
Recall on validation set: [0.   0.66 0.11 0.   0.29 0.93 0.   0.  ]
F1-score on validation set: [0.   0.52 0.17 0.   0.38 0.8  0.   0.  ]
ROC AUC on validation set: {'AK': 0.83, 'BCC': 0.88, 'BKL': 0.67, 'DF': 0.81, 'MEL': 0.5, 'NV': 0.16, 'SCC': 0.86, 'VASC': 0.7}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           31  ...            0             0
true class BCC            0          110  ...            0             0
true class BKL            0           36  ...            0             0
true class DF             0            7  ...            0             0
true class MEL            0           28  ...            0             0
true class NV             0           21  ...            0             0
true class SCC            0           22  ...            0             0
true class VASC           0            5  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.047

Epoch 62:
Mean loss 1.029464005201773 - Correctly labeled training images 63.13%
Classified 62.38 % of validation images correctly.
Precision on validation set: [0.   0.41 0.37 0.   0.51 0.74 0.   0.  ]
Recall on validation set: [0.   0.68 0.13 0.   0.39 0.89 0.   0.  ]
F1-score on validation set: [0.   0.51 0.19 0.   0.44 0.81 0.   0.  ]
ROC AUC on validation set: {'AK': 0.82, 'BCC': 0.88, 'BKL': 0.66, 'DF': 0.83, 'MEL': 0.52, 'NV': 0.16, 'SCC': 0.84, 'VASC': 0.7}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           32  ...            0             0
true class BCC            0          114  ...            0             0
true class BKL            0           37  ...            0             0
true class DF             0            8  ...            0             0
true class MEL            0           34  ...            0             0
true class NV             0           27  ...            0             0
true class SCC            0           23  ...            0             0
true class VASC           0            4  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.034

Epoch 63:
Mean loss 1.034455336042759 - Correctly labeled training images 62.94%
Classified 62.15 % of validation images correctly.
Precision on validation set: [0.   0.41 0.29 0.   0.56 0.73 0.   0.  ]
Recall on validation set: [0.   0.66 0.18 0.   0.31 0.91 0.   0.  ]
F1-score on validation set: [0.   0.51 0.22 0.   0.4  0.81 0.   0.  ]
ROC AUC on validation set: {'AK': 0.84, 'BCC': 0.88, 'BKL': 0.66, 'DF': 0.81, 'MEL': 0.53, 'NV': 0.15, 'SCC': 0.84, 'VASC': 0.67}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           30  ...            0             0
true class BCC            0          111  ...            0             0
true class BKL            0           36  ...            0             0
true class DF             0            8  ...            0             0
true class MEL            0           34  ...            0             0
true class NV             0           23  ...            0             0
true class SCC            0           23  ...            0             0
true class VASC           0            3  ...            0             0

/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
[8 rows x 8 columns]

Current validation loss: 1.032

Epoch 64:
Mean loss 1.0272052582788167 - Correctly labeled training images 62.85%
Classified 62.07 % of validation images correctly.
Precision on validation set: [0.   0.4  0.38 0.   0.56 0.72 0.   0.  ]
Recall on validation set: [0.   0.67 0.1  0.   0.32 0.92 0.   0.  ]
F1-score on validation set: [0.   0.5  0.16 0.   0.41 0.8  0.   0.  ]
ROC AUC on validation set: {'AK': 0.84, 'BCC': 0.88, 'BKL': 0.67, 'DF': 0.8, 'MEL': 0.53, 'NV': 0.15, 'SCC': 0.84, 'VASC': 0.66}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           31  ...            0             0
true class BCC            0          112  ...            0             0
true class BKL            0           43  ...            0             0
true class DF             0            7  ...            0             0
true class MEL            0           39  ...            0             0
true class NV             0           24  ...            0             0
true class SCC            0           24  ...            0             0
true class VASC           0            3  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.043

Epoch 65:
Mean loss 1.0269276978277633 - Correctly labeled training images 62.74%
Classified 61.04 % of validation images correctly.
Precision on validation set: [0.   0.4  0.32 0.   0.5  0.73 0.   0.  ]
Recall on validation set: [0.   0.65 0.14 0.   0.33 0.89 0.   0.  ]
F1-score on validation set: [0.   0.49 0.19 0.   0.4  0.8  0.   0.  ]
ROC AUC on validation set: {'AK': 0.84, 'BCC': 0.88, 'BKL': 0.66, 'DF': 0.81, 'MEL': 0.53, 'NV': 0.15, 'SCC': 0.85, 'VASC': 0.65}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           31  ...            0             0
true class BCC            0          109  ...            0             0
true class BKL            0           39  ...            0             0
true class DF             0            8  ...            0             0
true class MEL            0           37  ...            0             0
true class NV             0           22  ...            0             0
true class SCC            0           25  ...            0             0
true class VASC           0            4  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.041

Epoch 66:
Mean loss 1.0313442771555121 - Correctly labeled training images 62.90%
Classified 62.78 % of validation images correctly.
Precision on validation set: [0.   0.43 0.37 0.   0.53 0.74 0.   0.  ]
Recall on validation set: [0.   0.74 0.15 0.   0.32 0.9  0.   0.  ]
F1-score on validation set: [0.   0.54 0.22 0.   0.4  0.81 0.   0.  ]
ROC AUC on validation set: {'AK': 0.83, 'BCC': 0.89, 'BKL': 0.66, 'DF': 0.85, 'MEL': 0.53, 'NV': 0.15, 'SCC': 0.85, 'VASC': 0.67}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           31  ...            0             0
true class BCC            0          123  ...            0             0
true class BKL            0           37  ...            0             0
true class DF             0            9  ...            0             0
true class MEL            0           35  ...            0             0
true class NV             0           23  ...            0             0
true class SCC            0           26  ...            0             0
true class VASC           0            4  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.030

Epoch 67:
Mean loss 1.0184075448791312 - Correctly labeled training images 63.52%
Classified 61.83 % of validation images correctly.
Precision on validation set: [0.   0.41 0.29 0.   0.51 0.75 0.   0.  ]
Recall on validation set: [0.   0.66 0.18 0.   0.35 0.89 0.   0.  ]
F1-score on validation set: [0.   0.5  0.22 0.   0.41 0.81 0.   0.  ]
ROC AUC on validation set: {'AK': 0.84, 'BCC': 0.88, 'BKL': 0.67, 'DF': 0.82, 'MEL': 0.53, 'NV': 0.15, 'SCC': 0.85, 'VASC': 0.67}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           30  ...            0             0
true class BCC            0          111  ...            0             0
true class BKL            0           33  ...            0             0
true class DF             0            9  ...            0             0
true class MEL            0           39  ...            0             0
true class NV             0           23  ...            0             0
true class SCC            0           24  ...            0             0
true class VASC           0            4  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.019

Epoch 68:
Mean loss 1.0165419084040523 - Correctly labeled training images 63.36%
Classified 61.91 % of validation images correctly.
Precision on validation set: [0.   0.42 0.28 0.   0.5  0.73 0.   0.  ]
Recall on validation set: [0.   0.67 0.15 0.   0.31 0.91 0.   0.  ]
F1-score on validation set: [0.   0.52 0.19 0.   0.39 0.81 0.   0.  ]
ROC AUC on validation set: {'AK': 0.83, 'BCC': 0.89, 'BKL': 0.67, 'DF': 0.82, 'MEL': 0.5, 'NV': 0.16, 'SCC': 0.83, 'VASC': 0.71}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           26  ...            0             0
true class BCC            0          112  ...            0             0
true class BKL            0           38  ...            0             0
true class DF             0            7  ...            0             0
true class MEL            0           36  ...            0             0
true class NV             0           21  ...            0             0
true class SCC            0           21  ...            0             0
true class VASC           0            4  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.025

Epoch 69:
Mean loss 1.0152537616833528 - Correctly labeled training images 63.53%
Classified 63.25 % of validation images correctly.
Precision on validation set: [0.   0.42 0.39 0.   0.55 0.74 0.   0.  ]
Recall on validation set: [0.   0.72 0.15 0.   0.34 0.91 0.   0.  ]
F1-score on validation set: [0.   0.53 0.21 0.   0.42 0.82 0.   0.  ]
ROC AUC on validation set: {'AK': 0.83, 'BCC': 0.89, 'BKL': 0.67, 'DF': 0.82, 'MEL': 0.51, 'NV': 0.16, 'SCC': 0.84, 'VASC': 0.66}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           31  ...            0             0
true class BCC            0          120  ...            0             0
true class BKL            0           37  ...            0             0
true class DF             0            8  ...            0             0
true class MEL            0           38  ...            0             0
true class NV             0           25  ...            0             0
true class SCC            0           24  ...            0             0
true class VASC           0            4  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.024

Epoch 70:
Mean loss 1.0152711181986596 - Correctly labeled training images 63.65%
Classified 62.85 % of validation images correctly.
Precision on validation set: [0.   0.41 0.36 0.   0.57 0.75 0.   0.  ]
Recall on validation set: [0.   0.8  0.12 0.   0.31 0.9  0.   0.  ]
F1-score on validation set: [0.   0.54 0.18 0.   0.4  0.82 0.   0.  ]
ROC AUC on validation set: {'AK': 0.83, 'BCC': 0.89, 'BKL': 0.67, 'DF': 0.8, 'MEL': 0.53, 'NV': 0.15, 'SCC': 0.85, 'VASC': 0.64}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           30  ...            0             0
true class BCC            0          133  ...            0             0
true class BKL            0           48  ...            0             0
true class DF             0            9  ...            0             0
true class MEL            0           47  ...            0             0
true class NV             0           31  ...            0             0
true class SCC            0           26  ...            0             0
true class VASC           0            4  ...            0             0

/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
[8 rows x 8 columns]

Current validation loss: 1.041

Epoch 71:
Mean loss 1.0130540104318493 - Correctly labeled training images 63.65%
Classified 61.59 % of validation images correctly.
Precision on validation set: [0.   0.41 0.31 0.   0.52 0.72 0.   0.  ]
Recall on validation set: [0.   0.65 0.16 0.   0.28 0.91 0.   0.  ]
F1-score on validation set: [0.   0.5  0.21 0.   0.36 0.81 0.   0.  ]
ROC AUC on validation set: {'AK': 0.83, 'BCC': 0.89, 'BKL': 0.66, 'DF': 0.84, 'MEL': 0.52, 'NV': 0.15, 'SCC': 0.86, 'VASC': 0.66}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           29  ...            0             0
true class BCC            0          109  ...            0             0
true class BKL            0           37  ...            0             0
true class DF             0            9  ...            0             0
true class MEL            0           36  ...            0             0
true class NV             0           20  ...            0             0
true class SCC            0           24  ...            0             0
true class VASC           0            3  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.020

Epoch 72:
Mean loss 1.00693072044887 - Correctly labeled training images 63.93%
Classified 62.15 % of validation images correctly.
Precision on validation set: [0.   0.42 0.35 0.   0.55 0.72 0.   0.  ]
Recall on validation set: [0.   0.65 0.18 0.   0.31 0.91 0.   0.  ]
F1-score on validation set: [0.   0.51 0.23 0.   0.39 0.8  0.   0.  ]
ROC AUC on validation set: {'AK': 0.82, 'BCC': 0.89, 'BKL': 0.66, 'DF': 0.83, 'MEL': 0.53, 'NV': 0.15, 'SCC': 0.84, 'VASC': 0.68}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           27  ...            0             0
true class BCC            0          108  ...            0             0
true class BKL            0           32  ...            0             0
true class DF             0            9  ...            0             0
true class MEL            0           34  ...            0             0
true class NV             0           22  ...            0             0
true class SCC            0           24  ...            0             0
true class VASC           0            4  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.026

Epoch 73:
Mean loss 1.0061529024918372 - Correctly labeled training images 63.73%
Classified 62.70 % of validation images correctly.
Precision on validation set: [0.   0.42 0.35 0.   0.56 0.74 0.   0.  ]
Recall on validation set: [0.   0.67 0.21 0.   0.33 0.9  0.   0.  ]
F1-score on validation set: [0.   0.51 0.26 0.   0.41 0.81 0.   0.  ]
ROC AUC on validation set: {'AK': 0.83, 'BCC': 0.89, 'BKL': 0.67, 'DF': 0.84, 'MEL': 0.52, 'NV': 0.15, 'SCC': 0.85, 'VASC': 0.67}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           29  ...            0             0
true class BCC            0          112  ...            0             0
true class BKL            0           37  ...            0             0
true class DF             0            9  ...            0             0
true class MEL            0           28  ...            0             0
true class NV             0           27  ...            0             0
true class SCC            0           22  ...            0             0
true class VASC           0            4  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.022

Epoch 74:
Mean loss 1.0017288380804874 - Correctly labeled training images 63.95%
Classified 61.99 % of validation images correctly.
Precision on validation set: [0.   0.4  0.34 0.   0.55 0.72 0.   0.  ]
Recall on validation set: [0.   0.69 0.13 0.   0.31 0.91 0.   0.  ]
F1-score on validation set: [0.   0.51 0.19 0.   0.39 0.81 0.   0.  ]
ROC AUC on validation set: {'AK': 0.84, 'BCC': 0.89, 'BKL': 0.66, 'DF': 0.81, 'MEL': 0.52, 'NV': 0.15, 'SCC': 0.85, 'VASC': 0.65}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           31  ...            0             0
true class BCC            0          115  ...            0             0
true class BKL            0           37  ...            0             0
true class DF             0            8  ...            0             0
true class MEL            0           37  ...            0             0
true class NV             0           27  ...            0             0
true class SCC            0           25  ...            0             0
true class VASC           0            4  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.025

Epoch 75:
Mean loss 1.0060478549462388 - Correctly labeled training images 63.82%
Classified 63.56 % of validation images correctly.
Precision on validation set: [0.   0.41 0.41 0.   0.57 0.76 0.   0.  ]
Recall on validation set: [0.   0.77 0.18 0.   0.34 0.9  0.   0.  ]
F1-score on validation set: [0.   0.53 0.25 0.   0.43 0.82 0.   0.  ]
ROC AUC on validation set: {'AK': 0.82, 'BCC': 0.89, 'BKL': 0.66, 'DF': 0.83, 'MEL': 0.51, 'NV': 0.15, 'SCC': 0.85, 'VASC': 0.7}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           34  ...            0             0
true class BCC            0          129  ...            0             0
true class BKL            0           44  ...            0             0
true class DF             0            9  ...            0             0
true class MEL            0           41  ...            0             0
true class NV             0           29  ...            0             0
true class SCC            0           26  ...            0             0
true class VASC           0            5  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.016

Epoch 76:
Mean loss 0.9993989625563757 - Correctly labeled training images 64.01%
Classified 63.56 % of validation images correctly.
Precision on validation set: [0.   0.43 0.38 0.   0.54 0.75 0.   0.  ]
Recall on validation set: [0.   0.74 0.22 0.   0.31 0.91 0.   0.  ]
F1-score on validation set: [0.   0.55 0.28 0.   0.39 0.82 0.   0.  ]
ROC AUC on validation set: {'AK': 0.84, 'BCC': 0.89, 'BKL': 0.66, 'DF': 0.84, 'MEL': 0.52, 'NV': 0.15, 'SCC': 0.84, 'VASC': 0.67}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           30  ...            0             0
true class BCC            0          124  ...            0             0
true class BKL            0           39  ...            0             0
true class DF             0            8  ...            0             0
true class MEL            0           36  ...            0             0
true class NV             0           24  ...            0             0
true class SCC            0           23  ...            0             0
true class VASC           0            4  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.012

Epoch 77:
Mean loss 1.0018790778865574 - Correctly labeled training images 63.95%
Classified 63.49 % of validation images correctly.
Precision on validation set: [0.   0.43 0.38 0.   0.55 0.74 0.   0.  ]
Recall on validation set: [0.   0.69 0.19 0.   0.31 0.92 0.   0.  ]
F1-score on validation set: [0.   0.53 0.25 0.   0.4  0.82 0.   0.  ]
ROC AUC on validation set: {'AK': 0.84, 'BCC': 0.89, 'BKL': 0.66, 'DF': 0.86, 'MEL': 0.52, 'NV': 0.15, 'SCC': 0.84, 'VASC': 0.69}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           31  ...            0             0
true class BCC            0          115  ...            0             0
true class BKL            0           33  ...            0             0
true class DF             0            9  ...            0             0
true class MEL            0           33  ...            0             0
true class NV             0           20  ...            0             0
true class SCC            0           24  ...            0             0
true class VASC           0            3  ...            0             0

/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
[8 rows x 8 columns]

Current validation loss: 1.013

Epoch 78:
Mean loss 0.9988537286922383 - Correctly labeled training images 63.91%
Classified 63.72 % of validation images correctly.
Precision on validation set: [0.   0.4  0.44 0.   0.56 0.76 0.   0.  ]
Recall on validation set: [0.   0.74 0.17 0.   0.35 0.91 0.   0.  ]
F1-score on validation set: [0.   0.52 0.24 0.   0.43 0.83 0.   0.  ]
ROC AUC on validation set: {'AK': 0.83, 'BCC': 0.89, 'BKL': 0.67, 'DF': 0.82, 'MEL': 0.52, 'NV': 0.15, 'SCC': 0.83, 'VASC': 0.66}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           35  ...            0             0
true class BCC            0          124  ...            0             0
true class BKL            0           46  ...            0             0
true class DF             0            8  ...            0             0
true class MEL            0           38  ...            0             0
true class NV             0           30  ...            0             0
true class SCC            0           24  ...            0             0
true class VASC           0            5  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.011

Epoch 79:
Mean loss 0.9985025989990505 - Correctly labeled training images 64.36%
Classified 62.70 % of validation images correctly.
Precision on validation set: [0.   0.41 0.37 0.   0.51 0.75 0.   0.  ]
Recall on validation set: [0.   0.69 0.15 0.   0.39 0.89 0.   0.  ]
F1-score on validation set: [0.   0.52 0.22 0.   0.44 0.81 0.   0.  ]
ROC AUC on validation set: {'AK': 0.84, 'BCC': 0.89, 'BKL': 0.66, 'DF': 0.84, 'MEL': 0.52, 'NV': 0.15, 'SCC': 0.85, 'VASC': 0.69}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           28  ...            0             0
true class BCC            0          116  ...            0             0
true class BKL            0           37  ...            0             0
true class DF             0            9  ...            0             0
true class MEL            0           33  ...            1             0
true class NV             0           27  ...            0             0
true class SCC            0           26  ...            0             0
true class VASC           0            4  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.009

Epoch 80:
Mean loss 0.9952108781984552 - Correctly labeled training images 64.12%
Classified 62.70 % of validation images correctly.
Precision on validation set: [0.   0.41 0.4  0.   0.56 0.73 0.   0.  ]
Recall on validation set: [0.   0.72 0.16 0.   0.29 0.91 0.   0.  ]
F1-score on validation set: [0.   0.52 0.23 0.   0.38 0.81 0.   0.  ]
ROC AUC on validation set: {'AK': 0.83, 'BCC': 0.89, 'BKL': 0.65, 'DF': 0.81, 'MEL': 0.52, 'NV': 0.16, 'SCC': 0.84, 'VASC': 0.71}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           32  ...            0             0
true class BCC            0          120  ...            0             0
true class BKL            0           42  ...            0             0
true class DF             0            7  ...            0             0
true class MEL            0           36  ...            0             0
true class NV             0           25  ...            0             0
true class SCC            0           25  ...            0             0
true class VASC           0            5  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.015

Epoch 81:
Mean loss 0.9914613776026464 - Correctly labeled training images 64.40%
Classified 63.25 % of validation images correctly.
Precision on validation set: [0.   0.43 0.37 0.   0.54 0.74 0.   0.  ]
Recall on validation set: [0.   0.71 0.17 0.   0.36 0.9  0.   0.  ]
F1-score on validation set: [0.   0.54 0.23 0.   0.43 0.81 0.   0.  ]
ROC AUC on validation set: {'AK': 0.83, 'BCC': 0.89, 'BKL': 0.65, 'DF': 0.82, 'MEL': 0.53, 'NV': 0.15, 'SCC': 0.84, 'VASC': 0.7}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           30  ...            0             0
true class BCC            0          118  ...            0             0
true class BKL            0           35  ...            0             0
true class DF             0            8  ...            0             0
true class MEL            0           31  ...            0             0
true class NV             0           22  ...            0             0
true class SCC            0           26  ...            0             0
true class VASC           0            4  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.010

Epoch 82:
Mean loss 0.991767641309684 - Correctly labeled training images 64.20%
Classified 63.56 % of validation images correctly.
Precision on validation set: [0.   0.47 0.38 0.   0.55 0.72 0.   0.  ]
Recall on validation set: [0.   0.69 0.15 0.   0.32 0.93 0.   0.  ]
F1-score on validation set: [0.   0.56 0.22 0.   0.4  0.81 0.   0.  ]
ROC AUC on validation set: {'AK': 0.83, 'BCC': 0.9, 'BKL': 0.64, 'DF': 0.84, 'MEL': 0.53, 'NV': 0.15, 'SCC': 0.86, 'VASC': 0.69}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           29  ...            0             0
true class BCC            0          115  ...            1             0
true class BKL            0           27  ...            0             0
true class DF             0            8  ...            0             0
true class MEL            0           22  ...            1             0
true class NV             0           16  ...            0             0
true class SCC            0           24  ...            0             0
true class VASC           0            5  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.008

Epoch 83:
Mean loss 0.9902961736409822 - Correctly labeled training images 64.51%
Classified 63.49 % of validation images correctly.
Precision on validation set: [0.   0.45 0.38 0.   0.51 0.74 0.   0.  ]
Recall on validation set: [0.   0.66 0.19 0.   0.38 0.91 0.   0.  ]
F1-score on validation set: [0.   0.53 0.26 0.   0.43 0.82 0.   0.  ]
ROC AUC on validation set: {'AK': 0.83, 'BCC': 0.9, 'BKL': 0.66, 'DF': 0.82, 'MEL': 0.53, 'NV': 0.14, 'SCC': 0.85, 'VASC': 0.7}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           26  ...            0             0
true class BCC            0          110  ...            0             0
true class BKL            0           29  ...            0             0
true class DF             0            8  ...            0             0
true class MEL            1           29  ...            0             0
true class NV             0           16  ...            0             0
true class SCC            0           24  ...            0             0
true class VASC           0            3  ...            0             0

[8 rows x 8 columns]

Current validation loss: 0.997

Epoch 84:
Mean loss 0.9843298499516508 - Correctly labeled training images 64.55%
Classified 63.33 % of validation images correctly.
Precision on validation set: [0.   0.44 0.43 0.   0.54 0.73 0.   0.  ]
Recall on validation set: [0.   0.71 0.18 0.   0.33 0.91 0.   0.  ]
F1-score on validation set: [0.   0.54 0.25 0.   0.41 0.81 0.   0.  ]
ROC AUC on validation set: {'AK': 0.83, 'BCC': 0.89, 'BKL': 0.65, 'DF': 0.84, 'MEL': 0.53, 'NV': 0.15, 'SCC': 0.86, 'VASC': 0.66}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           31  ...            0             0
true class BCC            0          118  ...            0             0
true class BKL            0           31  ...            0             0
true class DF             0            9  ...            0             0
true class MEL            0           32  ...            0             0
true class NV             0           21  ...            0             0
true class SCC            0           24  ...            0             0
true class VASC           0            4  ...            0             0

/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
[8 rows x 8 columns]

Current validation loss: 1.008

Epoch 85:
Mean loss 0.9863158159827584 - Correctly labeled training images 64.35%
Classified 64.12 % of validation images correctly.
Precision on validation set: [0.   0.44 0.36 0.   0.55 0.76 0.   0.  ]
Recall on validation set: [0.   0.72 0.19 0.   0.39 0.9  0.   0.  ]
F1-score on validation set: [0.   0.55 0.25 0.   0.46 0.82 0.   0.  ]
ROC AUC on validation set: {'AK': 0.83, 'BCC': 0.89, 'BKL': 0.64, 'DF': 0.85, 'MEL': 0.5, 'NV': 0.17, 'SCC': 0.85, 'VASC': 0.65}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           29  ...            0             0
true class BCC            0          121  ...            0             0
true class BKL            0           31  ...            0             0
true class DF             0            9  ...            0             0
true class MEL            0           30  ...            1             0
true class NV             0           25  ...            0             0
true class SCC            0           23  ...            0             0
true class VASC           0            5  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.014

Epoch 86:
Mean loss 0.9817224119551926 - Correctly labeled training images 64.38%
Classified 62.93 % of validation images correctly.
Precision on validation set: [0.   0.43 0.4  0.   0.51 0.75 0.   0.  ]
Recall on validation set: [0.   0.72 0.19 0.   0.38 0.88 0.   0.  ]
F1-score on validation set: [0.   0.54 0.26 0.   0.43 0.81 0.   0.  ]
ROC AUC on validation set: {'AK': 0.83, 'BCC': 0.89, 'BKL': 0.65, 'DF': 0.82, 'MEL': 0.51, 'NV': 0.16, 'SCC': 0.85, 'VASC': 0.7}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           31  ...            0             0
true class BCC            0          121  ...            0             0
true class BKL            0           32  ...            0             0
true class DF             0            7  ...            0             0
true class MEL            0           34  ...            0             0
true class NV             0           26  ...            0             0
true class SCC            0           27  ...            0             0
true class VASC           0            4  ...            0             0

[8 rows x 8 columns]

Current validation loss: 0.995

Epoch 87:
Mean loss 0.9761012626183145 - Correctly labeled training images 64.91%
Classified 64.20 % of validation images correctly.
Precision on validation set: [1.   0.44 0.37 0.   0.56 0.75 0.   0.  ]
Recall on validation set: [0.02 0.75 0.19 0.   0.34 0.91 0.   0.  ]
F1-score on validation set: [0.05 0.55 0.25 0.   0.42 0.83 0.   0.  ]
ROC AUC on validation set: {'AK': 0.83, 'BCC': 0.9, 'BKL': 0.65, 'DF': 0.83, 'MEL': 0.51, 'NV': 0.16, 'SCC': 0.85, 'VASC': 0.65}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             1           30  ...            0             0
true class BCC            0          125  ...            0             0
true class BKL            0           35  ...            0             0
true class DF             0            8  ...            0             0
true class MEL            0           37  ...            1             0
true class NV             0           21  ...            0             0
true class SCC            0           26  ...            0             0
true class VASC           0            3  ...            0             0

[8 rows x 8 columns]

Current validation loss: 0.991

Epoch 88:
Mean loss 0.9767930229379551 - Correctly labeled training images 64.56%
Classified 63.88 % of validation images correctly.
Precision on validation set: [1.   0.46 0.39 0.   0.56 0.74 0.   0.  ]
Recall on validation set: [0.02 0.72 0.22 0.   0.31 0.92 0.   0.  ]
F1-score on validation set: [0.05 0.56 0.28 0.   0.39 0.82 0.   0.  ]
ROC AUC on validation set: {'AK': 0.82, 'BCC': 0.9, 'BKL': 0.65, 'DF': 0.82, 'MEL': 0.53, 'NV': 0.15, 'SCC': 0.86, 'VASC': 0.66}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             1           28  ...            0             0
true class BCC            0          120  ...            1             0
true class BKL            0           28  ...            0             0
true class DF             0            8  ...            0             0
true class MEL            0           31  ...            1             0
true class NV             0           19  ...            0             0
true class SCC            0           25  ...            0             0
true class VASC           0            3  ...            0             0

[8 rows x 8 columns]

Current validation loss: 1.006

Epoch 89:
Mean loss 0.9750998000429256 - Correctly labeled training images 64.80%
Classified 64.12 % of validation images correctly.
Precision on validation set: [0.   0.43 0.38 0.   0.56 0.77 0.   0.  ]
Recall on validation set: [0.   0.73 0.25 0.   0.35 0.9  0.   0.  ]
F1-score on validation set: [0.   0.54 0.3  0.   0.43 0.83 0.   0.  ]
ROC AUC on validation set: {'AK': 0.81, 'BCC': 0.9, 'BKL': 0.66, 'DF': 0.83, 'MEL': 0.52, 'NV': 0.15, 'SCC': 0.86, 'VASC': 0.73}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           29  ...            0             0
true class BCC            1          122  ...            1             0
true class BKL            0           36  ...            0             0
true class DF             0            9  ...            0             0
true class MEL            0           32  ...            1             0
true class NV             0           24  ...            0             0
true class SCC            0           26  ...            0             0
true class VASC           0            5  ...            0             0

[8 rows x 8 columns]

Current validation loss: 0.982

Epoch 90:
Mean loss 0.9714228717686626 - Correctly labeled training images 64.60%
Classified 63.49 % of validation images correctly.
Precision on validation set: [0.5  0.46 0.33 0.   0.55 0.75 0.   0.  ]
Recall on validation set: [0.02 0.66 0.28 0.   0.33 0.9  0.   0.  ]
F1-score on validation set: [0.04 0.54 0.3  0.   0.41 0.82 0.   0.  ]
ROC AUC on validation set: {'AK': 0.83, 'BCC': 0.9, 'BKL': 0.65, 'DF': 0.81, 'MEL': 0.54, 'NV': 0.15, 'SCC': 0.84, 'VASC': 0.69}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             1           26  ...            0             0
true class BCC            0          111  ...            0             0
true class BKL            0           26  ...            0             0
true class DF             0            7  ...            0             0
true class MEL            0           30  ...            1             0
true class NV             0           18  ...            0             0
true class SCC            1           19  ...            0             0
true class VASC           0            5  ...            0             0

[8 rows x 8 columns]

Current validation loss: 0.991

Epoch 91:
Mean loss 0.9678643936238455 - Correctly labeled training images 65.15%
Classified 63.88 % of validation images correctly.
Precision on validation set: [0.   0.48 0.35 0.   0.55 0.73 0.   0.  ]
Recall on validation set: [0.   0.67 0.21 0.   0.35 0.92 0.   0.  ]
F1-score on validation set: [0.   0.56 0.26 0.   0.43 0.81 0.   0.  ]
ROC AUC on validation set: {'AK': 0.82, 'BCC': 0.91, 'BKL': 0.65, 'DF': 0.8, 'MEL': 0.52, 'NV': 0.15, 'SCC': 0.84, 'VASC': 0.7}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           22  ...            0             0
true class BCC            0          112  ...            0             0
true class BKL            0           30  ...            0             0
true class DF             0            6  ...            0             0
true class MEL            0           26  ...            1             0
true class NV             0           17  ...            0             0
true class SCC            0           19  ...            0             0
true class VASC           0            3  ...            0             0

/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
[8 rows x 8 columns]

Current validation loss: 0.986

Epoch 92:
Mean loss 0.9666228478639284 - Correctly labeled training images 65.17%
Classified 64.51 % of validation images correctly.
Precision on validation set: [0.   0.43 0.41 0.   0.58 0.76 0.   0.  ]
Recall on validation set: [0.   0.75 0.23 0.   0.36 0.9  0.   0.  ]
F1-score on validation set: [0.   0.55 0.29 0.   0.44 0.83 0.   0.  ]
ROC AUC on validation set: {'AK': 0.83, 'BCC': 0.9, 'BKL': 0.66, 'DF': 0.82, 'MEL': 0.53, 'NV': 0.15, 'SCC': 0.86, 'VASC': 0.68}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           30  ...            0             0
true class BCC            0          126  ...            1             0
true class BKL            1           38  ...            0             0
true class DF             0            8  ...            0             0
true class MEL            0           34  ...            1             0
true class NV             0           27  ...            0             0
true class SCC            1           24  ...            0             0
true class VASC           0            4  ...            0             0

[8 rows x 8 columns]

Current validation loss: 0.979

Epoch 93:
Mean loss 0.9682289962700865 - Correctly labeled training images 65.09%
Classified 63.49 % of validation images correctly.
Precision on validation set: [0.   0.46 0.34 0.   0.54 0.75 0.   0.  ]
Recall on validation set: [0.   0.62 0.26 0.   0.39 0.9  0.   0.  ]
F1-score on validation set: [0.   0.53 0.29 0.   0.45 0.82 0.   0.  ]
ROC AUC on validation set: {'AK': 0.82, 'BCC': 0.9, 'BKL': 0.65, 'DF': 0.83, 'MEL': 0.53, 'NV': 0.15, 'SCC': 0.84, 'VASC': 0.7}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           23  ...            0             0
true class BCC            0          104  ...            1             1
true class BKL            0           25  ...            0             0
true class DF             0            8  ...            0             0
true class MEL            1           25  ...            0             0
true class NV             0           18  ...            0             0
true class SCC            2           19  ...            0             0
true class VASC           0            4  ...            0             0

[8 rows x 8 columns]

Current validation loss: 0.994

Epoch 94:
Mean loss 0.964808050296284 - Correctly labeled training images 65.26%
Classified 64.35 % of validation images correctly.
Precision on validation set: [0.   0.44 0.38 0.   0.56 0.77 0.   0.  ]
Recall on validation set: [0.   0.75 0.23 0.   0.4  0.89 0.   0.  ]
F1-score on validation set: [0.   0.55 0.28 0.   0.47 0.83 0.   0.  ]
ROC AUC on validation set: {'AK': 0.82, 'BCC': 0.9, 'BKL': 0.64, 'DF': 0.81, 'MEL': 0.53, 'NV': 0.15, 'SCC': 0.85, 'VASC': 0.73}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           29  ...            0             0
true class BCC            1          125  ...            0             0
true class BKL            0           34  ...            0             0
true class DF             0            8  ...            0             0
true class MEL            0           39  ...            1             0
true class NV             0           23  ...            0             0
true class SCC            2           23  ...            0             0
true class VASC           0            5  ...            0             0

[8 rows x 8 columns]

Current validation loss: 0.978

Epoch 95:
Mean loss 0.9643518527505526 - Correctly labeled training images 65.19%
Classified 63.49 % of validation images correctly.
Precision on validation set: [0.33 0.48 0.38 0.   0.55 0.71 0.   0.  ]
Recall on validation set: [0.02 0.63 0.21 0.   0.32 0.93 0.   0.  ]
F1-score on validation set: [0.04 0.54 0.27 0.   0.41 0.81 0.   0.  ]
ROC AUC on validation set: {'AK': 0.82, 'BCC': 0.9, 'BKL': 0.65, 'DF': 0.81, 'MEL': 0.54, 'NV': 0.14, 'SCC': 0.86, 'VASC': 0.72}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             1           23  ...            0             0
true class BCC            0          105  ...            1             0
true class BKL            1           23  ...            0             0
true class DF             0            6  ...            0             0
true class MEL            0           24  ...            1             0
true class NV             0           12  ...            0             0
true class SCC            1           22  ...            0             0
true class VASC           0            4  ...            0             0

[8 rows x 8 columns]

Current validation loss: 0.986

Epoch 96:
Mean loss 0.9632488554490477 - Correctly labeled training images 65.18%
Classified 64.04 % of validation images correctly.
Precision on validation set: [0.   0.48 0.39 0.   0.6  0.71 0.   0.  ]
Recall on validation set: [0.   0.69 0.21 0.   0.28 0.94 0.   0.  ]
F1-score on validation set: [0.   0.57 0.28 0.   0.38 0.81 0.   0.  ]
ROC AUC on validation set: {'AK': 0.81, 'BCC': 0.91, 'BKL': 0.65, 'DF': 0.83, 'MEL': 0.52, 'NV': 0.15, 'SCC': 0.84, 'VASC': 0.76}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           24  ...            0             0
true class BCC            0          115  ...            1             0
true class BKL            1           23  ...            0             0
true class DF             0            8  ...            0             0
true class MEL            0           29  ...            1             0
true class NV             0           13  ...            0             0
true class SCC            1           21  ...            0             0
true class VASC           0            5  ...            0             0

[8 rows x 8 columns]

Current validation loss: 0.996

Epoch 97:
Mean loss 0.9531933846251822 - Correctly labeled training images 65.46%
Classified 63.72 % of validation images correctly.
Precision on validation set: [0.2  0.45 0.37 0.   0.55 0.75 0.   0.  ]
Recall on validation set: [0.02 0.71 0.2  0.   0.37 0.9  0.   0.  ]
F1-score on validation set: [0.04 0.55 0.26 0.   0.44 0.82 0.   0.  ]
ROC AUC on validation set: {'AK': 0.81, 'BCC': 0.9, 'BKL': 0.65, 'DF': 0.83, 'MEL': 0.53, 'NV': 0.15, 'SCC': 0.85, 'VASC': 0.7}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             1           26  ...            0             0
true class BCC            1          118  ...            0             0
true class BKL            1           34  ...            0             0
true class DF             0            8  ...            0             0
true class MEL            0           31  ...            1             0
true class NV             0           21  ...            0             0
true class SCC            2           20  ...            0             0
true class VASC           0            5  ...            0             0

[8 rows x 8 columns]

Current validation loss: 0.982

Epoch 98:
Mean loss 0.9535798431382947 - Correctly labeled training images 65.96%
Classified 63.17 % of validation images correctly.
Precision on validation set: [0.   0.46 0.34 0.   0.53 0.74 0.   0.  ]
Recall on validation set: [0.   0.69 0.21 0.   0.35 0.9  0.   0.  ]
F1-score on validation set: [0.   0.55 0.26 0.   0.42 0.81 0.   0.  ]
ROC AUC on validation set: {'AK': 0.81, 'BCC': 0.9, 'BKL': 0.66, 'DF': 0.82, 'MEL': 0.51, 'NV': 0.16, 'SCC': 0.84, 'VASC': 0.74}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           25  ...            0             0
true class BCC            0          115  ...            0             0
true class BKL            0           33  ...            0             0
true class DF             0            8  ...            0             0
true class MEL            1           27  ...            1             0
true class NV             0           22  ...            0             0
true class SCC            0           17  ...            0             0
true class VASC           0            5  ...            0             0

/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
[8 rows x 8 columns]

Current validation loss: 0.983

Epoch 99:
Mean loss 0.9559383639119777 - Correctly labeled training images 65.51%
Classified 63.88 % of validation images correctly.
Precision on validation set: [0.4  0.49 0.37 0.   0.57 0.72 0.   0.  ]
Recall on validation set: [0.05 0.65 0.25 0.   0.3  0.93 0.   0.  ]
F1-score on validation set: [0.08 0.56 0.3  0.   0.39 0.81 0.   0.  ]
ROC AUC on validation set: {'AK': 0.82, 'BCC': 0.91, 'BKL': 0.64, 'DF': 0.81, 'MEL': 0.53, 'NV': 0.15, 'SCC': 0.86, 'VASC': 0.71}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             2           21  ...            0             0
true class BCC            1          108  ...            0             0
true class BKL            0           21  ...            0             0
true class DF             0            8  ...            0             0
true class MEL            1           24  ...            0             0
true class NV             0           14  ...            0             0
true class SCC            1           21  ...            0             0
true class VASC           0            4  ...            0             0

[8 rows x 8 columns]

Current validation loss: 0.983

Epoch 100:
Mean loss 0.9545857662846238 - Correctly labeled training images 65.47%
Classified 63.56 % of validation images correctly.
Precision on validation set: [0.   0.44 0.36 0.   0.52 0.77 0.   0.  ]
Recall on validation set: [0.   0.72 0.21 0.   0.38 0.89 0.   0.  ]
F1-score on validation set: [0.   0.54 0.26 0.   0.43 0.82 0.   0.  ]
ROC AUC on validation set: {'AK': 0.8, 'BCC': 0.9, 'BKL': 0.65, 'DF': 0.78, 'MEL': 0.52, 'NV': 0.16, 'SCC': 0.83, 'VASC': 0.77}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           28  ...            0             0
true class BCC            0          120  ...            1             0
true class BKL            2           34  ...            0             0
true class DF             0            8  ...            0             0
true class MEL            0           34  ...            1             0
true class NV             0           23  ...            0             0
true class SCC            0           22  ...            0             0
true class VASC           0            6  ...            0             0

[8 rows x 8 columns]

Current validation loss: 0.981

Epoch 101:
Mean loss 0.9551709005697292 - Correctly labeled training images 65.53%
Classified 63.80 % of validation images correctly.
Precision on validation set: [0.25 0.45 0.39 0.   0.54 0.75 0.   0.  ]
Recall on validation set: [0.05 0.74 0.24 0.   0.33 0.9  0.   0.  ]
F1-score on validation set: [0.08 0.56 0.29 0.   0.41 0.82 0.   0.  ]
ROC AUC on validation set: {'AK': 0.81, 'BCC': 0.91, 'BKL': 0.63, 'DF': 0.8, 'MEL': 0.52, 'NV': 0.16, 'SCC': 0.85, 'VASC': 0.74}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             2           27  ...            0             0
true class BCC            1          124  ...            1             1
true class BKL            1           30  ...            0             0
true class DF             0            8  ...            0             0
true class MEL            2           33  ...            0             0
true class NV             0           24  ...            0             0
true class SCC            2           22  ...            0             0
true class VASC           0            7  ...            0             0

[8 rows x 8 columns]

Current validation loss: 0.970

Epoch 102:
Mean loss 0.9502902528276955 - Correctly labeled training images 65.59%
Classified 63.72 % of validation images correctly.
Precision on validation set: [0.2  0.47 0.36 0.   0.54 0.75 0.   0.  ]
Recall on validation set: [0.02 0.72 0.22 0.   0.35 0.9  0.   0.  ]
F1-score on validation set: [0.04 0.56 0.27 0.   0.42 0.81 0.   0.  ]
ROC AUC on validation set: {'AK': 0.82, 'BCC': 0.9, 'BKL': 0.64, 'DF': 0.84, 'MEL': 0.51, 'NV': 0.16, 'SCC': 0.85, 'VASC': 0.72}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             1           26  ...            0             0
true class BCC            1          120  ...            0             0
true class BKL            1           30  ...            0             0
true class DF             0            7  ...            0             0
true class MEL            0           30  ...            1             0
true class NV             0           19  ...            0             0
true class SCC            2           21  ...            0             0
true class VASC           0            5  ...            0             0

[8 rows x 8 columns]

Current validation loss: 0.975

Epoch 103:
Mean loss 0.9513894068517895 - Correctly labeled training images 65.77%
Classified 63.56 % of validation images correctly.
Precision on validation set: [0.25 0.43 0.4  0.   0.55 0.75 0.   0.  ]
Recall on validation set: [0.02 0.74 0.19 0.   0.35 0.9  0.   0.  ]
F1-score on validation set: [0.04 0.54 0.26 0.   0.42 0.82 0.   0.  ]
ROC AUC on validation set: {'AK': 0.83, 'BCC': 0.91, 'BKL': 0.64, 'DF': 0.81, 'MEL': 0.52, 'NV': 0.15, 'SCC': 0.86, 'VASC': 0.74}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             1           31  ...            0             0
true class BCC            0          124  ...            0             0
true class BKL            1           39  ...            0             0
true class DF             0            8  ...            0             0
true class MEL            0           38  ...            1             0
true class NV             0           23  ...            0             0
true class SCC            2           22  ...            0             0
true class VASC           0            5  ...            0             0

[8 rows x 8 columns]

Current validation loss: 0.974

Epoch 104:
Mean loss 0.9452604054464526 - Correctly labeled training images 65.66%
Classified 64.20 % of validation images correctly.
Precision on validation set: [0.25 0.43 0.39 0.   0.6  0.74 0.   0.  ]
Recall on validation set: [0.02 0.68 0.18 0.   0.36 0.92 0.   0.  ]
F1-score on validation set: [0.04 0.53 0.25 0.   0.45 0.82 0.   0.  ]
ROC AUC on validation set: {'AK': 0.82, 'BCC': 0.91, 'BKL': 0.65, 'DF': 0.81, 'MEL': 0.52, 'NV': 0.15, 'SCC': 0.86, 'VASC': 0.74}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             1           28  ...            0             0
true class BCC            0          114  ...            1             0
true class BKL            0           37  ...            0             0
true class DF             0            8  ...            0             0
true class MEL            2           30  ...            0             0
true class NV             0           20  ...            0             0
true class SCC            1           24  ...            0             0
true class VASC           0            5  ...            0             0

[8 rows x 8 columns]

Current validation loss: 0.968

Epoch 105:
Mean loss 0.9461178534226463 - Correctly labeled training images 65.66%
Classified 63.56 % of validation images correctly.
Precision on validation set: [0.25 0.46 0.43 0.   0.58 0.72 0.   0.  ]
Recall on validation set: [0.02 0.66 0.29 0.   0.27 0.92 0.   0.  ]
F1-score on validation set: [0.04 0.54 0.35 0.   0.37 0.81 0.   0.  ]
ROC AUC on validation set: {'AK': 0.82, 'BCC': 0.9, 'BKL': 0.64, 'DF': 0.78, 'MEL': 0.52, 'NV': 0.15, 'SCC': 0.86, 'VASC': 0.78}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             1           27  ...            0             0
true class BCC            1          111  ...            1             0
true class BKL            0           22  ...            0             0
true class DF             0            7  ...            0             0
true class MEL            1           29  ...            1             0
true class NV             0           18  ...            0             0
true class SCC            1           23  ...            0             0
true class VASC           0            6  ...            0             0

/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
[8 rows x 8 columns]

Current validation loss: 0.989

Epoch 106:
Mean loss 0.9424378829141521 - Correctly labeled training images 66.03%
Classified 64.04 % of validation images correctly.
Precision on validation set: [0.25 0.49 0.39 0.   0.53 0.73 0.   0.  ]
Recall on validation set: [0.02 0.65 0.25 0.   0.31 0.93 0.   0.  ]
F1-score on validation set: [0.04 0.56 0.31 0.   0.39 0.82 0.   0.  ]
ROC AUC on validation set: {'AK': 0.82, 'BCC': 0.91, 'BKL': 0.62, 'DF': 0.82, 'MEL': 0.52, 'NV': 0.15, 'SCC': 0.86, 'VASC': 0.77}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             1           24  ...            0             0
true class BCC            0          109  ...            1             0
true class BKL            0           21  ...            0             0
true class DF             0            6  ...            0             0
true class MEL            1           24  ...            1             1
true class NV             0           11  ...            0             0
true class SCC            2           20  ...            0             0
true class VASC           0            6  ...            0             0

[8 rows x 8 columns]

Current validation loss: 0.971

Epoch 107:
Mean loss 0.9463236822690874 - Correctly labeled training images 65.82%
Classified 64.12 % of validation images correctly.
Precision on validation set: [0.33 0.51 0.36 0.   0.5  0.74 0.   0.  ]
Recall on validation set: [0.02 0.6  0.25 0.   0.36 0.93 0.   0.  ]
F1-score on validation set: [0.04 0.55 0.3  0.   0.42 0.82 0.   0.  ]
ROC AUC on validation set: {'AK': 0.83, 'BCC': 0.9, 'BKL': 0.63, 'DF': 0.82, 'MEL': 0.5, 'NV': 0.16, 'SCC': 0.86, 'VASC': 0.79}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             1           18  ...            0             0
true class BCC            0          101  ...            1             0
true class BKL            0           16  ...            0             0
true class DF             0            5  ...            0             0
true class MEL            1           22  ...            1             0
true class NV             0           12  ...            0             0
true class SCC            1           19  ...            0             0
true class VASC           0            6  ...            0             0

[8 rows x 8 columns]

Current validation loss: 0.982

Epoch 108:
Mean loss 0.9447347424947877 - Correctly labeled training images 65.87%
Classified 63.80 % of validation images correctly.
Precision on validation set: [0.42 0.52 0.35 0.   0.55 0.72 0.   0.  ]
Recall on validation set: [0.12 0.62 0.26 0.   0.32 0.92 0.   0.  ]
F1-score on validation set: [0.18 0.56 0.3  0.   0.4  0.81 0.   0.  ]
ROC AUC on validation set: {'AK': 0.81, 'BCC': 0.91, 'BKL': 0.63, 'DF': 0.84, 'MEL': 0.52, 'NV': 0.15, 'SCC': 0.85, 'VASC': 0.78}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             5           17  ...            0             0
true class BCC            3          103  ...            2             0
true class BKL            1           16  ...            0             0
true class DF             0            6  ...            0             0
true class MEL            1           18  ...            1             1
true class NV             0           13  ...            0             0
true class SCC            2           20  ...            0             0
true class VASC           0            6  ...            0             0

[8 rows x 8 columns]

Current validation loss: 0.976

Epoch 109:
Mean loss 0.9394734352357004 - Correctly labeled training images 65.95%
Classified 64.12 % of validation images correctly.
Precision on validation set: [0.   0.47 0.38 0.   0.53 0.75 0.   0.  ]
Recall on validation set: [0.   0.71 0.24 0.   0.34 0.91 0.   0.  ]
F1-score on validation set: [0.   0.56 0.29 0.   0.42 0.82 0.   0.  ]
ROC AUC on validation set: {'AK': 0.81, 'BCC': 0.91, 'BKL': 0.64, 'DF': 0.83, 'MEL': 0.5, 'NV': 0.16, 'SCC': 0.85, 'VASC': 0.81}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           28  ...            0             0
true class BCC            1          118  ...            0             0
true class BKL            1           29  ...            0             0
true class DF             0            7  ...            0             0
true class MEL            1           26  ...            1             0
true class NV             0           16  ...            0             0
true class SCC            2           22  ...            0             0
true class VASC           0            7  ...            0             0

[8 rows x 8 columns]

Current validation loss: 0.959

Epoch 110:
Mean loss 0.9248258805237358 - Correctly labeled training images 66.64%
Classified 64.43 % of validation images correctly.
Precision on validation set: [0.25 0.49 0.35 0.   0.55 0.75 0.   0.  ]
Recall on validation set: [0.05 0.69 0.26 0.   0.36 0.91 0.   0.  ]
F1-score on validation set: [0.08 0.57 0.3  0.   0.44 0.82 0.   0.  ]
ROC AUC on validation set: {'AK': 0.81, 'BCC': 0.91, 'BKL': 0.62, 'DF': 0.85, 'MEL': 0.52, 'NV': 0.16, 'SCC': 0.83, 'VASC': 0.76}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             2           22  ...            0             0
true class BCC            3          115  ...            2             0
true class BKL            1           22  ...            0             0
true class DF             0            7  ...            0             0
true class MEL            1           26  ...            0             0
true class NV             0           20  ...            0             0
true class SCC            1           18  ...            0             0
true class VASC           0            6  ...            0             0

[8 rows x 8 columns]

Current validation loss: 0.962

Epoch 111:
Mean loss 0.9299750511860622 - Correctly labeled training images 66.60%
Classified 64.67 % of validation images correctly.
Precision on validation set: [0.2  0.48 0.38 0.   0.58 0.74 0.   0.  ]
Recall on validation set: [0.02 0.7  0.27 0.   0.32 0.92 0.   0.  ]
F1-score on validation set: [0.04 0.57 0.32 0.   0.41 0.82 0.   0.  ]
ROC AUC on validation set: {'AK': 0.81, 'BCC': 0.91, 'BKL': 0.63, 'DF': 0.84, 'MEL': 0.5, 'NV': 0.16, 'SCC': 0.85, 'VASC': 0.75}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             1           25  ...            0             0
true class BCC            0          117  ...            1             0
true class BKL            0           25  ...            0             0
true class DF             0            8  ...            0             0
true class MEL            2           24  ...            1             0
true class NV             0           18  ...            0             0
true class SCC            2           21  ...            0             0
true class VASC           0            6  ...            0             0

[8 rows x 8 columns]

Current validation loss: 0.962

Epoch 112:
Mean loss 0.92868149562589 - Correctly labeled training images 66.34%
Classified 64.12 % of validation images correctly.
Precision on validation set: [0.38 0.46 0.4  0.   0.6  0.73 0.   0.  ]
Recall on validation set: [0.07 0.69 0.26 0.   0.3  0.92 0.   0.  ]
F1-score on validation set: [0.12 0.55 0.31 0.   0.4  0.82 0.   0.  ]
ROC AUC on validation set: {'AK': 0.81, 'BCC': 0.9, 'BKL': 0.64, 'DF': 0.82, 'MEL': 0.51, 'NV': 0.16, 'SCC': 0.84, 'VASC': 0.73}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             3           23  ...            0             0
true class BCC            2          115  ...            1             0
true class BKL            0           28  ...            0             0
true class DF             0            7  ...            0             0
true class MEL            2           29  ...            0             0
true class NV             0           20  ...            0             0
true class SCC            1           21  ...            0             0
true class VASC           0            5  ...            0             0

/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
[8 rows x 8 columns]

Current validation loss: 0.973

Epoch 113:
Mean loss 0.9331669037932477 - Correctly labeled training images 66.46%
Classified 64.35 % of validation images correctly.
Precision on validation set: [0.17 0.47 0.4  0.   0.55 0.75 0.   0.  ]
Recall on validation set: [0.02 0.7  0.23 0.   0.38 0.9  0.   0.  ]
F1-score on validation set: [0.04 0.57 0.29 0.   0.45 0.82 0.   0.  ]
ROC AUC on validation set: {'AK': 0.82, 'BCC': 0.91, 'BKL': 0.64, 'DF': 0.82, 'MEL': 0.51, 'NV': 0.15, 'SCC': 0.85, 'VASC': 0.79}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             1           25  ...            0             0
true class BCC            1          117  ...            1             0
true class BKL            1           26  ...            0             0
true class DF             0            6  ...            0             0
true class MEL            1           21  ...            1             0
true class NV             0           23  ...            0             0
true class SCC            2           22  ...            0             0
true class VASC           0            7  ...            0             0

[8 rows x 8 columns]

Current validation loss: 0.950

Epoch 114:
Mean loss 0.9215717287469738 - Correctly labeled training images 66.49%
Classified 65.14 % of validation images correctly.
Precision on validation set: [0.2  0.48 0.42 0.   0.55 0.76 0.   1.  ]
Recall on validation set: [0.02 0.75 0.26 0.   0.35 0.91 0.   0.08]
F1-score on validation set: [0.04 0.59 0.32 0.   0.43 0.83 0.   0.14]
ROC AUC on validation set: {'AK': 0.82, 'BCC': 0.91, 'BKL': 0.65, 'DF': 0.81, 'MEL': 0.5, 'NV': 0.16, 'SCC': 0.87, 'VASC': 0.76}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             1           28  ...            0             0
true class BCC            1          125  ...            1             0
true class BKL            2           24  ...            0             0
true class DF             0            7  ...            0             0
true class MEL            0           29  ...            1             0
true class NV             0           18  ...            0             0
true class SCC            1           24  ...            0             0
true class VASC           0            5  ...            0             1

[8 rows x 8 columns]

Current validation loss: 0.943

Epoch 115:
Mean loss 0.9173019316858297 - Correctly labeled training images 66.62%
Classified 64.59 % of validation images correctly.
Precision on validation set: [0.25 0.46 0.43 0.   0.53 0.75 0.   0.  ]
Recall on validation set: [0.02 0.75 0.19 0.   0.36 0.91 0.   0.  ]
F1-score on validation set: [0.04 0.58 0.26 0.   0.43 0.82 0.   0.  ]
ROC AUC on validation set: {'AK': 0.82, 'BCC': 0.91, 'BKL': 0.65, 'DF': 0.8, 'MEL': 0.5, 'NV': 0.16, 'SCC': 0.84, 'VASC': 0.78}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             1           30  ...            0             0
true class BCC            1          126  ...            1             0
true class BKL            0           31  ...            0             0
true class DF             0            7  ...            0             0
true class MEL            0           27  ...            0             0
true class NV             0           21  ...            0             0
true class SCC            2           23  ...            0             0
true class VASC           0            6  ...            0             0

[8 rows x 8 columns]

Current validation loss: 0.965

Epoch 116:
Mean loss 0.9226905256509781 - Correctly labeled training images 66.76%
Classified 66.09 % of validation images correctly.
Precision on validation set: [0.38 0.49 0.42 0.   0.57 0.77 0.   1.  ]
Recall on validation set: [0.07 0.74 0.27 0.   0.38 0.91 0.   0.08]
F1-score on validation set: [0.12 0.59 0.33 0.   0.46 0.83 0.   0.14]
ROC AUC on validation set: {'AK': 0.81, 'BCC': 0.92, 'BKL': 0.63, 'DF': 0.82, 'MEL': 0.51, 'NV': 0.16, 'SCC': 0.84, 'VASC': 0.75}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             3           24  ...            0             0
true class BCC            1          123  ...            1             0
true class BKL            1           26  ...            0             0
true class DF             0            7  ...            0             0
true class MEL            0           29  ...            0             0
true class NV             0           16  ...            0             0
true class SCC            3           23  ...            0             0
true class VASC           0            5  ...            0             1

[8 rows x 8 columns]

Current validation loss: 0.946

Epoch 117:
Mean loss 0.9179850483448347 - Correctly labeled training images 66.80%
Classified 64.91 % of validation images correctly.
Precision on validation set: [0.25 0.49 0.36 0.   0.55 0.76 0.   0.  ]
Recall on validation set: [0.05 0.75 0.22 0.   0.36 0.91 0.   0.  ]
F1-score on validation set: [0.08 0.59 0.27 0.   0.44 0.83 0.   0.  ]
ROC AUC on validation set: {'AK': 0.82, 'BCC': 0.92, 'BKL': 0.64, 'DF': 0.82, 'MEL': 0.5, 'NV': 0.16, 'SCC': 0.85, 'VASC': 0.78}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             2           26  ...            0             0
true class BCC            2          125  ...            1             0
true class BKL            1           27  ...            0             0
true class DF             0            7  ...            0             0
true class MEL            2           23  ...            0             0
true class NV             0           18  ...            0             0
true class SCC            1           26  ...            0             0
true class VASC           0            5  ...            0             0

[8 rows x 8 columns]

Current validation loss: 0.939

Epoch 118:
Mean loss 0.9136843435959862 - Correctly labeled training images 66.84%
Classified 64.67 % of validation images correctly.
Precision on validation set: [0.   0.47 0.39 0.   0.55 0.76 0.   0.  ]
Recall on validation set: [0.   0.75 0.27 0.   0.36 0.9  0.   0.  ]
F1-score on validation set: [0.   0.58 0.32 0.   0.44 0.82 0.   0.  ]
ROC AUC on validation set: {'AK': 0.81, 'BCC': 0.91, 'BKL': 0.64, 'DF': 0.82, 'MEL': 0.51, 'NV': 0.16, 'SCC': 0.85, 'VASC': 0.79}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           28  ...            0             0
true class BCC            1          125  ...            1             0
true class BKL            0           24  ...            0             0
true class DF             0            8  ...            0             0
true class MEL            1           31  ...            0             0
true class NV             0           20  ...            0             0
true class SCC            1           24  ...            0             0
true class VASC           0            7  ...            0             0

[8 rows x 8 columns]

Current validation loss: 0.946

Epoch 119:
Mean loss 0.9182992407858184 - Correctly labeled training images 66.62%
Classified 64.35 % of validation images correctly.
Precision on validation set: [0.   0.47 0.36 0.   0.54 0.76 0.   0.  ]
Recall on validation set: [0.   0.78 0.22 0.   0.32 0.91 0.   0.  ]
F1-score on validation set: [0.   0.59 0.27 0.   0.4  0.82 0.   0.  ]
ROC AUC on validation set: {'AK': 0.8, 'BCC': 0.92, 'BKL': 0.64, 'DF': 0.84, 'MEL': 0.51, 'NV': 0.15, 'SCC': 0.86, 'VASC': 0.78}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           30  ...            0             0
true class BCC            1          130  ...            1             0
true class BKL            0           27  ...            0             0
true class DF             0            9  ...            0             0
true class MEL            0           30  ...            0             0
true class NV             0           19  ...            0             0
true class SCC            1           25  ...            0             0
true class VASC           0            7  ...            0             0

/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
[8 rows x 8 columns]

Current validation loss: 0.945

Epoch 120:
Mean loss 0.911271435793266 - Correctly labeled training images 66.91%
Classified 64.59 % of validation images correctly.
Precision on validation set: [0.2  0.47 0.36 0.   0.55 0.77 0.   1.  ]
Recall on validation set: [0.02 0.75 0.27 0.   0.33 0.9  0.   0.08]
F1-score on validation set: [0.04 0.57 0.31 0.   0.41 0.83 0.   0.14]
ROC AUC on validation set: {'AK': 0.83, 'BCC': 0.92, 'BKL': 0.63, 'DF': 0.85, 'MEL': 0.51, 'NV': 0.15, 'SCC': 0.86, 'VASC': 0.73}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             1           27  ...            0             0
true class BCC            2          125  ...            1             0
true class BKL            0           30  ...            0             0
true class DF             0            8  ...            0             0
true class MEL            0           30  ...            0             0
true class NV             0           18  ...            0             0
true class SCC            2           25  ...            0             0
true class VASC           0            5  ...            0             1

[8 rows x 8 columns]

Current validation loss: 0.940

Epoch 121:
Mean loss 0.9096498291481181 - Correctly labeled training images 67.11%
Classified 63.88 % of validation images correctly.
Precision on validation set: [0.25 0.46 0.39 0.   0.49 0.76 0.   0.  ]
Recall on validation set: [0.02 0.75 0.21 0.   0.36 0.89 0.   0.  ]
F1-score on validation set: [0.04 0.57 0.28 0.   0.42 0.82 0.   0.  ]
ROC AUC on validation set: {'AK': 0.83, 'BCC': 0.92, 'BKL': 0.63, 'DF': 0.82, 'MEL': 0.51, 'NV': 0.15, 'SCC': 0.86, 'VASC': 0.77}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             1           28  ...            0             0
true class BCC            1          125  ...            1             0
true class BKL            1           28  ...            0             0
true class DF             0            8  ...            0             0
true class MEL            0           29  ...            0             0
true class NV             0           20  ...            0             0
true class SCC            1           25  ...            0             0
true class VASC           0            6  ...            0             0

[8 rows x 8 columns]

Current validation loss: 0.941

Epoch 122:
Mean loss 0.9085093119919112 - Correctly labeled training images 67.06%
Classified 65.06 % of validation images correctly.
Precision on validation set: [0.2  0.48 0.41 0.   0.6  0.75 0.   1.  ]
Recall on validation set: [0.02 0.74 0.3  0.   0.32 0.91 0.   0.08]
F1-score on validation set: [0.04 0.58 0.35 0.   0.42 0.82 0.   0.14]
ROC AUC on validation set: {'AK': 0.82, 'BCC': 0.92, 'BKL': 0.64, 'DF': 0.82, 'MEL': 0.52, 'NV': 0.14, 'SCC': 0.86, 'VASC': 0.75}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             1           27  ...            0             0
true class BCC            1          124  ...            1             0
true class BKL            0           29  ...            0             0
true class DF             0            9  ...            0             0
true class MEL            1           25  ...            0             0
true class NV             0           17  ...            0             0
true class SCC            2           25  ...            0             0
true class VASC           0            5  ...            0             1

[8 rows x 8 columns]

Current validation loss: 0.938

Epoch 123:
Mean loss 0.9055268513949511 - Correctly labeled training images 67.40%
Classified 65.06 % of validation images correctly.
Precision on validation set: [0.17 0.5  0.36 0.   0.61 0.74 0.   0.  ]
Recall on validation set: [0.02 0.71 0.27 0.   0.33 0.93 0.   0.  ]
F1-score on validation set: [0.04 0.58 0.31 0.   0.43 0.83 0.   0.  ]
ROC AUC on validation set: {'AK': 0.81, 'BCC': 0.92, 'BKL': 0.64, 'DF': 0.83, 'MEL': 0.52, 'NV': 0.15, 'SCC': 0.85, 'VASC': 0.77}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             1           26  ...            0             0
true class BCC            1          118  ...            2             0
true class BKL            1           21  ...            0             0
true class DF             0            8  ...            0             0
true class MEL            2           23  ...            0             0
true class NV             0           12  ...            0             0
true class SCC            1           23  ...            0             0
true class VASC           0            7  ...            0             0

[8 rows x 8 columns]

Current validation loss: 0.941

Epoch 124:
Mean loss 0.9036763274237184 - Correctly labeled training images 67.20%
Classified 64.83 % of validation images correctly.
Precision on validation set: [0.1  0.49 0.36 0.   0.53 0.76 0.   1.  ]
Recall on validation set: [0.02 0.71 0.24 0.   0.42 0.89 0.   0.08]
F1-score on validation set: [0.04 0.58 0.29 0.   0.47 0.82 0.   0.14]
ROC AUC on validation set: {'AK': 0.81, 'BCC': 0.92, 'BKL': 0.64, 'DF': 0.84, 'MEL': 0.51, 'NV': 0.15, 'SCC': 0.86, 'VASC': 0.75}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             1           23  ...            0             0
true class BCC            2          118  ...            1             0
true class BKL            2           23  ...            0             0
true class DF             0            7  ...            0             0
true class MEL            2           22  ...            0             0
true class NV             0           20  ...            0             0
true class SCC            3           21  ...            0             0
true class VASC           0            5  ...            0             1

[8 rows x 8 columns]

Current validation loss: 0.937

Epoch 125:
Mean loss 0.9033656674040604 - Correctly labeled training images 67.32%
Classified 65.46 % of validation images correctly.
Precision on validation set: [0.36 0.51 0.36 0.   0.58 0.75 0.   1.  ]
Recall on validation set: [0.09 0.72 0.29 0.   0.32 0.92 0.   0.15]
F1-score on validation set: [0.15 0.6  0.32 0.   0.42 0.83 0.   0.27]
ROC AUC on validation set: {'AK': 0.81, 'BCC': 0.92, 'BKL': 0.63, 'DF': 0.84, 'MEL': 0.51, 'NV': 0.15, 'SCC': 0.85, 'VASC': 0.74}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             4           21  ...            0             0
true class BCC            2          120  ...            1             0
true class BKL            2           19  ...            0             0
true class DF             0            7  ...            0             0
true class MEL            0           26  ...            0             0
true class NV             0           16  ...            0             0
true class SCC            3           22  ...            0             0
true class VASC           0            5  ...            0             2

[8 rows x 8 columns]

Current validation loss: 0.929

Epoch 126:
Mean loss 0.9016956189171373 - Correctly labeled training images 67.39%
Classified 64.83 % of validation images correctly.
Precision on validation set: [0.   0.49 0.38 0.   0.55 0.75 0.   0.5 ]
Recall on validation set: [0.   0.7  0.24 0.   0.41 0.9  0.   0.08]
F1-score on validation set: [0.   0.57 0.3  0.   0.47 0.82 0.   0.13]
ROC AUC on validation set: {'AK': 0.81, 'BCC': 0.92, 'BKL': 0.63, 'DF': 0.83, 'MEL': 0.51, 'NV': 0.16, 'SCC': 0.86, 'VASC': 0.74}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           26  ...            0             0
true class BCC            1          117  ...            0             1
true class BKL            0           24  ...            0             0
true class DF             0            7  ...            0             0
true class MEL            1           24  ...            0             0
true class NV             0           15  ...            0             0
true class SCC            1           24  ...            0             0
true class VASC           0            4  ...            0             1

/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
[8 rows x 8 columns]

Current validation loss: 0.938

Epoch 127:
Mean loss 0.896806784514749 - Correctly labeled training images 67.53%
Classified 64.83 % of validation images correctly.
Precision on validation set: [0.33 0.51 0.37 0.   0.59 0.73 0.5  0.5 ]
Recall on validation set: [0.05 0.65 0.28 0.   0.35 0.92 0.03 0.08]
F1-score on validation set: [0.08 0.57 0.32 0.   0.44 0.81 0.06 0.13]
ROC AUC on validation set: {'AK': 0.81, 'BCC': 0.92, 'BKL': 0.64, 'DF': 0.83, 'MEL': 0.52, 'NV': 0.14, 'SCC': 0.88, 'VASC': 0.75}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             2           19  ...            0             0
true class BCC            3          108  ...            1             1
true class BKL            0           19  ...            0             0
true class DF             0            5  ...            0             0
true class MEL            0           17  ...            0             0
true class NV             0           14  ...            0             0
true class SCC            1           24  ...            1             0
true class VASC           0            5  ...            0             1

[8 rows x 8 columns]

Current validation loss: 0.946

Epoch 128:
Mean loss 0.890197895960853 - Correctly labeled training images 67.95%
Classified 65.54 % of validation images correctly.
Precision on validation set: [0.4  0.51 0.35 0.   0.6  0.75 0.   1.  ]
Recall on validation set: [0.05 0.72 0.27 0.   0.36 0.92 0.   0.15]
F1-score on validation set: [0.08 0.6  0.31 0.   0.45 0.82 0.   0.27]
ROC AUC on validation set: {'AK': 0.8, 'BCC': 0.92, 'BKL': 0.64, 'DF': 0.82, 'MEL': 0.53, 'NV': 0.14, 'SCC': 0.87, 'VASC': 0.76}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             2           23  ...            0             0
true class BCC            0          120  ...            1             0
true class BKL            0           23  ...            0             0
true class DF             0            7  ...            0             0
true class MEL            2           22  ...            0             0
true class NV             0           13  ...            0             0
true class SCC            1           22  ...            0             0
true class VASC           0            4  ...            0             2

[8 rows x 8 columns]

Current validation loss: 0.920

Epoch 129:
Mean loss 0.8949405716420724 - Correctly labeled training images 67.70%
Classified 66.09 % of validation images correctly.
Precision on validation set: [0.17 0.49 0.42 0.   0.59 0.77 0.   1.  ]
Recall on validation set: [0.02 0.74 0.32 0.   0.35 0.92 0.   0.08]
F1-score on validation set: [0.04 0.59 0.36 0.   0.44 0.83 0.   0.14]
ROC AUC on validation set: {'AK': 0.8, 'BCC': 0.92, 'BKL': 0.63, 'DF': 0.86, 'MEL': 0.53, 'NV': 0.14, 'SCC': 0.86, 'VASC': 0.77}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             1           22  ...            0             0
true class BCC            1          124  ...            2             0
true class BKL            2           24  ...            0             0
true class DF             0            8  ...            0             0
true class MEL            1           27  ...            0             0
true class NV             0           17  ...            0             0
true class SCC            1           24  ...            0             0
true class VASC           0            6  ...            0             1

[8 rows x 8 columns]

Current validation loss: 0.916

Epoch 130:
Mean loss 0.8841825270502349 - Correctly labeled training images 68.33%
Classified 65.54 % of validation images correctly.
Precision on validation set: [0.25 0.53 0.38 0.   0.53 0.75 0.   1.  ]
Recall on validation set: [0.05 0.72 0.25 0.   0.41 0.9  0.   0.08]
F1-score on validation set: [0.08 0.61 0.3  0.   0.46 0.82 0.   0.14]
ROC AUC on validation set: {'AK': 0.79, 'BCC': 0.92, 'BKL': 0.62, 'DF': 0.83, 'MEL': 0.5, 'NV': 0.17, 'SCC': 0.85, 'VASC': 0.77}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             2           20  ...            0             0
true class BCC            3          121  ...            0             0
true class BKL            0           23  ...            0             0
true class DF             0            7  ...            0             0
true class MEL            0           19  ...            0             0
true class NV             0           14  ...            0             0
true class SCC            3           18  ...            0             0
true class VASC           0            5  ...            0             1

[8 rows x 8 columns]

Current validation loss: 0.939

Epoch 131:
Mean loss 0.8881311205095297 - Correctly labeled training images 67.80%
Classified 65.38 % of validation images correctly.
Precision on validation set: [0.4  0.5  0.38 0.   0.56 0.77 0.5  1.  ]
Recall on validation set: [0.05 0.72 0.33 0.   0.38 0.89 0.03 0.08]
F1-score on validation set: [0.08 0.59 0.35 0.   0.45 0.83 0.06 0.14]
ROC AUC on validation set: {'AK': 0.81, 'BCC': 0.92, 'BKL': 0.63, 'DF': 0.85, 'MEL': 0.52, 'NV': 0.15, 'SCC': 0.85, 'VASC': 0.72}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             2           25  ...            0             0
true class BCC            0          121  ...            1             0
true class BKL            0           24  ...            0             0
true class DF             0            9  ...            0             0
true class MEL            2           23  ...            0             0
true class NV             0           16  ...            0             0
true class SCC            1           21  ...            1             0
true class VASC           0            3  ...            0             1

[8 rows x 8 columns]

Current validation loss: 0.923

Epoch 132:
Mean loss 0.884835102627706 - Correctly labeled training images 67.74%
Classified 65.85 % of validation images correctly.
Precision on validation set: [0.33 0.55 0.43 0.   0.54 0.74 0.33 1.  ]
Recall on validation set: [0.02 0.71 0.27 0.   0.39 0.91 0.03 0.08]
F1-score on validation set: [0.04 0.62 0.33 0.   0.45 0.82 0.06 0.14]
ROC AUC on validation set: {'AK': 0.8, 'BCC': 0.93, 'BKL': 0.63, 'DF': 0.83, 'MEL': 0.5, 'NV': 0.16, 'SCC': 0.87, 'VASC': 0.75}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             1           21  ...            0             0
true class BCC            0          119  ...            1             0
true class BKL            1           14  ...            0             0
true class DF             0            6  ...            0             0
true class MEL            1           16  ...            1             0
true class NV             0           15  ...            0             0
true class SCC            0           23  ...            1             0
true class VASC           0            3  ...            0             1

[8 rows x 8 columns]

Current validation loss: 0.927

Epoch 133:
Mean loss 0.8833605733579641 - Correctly labeled training images 67.97%
Classified 66.01 % of validation images correctly.
Precision on validation set: [0.25 0.48 0.41 0.   0.58 0.77 0.   1.  ]
Recall on validation set: [0.02 0.78 0.3  0.   0.38 0.9  0.   0.08]
F1-score on validation set: [0.04 0.59 0.35 0.   0.46 0.83 0.   0.14]
ROC AUC on validation set: {'AK': 0.8, 'BCC': 0.92, 'BKL': 0.63, 'DF': 0.83, 'MEL': 0.52, 'NV': 0.15, 'SCC': 0.86, 'VASC': 0.74}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             1           24  ...            0             0
true class BCC            1          130  ...            1             0
true class BKL            0           29  ...            0             0
true class DF             0           10  ...            0             0
true class MEL            1           28  ...            0             0
true class NV             0           18  ...            0             0
true class SCC            1           25  ...            0             0
true class VASC           0            6  ...            0             1

/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
[8 rows x 8 columns]

Current validation loss: 0.920

Epoch 134:
Mean loss 0.8773143872007586 - Correctly labeled training images 68.26%
Classified 66.01 % of validation images correctly.
Precision on validation set: [0.14 0.52 0.42 0.   0.55 0.76 0.5  1.  ]
Recall on validation set: [0.05 0.74 0.21 0.   0.4  0.92 0.03 0.08]
F1-score on validation set: [0.07 0.61 0.28 0.   0.46 0.83 0.06 0.14]
ROC AUC on validation set: {'AK': 0.81, 'BCC': 0.93, 'BKL': 0.64, 'DF': 0.83, 'MEL': 0.5, 'NV': 0.16, 'SCC': 0.86, 'VASC': 0.73}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             2           22  ...            0             0
true class BCC            3          124  ...            1             0
true class BKL            5           22  ...            0             0
true class DF             0            7  ...            0             0
true class MEL            2           23  ...            0             0
true class NV             0           15  ...            0             0
true class SCC            2           23  ...            1             0
true class VASC           0            4  ...            0             1

[8 rows x 8 columns]

Current validation loss: 0.929

Epoch 135:
Mean loss 0.8771532983151896 - Correctly labeled training images 68.38%
Classified 66.09 % of validation images correctly.
Precision on validation set: [0.11 0.53 0.39 0.   0.57 0.76 0.   1.  ]
Recall on validation set: [0.02 0.7  0.33 0.   0.39 0.91 0.   0.15]
F1-score on validation set: [0.04 0.6  0.36 0.   0.47 0.83 0.   0.27]
ROC AUC on validation set: {'AK': 0.8, 'BCC': 0.93, 'BKL': 0.63, 'DF': 0.85, 'MEL': 0.51, 'NV': 0.16, 'SCC': 0.85, 'VASC': 0.72}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             1           22  ...            0             0
true class BCC            2          117  ...            1             0
true class BKL            2           16  ...            0             0
true class DF             0            7  ...            0             0
true class MEL            1           21  ...            0             0
true class NV             0           14  ...            0             0
true class SCC            3           19  ...            0             0
true class VASC           0            4  ...            0             2

[8 rows x 8 columns]

Current validation loss: 0.920

Epoch 136:
Mean loss 0.8687202149667198 - Correctly labeled training images 68.50%
Classified 65.85 % of validation images correctly.
Precision on validation set: [0.29 0.47 0.4  0.   0.6  0.77 0.   1.  ]
Recall on validation set: [0.05 0.73 0.27 0.   0.39 0.91 0.   0.08]
F1-score on validation set: [0.08 0.57 0.32 0.   0.47 0.83 0.   0.14]
ROC AUC on validation set: {'AK': 0.81, 'BCC': 0.92, 'BKL': 0.63, 'DF': 0.82, 'MEL': 0.52, 'NV': 0.15, 'SCC': 0.85, 'VASC': 0.74}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             2           25  ...            0             0
true class BCC            2          122  ...            0             0
true class BKL            1           25  ...            0             0
true class DF             0            7  ...            0             0
true class MEL            2           30  ...            0             0
true class NV             0           22  ...            0             0
true class SCC            0           25  ...            0             0
true class VASC           0            6  ...            0             1

[8 rows x 8 columns]

Current validation loss: 0.929

Epoch 137:
Mean loss 0.8780863081055109 - Correctly labeled training images 68.22%
Classified 65.62 % of validation images correctly.
Precision on validation set: [0.25 0.51 0.39 0.   0.56 0.76 0.   0.67]
Recall on validation set: [0.07 0.73 0.3  0.   0.39 0.9  0.   0.15]
F1-score on validation set: [0.11 0.6  0.34 0.   0.46 0.82 0.   0.25]
ROC AUC on validation set: {'AK': 0.8, 'BCC': 0.93, 'BKL': 0.64, 'DF': 0.85, 'MEL': 0.51, 'NV': 0.15, 'SCC': 0.85, 'VASC': 0.7}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             3           23  ...            0             0
true class BCC            3          122  ...            1             1
true class BKL            3           21  ...            0             0
true class DF             0            8  ...            0             0
true class MEL            2           23  ...            1             0
true class NV             0           14  ...            0             0
true class SCC            1           22  ...            0             0
true class VASC           0            4  ...            0             2

[8 rows x 8 columns]

Current validation loss: 0.916

Epoch 138:
Mean loss 0.8708902629862072 - Correctly labeled training images 68.25%
Classified 65.69 % of validation images correctly.
Precision on validation set: [0.4  0.5  0.38 0.   0.56 0.76 0.   1.  ]
Recall on validation set: [0.09 0.73 0.26 0.   0.36 0.91 0.   0.15]
F1-score on validation set: [0.15 0.6  0.31 0.   0.44 0.83 0.   0.27]
ROC AUC on validation set: {'AK': 0.81, 'BCC': 0.93, 'BKL': 0.63, 'DF': 0.82, 'MEL': 0.5, 'NV': 0.16, 'SCC': 0.85, 'VASC': 0.73}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             4           25  ...            0             0
true class BCC            2          122  ...            0             0
true class BKL            0           25  ...            0             0
true class DF             0            8  ...            0             0
true class MEL            2           20  ...            0             0
true class NV             0           16  ...            0             0
true class SCC            2           22  ...            0             0
true class VASC           0            5  ...            0             2

[8 rows x 8 columns]

Current validation loss: 0.914

Epoch 139:
Mean loss 0.8682591591253641 - Correctly labeled training images 68.51%
Classified 65.54 % of validation images correctly.
Precision on validation set: [0.17 0.53 0.39 0.   0.57 0.73 0.5  1.  ]
Recall on validation set: [0.02 0.71 0.24 0.   0.37 0.92 0.03 0.23]
F1-score on validation set: [0.04 0.61 0.3  0.   0.45 0.82 0.06 0.38]
ROC AUC on validation set: {'AK': 0.81, 'BCC': 0.93, 'BKL': 0.63, 'DF': 0.83, 'MEL': 0.52, 'NV': 0.14, 'SCC': 0.86, 'VASC': 0.76}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             1           22  ...            0             0
true class BCC            0          119  ...            1             0
true class BKL            0           20  ...            0             0
true class DF             0            6  ...            0             0
true class MEL            4           19  ...            0             0
true class NV             0           14  ...            0             0
true class SCC            1           22  ...            1             0
true class VASC           0            3  ...            0             3

[8 rows x 8 columns]

Current validation loss: 0.900

Epoch 140:
Mean loss 0.867929539845945 - Correctly labeled training images 68.47%
Classified 66.64 % of validation images correctly.
Precision on validation set: [0.4  0.56 0.42 0.   0.59 0.74 0.   1.  ]
Recall on validation set: [0.09 0.72 0.32 0.   0.33 0.93 0.   0.15]
F1-score on validation set: [0.15 0.63 0.36 0.   0.42 0.82 0.   0.27]
ROC AUC on validation set: {'AK': 0.79, 'BCC': 0.93, 'BKL': 0.62, 'DF': 0.84, 'MEL': 0.51, 'NV': 0.16, 'SCC': 0.87, 'VASC': 0.8}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             4           18  ...            0             0
true class BCC            2          121  ...            0             0
true class BKL            0           15  ...            0             0
true class DF             0            7  ...            0             0
true class MEL            2           19  ...            0             0
true class NV             0            9  ...            0             0
true class SCC            2           21  ...            0             0
true class VASC           0            5  ...            0             2

/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
[8 rows x 8 columns]

Current validation loss: 0.926

Epoch 141:
Mean loss 0.8685665213817302 - Correctly labeled training images 68.73%
Classified 66.09 % of validation images correctly.
Precision on validation set: [0.17 0.49 0.38 0.   0.62 0.76 0.   1.  ]
Recall on validation set: [0.02 0.77 0.23 0.   0.37 0.92 0.   0.15]
F1-score on validation set: [0.04 0.6  0.28 0.   0.46 0.83 0.   0.27]
ROC AUC on validation set: {'AK': 0.79, 'BCC': 0.93, 'BKL': 0.65, 'DF': 0.83, 'MEL': 0.52, 'NV': 0.14, 'SCC': 0.86, 'VASC': 0.75}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             1           24  ...            0             0
true class BCC            2          129  ...            1             0
true class BKL            2           29  ...            0             0
true class DF             0            8  ...            0             0
true class MEL            1           25  ...            1             0
true class NV             0           17  ...            0             0
true class SCC            0           24  ...            0             0
true class VASC           0            6  ...            0             2

[8 rows x 8 columns]

Current validation loss: 0.911

Epoch 142:
Mean loss 0.863464256754433 - Correctly labeled training images 68.79%
Classified 66.01 % of validation images correctly.
Precision on validation set: [0.27 0.49 0.35 0.   0.61 0.78 0.   1.  ]
Recall on validation set: [0.07 0.78 0.29 0.   0.41 0.89 0.   0.15]
F1-score on validation set: [0.11 0.6  0.32 0.   0.49 0.83 0.   0.27]
ROC AUC on validation set: {'AK': 0.8, 'BCC': 0.93, 'BKL': 0.63, 'DF': 0.82, 'MEL': 0.52, 'NV': 0.15, 'SCC': 0.85, 'VASC': 0.74}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             3           25  ...            0             0
true class BCC            3          130  ...            1             0
true class BKL            1           31  ...            0             0
true class DF             0            8  ...            0             0
true class MEL            2           25  ...            0             0
true class NV             0           18  ...            0             0
true class SCC            2           22  ...            0             0
true class VASC           0            5  ...            0             2

[8 rows x 8 columns]

Current validation loss: 0.921

Epoch 143:
Mean loss 0.8573660324518613 - Correctly labeled training images 68.75%
Classified 66.01 % of validation images correctly.
Precision on validation set: [0.38 0.51 0.33 0.   0.6  0.78 0.   0.5 ]
Recall on validation set: [0.07 0.74 0.3  0.   0.43 0.89 0.   0.15]
F1-score on validation set: [0.12 0.61 0.31 0.   0.5  0.83 0.   0.24]
ROC AUC on validation set: {'AK': 0.79, 'BCC': 0.93, 'BKL': 0.63, 'DF': 0.83, 'MEL': 0.52, 'NV': 0.15, 'SCC': 0.84, 'VASC': 0.74}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             3           18  ...            0             0
true class BCC            1          124  ...            1             0
true class BKL            1           27  ...            0             0
true class DF             0            7  ...            0             0
true class MEL            2           22  ...            0             0
true class NV             0           18  ...            0             2
true class SCC            1           19  ...            0             0
true class VASC           0            6  ...            0             2

[8 rows x 8 columns]

Current validation loss: 0.927

Epoch 144:
Mean loss 0.8588295721387261 - Correctly labeled training images 68.92%
Classified 66.32 % of validation images correctly.
Precision on validation set: [0.24 0.55 0.38 0.   0.57 0.77 0.33 1.  ]
Recall on validation set: [0.14 0.77 0.28 0.   0.38 0.9  0.03 0.23]
F1-score on validation set: [0.18 0.64 0.32 0.   0.45 0.83 0.06 0.38]
ROC AUC on validation set: {'AK': 0.77, 'BCC': 0.93, 'BKL': 0.62, 'DF': 0.84, 'MEL': 0.49, 'NV': 0.17, 'SCC': 0.85, 'VASC': 0.76}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             6           17  ...            0             0
true class BCC            4          128  ...            2             0
true class BKL            6           20  ...            0             0
true class DF             0            7  ...            0             0
true class MEL            4           19  ...            0             0
true class NV             2           17  ...            0             0
true class SCC            3           22  ...            1             0
true class VASC           0            4  ...            0             3

[8 rows x 8 columns]

Current validation loss: 0.916

Epoch 145:
Mean loss 0.8501753826810734 - Correctly labeled training images 69.35%
Classified 66.09 % of validation images correctly.
Precision on validation set: [0.33 0.52 0.37 0.   0.57 0.76 1.   1.  ]
Recall on validation set: [0.07 0.77 0.26 0.   0.38 0.91 0.03 0.23]
F1-score on validation set: [0.12 0.62 0.31 0.   0.45 0.83 0.06 0.38]
ROC AUC on validation set: {'AK': 0.8, 'BCC': 0.93, 'BKL': 0.63, 'DF': 0.83, 'MEL': 0.51, 'NV': 0.15, 'SCC': 0.87, 'VASC': 0.7}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             3           22  ...            0             0
true class BCC            2          128  ...            0             0
true class BKL            1           25  ...            0             0
true class DF             0            7  ...            0             0
true class MEL            2           18  ...            0             0
true class NV             0           17  ...            0             0
true class SCC            1           24  ...            1             0
true class VASC           0            4  ...            0             3

[8 rows x 8 columns]

Current validation loss: 0.917

Epoch 146:
Mean loss 0.8499851703455772 - Correctly labeled training images 69.07%
Classified 65.93 % of validation images correctly.
Precision on validation set: [0.3  0.53 0.37 0.   0.61 0.74 0.   1.  ]
Recall on validation set: [0.07 0.74 0.23 0.   0.36 0.93 0.   0.08]
F1-score on validation set: [0.11 0.62 0.28 0.   0.45 0.82 0.   0.14]
ROC AUC on validation set: {'AK': 0.8, 'BCC': 0.93, 'BKL': 0.63, 'DF': 0.83, 'MEL': 0.51, 'NV': 0.16, 'SCC': 0.86, 'VASC': 0.72}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             3           20  ...            0             0
true class BCC            2          123  ...            1             0
true class BKL            3           19  ...            0             0
true class DF             0            7  ...            0             0
true class MEL            1           20  ...            0             0
true class NV             0           13  ...            0             0
true class SCC            1           23  ...            0             0
true class VASC           0            5  ...            0             1

[8 rows x 8 columns]

Current validation loss: 0.929

Epoch 147:
Mean loss 0.8491905327851088 - Correctly labeled training images 69.19%
Classified 65.69 % of validation images correctly.
Precision on validation set: [0.43 0.49 0.37 0.   0.61 0.76 0.67 1.  ]
Recall on validation set: [0.07 0.78 0.3  0.   0.33 0.9  0.06 0.08]
F1-score on validation set: [0.12 0.61 0.33 0.   0.43 0.83 0.11 0.14]
ROC AUC on validation set: {'AK': 0.8, 'BCC': 0.93, 'BKL': 0.64, 'DF': 0.81, 'MEL': 0.52, 'NV': 0.14, 'SCC': 0.85, 'VASC': 0.73}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             3           25  ...            0             0
true class BCC            1          131  ...            1             0
true class BKL            1           32  ...            0             0
true class DF             0            8  ...            0             0
true class MEL            1           23  ...            0             0
true class NV             0           19  ...            0             0
true class SCC            1           23  ...            2             0
true class VASC           0            5  ...            0             1

/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
[8 rows x 8 columns]

Current validation loss: 0.926

Epoch 148:
Mean loss 0.8416541557676784 - Correctly labeled training images 69.80%
Classified 65.85 % of validation images correctly.
Precision on validation set: [0.5  0.51 0.33 0.   0.56 0.76 1.   1.  ]
Recall on validation set: [0.05 0.71 0.25 0.   0.4  0.92 0.03 0.08]
F1-score on validation set: [0.09 0.59 0.29 0.   0.47 0.83 0.06 0.14]
ROC AUC on validation set: {'AK': 0.8, 'BCC': 0.93, 'BKL': 0.62, 'DF': 0.82, 'MEL': 0.49, 'NV': 0.17, 'SCC': 0.87, 'VASC': 0.73}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             2           22  ...            0             0
true class BCC            0          118  ...            0             0
true class BKL            0           21  ...            0             0
true class DF             0            6  ...            0             0
true class MEL            1           21  ...            0             0
true class NV             0           15  ...            0             0
true class SCC            1           24  ...            1             0
true class VASC           0            4  ...            0             1

[8 rows x 8 columns]

Current validation loss: 0.921

Epoch 149:
Mean loss 0.8364076107646389 - Correctly labeled training images 69.85%
Classified 65.93 % of validation images correctly.
Precision on validation set: [0.17 0.51 0.35 0.   0.57 0.78 0.5  0.67]
Recall on validation set: [0.05 0.72 0.3  0.   0.39 0.91 0.03 0.15]
F1-score on validation set: [0.07 0.6  0.32 0.   0.46 0.84 0.06 0.25]
ROC AUC on validation set: {'AK': 0.79, 'BCC': 0.93, 'BKL': 0.62, 'DF': 0.83, 'MEL': 0.5, 'NV': 0.16, 'SCC': 0.87, 'VASC': 0.76}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             2           21  ...            0             0
true class BCC            4          121  ...            1             0
true class BKL            1           24  ...            0             0
true class DF             0            8  ...            0             0
true class MEL            3           18  ...            0             0
true class NV             0           13  ...            0             1
true class SCC            2           25  ...            1             0
true class VASC           0            5  ...            0             2

[8 rows x 8 columns]

Current validation loss: 0.916

Epoch 150:
Mean loss 0.839663489900929 - Correctly labeled training images 69.66%
Classified 65.38 % of validation images correctly.
Precision on validation set: [0.25 0.55 0.32 0.   0.54 0.75 1.   1.  ]
Recall on validation set: [0.12 0.7  0.2  0.   0.39 0.92 0.03 0.08]
F1-score on validation set: [0.16 0.62 0.24 0.   0.46 0.82 0.06 0.14]
ROC AUC on validation set: {'AK': 0.81, 'BCC': 0.93, 'BKL': 0.62, 'DF': 0.83, 'MEL': 0.51, 'NV': 0.16, 'SCC': 0.85, 'VASC': 0.71}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             5           22  ...            0             0
true class BCC            7          117  ...            0             0
true class BKL            3           17  ...            0             0
true class DF             1            5  ...            0             0
true class MEL            2           16  ...            0             0
true class NV             0           13  ...            0             0
true class SCC            2           18  ...            1             0
true class VASC           0            4  ...            0             1

[8 rows x 8 columns]

Current validation loss: 0.929

Epoch 151:
Mean loss 0.8313901169631007 - Correctly labeled training images 69.98%
Classified 66.48 % of validation images correctly.
Precision on validation set: [0.42 0.52 0.4  0.   0.6  0.77 0.   1.  ]
Recall on validation set: [0.12 0.77 0.31 0.   0.41 0.89 0.   0.08]
F1-score on validation set: [0.18 0.62 0.35 0.   0.49 0.83 0.   0.14]
ROC AUC on validation set: {'AK': 0.78, 'BCC': 0.93, 'BKL': 0.62, 'DF': 0.86, 'MEL': 0.52, 'NV': 0.15, 'SCC': 0.85, 'VASC': 0.73}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             5           22  ...            0             0
true class BCC            2          128  ...            3             0
true class BKL            1           22  ...            1             0
true class DF             0            9  ...            0             0
true class MEL            2           21  ...            0             0
true class NV             0           18  ...            0             0
true class SCC            2           22  ...            0             0
true class VASC           0            5  ...            0             1

[8 rows x 8 columns]

Current validation loss: 0.909

Epoch 152:
Mean loss 0.8442647580280664 - Correctly labeled training images 69.63%
Classified 66.32 % of validation images correctly.
Precision on validation set: [0.33 0.55 0.4  0.   0.57 0.75 0.   1.  ]
Recall on validation set: [0.09 0.73 0.32 0.   0.39 0.9  0.   0.15]
F1-score on validation set: [0.15 0.63 0.35 0.   0.47 0.82 0.   0.27]
ROC AUC on validation set: {'AK': 0.78, 'BCC': 0.93, 'BKL': 0.63, 'DF': 0.83, 'MEL': 0.5, 'NV': 0.16, 'SCC': 0.86, 'VASC': 0.71}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             4           19  ...            0             0
true class BCC            2          122  ...            0             0
true class BKL            2           19  ...            0             0
true class DF             0            7  ...            0             0
true class MEL            2           14  ...            0             0
true class NV             0           14  ...            0             0
true class SCC            2           21  ...            0             0
true class VASC           0            5  ...            0             2

[8 rows x 8 columns]

Current validation loss: 0.910

Epoch 153:
Mean loss 0.8342967651525882 - Correctly labeled training images 70.02%
Classified 65.85 % of validation images correctly.
Precision on validation set: [0.36 0.55 0.35 0.   0.6  0.74 0.   0.67]
Recall on validation set: [0.09 0.77 0.27 0.   0.34 0.91 0.   0.15]
F1-score on validation set: [0.15 0.64 0.3  0.   0.43 0.82 0.   0.25]
ROC AUC on validation set: {'AK': 0.79, 'BCC': 0.94, 'BKL': 0.63, 'DF': 0.83, 'MEL': 0.51, 'NV': 0.15, 'SCC': 0.86, 'VASC': 0.65}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             4           19  ...            0             0
true class BCC            2          128  ...            1             0
true class BKL            1           26  ...            0             0
true class DF             0            6  ...            0             0
true class MEL            2           17  ...            0             0
true class NV             0           14  ...            0             1
true class SCC            2           21  ...            0             0
true class VASC           0            3  ...            0             2

[8 rows x 8 columns]

Current validation loss: 0.915

Epoch 154:
Mean loss 0.8240247318985334 - Correctly labeled training images 70.33%
Classified 66.17 % of validation images correctly.
Precision on validation set: [0.3  0.54 0.36 0.   0.58 0.77 0.5  1.  ]
Recall on validation set: [0.14 0.76 0.28 0.   0.39 0.9  0.06 0.08]
F1-score on validation set: [0.19 0.63 0.31 0.   0.47 0.83 0.11 0.14]
ROC AUC on validation set: {'AK': 0.8, 'BCC': 0.94, 'BKL': 0.63, 'DF': 0.82, 'MEL': 0.51, 'NV': 0.15, 'SCC': 0.86, 'VASC': 0.7}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             6           19  ...            0             0
true class BCC            5          127  ...            1             0
true class BKL            4           21  ...            0             0
true class DF             0            8  ...            0             0
true class MEL            2           15  ...            1             0
true class NV             0           18  ...            0             0
true class SCC            3           21  ...            2             0
true class VASC           0            5  ...            0             1

[8 rows x 8 columns]

Current validation loss: 0.896

Epoch 155:
Mean loss 0.8286222655690431 - Correctly labeled training images 70.16%
Classified 66.96 % of validation images correctly.
Precision on validation set: [0.38 0.53 0.46 0.   0.55 0.78 0.25 1.  ]
Recall on validation set: [0.14 0.81 0.32 0.   0.42 0.88 0.03 0.23]
F1-score on validation set: [0.2  0.64 0.38 0.   0.47 0.83 0.06 0.38]
ROC AUC on validation set: {'AK': 0.8, 'BCC': 0.94, 'BKL': 0.62, 'DF': 0.82, 'MEL': 0.51, 'NV': 0.15, 'SCC': 0.85, 'VASC': 0.69}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             6           21  ...            0             0
true class BCC            3          136  ...            2             0
true class BKL            2           21  ...            0             0
true class DF             0            6  ...            0             0
true class MEL            3           24  ...            1             0
true class NV             1           20  ...            0             0
true class SCC            1           23  ...            1             0
true class VASC           0            4  ...            0             3

[8 rows x 8 columns]

Current validation loss: 0.894

Epoch 156:
Mean loss 0.8261876266085387 - Correctly labeled training images 70.24%
Classified 67.27 % of validation images correctly.
Precision on validation set: [0.33 0.55 0.4  0.   0.62 0.76 0.5  1.  ]
Recall on validation set: [0.16 0.76 0.29 0.   0.37 0.92 0.06 0.23]
F1-score on validation set: [0.22 0.64 0.33 0.   0.47 0.83 0.11 0.38]
ROC AUC on validation set: {'AK': 0.8, 'BCC': 0.93, 'BKL': 0.63, 'DF': 0.85, 'MEL': 0.52, 'NV': 0.15, 'SCC': 0.85, 'VASC': 0.72}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             7           18  ...            0             0
true class BCC            3          127  ...            1             0
true class BKL            6           21  ...            0             0
true class DF             0            8  ...            0             0
true class MEL            3           17  ...            1             0
true class NV             0           13  ...            0             0
true class SCC            2           21  ...            2             0
true class VASC           0            4  ...            0             3

[8 rows x 8 columns]

Current validation loss: 0.920

Epoch 157:
Mean loss 0.8203503148224828 - Correctly labeled training images 70.10%
Classified 65.62 % of validation images correctly.
Precision on validation set: [0.25 0.54 0.38 0.   0.53 0.76 0.   0.8 ]
Recall on validation set: [0.09 0.72 0.27 0.   0.42 0.89 0.   0.31]
F1-score on validation set: [0.14 0.61 0.31 0.   0.47 0.82 0.   0.44]
ROC AUC on validation set: {'AK': 0.79, 'BCC': 0.93, 'BKL': 0.61, 'DF': 0.85, 'MEL': 0.51, 'NV': 0.16, 'SCC': 0.86, 'VASC': 0.7}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             4           18  ...            0             0
true class BCC            6          120  ...            1             0
true class BKL            3           20  ...            0             0
true class DF             0            7  ...            0             0
true class MEL            1           19  ...            0             0
true class NV             0           16  ...            0             1
true class SCC            2           22  ...            0             0
true class VASC           0            2  ...            0             4

[8 rows x 8 columns]

Current validation loss: 0.918

Epoch 158:
Mean loss 0.817632255117976 - Correctly labeled training images 70.17%
Classified 66.09 % of validation images correctly.
Precision on validation set: [0.28 0.54 0.44 0.   0.56 0.75 0.25 1.  ]
Recall on validation set: [0.12 0.72 0.31 0.   0.4  0.9  0.03 0.23]
F1-score on validation set: [0.16 0.61 0.36 0.   0.47 0.82 0.06 0.38]
ROC AUC on validation set: {'AK': 0.78, 'BCC': 0.93, 'BKL': 0.62, 'DF': 0.85, 'MEL': 0.52, 'NV': 0.15, 'SCC': 0.84, 'VASC': 0.76}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             5           18  ...            0             0
true class BCC            4          120  ...            2             0
true class BKL            4           17  ...            1             0
true class DF             0            9  ...            0             0
true class MEL            3           17  ...            0             0
true class NV             0           18  ...            0             0
true class SCC            2           19  ...            1             0
true class VASC           0            6  ...            0             3

[8 rows x 8 columns]

Current validation loss: 0.910

Epoch 159:
Mean loss 0.8243841481415631 - Correctly labeled training images 70.34%
Classified 65.38 % of validation images correctly.
Precision on validation set: [0.14 0.51 0.38 0.   0.55 0.78 0.   1.  ]
Recall on validation set: [0.07 0.69 0.34 0.   0.42 0.89 0.   0.15]
F1-score on validation set: [0.09 0.59 0.36 0.   0.47 0.83 0.   0.27]
ROC AUC on validation set: {'AK': 0.79, 'BCC': 0.93, 'BKL': 0.62, 'DF': 0.82, 'MEL': 0.5, 'NV': 0.16, 'SCC': 0.86, 'VASC': 0.75}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             3           22  ...            0             0
true class BCC            6          116  ...            1             0
true class BKL            3           23  ...            0             0
true class DF             0            6  ...            0             0
true class MEL            4           20  ...            0             0
true class NV             0           16  ...            0             0
true class SCC            5           20  ...            0             0
true class VASC           0            6  ...            0             2

[8 rows x 8 columns]

Current validation loss: 0.910

Epoch 160:
Mean loss 0.8184074216084526 - Correctly labeled training images 70.13%
Classified 67.43 % of validation images correctly.
Precision on validation set: [0.17 0.49 0.43 0.   0.61 0.8  0.5  0.8 ]
Recall on validation set: [0.05 0.81 0.32 0.   0.44 0.89 0.06 0.31]
F1-score on validation set: [0.07 0.61 0.37 0.   0.51 0.84 0.11 0.44]
ROC AUC on validation set: {'AK': 0.79, 'BCC': 0.94, 'BKL': 0.61, 'DF': 0.83, 'MEL': 0.49, 'NV': 0.17, 'SCC': 0.84, 'VASC': 0.74}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             2           28  ...            0             0
true class BCC            4          136  ...            2             0
true class BKL            3           31  ...            0             0
true class DF             0            7  ...            0             0
true class MEL            1           25  ...            0             0
true class NV             0           20  ...            0             1
true class SCC            2           25  ...            2             0
true class VASC           0            4  ...            0             4

[8 rows x 8 columns]

Current validation loss: 0.903

Epoch 161:
Mean loss 0.8127566806337435 - Correctly labeled training images 70.52%
Classified 65.38 % of validation images correctly.
Precision on validation set: [0.35 0.53 0.36 0.   0.59 0.76 0.5  0.4 ]
Recall on validation set: [0.14 0.75 0.34 0.   0.36 0.88 0.03 0.15]
F1-score on validation set: [0.2  0.62 0.35 0.   0.45 0.82 0.06 0.22]
ROC AUC on validation set: {'AK': 0.77, 'BCC': 0.94, 'BKL': 0.63, 'DF': 0.83, 'MEL': 0.52, 'NV': 0.15, 'SCC': 0.84, 'VASC': 0.75}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             6           17  ...            0             0
true class BCC            3          125  ...            1             1
true class BKL            3           19  ...            0             0
true class DF             0            7  ...            0             0
true class MEL            2           23  ...            0             0
true class NV             0           20  ...            0             2
true class SCC            3           17  ...            1             0
true class VASC           0            7  ...            0             2

/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
[8 rows x 8 columns]

Current validation loss: 0.901

Epoch 162:
Mean loss 0.8090729697457624 - Correctly labeled training images 70.88%
Classified 66.40 % of validation images correctly.
Precision on validation set: [0.17 0.53 0.38 0.   0.59 0.78 0.4  1.  ]
Recall on validation set: [0.07 0.76 0.37 0.   0.34 0.9  0.06 0.31]
F1-score on validation set: [0.1  0.62 0.38 0.   0.43 0.84 0.11 0.47]
ROC AUC on validation set: {'AK': 0.8, 'BCC': 0.94, 'BKL': 0.62, 'DF': 0.83, 'MEL': 0.52, 'NV': 0.15, 'SCC': 0.85, 'VASC': 0.72}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             3           21  ...            0             0
true class BCC            5          127  ...            2             0
true class BKL            2           28  ...            0             0
true class DF             0            8  ...            0             0
true class MEL            4           18  ...            1             0
true class NV             1           15  ...            0             0
true class SCC            3           20  ...            2             0
true class VASC           0            4  ...            0             4

[8 rows x 8 columns]

Current validation loss: 0.911

Epoch 163:
Mean loss 0.8137404857561792 - Correctly labeled training images 70.51%
Classified 67.74 % of validation images correctly.
Precision on validation set: [0.21 0.56 0.42 0.   0.6  0.77 0.67 1.  ]
Recall on validation set: [0.07 0.75 0.37 0.   0.39 0.91 0.06 0.15]
F1-score on validation set: [0.11 0.64 0.39 0.   0.48 0.84 0.11 0.27]
ROC AUC on validation set: {'AK': 0.79, 'BCC': 0.94, 'BKL': 0.62, 'DF': 0.83, 'MEL': 0.51, 'NV': 0.15, 'SCC': 0.86, 'VASC': 0.74}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             3           20  ...            0             0
true class BCC            4          126  ...            1             0
true class BKL            1           24  ...            0             0
true class DF             0            7  ...            0             0
true class MEL            3           14  ...            0             0
true class NV             0           11  ...            0             0
true class SCC            3           20  ...            2             0
true class VASC           0            5  ...            0             2

[8 rows x 8 columns]

Current validation loss: 0.884

Epoch 164:
Mean loss 0.8060026503511784 - Correctly labeled training images 70.62%
Classified 66.80 % of validation images correctly.
Precision on validation set: [0.33 0.53 0.4  0.   0.54 0.8  0.   0.8 ]
Recall on validation set: [0.16 0.81 0.28 0.   0.43 0.88 0.   0.31]
F1-score on validation set: [0.22 0.64 0.33 0.   0.48 0.84 0.   0.44]
ROC AUC on validation set: {'AK': 0.78, 'BCC': 0.94, 'BKL': 0.63, 'DF': 0.83, 'MEL': 0.5, 'NV': 0.15, 'SCC': 0.85, 'VASC': 0.79}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             7           21  ...            0             0
true class BCC            5          135  ...            2             0
true class BKL            3           24  ...            0             0
true class DF             0            9  ...            0             0
true class MEL            3           19  ...            1             1
true class NV             0           22  ...            0             0
true class SCC            3           23  ...            0             0
true class VASC           0            4  ...            0             4

[8 rows x 8 columns]

Current validation loss: 0.885

Epoch 165:
Mean loss 0.8017882878660028 - Correctly labeled training images 70.90%
Classified 67.59 % of validation images correctly.
Precision on validation set: [0.42 0.56 0.4  0.   0.61 0.78 0.   1.  ]
Recall on validation set: [0.26 0.72 0.35 0.   0.42 0.9  0.   0.15]
F1-score on validation set: [0.32 0.63 0.37 0.   0.5  0.84 0.   0.27]
ROC AUC on validation set: {'AK': 0.78, 'BCC': 0.94, 'BKL': 0.63, 'DF': 0.82, 'MEL': 0.52, 'NV': 0.15, 'SCC': 0.84, 'VASC': 0.75}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            11           12  ...            0             0
true class BCC            6          121  ...            2             0
true class BKL            4           20  ...            0             0
true class DF             0            6  ...            0             0
true class MEL            2           19  ...            0             0
true class NV             1           16  ...            0             0
true class SCC            2           19  ...            0             0
true class VASC           0            5  ...            0             2

[8 rows x 8 columns]

Current validation loss: 0.900

Epoch 166:
Mean loss 0.8032177618531399 - Correctly labeled training images 70.95%
Classified 66.17 % of validation images correctly.
Precision on validation set: [0.19 0.58 0.36 0.   0.57 0.76 0.33 1.  ]
Recall on validation set: [0.12 0.67 0.3  0.   0.41 0.91 0.03 0.31]
F1-score on validation set: [0.14 0.62 0.33 0.   0.48 0.83 0.06 0.47]
ROC AUC on validation set: {'AK': 0.8, 'BCC': 0.93, 'BKL': 0.62, 'DF': 0.82, 'MEL': 0.53, 'NV': 0.15, 'SCC': 0.84, 'VASC': 0.72}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             5           18  ...            0             0
true class BCC            6          112  ...            2             0
true class BKL            6           14  ...            0             0
true class DF             0            7  ...            0             0
true class MEL            4           19  ...            0             0
true class NV             1            7  ...            0             0
true class SCC            4           14  ...            1             0
true class VASC           0            3  ...            0             4

[8 rows x 8 columns]

Current validation loss: 0.912

Epoch 167:
Mean loss 0.7998810863175226 - Correctly labeled training images 71.13%
Classified 66.56 % of validation images correctly.
Precision on validation set: [0.23 0.55 0.36 0.   0.62 0.76 0.5  0.67]
Recall on validation set: [0.07 0.79 0.27 0.   0.38 0.91 0.06 0.15]
F1-score on validation set: [0.11 0.65 0.31 0.   0.47 0.83 0.11 0.25]
ROC AUC on validation set: {'AK': 0.81, 'BCC': 0.94, 'BKL': 0.62, 'DF': 0.85, 'MEL': 0.53, 'NV': 0.14, 'SCC': 0.85, 'VASC': 0.68}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             3           23  ...            0             0
true class BCC            2          132  ...            1             0
true class BKL            2           21  ...            0             0
true class DF             0           10  ...            0             0
true class MEL            4           17  ...            1             0
true class NV             0           13  ...            0             1
true class SCC            2           22  ...            2             0
true class VASC           0            3  ...            0             2

[8 rows x 8 columns]

Current validation loss: 0.914

Epoch 168:
Mean loss 0.797948025378519 - Correctly labeled training images 71.21%
Classified 67.19 % of validation images correctly.
Precision on validation set: [0.25 0.62 0.37 0.   0.55 0.78 0.67 1.  ]
Recall on validation set: [0.14 0.72 0.34 0.   0.5  0.88 0.06 0.08]
F1-score on validation set: [0.18 0.66 0.35 0.   0.53 0.83 0.11 0.14]
ROC AUC on validation set: {'AK': 0.78, 'BCC': 0.93, 'BKL': 0.62, 'DF': 0.85, 'MEL': 0.52, 'NV': 0.15, 'SCC': 0.84, 'VASC': 0.69}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             6           14  ...            0             0
true class BCC            4          120  ...            1             0
true class BKL            4           16  ...            0             0
true class DF             0            7  ...            0             0
true class MEL            7           14  ...            0             0
true class NV             1            7  ...            0             0
true class SCC            2           13  ...            2             0
true class VASC           0            4  ...            0             1

/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
[8 rows x 8 columns]

Current validation loss: 0.906

Epoch 169:
Mean loss 0.7945959539819591 - Correctly labeled training images 71.03%
Classified 67.67 % of validation images correctly.
Precision on validation set: [0.41 0.58 0.42 0.   0.58 0.77 0.17 1.  ]
Recall on validation set: [0.21 0.71 0.35 0.   0.42 0.91 0.03 0.23]
F1-score on validation set: [0.28 0.63 0.38 0.   0.49 0.84 0.05 0.38]
ROC AUC on validation set: {'AK': 0.79, 'BCC': 0.94, 'BKL': 0.63, 'DF': 0.83, 'MEL': 0.53, 'NV': 0.14, 'SCC': 0.84, 'VASC': 0.73}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             9           17  ...            0             0
true class BCC            6          118  ...            2             0
true class BKL            4           15  ...            2             0
true class DF             0            7  ...            0             0
true class MEL            1           16  ...            1             0
true class NV             0            9  ...            0             0
true class SCC            2           18  ...            1             0
true class VASC           0            5  ...            0             3

[8 rows x 8 columns]

Current validation loss: 0.893

Epoch 170:
Mean loss 0.7902253592616 - Correctly labeled training images 71.42%
Classified 66.64 % of validation images correctly.
Precision on validation set: [0.17 0.54 0.41 0.   0.59 0.76 0.5  1.  ]
Recall on validation set: [0.07 0.74 0.29 0.   0.35 0.93 0.03 0.15]
F1-score on validation set: [0.1  0.63 0.34 0.   0.44 0.83 0.06 0.27]
ROC AUC on validation set: {'AK': 0.78, 'BCC': 0.93, 'BKL': 0.62, 'DF': 0.83, 'MEL': 0.5, 'NV': 0.17, 'SCC': 0.86, 'VASC': 0.74}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             3           21  ...            0             0
true class BCC            4          124  ...            1             0
true class BKL            5           21  ...            0             0
true class DF             0            7  ...            0             0
true class MEL            3           18  ...            0             0
true class NV             1           11  ...            0             0
true class SCC            2           23  ...            1             0
true class VASC           0            4  ...            0             2

[8 rows x 8 columns]

Current validation loss: 0.919

Epoch 171:
Mean loss 0.783572688839789 - Correctly labeled training images 71.66%
Classified 67.35 % of validation images correctly.
Precision on validation set: [0.35 0.54 0.38 0.   0.6  0.78 0.33 0.67]
Recall on validation set: [0.16 0.77 0.28 0.   0.42 0.91 0.06 0.15]
F1-score on validation set: [0.22 0.64 0.32 0.   0.49 0.84 0.11 0.25]
ROC AUC on validation set: {'AK': 0.78, 'BCC': 0.94, 'BKL': 0.61, 'DF': 0.86, 'MEL': 0.51, 'NV': 0.16, 'SCC': 0.85, 'VASC': 0.7}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             7           16  ...            0             0
true class BCC            3          128  ...            3             0
true class BKL            4           21  ...            0             0
true class DF             0            8  ...            0             0
true class MEL            4           20  ...            1             0
true class NV             0           17  ...            0             1
true class SCC            2           21  ...            2             0
true class VASC           0            5  ...            0             2

[8 rows x 8 columns]

Current validation loss: 0.885

Epoch 172:
Mean loss 0.782319380140831 - Correctly labeled training images 71.50%
Classified 66.72 % of validation images correctly.
Precision on validation set: [0.24 0.57 0.4  0.   0.57 0.76 0.43 0.67]
Recall on validation set: [0.12 0.72 0.27 0.   0.42 0.91 0.09 0.31]
F1-score on validation set: [0.16 0.64 0.33 0.   0.48 0.83 0.15 0.42]
ROC AUC on validation set: {'AK': 0.78, 'BCC': 0.94, 'BKL': 0.62, 'DF': 0.81, 'MEL': 0.51, 'NV': 0.16, 'SCC': 0.86, 'VASC': 0.74}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             5           17  ...            0             0
true class BCC            5          120  ...            3             2
true class BKL            4           18  ...            1             0
true class DF             1            5  ...            0             0
true class MEL            3           16  ...            0             0
true class NV             1           12  ...            0             0
true class SCC            2           19  ...            3             0
true class VASC           0            3  ...            0             4

[8 rows x 8 columns]

Current validation loss: 0.904

Epoch 173:
Mean loss 0.7797026865489851 - Correctly labeled training images 71.97%
Classified 67.43 % of validation images correctly.
Precision on validation set: [0.31 0.55 0.37 0.   0.61 0.78 0.43 0.71]
Recall on validation set: [0.09 0.77 0.29 0.   0.41 0.91 0.09 0.38]
F1-score on validation set: [0.14 0.64 0.32 0.   0.49 0.84 0.15 0.5 ]
ROC AUC on validation set: {'AK': 0.81, 'BCC': 0.94, 'BKL': 0.63, 'DF': 0.85, 'MEL': 0.51, 'NV': 0.15, 'SCC': 0.85, 'VASC': 0.73}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             4           23  ...            0             0
true class BCC            0          128  ...            3             1
true class BKL            5           23  ...            1             0
true class DF             0            9  ...            0             0
true class MEL            2           14  ...            0             1
true class NV             1           13  ...            0             0
true class SCC            1           17  ...            3             0
true class VASC           0            4  ...            0             5

[8 rows x 8 columns]

Current validation loss: 0.883

Epoch 174:
Mean loss 0.7784542313979628 - Correctly labeled training images 71.72%
Classified 68.06 % of validation images correctly.
Precision on validation set: [0.35 0.58 0.4  0.   0.59 0.78 0.67 0.83]
Recall on validation set: [0.19 0.74 0.31 0.   0.45 0.9  0.06 0.38]
F1-score on validation set: [0.24 0.65 0.35 0.   0.51 0.84 0.11 0.53]
ROC AUC on validation set: {'AK': 0.8, 'BCC': 0.94, 'BKL': 0.62, 'DF': 0.82, 'MEL': 0.52, 'NV': 0.15, 'SCC': 0.85, 'VASC': 0.68}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             8           19  ...            0             0
true class BCC            4          124  ...            1             1
true class BKL            4           19  ...            0             0
true class DF             0            6  ...            0             0
true class MEL            3           14  ...            0             0
true class NV             1           11  ...            0             0
true class SCC            3           18  ...            2             0
true class VASC           0            1  ...            0             5

[8 rows x 8 columns]

Current validation loss: 0.882

Epoch 175:
Mean loss 0.7770963840962208 - Correctly labeled training images 71.89%
Classified 67.43 % of validation images correctly.
Precision on validation set: [0.3  0.55 0.44 0.   0.6  0.78 0.5  0.75]
Recall on validation set: [0.26 0.74 0.31 0.   0.42 0.9  0.06 0.23]
F1-score on validation set: [0.28 0.63 0.36 0.   0.49 0.83 0.11 0.35]
ROC AUC on validation set: {'AK': 0.8, 'BCC': 0.93, 'BKL': 0.62, 'DF': 0.83, 'MEL': 0.51, 'NV': 0.16, 'SCC': 0.84, 'VASC': 0.7}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            11           17  ...            0             0
true class BCC            7          123  ...            1             0
true class BKL           10           15  ...            1             0
true class DF             0            6  ...            0             0
true class MEL            5           22  ...            0             1
true class NV             2           18  ...            0             0
true class SCC            2           19  ...            2             0
true class VASC           0            4  ...            0             3

/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
[8 rows x 8 columns]

Current validation loss: 0.896

Epoch 176:
Mean loss 0.7746120104184286 - Correctly labeled training images 72.28%
Classified 66.88 % of validation images correctly.
Precision on validation set: [0.24 0.62 0.38 0.   0.57 0.76 0.5  0.75]
Recall on validation set: [0.09 0.72 0.37 0.   0.42 0.89 0.06 0.23]
F1-score on validation set: [0.13 0.67 0.37 0.   0.49 0.82 0.11 0.35]
ROC AUC on validation set: {'AK': 0.79, 'BCC': 0.94, 'BKL': 0.62, 'DF': 0.83, 'MEL': 0.52, 'NV': 0.15, 'SCC': 0.83, 'VASC': 0.72}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             4           16  ...            0             0
true class BCC            4          120  ...            1             0
true class BKL            2           11  ...            1             0
true class DF             0            6  ...            0             0
true class MEL            4           12  ...            0             0
true class NV             1           11  ...            0             1
true class SCC            2           14  ...            2             0
true class VASC           0            3  ...            0             3

[8 rows x 8 columns]

Current validation loss: 0.897

Epoch 177:
Mean loss 0.7700485535412557 - Correctly labeled training images 72.09%
Classified 67.11 % of validation images correctly.
Precision on validation set: [0.27 0.57 0.39 0.   0.64 0.75 0.25 1.  ]
Recall on validation set: [0.09 0.7  0.33 0.   0.4  0.92 0.03 0.23]
F1-score on validation set: [0.14 0.63 0.36 0.   0.49 0.83 0.06 0.38]
ROC AUC on validation set: {'AK': 0.8, 'BCC': 0.93, 'BKL': 0.62, 'DF': 0.85, 'MEL': 0.53, 'NV': 0.14, 'SCC': 0.86, 'VASC': 0.67}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             4           18  ...            0             0
true class BCC            4          117  ...            2             0
true class BKL            3           16  ...            1             0
true class DF             0            7  ...            0             0
true class MEL            3           14  ...            0             0
true class NV             0           15  ...            0             0
true class SCC            1           17  ...            1             0
true class VASC           0            3  ...            0             3

[8 rows x 8 columns]

Current validation loss: 0.917

Epoch 178:
Mean loss 0.7641615223151276 - Correctly labeled training images 72.26%
Classified 67.90 % of validation images correctly.
Precision on validation set: [0.41 0.58 0.38 0.   0.64 0.77 0.33 0.8 ]
Recall on validation set: [0.26 0.74 0.31 0.   0.4  0.92 0.03 0.31]
F1-score on validation set: [0.31 0.65 0.34 0.   0.49 0.84 0.06 0.44]
ROC AUC on validation set: {'AK': 0.79, 'BCC': 0.94, 'BKL': 0.6, 'DF': 0.84, 'MEL': 0.51, 'NV': 0.16, 'SCC': 0.85, 'VASC': 0.73}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            11           15  ...            0             0
true class BCC            3          124  ...            2             0
true class BKL            5           17  ...            0             0
true class DF             0            9  ...            0             0
true class MEL            4           12  ...            0             1
true class NV             2           13  ...            0             0
true class SCC            2           21  ...            1             0
true class VASC           0            4  ...            0             4

[8 rows x 8 columns]

Current validation loss: 0.898

Epoch 179:
Mean loss 0.7668658792972565 - Correctly labeled training images 72.32%
Classified 66.88 % of validation images correctly.
Precision on validation set: [0.31 0.56 0.4  0.   0.57 0.75 0.75 1.  ]
Recall on validation set: [0.09 0.72 0.24 0.   0.45 0.91 0.09 0.38]
F1-score on validation set: [0.14 0.63 0.3  0.   0.5  0.82 0.17 0.56]
ROC AUC on validation set: {'AK': 0.8, 'BCC': 0.94, 'BKL': 0.62, 'DF': 0.83, 'MEL': 0.53, 'NV': 0.14, 'SCC': 0.87, 'VASC': 0.7}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             4           17  ...            0             0
true class BCC            3          121  ...            1             0
true class BKL            2           17  ...            0             0
true class DF             0            7  ...            0             0
true class MEL            2           16  ...            0             0
true class NV             1           13  ...            0             0
true class SCC            1           22  ...            3             0
true class VASC           0            3  ...            0             5

[8 rows x 8 columns]

Current validation loss: 0.914

Epoch 180:
Mean loss 0.7699032756808428 - Correctly labeled training images 72.05%
Classified 66.72 % of validation images correctly.
Precision on validation set: [0.17 0.53 0.43 0.   0.57 0.78 0.33 1.  ]
Recall on validation set: [0.07 0.73 0.32 0.   0.42 0.9  0.03 0.23]
F1-score on validation set: [0.1  0.61 0.37 0.   0.49 0.83 0.06 0.38]
ROC AUC on validation set: {'AK': 0.8, 'BCC': 0.93, 'BKL': 0.62, 'DF': 0.83, 'MEL': 0.53, 'NV': 0.14, 'SCC': 0.86, 'VASC': 0.7}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             3           22  ...            0             0
true class BCC            3          122  ...            2             0
true class BKL            5           20  ...            0             0
true class DF             0            8  ...            0             0
true class MEL            4           20  ...            0             0
true class NV             1           13  ...            0             0
true class SCC            2           22  ...            1             0
true class VASC           0            5  ...            0             3

[8 rows x 8 columns]

Current validation loss: 0.898

Epoch 181:
Mean loss 0.7572586339448905 - Correctly labeled training images 72.65%
Classified 68.69 % of validation images correctly.
Precision on validation set: [0.24 0.56 0.45 0.   0.6  0.79 0.67 0.75]
Recall on validation set: [0.12 0.75 0.3  0.   0.48 0.91 0.06 0.46]
F1-score on validation set: [0.16 0.64 0.36 0.   0.53 0.84 0.11 0.57]
ROC AUC on validation set: {'AK': 0.78, 'BCC': 0.94, 'BKL': 0.62, 'DF': 0.82, 'MEL': 0.51, 'NV': 0.16, 'SCC': 0.86, 'VASC': 0.72}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             5           21  ...            0             0
true class BCC            4          126  ...            1             0
true class BKL            7           21  ...            0             0
true class DF             1            7  ...            0             0
true class MEL            4           15  ...            0             0
true class NV             0           11  ...            0             2
true class SCC            0           23  ...            2             0
true class VASC           0            1  ...            0             6

[8 rows x 8 columns]

Current validation loss: 0.869

Epoch 182:
Mean loss 0.7548967624547354 - Correctly labeled training images 72.55%
Classified 67.98 % of validation images correctly.
Precision on validation set: [0.22 0.58 0.4  0.   0.61 0.77 0.4  1.  ]
Recall on validation set: [0.09 0.7  0.34 0.   0.44 0.92 0.06 0.31]
F1-score on validation set: [0.13 0.64 0.37 0.   0.51 0.84 0.11 0.47]
ROC AUC on validation set: {'AK': 0.8, 'BCC': 0.93, 'BKL': 0.63, 'DF': 0.83, 'MEL': 0.52, 'NV': 0.15, 'SCC': 0.86, 'VASC': 0.75}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             4           18  ...            0             0
true class BCC            5          117  ...            3             0
true class BKL            4           17  ...            0             0
true class DF             0            8  ...            0             0
true class MEL            1            9  ...            0             0
true class NV             1           10  ...            0             0
true class SCC            3           19  ...            2             0
true class VASC           0            3  ...            0             4

/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
[8 rows x 8 columns]

Current validation loss: 0.897

Epoch 183:
Mean loss 0.74515827785155 - Correctly labeled training images 73.31%
Classified 67.82 % of validation images correctly.
Precision on validation set: [0.29 0.59 0.4  0.   0.59 0.78 0.5  1.  ]
Recall on validation set: [0.14 0.75 0.4  0.   0.39 0.9  0.06 0.31]
F1-score on validation set: [0.19 0.66 0.4  0.   0.47 0.84 0.11 0.47]
ROC AUC on validation set: {'AK': 0.78, 'BCC': 0.94, 'BKL': 0.61, 'DF': 0.82, 'MEL': 0.52, 'NV': 0.15, 'SCC': 0.85, 'VASC': 0.72}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             6           13  ...            0             0
true class BCC            4          126  ...            1             0
true class BKL            3           18  ...            0             0
true class DF             0            7  ...            0             0
true class MEL            3           15  ...            1             0
true class NV             2           14  ...            0             0
true class SCC            3           19  ...            2             0
true class VASC           0            3  ...            0             4

[8 rows x 8 columns]

Current validation loss: 0.896

Epoch 184:
Mean loss 0.7545673537893626 - Correctly labeled training images 72.73%
Classified 66.64 % of validation images correctly.
Precision on validation set: [0.26 0.55 0.35 0.   0.61 0.77 0.5  1.  ]
Recall on validation set: [0.16 0.72 0.28 0.   0.44 0.89 0.06 0.46]
F1-score on validation set: [0.2  0.62 0.31 0.   0.51 0.83 0.11 0.63]
ROC AUC on validation set: {'AK': 0.78, 'BCC': 0.93, 'BKL': 0.62, 'DF': 0.83, 'MEL': 0.51, 'NV': 0.16, 'SCC': 0.85, 'VASC': 0.73}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             7           18  ...            0             0
true class BCC            8          120  ...            2             0
true class BKL            6           23  ...            0             0
true class DF             0            7  ...            0             0
true class MEL            3           13  ...            0             0
true class NV             0           17  ...            0             0
true class SCC            3           18  ...            2             0
true class VASC           0            2  ...            0             6

[8 rows x 8 columns]

Current validation loss: 0.900

Epoch 185:
Mean loss 0.7426603708169438 - Correctly labeled training images 73.18%
Classified 68.53 % of validation images correctly.
Precision on validation set: [0.4  0.57 0.38 0.   0.62 0.79 0.4  1.  ]
Recall on validation set: [0.23 0.78 0.31 0.   0.44 0.9  0.06 0.31]
F1-score on validation set: [0.29 0.66 0.34 0.   0.52 0.84 0.11 0.47]
ROC AUC on validation set: {'AK': 0.78, 'BCC': 0.94, 'BKL': 0.62, 'DF': 0.83, 'MEL': 0.52, 'NV': 0.15, 'SCC': 0.85, 'VASC': 0.73}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            10           17  ...            0             0
true class BCC            4          131  ...            2             0
true class BKL            8           18  ...            1             0
true class DF             0            6  ...            0             0
true class MEL            2           15  ...            0             0
true class NV             0           17  ...            0             0
true class SCC            1           21  ...            2             0
true class VASC           0            4  ...            0             4

[8 rows x 8 columns]

Current validation loss: 0.884

Epoch 186:
Mean loss 0.7396870692163612 - Correctly labeled training images 73.39%
Classified 66.96 % of validation images correctly.
Precision on validation set: [0.38 0.55 0.39 0.   0.6  0.78 0.4  1.  ]
Recall on validation set: [0.14 0.78 0.36 0.   0.4  0.88 0.06 0.38]
F1-score on validation set: [0.2  0.64 0.37 0.   0.48 0.83 0.11 0.56]
ROC AUC on validation set: {'AK': 0.79, 'BCC': 0.94, 'BKL': 0.63, 'DF': 0.83, 'MEL': 0.5, 'NV': 0.16, 'SCC': 0.86, 'VASC': 0.71}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             6           17  ...            0             0
true class BCC            3          130  ...            3             0
true class BKL            2           23  ...            0             0
true class DF             0            6  ...            0             0
true class MEL            4           18  ...            0             0
true class NV             0           20  ...            0             0
true class SCC            1           21  ...            2             0
true class VASC           0            2  ...            0             5

[8 rows x 8 columns]

Current validation loss: 0.893

Epoch 187:
Mean loss 0.7350636477162034 - Correctly labeled training images 73.49%
Classified 67.03 % of validation images correctly.
Precision on validation set: [0.42 0.55 0.38 0.   0.55 0.79 0.43 1.  ]
Recall on validation set: [0.23 0.74 0.31 0.   0.47 0.87 0.09 0.23]
F1-score on validation set: [0.3  0.63 0.34 0.   0.51 0.83 0.15 0.38]
ROC AUC on validation set: {'AK': 0.79, 'BCC': 0.93, 'BKL': 0.63, 'DF': 0.79, 'MEL': 0.53, 'NV': 0.15, 'SCC': 0.84, 'VASC': 0.7}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            10           17  ...            0             0
true class BCC            5          124  ...            4             0
true class BKL            2           26  ...            0             0
true class DF             0            6  ...            0             0
true class MEL            4           17  ...            0             0
true class NV             0           14  ...            0             0
true class SCC            3           18  ...            3             0
true class VASC           0            4  ...            0             3

[8 rows x 8 columns]

Current validation loss: 0.900

Epoch 188:
Mean loss 0.7383170078041426 - Correctly labeled training images 73.38%
Classified 67.51 % of validation images correctly.
Precision on validation set: [0.38 0.59 0.38 0.   0.58 0.78 0.43 1.  ]
Recall on validation set: [0.19 0.69 0.37 0.   0.45 0.89 0.09 0.31]
F1-score on validation set: [0.25 0.64 0.38 0.   0.51 0.83 0.15 0.47]
ROC AUC on validation set: {'AK': 0.78, 'BCC': 0.94, 'BKL': 0.62, 'DF': 0.83, 'MEL': 0.53, 'NV': 0.15, 'SCC': 0.85, 'VASC': 0.72}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             8           12  ...            0             0
true class BCC            4          116  ...            3             0
true class BKL            3           14  ...            0             0
true class DF             0            6  ...            0             0
true class MEL            4           16  ...            1             0
true class NV             0           13  ...            0             0
true class SCC            2           16  ...            3             0
true class VASC           0            2  ...            0             4

[8 rows x 8 columns]

Current validation loss: 0.899

Epoch 189:
Mean loss 0.7318665637202819 - Correctly labeled training images 73.57%
Classified 67.43 % of validation images correctly.
Precision on validation set: [0.1  0.54 0.42 0.   0.59 0.8  0.33 0.67]
Recall on validation set: [0.05 0.78 0.34 0.   0.46 0.88 0.03 0.31]
F1-score on validation set: [0.06 0.64 0.38 0.   0.52 0.84 0.06 0.42]
ROC AUC on validation set: {'AK': 0.77, 'BCC': 0.94, 'BKL': 0.61, 'DF': 0.81, 'MEL': 0.53, 'NV': 0.15, 'SCC': 0.86, 'VASC': 0.68}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             2           23  ...            0             0
true class BCC            4          130  ...            2             1
true class BKL            9           15  ...            0             0
true class DF             1            8  ...            0             0
true class MEL            3           20  ...            0             0
true class NV             0           17  ...            0             1
true class SCC            2           22  ...            1             0
true class VASC           0            4  ...            0             4

/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
[8 rows x 8 columns]

Current validation loss: 0.893

Epoch 190:
Mean loss 0.7251222240812019 - Correctly labeled training images 73.83%
Classified 67.90 % of validation images correctly.
Precision on validation set: [0.18 0.57 0.41 0.   0.61 0.79 0.5  1.  ]
Recall on validation set: [0.09 0.77 0.38 0.   0.48 0.88 0.06 0.23]
F1-score on validation set: [0.12 0.65 0.39 0.   0.54 0.83 0.11 0.38]
ROC AUC on validation set: {'AK': 0.77, 'BCC': 0.94, 'BKL': 0.61, 'DF': 0.83, 'MEL': 0.53, 'NV': 0.15, 'SCC': 0.86, 'VASC': 0.77}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             4           17  ...            0             0
true class BCC            4          129  ...            1             0
true class BKL            6           17  ...            0             0
true class DF             0            7  ...            0             0
true class MEL            5           15  ...            1             0
true class NV             2           16  ...            0             0
true class SCC            1           22  ...            2             0
true class VASC           0            5  ...            0             3

[8 rows x 8 columns]

Current validation loss: 0.878

Epoch 191:
Mean loss 0.7177686248950026 - Correctly labeled training images 74.18%
Classified 67.11 % of validation images correctly.
Precision on validation set: [0.11 0.6  0.41 0.   0.57 0.78 0.6  0.6 ]
Recall on validation set: [0.05 0.73 0.39 0.   0.45 0.88 0.09 0.23]
F1-score on validation set: [0.06 0.66 0.4  0.   0.5  0.83 0.16 0.33]
ROC AUC on validation set: {'AK': 0.79, 'BCC': 0.94, 'BKL': 0.61, 'DF': 0.84, 'MEL': 0.51, 'NV': 0.16, 'SCC': 0.85, 'VASC': 0.72}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             2           21  ...            0             0
true class BCC            6          122  ...            1             1
true class BKL            4           14  ...            0             0
true class DF             1            6  ...            0             0
true class MEL            3            8  ...            1             0
true class NV             1           12  ...            0             1
true class SCC            2           17  ...            3             0
true class VASC           0            5  ...            0             3

[8 rows x 8 columns]

Current validation loss: 0.889

Epoch 192:
Mean loss 0.7200130641178378 - Correctly labeled training images 74.28%
Classified 67.90 % of validation images correctly.
Precision on validation set: [0.3  0.6  0.37 0.   0.61 0.78 0.6  0.6 ]
Recall on validation set: [0.16 0.75 0.34 0.   0.44 0.9  0.09 0.23]
F1-score on validation set: [0.21 0.67 0.35 0.   0.51 0.83 0.16 0.33]
ROC AUC on validation set: {'AK': 0.78, 'BCC': 0.94, 'BKL': 0.6, 'DF': 0.82, 'MEL': 0.52, 'NV': 0.16, 'SCC': 0.85, 'VASC': 0.7}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             7           15  ...            0             0
true class BCC            3          126  ...            1             1
true class BKL            6           16  ...            1             0
true class DF             1            6  ...            0             0
true class MEL            3           14  ...            0             0
true class NV             1           11  ...            0             1
true class SCC            2           18  ...            3             0
true class VASC           0            3  ...            0             3

[8 rows x 8 columns]

Current validation loss: 0.887

Epoch 193:
Mean loss 0.7224289666779034 - Correctly labeled training images 74.07%
Classified 68.30 % of validation images correctly.
Precision on validation set: [0.26 0.58 0.45 0.   0.61 0.78 0.75 0.75]
Recall on validation set: [0.14 0.8  0.33 0.   0.44 0.9  0.09 0.23]
F1-score on validation set: [0.18 0.67 0.38 0.   0.51 0.83 0.17 0.35]
ROC AUC on validation set: {'AK': 0.8, 'BCC': 0.94, 'BKL': 0.62, 'DF': 0.83, 'MEL': 0.51, 'NV': 0.15, 'SCC': 0.85, 'VASC': 0.73}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             6           18  ...            0             0
true class BCC            6          133  ...            0             1
true class BKL            4           18  ...            0             0
true class DF             1            6  ...            0             0
true class MEL            3           16  ...            1             0
true class NV             1           17  ...            0             0
true class SCC            2           18  ...            3             0
true class VASC           0            5  ...            0             3

[8 rows x 8 columns]

Current validation loss: 0.896

Epoch 194:
Mean loss 0.7250630260924059 - Correctly labeled training images 73.99%
Classified 68.22 % of validation images correctly.
Precision on validation set: [0.3  0.63 0.44 0.   0.55 0.78 1.   0.75]
Recall on validation set: [0.21 0.76 0.37 0.   0.46 0.88 0.06 0.46]
F1-score on validation set: [0.25 0.69 0.4  0.   0.5  0.83 0.12 0.57]
ROC AUC on validation set: {'AK': 0.78, 'BCC': 0.94, 'BKL': 0.61, 'DF': 0.84, 'MEL': 0.5, 'NV': 0.16, 'SCC': 0.85, 'VASC': 0.73}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             9           15  ...            0             0
true class BCC            6          127  ...            0             1
true class BKL            6           13  ...            0             0
true class DF             2            5  ...            0             0
true class MEL            4           10  ...            0             0
true class NV             1           13  ...            0             1
true class SCC            2           16  ...            2             0
true class VASC           0            3  ...            0             6

[8 rows x 8 columns]

Current validation loss: 0.881

Epoch 195:
Mean loss 0.71564510690301 - Correctly labeled training images 74.20%
Classified 68.30 % of validation images correctly.
Precision on validation set: [0.22 0.58 0.43 0.   0.59 0.78 0.6  1.  ]
Recall on validation set: [0.09 0.69 0.4  0.   0.46 0.9  0.09 0.38]
F1-score on validation set: [0.13 0.63 0.42 0.   0.51 0.84 0.16 0.56]
ROC AUC on validation set: {'AK': 0.79, 'BCC': 0.94, 'BKL': 0.62, 'DF': 0.84, 'MEL': 0.51, 'NV': 0.16, 'SCC': 0.84, 'VASC': 0.74}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             4           17  ...            0             0
true class BCC            5          116  ...            2             0
true class BKL            4           14  ...            0             0
true class DF             0            7  ...            0             0
true class MEL            2           12  ...            0             0
true class NV             1           14  ...            0             0
true class SCC            2           16  ...            3             0
true class VASC           0            3  ...            0             5

[8 rows x 8 columns]

Current validation loss: 0.892

Epoch 196:
Mean loss 0.7054219814223069 - Correctly labeled training images 74.80%
Classified 67.43 % of validation images correctly.
Precision on validation set: [0.21 0.57 0.47 0.   0.55 0.77 1.   1.  ]
Recall on validation set: [0.09 0.74 0.36 0.   0.43 0.9  0.09 0.23]
F1-score on validation set: [0.13 0.64 0.41 0.   0.49 0.83 0.17 0.38]
ROC AUC on validation set: {'AK': 0.79, 'BCC': 0.94, 'BKL': 0.61, 'DF': 0.85, 'MEL': 0.51, 'NV': 0.16, 'SCC': 0.85, 'VASC': 0.73}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             4           19  ...            0             0
true class BCC            6          123  ...            0             0
true class BKL            2           16  ...            0             0
true class DF             0            7  ...            0             0
true class MEL            3           17  ...            0             0
true class NV             1           14  ...            0             0
true class SCC            3           18  ...            3             0
true class VASC           0            3  ...            0             3

/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
[8 rows x 8 columns]

Current validation loss: 0.893

Epoch 197:
Mean loss 0.7056260533889386 - Correctly labeled training images 74.46%
Classified 67.67 % of validation images correctly.
Precision on validation set: [0.33 0.61 0.4  0.   0.57 0.78 0.5  0.83]
Recall on validation set: [0.12 0.74 0.41 0.   0.42 0.89 0.09 0.38]
F1-score on validation set: [0.17 0.67 0.41 0.   0.49 0.83 0.16 0.53]
ROC AUC on validation set: {'AK': 0.8, 'BCC': 0.94, 'BKL': 0.61, 'DF': 0.82, 'MEL': 0.51, 'NV': 0.16, 'SCC': 0.85, 'VASC': 0.71}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             5           20  ...            0             0
true class BCC            1          124  ...            3             1
true class BKL            4           11  ...            0             0
true class DF             0            6  ...            0             0
true class MEL            1           11  ...            0             0
true class NV             2           12  ...            0             0
true class SCC            2           18  ...            3             0
true class VASC           0            2  ...            0             5

[8 rows x 8 columns]

Current validation loss: 0.902

Epoch 198:
Mean loss 0.6938486019801642 - Correctly labeled training images 75.18%
Classified 69.16 % of validation images correctly.
Precision on validation set: [0.29 0.63 0.42 0.   0.59 0.79 0.57 1.  ]
Recall on validation set: [0.14 0.77 0.37 0.   0.53 0.88 0.12 0.31]
F1-score on validation set: [0.19 0.69 0.39 0.   0.56 0.83 0.21 0.47]
ROC AUC on validation set: {'AK': 0.79, 'BCC': 0.94, 'BKL': 0.61, 'DF': 0.85, 'MEL': 0.51, 'NV': 0.16, 'SCC': 0.86, 'VASC': 0.73}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             6           17  ...            0             0
true class BCC            5          129  ...            2             0
true class BKL            5           14  ...            0             0
true class DF             0            6  ...            0             0
true class MEL            3            9  ...            1             0
true class NV             0           11  ...            0             0
true class SCC            2           17  ...            4             0
true class VASC           0            2  ...            0             4

[8 rows x 8 columns]

Current validation loss: 0.905

Epoch 199:
Mean loss 0.6915352283404077 - Correctly labeled training images 75.13%
Classified 69.64 % of validation images correctly.
Precision on validation set: [0.26 0.61 0.44 0.   0.63 0.8  0.67 0.71]
Recall on validation set: [0.16 0.81 0.42 0.   0.45 0.89 0.12 0.38]
F1-score on validation set: [0.2  0.7  0.43 0.   0.53 0.84 0.21 0.5 ]
ROC AUC on validation set: {'AK': 0.79, 'BCC': 0.95, 'BKL': 0.62, 'DF': 0.84, 'MEL': 0.51, 'NV': 0.15, 'SCC': 0.85, 'VASC': 0.72}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             7           16  ...            0             0
true class BCC            6          135  ...            2             1
true class BKL            6           16  ...            0             0
true class DF             0            7  ...            0             0
true class MEL            5           13  ...            0             0
true class NV             0           12  ...            0             1
true class SCC            3           19  ...            4             0
true class VASC           0            3  ...            0             5

[8 rows x 8 columns]

Current validation loss: 0.872

Epoch 200:
Mean loss 0.6995832823710487 - Correctly labeled training images 74.67%
Classified 67.90 % of validation images correctly.
Precision on validation set: [0.28 0.67 0.45 0.   0.56 0.76 0.57 1.  ]
Recall on validation set: [0.23 0.68 0.4  0.   0.43 0.9  0.12 0.31]
F1-score on validation set: [0.25 0.68 0.43 0.   0.49 0.82 0.21 0.47]
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
ROC AUC on validation set: {'AK': 0.78, 'BCC': 0.94, 'BKL': 0.62, 'DF': 0.81, 'MEL': 0.52, 'NV': 0.15, 'SCC': 0.86, 'VASC': 0.74}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            10           10  ...            0             0
true class BCC            7          114  ...            2             0
true class BKL            8            6  ...            0             0
true class DF             2            4  ...            0             0
true class MEL            5            7  ...            1             0
true class NV             1           12  ...            0             0
true class SCC            3           15  ...            4             0
true class VASC           0            1  ...            0             4

[8 rows x 8 columns]

Current validation loss: 0.896
Training finished. Time >28.0 hours.
Model succesfully saved to /scratch/work/hakkina7/melanoma/inceptionV3_nonweighted.pth
