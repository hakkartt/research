File path is /scratch/work/hakkina7/melanoma/
Device is cuda
Training InceptionV3 model.
Since there is class imbalance present in some of the data sets, use the following weights in the loss function:
tensor([ 29.1988,   7.6238,   9.6541, 106.0942,   5.6009,   1.9674,  40.3665,
        100.3168], device='cuda:0')


Epoch 1:
Mean loss 2.058825548891013 - Correctly labeled training images 20.53%
Classified 12.38 % of validation images correctly.
Precision on validation set: [0.04 0.2  0.14 0.   0.15 0.83 0.   0.03]
Recall on validation set: [0.65 0.09 0.18 0.   0.05 0.12 0.   0.31]
F1-score on validation set: [0.07 0.12 0.16 0.   0.07 0.2  0.   0.06]
ROC AUC on validation set: {'AK': 0.51, 'BCC': 0.55, 'BKL': 0.55, 'DF': 0.6, 'MEL': 0.44, 'NV': 0.5, 'SCC': 0.51, 'VASC': 0.34}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            28            2  ...            0             6
true class BCC          108           15  ...            0             8
true class BKL           77           10  ...            1             7
true class DF             7            0  ...            0             0
true class MEL          130           11  ...            1            36
true class NV           347           36  ...            1            63
true class SCC           22            2  ...            0             3
true class VASC           8            0  ...            0             4

[8 rows x 8 columns]

Current validation loss: 2.025

Epoch 2:
Mean loss 1.9949500765710222 - Correctly labeled training images 25.28%
Classified 30.99 % of validation images correctly.
Precision on validation set: [0.08 0.2  0.23 0.   0.32 0.8  0.06 0.08]
Recall on validation set: [0.02 0.37 0.25 0.   0.38 0.3  0.41 0.38]
F1-score on validation set: [0.04 0.26 0.24 0.   0.35 0.44 0.1  0.14]
ROC AUC on validation set: {'AK': 0.59, 'BCC': 0.65, 'BKL': 0.58, 'DF': 0.67, 'MEL': 0.46, 'NV': 0.41, 'SCC': 0.56, 'VASC': 0.28}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             1           12  ...           12             0
true class BCC            2           62  ...           33             4
true class BKL            2           31  ...           26             0
true class DF             0            6  ...            2             0
true class MEL            1           47  ...           51             6
true class NV             5          146  ...           94            43
true class SCC            1            7  ...           13             2
true class VASC           0            2  ...            0             5

[8 rows x 8 columns]

Current validation loss: 1.924

Epoch 3:
Mean loss 1.9476247779578442 - Correctly labeled training images 28.94%
Classified 34.07 % of validation images correctly.
Precision on validation set: [0.08 0.19 0.16 0.   0.35 0.73 0.06 0.06]
Recall on validation set: [0.02 0.25 0.18 0.   0.27 0.44 0.38 0.62]
F1-score on validation set: [0.04 0.21 0.17 0.   0.3  0.55 0.11 0.11]
ROC AUC on validation set: {'AK': 0.63, 'BCC': 0.62, 'BKL': 0.6, 'DF': 0.61, 'MEL': 0.46, 'NV': 0.42, 'SCC': 0.61, 'VASC': 0.23}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             1            9  ...           17             1
true class BCC            1           41  ...           43            14
true class BKL            2           24  ...           26             5
true class DF             0            4  ...            0             0
true class MEL            1           29  ...           38            23
true class NV             7          107  ...           56            74
true class SCC            0            7  ...           12             3
true class VASC           0            0  ...            1             8

[8 rows x 8 columns]

Current validation loss: 1.955

Epoch 4:
Mean loss 1.9181564621368794 - Correctly labeled training images 31.91%
Classified 37.07 % of validation images correctly.
Precision on validation set: [0.09 0.21 0.18 0.   0.32 0.8  0.27 0.18]
Recall on validation set: [0.33 0.32 0.21 0.   0.44 0.41 0.09 0.54]
F1-score on validation set: [0.14 0.25 0.19 0.   0.37 0.54 0.14 0.26]
ROC AUC on validation set: {'AK': 0.65, 'BCC': 0.69, 'BKL': 0.57, 'DF': 0.68, 'MEL': 0.46, 'NV': 0.38, 'SCC': 0.68, 'VASC': 0.3}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            14            9  ...            0             0
true class BCC           42           54  ...            3             4
true class BKL           19           28  ...            3             1
true class DF             2            3  ...            0             0
true class MEL           24           38  ...            2             7
true class NV            56          108  ...            0            20
true class SCC            3           18  ...            3             1
true class VASC           1            2  ...            0             7

[8 rows x 8 columns]

Current validation loss: 1.760

Epoch 5:
Mean loss 1.8726388797022944 - Correctly labeled training images 34.54%
Classified 38.72 % of validation images correctly.
Precision on validation set: [0.   0.2  0.2  0.   0.35 0.78 0.08 0.17]
Recall on validation set: [0.   0.39 0.16 0.   0.42 0.45 0.34 0.62]
F1-score on validation set: [0.   0.26 0.18 0.   0.38 0.57 0.13 0.27]
ROC AUC on validation set: {'AK': 0.68, 'BCC': 0.71, 'BKL': 0.61, 'DF': 0.64, 'MEL': 0.46, 'NV': 0.35, 'SCC': 0.67, 'VASC': 0.25}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             0           14  ...           14             0
true class BCC            1           65  ...           44             6
true class BKL            0           33  ...           23             2
true class DF             0            4  ...            2             0
true class MEL            0           43  ...           22             9
true class NV             0          159  ...           25            20
true class SCC            0           10  ...           11             2
true class VASC           0            2  ...            0             8

[8 rows x 8 columns]

Current validation loss: 1.722

Epoch 6:
Mean loss 1.8452989954489638 - Correctly labeled training images 35.86%
Classified 40.22 % of validation images correctly.
Precision on validation set: [0.15 0.26 0.15 0.   0.36 0.81 0.08 0.19]
Recall on validation set: [0.37 0.4  0.24 0.   0.42 0.45 0.06 0.69]
F1-score on validation set: [0.22 0.32 0.18 0.   0.39 0.58 0.07 0.3 ]
ROC AUC on validation set: {'AK': 0.71, 'BCC': 0.71, 'BKL': 0.62, 'DF': 0.79, 'MEL': 0.45, 'NV': 0.34, 'SCC': 0.69, 'VASC': 0.3}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            16            8  ...            1             0
true class BCC           29           66  ...            6             5
true class BKL           10           29  ...            7             0
true class DF             0            7  ...            0             0
true class MEL           19           21  ...            6             5
true class NV            27          104  ...            2            27
true class SCC            3           14  ...            2             2
true class VASC           0            3  ...            0             9

[8 rows x 8 columns]

Current validation loss: 1.717

Epoch 7:
Mean loss 1.8131165695303246 - Correctly labeled training images 37.50%
Classified 41.17 % of validation images correctly.
Precision on validation set: [0.1  0.26 0.17 0.   0.33 0.82 0.19 0.32]
Recall on validation set: [0.44 0.4  0.09 0.   0.5  0.47 0.09 0.69]
F1-score on validation set: [0.17 0.31 0.12 0.   0.4  0.59 0.12 0.44]
ROC AUC on validation set: {'AK': 0.71, 'BCC': 0.73, 'BKL': 0.62, 'DF': 0.74, 'MEL': 0.43, 'NV': 0.34, 'SCC': 0.71, 'VASC': 0.34}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            19           10  ...            0             0
true class BCC           44           67  ...            6             1
true class BKL           22           40  ...            1             1
true class DF             2            5  ...            0             0
true class MEL           37           21  ...            3             4
true class NV            54          103  ...            3            12
true class SCC            8           13  ...            3             1
true class VASC           1            2  ...            0             9

/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
[8 rows x 8 columns]

Current validation loss: 1.646

Epoch 8:
Mean loss 1.7999858971837943 - Correctly labeled training images 38.33%
Classified 42.03 % of validation images correctly.
Precision on validation set: [0.27 0.29 0.18 0.   0.33 0.83 0.13 0.28]
Recall on validation set: [0.07 0.41 0.24 0.   0.46 0.48 0.22 0.62]
F1-score on validation set: [0.11 0.34 0.2  0.   0.39 0.61 0.16 0.38]
ROC AUC on validation set: {'AK': 0.73, 'BCC': 0.75, 'BKL': 0.64, 'DF': 0.75, 'MEL': 0.44, 'NV': 0.31, 'SCC': 0.69, 'VASC': 0.38}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             3           14  ...            2             0
true class BCC            4           68  ...           14             2
true class BKL            1           34  ...            9             0
true class DF             0            8  ...            0             0
true class MEL            0           26  ...           16             8
true class NV             1           72  ...            6            10
true class SCC            2            8  ...            7             1
true class VASC           0            1  ...            0             8

[8 rows x 8 columns]

Current validation loss: 1.628

Epoch 9:
Mean loss 1.765816518278904 - Correctly labeled training images 39.13%
Classified 41.64 % of validation images correctly.
Precision on validation set: [0.18 0.2  0.15 0.   0.37 0.83 0.09 0.29]
Recall on validation set: [0.28 0.26 0.07 0.   0.4  0.54 0.62 0.69]
F1-score on validation set: [0.22 0.23 0.09 0.   0.38 0.65 0.15 0.41]
ROC AUC on validation set: {'AK': 0.72, 'BCC': 0.72, 'BKL': 0.61, 'DF': 0.76, 'MEL': 0.44, 'NV': 0.35, 'SCC': 0.67, 'VASC': 0.27}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            12           10  ...           12             0
true class BCC           15           43  ...           67             1
true class BKL            8           30  ...           35             2
true class DF             1            5  ...            1             0
true class MEL            8           32  ...           45             7
true class NV            19           87  ...           54            11
true class SCC            2            5  ...           20             1
true class VASC           0            1  ...            1             9

[8 rows x 8 columns]

Current validation loss: 1.666

Epoch 10:
Mean loss 1.761556711952769 - Correctly labeled training images 39.54%
Classified 43.38 % of validation images correctly.
Precision on validation set: [0.13 0.23 0.14 0.   0.38 0.83 0.   0.22]
Recall on validation set: [0.53 0.48 0.03 0.   0.43 0.52 0.   0.69]
F1-score on validation set: [0.2  0.31 0.05 0.   0.4  0.64 0.   0.33]
ROC AUC on validation set: {'AK': 0.76, 'BCC': 0.75, 'BKL': 0.63, 'DF': 0.73, 'MEL': 0.45, 'NV': 0.31, 'SCC': 0.75, 'VASC': 0.22}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            23           16  ...            0             0
true class BCC           44           80  ...            1             3
true class BKL           30           52  ...            2             2
true class DF             3            6  ...            0             0
true class MEL           29           53  ...            1             8
true class NV            45          125  ...            0            18
true class SCC            8           18  ...            0             1
true class VASC           1            1  ...            0             9

[8 rows x 8 columns]

Current validation loss: 1.585

Epoch 11:
Mean loss 1.7485152266755088 - Correctly labeled training images 42.24%
Classified 42.98 % of validation images correctly.
Precision on validation set: [0.1  0.28 0.23 0.1  0.4  0.81 0.1  0.2 ]
Recall on validation set: [0.47 0.09 0.19 0.08 0.39 0.57 0.53 0.69]
F1-score on validation set: [0.17 0.14 0.21 0.09 0.39 0.67 0.16 0.31]
ROC AUC on validation set: {'AK': 0.77, 'BCC': 0.75, 'BKL': 0.63, 'DF': 0.75, 'MEL': 0.44, 'NV': 0.32, 'SCC': 0.74, 'VASC': 0.25}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            20            3  ...           12             1
true class BCC           44           15  ...           52             6
true class BKL           27            7  ...           26             2
true class DF             3            3  ...            1             0
true class MEL           33            1  ...           33            10
true class NV            61           21  ...           34            16
true class SCC            6            4  ...           17             1
true class VASC           2            0  ...            0             9

[8 rows x 8 columns]

Current validation loss: 1.611

Epoch 12:
Mean loss 1.7265466774111666 - Correctly labeled training images 41.67%
Classified 43.14 % of validation images correctly.
Precision on validation set: [0.11 0.22 0.23 0.08 0.36 0.81 0.12 0.17]
Recall on validation set: [0.58 0.16 0.14 0.08 0.38 0.58 0.34 0.69]
F1-score on validation set: [0.19 0.18 0.17 0.08 0.37 0.67 0.17 0.28]
ROC AUC on validation set: {'AK': 0.77, 'BCC': 0.74, 'BKL': 0.63, 'DF': 0.77, 'MEL': 0.46, 'NV': 0.3, 'SCC': 0.74, 'VASC': 0.26}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            25            8  ...            2             1
true class BCC           49           26  ...           38             8
true class BKL           25           18  ...           15             2
true class DF             3            2  ...            1             0
true class MEL           50           11  ...           15            13
true class NV            57           46  ...           12            18
true class SCC            8            7  ...           11             1
true class VASC           2            0  ...            0             9

[8 rows x 8 columns]

Current validation loss: 1.619

Epoch 13:
Mean loss 1.7071902031778161 - Correctly labeled training images 42.32%
Classified 39.35 % of validation images correctly.
Precision on validation set: [0.09 0.28 0.18 0.04 0.39 0.85 0.22 0.16]
Recall on validation set: [0.77 0.1  0.09 0.25 0.4  0.52 0.12 0.69]
F1-score on validation set: [0.16 0.14 0.12 0.08 0.39 0.64 0.16 0.25]
ROC AUC on validation set: {'AK': 0.77, 'BCC': 0.78, 'BKL': 0.63, 'DF': 0.8, 'MEL': 0.45, 'NV': 0.3, 'SCC': 0.71, 'VASC': 0.2}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            33            3  ...            1             1
true class BCC          100           16  ...            8             6
true class BKL           62            7  ...            2             3
true class DF             6            1  ...            0             0
true class MEL           68            3  ...            2            13
true class NV            94           26  ...            1            25
true class SCC           16            1  ...            4             1
true class VASC           1            0  ...            0             9

[8 rows x 8 columns]

Current validation loss: 1.658

Epoch 14:
Mean loss 1.7095697679166162 - Correctly labeled training images 42.27%
Classified 41.40 % of validation images correctly.
Precision on validation set: [0.13 0.35 0.17 0.04 0.38 0.84 0.13 0.12]
Recall on validation set: [0.37 0.13 0.15 0.33 0.42 0.53 0.53 0.69]
F1-score on validation set: [0.19 0.19 0.16 0.07 0.4  0.65 0.2  0.21]
ROC AUC on validation set: {'AK': 0.81, 'BCC': 0.76, 'BKL': 0.62, 'DF': 0.8, 'MEL': 0.45, 'NV': 0.3, 'SCC': 0.74, 'VASC': 0.31}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            16            3  ...           13             1
true class BCC           34           22  ...           37             8
true class BKL           22            7  ...           18             5
true class DF             2            2  ...            0             1
true class MEL           21            8  ...           29            12
true class NV            28           19  ...           20            37
true class SCC            3            1  ...           17             1
true class VASC           1            1  ...            0             9

/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1248: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
[8 rows x 8 columns]

Current validation loss: 1.620

Epoch 15:
Mean loss 1.698314731429428 - Correctly labeled training images 43.16%
Classified 45.82 % of validation images correctly.
Precision on validation set: [0.16 0.27 0.15 0.   0.37 0.82 0.1  0.2 ]
Recall on validation set: [0.44 0.34 0.07 0.   0.38 0.61 0.38 0.69]
F1-score on validation set: [0.23 0.3  0.09 0.   0.37 0.7  0.16 0.31]
ROC AUC on validation set: {'AK': 0.79, 'BCC': 0.78, 'BKL': 0.64, 'DF': 0.81, 'MEL': 0.48, 'NV': 0.27, 'SCC': 0.77, 'VASC': 0.29}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            19           12  ...            6             1
true class BCC           29           56  ...           38             4
true class BKL           17           32  ...           19             2
true class DF             2            8  ...            0             0
true class MEL           23           23  ...           25             8
true class NV            24           64  ...           15            21
true class SCC            6            9  ...           12             1
true class VASC           0            2  ...            0             9

[8 rows x 8 columns]

Current validation loss: 1.506

Epoch 16:
Mean loss 1.6707952699450663 - Correctly labeled training images 44.49%
Classified 43.61 % of validation images correctly.
Precision on validation set: [0.12 0.29 0.17 0.08 0.37 0.83 0.11 0.22]
Recall on validation set: [0.47 0.13 0.11 0.33 0.42 0.58 0.47 0.69]
F1-score on validation set: [0.19 0.18 0.14 0.13 0.39 0.68 0.17 0.34]
ROC AUC on validation set: {'AK': 0.81, 'BCC': 0.79, 'BKL': 0.64, 'DF': 0.79, 'MEL': 0.45, 'NV': 0.28, 'SCC': 0.79, 'VASC': 0.3}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            20            5  ...           10             1
true class BCC           50           22  ...           39             5
true class BKL           27           14  ...           24             0
true class DF             3            2  ...            0             0
true class MEL           25            6  ...           34             8
true class NV            33           23  ...           19            16
true class SCC            7            5  ...           15             1
true class VASC           1            0  ...            0             9

[8 rows x 8 columns]

Current validation loss: 1.538

Epoch 17:
Mean loss 1.6577839747024259 - Correctly labeled training images 45.26%
Classified 44.56 % of validation images correctly.
Precision on validation set: [0.16 0.29 0.17 0.03 0.42 0.81 0.09 0.15]
Recall on validation set: [0.33 0.34 0.11 0.17 0.33 0.59 0.38 0.69]
F1-score on validation set: [0.21 0.31 0.14 0.06 0.37 0.69 0.15 0.25]
ROC AUC on validation set: {'AK': 0.78, 'BCC': 0.79, 'BKL': 0.63, 'DF': 0.73, 'MEL': 0.48, 'NV': 0.27, 'SCC': 0.75, 'VASC': 0.2}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            14           12  ...            9             1
true class BCC           18           56  ...           43             8
true class BKL           14           29  ...           18             1
true class DF             0            4  ...            1             0
true class MEL           16           24  ...           33             7
true class NV            24           60  ...           13            32
true class SCC            3            9  ...           12             1
true class VASC           0            1  ...            0             9

[8 rows x 8 columns]

Current validation loss: 1.601

Epoch 18:
Mean loss 1.656001718168379 - Correctly labeled training images 44.74%
Classified 47.48 % of validation images correctly.
Precision on validation set: [0.15 0.3  0.21 0.   0.38 0.81 0.1  0.25]
Recall on validation set: [0.42 0.25 0.15 0.   0.4  0.64 0.41 0.69]
F1-score on validation set: [0.22 0.27 0.17 0.   0.39 0.71 0.16 0.37]
ROC AUC on validation set: {'AK': 0.77, 'BCC': 0.79, 'BKL': 0.64, 'DF': 0.81, 'MEL': 0.46, 'NV': 0.27, 'SCC': 0.79, 'VASC': 0.31}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            18            7  ...            6             1
true class BCC           37           41  ...           41             3
true class BKL           18           21  ...           14             0
true class DF             1            6  ...            2             0
true class MEL           18           12  ...           33             4
true class NV            23           44  ...           20            18
true class SCC            7            5  ...           13             1
true class VASC           1            0  ...            0             9

[8 rows x 8 columns]

Current validation loss: 1.456

Epoch 19:
Mean loss 1.643984135299075 - Correctly labeled training images 44.83%
Classified 45.19 % of validation images correctly.
Precision on validation set: [0.14 0.32 0.21 0.14 0.43 0.82 0.11 0.1 ]
Recall on validation set: [0.56 0.17 0.12 0.08 0.35 0.62 0.53 0.69]
F1-score on validation set: [0.22 0.22 0.15 0.11 0.38 0.7  0.18 0.18]
ROC AUC on validation set: {'AK': 0.79, 'BCC': 0.78, 'BKL': 0.66, 'DF': 0.76, 'MEL': 0.48, 'NV': 0.27, 'SCC': 0.75, 'VASC': 0.15}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            24            4  ...            9             2
true class BCC           46           29  ...           47            13
true class BKL           28           11  ...           28             4
true class DF             3            5  ...            0             1
true class MEL           33           10  ...           32            14
true class NV            36           28  ...           26            42
true class SCC            5            5  ...           17             2
true class VASC           1            0  ...            0             9

[8 rows x 8 columns]

Current validation loss: 1.578

Epoch 20:
Mean loss 1.633889254147322 - Correctly labeled training images 45.17%
Classified 44.32 % of validation images correctly.
Precision on validation set: [0.15 0.31 0.18 0.03 0.4  0.85 0.18 0.12]
Recall on validation set: [0.51 0.29 0.14 0.17 0.41 0.56 0.31 0.69]
F1-score on validation set: [0.24 0.3  0.16 0.04 0.4  0.67 0.23 0.2 ]
ROC AUC on validation set: {'AK': 0.81, 'BCC': 0.8, 'BKL': 0.66, 'DF': 0.7, 'MEL': 0.48, 'NV': 0.25, 'SCC': 0.77, 'VASC': 0.21}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            22           10  ...            4             1
true class BCC           34           49  ...           20            10
true class BKL           26           23  ...            8             4
true class DF             2            4  ...            0             1
true class MEL           27           19  ...           12            12
true class NV            29           44  ...            1            38
true class SCC            4            8  ...           10             2
true class VASC           0            1  ...            0             9

[8 rows x 8 columns]

Current validation loss: 1.587

Epoch 21:
Mean loss 1.6399089019945368 - Correctly labeled training images 44.93%
Classified 43.61 % of validation images correctly.
Precision on validation set: [0.16 0.36 0.21 0.03 0.41 0.86 0.11 0.17]
Recall on validation set: [0.6  0.16 0.17 0.42 0.42 0.56 0.22 0.69]
F1-score on validation set: [0.26 0.22 0.19 0.06 0.41 0.68 0.15 0.27]
ROC AUC on validation set: {'AK': 0.81, 'BCC': 0.81, 'BKL': 0.65, 'DF': 0.74, 'MEL': 0.49, 'NV': 0.24, 'SCC': 0.77, 'VASC': 0.23}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            26            4  ...            4             0
true class BCC           43           26  ...           24             7
true class BKL           24           11  ...            6             4
true class DF             3            2  ...            0             0
true class MEL           24            8  ...           18             7
true class NV            33           18  ...            4            26
true class SCC            6            4  ...            7             1
true class VASC           1            0  ...            0             9

/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
[8 rows x 8 columns]

Current validation loss: 1.536

Epoch 22:
Mean loss 1.6255583882519875 - Correctly labeled training images 45.00%
Classified 47.32 % of validation images correctly.
Precision on validation set: [0.16 0.34 0.19 0.07 0.41 0.88 0.15 0.16]
Recall on validation set: [0.37 0.38 0.19 0.33 0.41 0.59 0.38 0.69]
F1-score on validation set: [0.23 0.35 0.19 0.11 0.41 0.7  0.22 0.25]
ROC AUC on validation set: {'AK': 0.82, 'BCC': 0.81, 'BKL': 0.66, 'DF': 0.73, 'MEL': 0.46, 'NV': 0.26, 'SCC': 0.79, 'VASC': 0.2}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            16           10  ...            3             0
true class BCC           26           63  ...           28             6
true class BKL           16           25  ...           13             6
true class DF             2            3  ...            0             0
true class MEL           18           29  ...           14            11
true class NV            16           50  ...            8            25
true class SCC            5            7  ...           12             1
true class VASC           0            1  ...            0             9

[8 rows x 8 columns]

Current validation loss: 1.500

Epoch 23:
Mean loss 1.611581181408103 - Correctly labeled training images 45.95%
Classified 45.90 % of validation images correctly.
Precision on validation set: [0.22 0.43 0.19 0.04 0.41 0.85 0.11 0.16]
Recall on validation set: [0.3  0.19 0.18 0.42 0.4  0.61 0.47 0.62]
F1-score on validation set: [0.25 0.26 0.19 0.07 0.4  0.71 0.17 0.25]
ROC AUC on validation set: {'AK': 0.82, 'BCC': 0.82, 'BKL': 0.66, 'DF': 0.76, 'MEL': 0.47, 'NV': 0.24, 'SCC': 0.77, 'VASC': 0.26}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            13            5  ...           10             0
true class BCC           14           31  ...           53             3
true class BKL            9           11  ...           20             3
true class DF             1            3  ...            0             1
true class MEL           11            6  ...           27             7
true class NV             9           13  ...           15            28
true class SCC            2            2  ...           15             1
true class VASC           0            1  ...            0             8

[8 rows x 8 columns]

Current validation loss: 1.457

Epoch 24:
Mean loss 1.609945422279346 - Correctly labeled training images 45.52%
Classified 48.74 % of validation images correctly.
Precision on validation set: [0.18 0.3  0.19 0.17 0.4  0.83 0.11 0.2 ]
Recall on validation set: [0.47 0.3  0.18 0.17 0.42 0.64 0.25 0.69]
F1-score on validation set: [0.26 0.3  0.18 0.17 0.41 0.72 0.15 0.31]
ROC AUC on validation set: {'AK': 0.81, 'BCC': 0.81, 'BKL': 0.65, 'DF': 0.74, 'MEL': 0.48, 'NV': 0.25, 'SCC': 0.76, 'VASC': 0.28}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            20           10  ...            4             0
true class BCC           38           50  ...           28             4
true class BKL           12           26  ...           11             4
true class DF             1            5  ...            0             1
true class MEL           17           21  ...           17             6
true class NV            14           47  ...            4            20
true class SCC            8            7  ...            8             1
true class VASC           0            1  ...            0             9

[8 rows x 8 columns]

Current validation loss: 1.415

Epoch 25:
Mean loss 1.6088608658464174 - Correctly labeled training images 45.69%
Classified 44.95 % of validation images correctly.
Precision on validation set: [0.17 0.28 0.16 0.03 0.36 0.85 0.12 0.15]
Recall on validation set: [0.56 0.2  0.14 0.08 0.45 0.58 0.31 0.62]
F1-score on validation set: [0.26 0.23 0.15 0.04 0.4  0.69 0.17 0.24]
ROC AUC on validation set: {'AK': 0.84, 'BCC': 0.81, 'BKL': 0.64, 'DF': 0.76, 'MEL': 0.49, 'NV': 0.24, 'SCC': 0.77, 'VASC': 0.23}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            24            7  ...            5             1
true class BCC           41           33  ...           38             8
true class BKL           21           18  ...            9             3
true class DF             2            4  ...            1             1
true class MEL           30           12  ...           16             7
true class NV            18           35  ...            6            24
true class SCC            6            6  ...           10             2
true class VASC           0            1  ...            0             8

[8 rows x 8 columns]

Current validation loss: 1.481

Epoch 26:
Mean loss 1.5883623214926252 - Correctly labeled training images 46.13%
Classified 50.87 % of validation images correctly.
Precision on validation set: [0.16 0.36 0.24 0.04 0.45 0.82 0.14 0.13]
Recall on validation set: [0.6  0.25 0.22 0.08 0.27 0.73 0.34 0.69]
F1-score on validation set: [0.26 0.29 0.23 0.05 0.34 0.77 0.2  0.22]
ROC AUC on validation set: {'AK': 0.82, 'BCC': 0.82, 'BKL': 0.66, 'DF': 0.81, 'MEL': 0.5, 'NV': 0.22, 'SCC': 0.79, 'VASC': 0.21}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            26            5  ...            4             1
true class BCC           41           41  ...           31            11
true class BKL           27           17  ...            9             4
true class DF             3            5  ...            1             1
true class MEL           31           12  ...           16            15
true class NV            24           26  ...            5            27
true class SCC            8            6  ...           11             1
true class VASC           0            1  ...            0             9

[8 rows x 8 columns]

Current validation loss: 1.430

Epoch 27:
Mean loss 1.5788205064809662 - Correctly labeled training images 46.20%
Classified 44.87 % of validation images correctly.
Precision on validation set: [0.13 0.29 0.19 0.02 0.39 0.86 0.17 0.15]
Recall on validation set: [0.6  0.17 0.23 0.08 0.43 0.58 0.16 0.69]
F1-score on validation set: [0.22 0.22 0.21 0.04 0.41 0.69 0.16 0.25]
ROC AUC on validation set: {'AK': 0.8, 'BCC': 0.81, 'BKL': 0.64, 'DF': 0.82, 'MEL': 0.46, 'NV': 0.26, 'SCC': 0.78, 'VASC': 0.34}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            26            4  ...            2             1
true class BCC           62           29  ...           16             8
true class BKL           27           13  ...            4             3
true class DF             5            4  ...            0             1
true class MEL           40            8  ...            2             8
true class NV            27           34  ...            0            28
true class SCC           11            6  ...            5             1
true class VASC           0            1  ...            0             9

[8 rows x 8 columns]

Current validation loss: 1.469

Epoch 28:
Mean loss 1.577835046530522 - Correctly labeled training images 45.47%
Classified 45.90 % of validation images correctly.
Precision on validation set: [0.19 0.36 0.18 0.03 0.4  0.88 0.12 0.18]
Recall on validation set: [0.4  0.28 0.24 0.17 0.42 0.57 0.34 0.77]
F1-score on validation set: [0.26 0.31 0.2  0.05 0.41 0.7  0.18 0.29]
ROC AUC on validation set: {'AK': 0.81, 'BCC': 0.82, 'BKL': 0.64, 'DF': 0.81, 'MEL': 0.48, 'NV': 0.24, 'SCC': 0.78, 'VASC': 0.29}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            17            8  ...            5             1
true class BCC           24           46  ...           35             9
true class BKL           15           17  ...           13             4
true class DF             0            6  ...            0             1
true class MEL           16           12  ...           16             9
true class NV            10           33  ...           11            22
true class SCC            6            4  ...           11             1
true class VASC           0            1  ...            0            10

[8 rows x 8 columns]

Current validation loss: 1.467

Epoch 29:
Mean loss 1.5868505716135826 - Correctly labeled training images 46.30%
Classified 47.56 % of validation images correctly.
Precision on validation set: [0.16 0.35 0.19 0.02 0.43 0.86 0.11 0.2 ]
Recall on validation set: [0.58 0.25 0.13 0.08 0.42 0.62 0.41 0.77]
F1-score on validation set: [0.25 0.29 0.15 0.03 0.43 0.72 0.17 0.31]
ROC AUC on validation set: {'AK': 0.81, 'BCC': 0.83, 'BKL': 0.64, 'DF': 0.8, 'MEL': 0.49, 'NV': 0.23, 'SCC': 0.79, 'VASC': 0.29}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            25            7  ...            7             0
true class BCC           41           41  ...           45             4
true class BKL           31           15  ...           14             4
true class DF             2            4  ...            1             1
true class MEL           28           12  ...           23             7
true class NV            24           30  ...           16            24
true class SCC            5            8  ...           13             1
true class VASC           0            1  ...            0            10

[8 rows x 8 columns]

Current validation loss: 1.431

Epoch 30:
Mean loss 1.5829896024348984 - Correctly labeled training images 46.55%
Classified 47.00 % of validation images correctly.
Precision on validation set: [0.19 0.32 0.19 0.04 0.4  0.88 0.11 0.18]
Recall on validation set: [0.47 0.26 0.11 0.33 0.45 0.61 0.28 0.85]
F1-score on validation set: [0.27 0.29 0.14 0.07 0.42 0.72 0.15 0.3 ]
ROC AUC on validation set: {'AK': 0.83, 'BCC': 0.83, 'BKL': 0.66, 'DF': 0.74, 'MEL': 0.5, 'NV': 0.22, 'SCC': 0.8, 'VASC': 0.25}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            20           13  ...            3             0
true class BCC           26           44  ...           35             6
true class BKL           18           22  ...           10             4
true class DF             2            2  ...            1             1
true class MEL           18           17  ...           21             7
true class NV            15           30  ...            6            31
true class SCC            7            8  ...            9             1
true class VASC           0            0  ...            0            11

[8 rows x 8 columns]

Current validation loss: 1.432

Epoch 31:
Mean loss 1.5673222917863623 - Correctly labeled training images 46.77%
Classified 48.34 % of validation images correctly.
Precision on validation set: [0.19 0.3  0.18 0.08 0.43 0.86 0.1  0.18]
Recall on validation set: [0.42 0.34 0.18 0.08 0.4  0.62 0.34 0.85]
F1-score on validation set: [0.26 0.31 0.18 0.08 0.42 0.72 0.16 0.3 ]
ROC AUC on validation set: {'AK': 0.81, 'BCC': 0.81, 'BKL': 0.65, 'DF': 0.82, 'MEL': 0.49, 'NV': 0.24, 'SCC': 0.77, 'VASC': 0.27}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            18           15  ...            4             0
true class BCC           23           56  ...           42            10
true class BKL           17           28  ...           12             4
true class DF             0            7  ...            2             1
true class MEL           14           26  ...           22             7
true class NV            17           51  ...           12            27
true class SCC            7            6  ...           11             1
true class VASC           0            0  ...            0            11

[8 rows x 8 columns]

Current validation loss: 1.445

Epoch 32:
Mean loss 1.5725307356483929 - Correctly labeled training images 47.24%
Classified 50.08 % of validation images correctly.
Precision on validation set: [0.18 0.38 0.25 0.04 0.38 0.85 0.14 0.24]
Recall on validation set: [0.49 0.25 0.15 0.25 0.5  0.65 0.25 0.77]
F1-score on validation set: [0.26 0.3  0.18 0.07 0.43 0.74 0.18 0.37]
ROC AUC on validation set: {'AK': 0.81, 'BCC': 0.83, 'BKL': 0.67, 'DF': 0.78, 'MEL': 0.48, 'NV': 0.22, 'SCC': 0.8, 'VASC': 0.33}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            21            7  ...            3             0
true class BCC           38           42  ...           22             3
true class BKL           21           13  ...            8             4
true class DF             1            3  ...            1             0
true class MEL           19           13  ...           12             4
true class NV            14           26  ...            5            19
true class SCC            6            5  ...            8             1
true class VASC           0            1  ...            0            10

[8 rows x 8 columns]

Current validation loss: 1.350

Epoch 33:
Mean loss 1.5661476992470234 - Correctly labeled training images 47.29%
Classified 48.74 % of validation images correctly.
Precision on validation set: [0.18 0.37 0.26 0.03 0.39 0.87 0.1  0.14]
Recall on validation set: [0.47 0.32 0.15 0.08 0.47 0.62 0.31 0.85]
F1-score on validation set: [0.25 0.34 0.19 0.05 0.43 0.72 0.15 0.24]
ROC AUC on validation set: {'AK': 0.81, 'BCC': 0.83, 'BKL': 0.66, 'DF': 0.83, 'MEL': 0.49, 'NV': 0.23, 'SCC': 0.76, 'VASC': 0.26}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            20            8  ...            3             0
true class BCC           32           53  ...           39             9
true class BKL           22           18  ...           14             5
true class DF             2            5  ...            2             1
true class MEL           20           18  ...           19             9
true class NV            12           33  ...           14            41
true class SCC            6            6  ...           10             1
true class VASC           0            1  ...            0            11

[8 rows x 8 columns]

Current validation loss: 1.418

Epoch 34:
Mean loss 1.5630634002128987 - Correctly labeled training images 46.90%
Classified 50.79 % of validation images correctly.
Precision on validation set: [0.15 0.35 0.19 0.04 0.47 0.85 0.11 0.22]
Recall on validation set: [0.42 0.38 0.18 0.08 0.4  0.67 0.31 0.77]
F1-score on validation set: [0.23 0.36 0.18 0.05 0.43 0.75 0.16 0.34]
ROC AUC on validation set: {'AK': 0.81, 'BCC': 0.83, 'BKL': 0.66, 'DF': 0.83, 'MEL': 0.49, 'NV': 0.22, 'SCC': 0.79, 'VASC': 0.28}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            18           10  ...            6             0
true class BCC           34           63  ...           30             3
true class BKL           24           21  ...           12             3
true class DF             2            4  ...            3             1
true class MEL           20           22  ...           21             5
true class NV            14           49  ...            9            23
true class SCC            5           10  ...           10             1
true class VASC           0            0  ...            0            10

[8 rows x 8 columns]

Current validation loss: 1.365

Epoch 35:
Mean loss 1.5401855525722263 - Correctly labeled training images 47.70%
Classified 49.53 % of validation images correctly.
Precision on validation set: [0.18 0.43 0.19 0.05 0.47 0.86 0.19 0.18]
Recall on validation set: [0.58 0.26 0.24 0.33 0.39 0.64 0.31 0.77]
F1-score on validation set: [0.27 0.33 0.21 0.09 0.43 0.74 0.24 0.29]
ROC AUC on validation set: {'AK': 0.81, 'BCC': 0.84, 'BKL': 0.64, 'DF': 0.79, 'MEL': 0.5, 'NV': 0.22, 'SCC': 0.81, 'VASC': 0.24}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            25            5  ...            3             0
true class BCC           38           44  ...           17             6
true class BKL           25           12  ...            9             4
true class DF             2            3  ...            0             1
true class MEL           25           13  ...           11             7
true class NV            20           20  ...            3            27
true class SCC            6            6  ...           10             1
true class VASC           0            0  ...            0            10

/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
[8 rows x 8 columns]

Current validation loss: 1.410

Epoch 36:
Mean loss 1.537440671905734 - Correctly labeled training images 47.65%
Classified 44.79 % of validation images correctly.
Precision on validation set: [0.12 0.39 0.19 0.03 0.43 0.87 0.14 0.23]
Recall on validation set: [0.65 0.11 0.15 0.25 0.37 0.61 0.38 0.77]
F1-score on validation set: [0.21 0.17 0.17 0.05 0.4  0.72 0.21 0.36]
ROC AUC on validation set: {'AK': 0.79, 'BCC': 0.84, 'BKL': 0.65, 'DF': 0.81, 'MEL': 0.5, 'NV': 0.22, 'SCC': 0.79, 'VASC': 0.34}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            28            1  ...            4             0
true class BCC           67           18  ...           34             2
true class BKL           43            6  ...            8             3
true class DF             3            2  ...            1             1
true class MEL           44            5  ...           18             6
true class NV            38           11  ...            6            20
true class SCC            7            2  ...           12             1
true class VASC           0            1  ...            0            10

[8 rows x 8 columns]

Current validation loss: 1.453

Epoch 37:
Mean loss 1.5357129191186525 - Correctly labeled training images 47.32%
Classified 47.00 % of validation images correctly.
Precision on validation set: [0.16 0.31 0.23 0.04 0.39 0.87 0.1  0.17]
Recall on validation set: [0.51 0.33 0.11 0.08 0.4  0.61 0.41 0.77]
F1-score on validation set: [0.24 0.32 0.15 0.05 0.4  0.71 0.17 0.28]
ROC AUC on validation set: {'AK': 0.8, 'BCC': 0.83, 'BKL': 0.64, 'DF': 0.8, 'MEL': 0.5, 'NV': 0.23, 'SCC': 0.77, 'VASC': 0.3}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            22           10  ...            8             0
true class BCC           37           55  ...           41             5
true class BKL           26           24  ...           16             4
true class DF             3            4  ...            2             1
true class MEL           24           21  ...           32             8
true class NV            23           54  ...           12            28
true class SCC            5            9  ...           13             2
true class VASC           0            1  ...            0            10

[8 rows x 8 columns]

Current validation loss: 1.432

Epoch 38:
Mean loss 1.5361815476643175 - Correctly labeled training images 47.45%
Classified 44.48 % of validation images correctly.
Precision on validation set: [0.13 0.33 0.17 0.01 0.39 0.86 0.16 0.18]
Recall on validation set: [0.67 0.14 0.16 0.08 0.39 0.59 0.25 0.85]
F1-score on validation set: [0.22 0.19 0.17 0.02 0.39 0.7  0.2  0.29]
ROC AUC on validation set: {'AK': 0.8, 'BCC': 0.83, 'BKL': 0.64, 'DF': 0.81, 'MEL': 0.5, 'NV': 0.23, 'SCC': 0.77, 'VASC': 0.23}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            29            3  ...            3             0
true class BCC           66           23  ...           16             7
true class BKL           35            8  ...            4             4
true class DF             3            5  ...            0             0
true class MEL           36            9  ...           14             5
true class NV            37           20  ...            4            32
true class SCC           10            2  ...            8             3
true class VASC           0            0  ...            0            11

[8 rows x 8 columns]

Current validation loss: 1.443

Epoch 39:
Mean loss 1.5174021890110774 - Correctly labeled training images 48.07%
Classified 46.06 % of validation images correctly.
Precision on validation set: [0.14 0.39 0.18 0.03 0.39 0.88 0.16 0.15]
Recall on validation set: [0.51 0.28 0.24 0.08 0.42 0.57 0.34 0.85]
F1-score on validation set: [0.23 0.32 0.21 0.05 0.41 0.69 0.22 0.25]
ROC AUC on validation set: {'AK': 0.81, 'BCC': 0.84, 'BKL': 0.65, 'DF': 0.82, 'MEL': 0.49, 'NV': 0.23, 'SCC': 0.78, 'VASC': 0.18}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            22            7  ...            3             1
true class BCC           51           46  ...           25             7
true class BKL           28           12  ...           11             5
true class DF             2            7  ...            0             1
true class MEL           19           16  ...           11            10
true class NV            23           24  ...            6            37
true class SCC            7            6  ...           11             2
true class VASC           0            0  ...            0            11

[8 rows x 8 columns]

Current validation loss: 1.444

Epoch 40:
Mean loss 1.521599275738659 - Correctly labeled training images 47.64%
Classified 50.24 % of validation images correctly.
Precision on validation set: [0.22 0.38 0.18 0.05 0.42 0.86 0.13 0.21]
Recall on validation set: [0.49 0.25 0.22 0.17 0.42 0.66 0.38 0.85]
F1-score on validation set: [0.31 0.3  0.2  0.08 0.42 0.75 0.2  0.33]
ROC AUC on validation set: {'AK': 0.83, 'BCC': 0.85, 'BKL': 0.65, 'DF': 0.79, 'MEL': 0.49, 'NV': 0.21, 'SCC': 0.8, 'VASC': 0.24}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            21            5  ...            5             0
true class BCC           29           41  ...           40             4
true class BKL           18           17  ...           12             5
true class DF             0            6  ...            1             1
true class MEL           15           13  ...           16             6
true class NV             7           20  ...            4            25
true class SCC            4            5  ...           12             1
true class VASC           0            0  ...            0            11

[8 rows x 8 columns]

Current validation loss: 1.331

Epoch 41:
Mean loss 1.508251373183088 - Correctly labeled training images 48.14%
Classified 48.34 % of validation images correctly.
Precision on validation set: [0.16 0.35 0.19 0.02 0.45 0.84 0.19 0.17]
Recall on validation set: [0.56 0.31 0.18 0.08 0.42 0.62 0.28 0.85]
F1-score on validation set: [0.24 0.33 0.18 0.04 0.43 0.71 0.22 0.28]
ROC AUC on validation set: {'AK': 0.84, 'BCC': 0.83, 'BKL': 0.65, 'DF': 0.8, 'MEL': 0.5, 'NV': 0.23, 'SCC': 0.77, 'VASC': 0.22}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            24           11  ...            1             0
true class BCC           47           52  ...           14            12
true class BKL           27           20  ...           10             4
true class DF             4            5  ...            0             0
true class MEL           23           21  ...           12             8
true class NV            21           33  ...            2            28
true class SCC            7            8  ...            9             2
true class VASC           0            0  ...            0            11

[8 rows x 8 columns]

Current validation loss: 1.412

Epoch 42:
Mean loss 1.5130122695059431 - Correctly labeled training images 47.79%
Classified 46.85 % of validation images correctly.
Precision on validation set: [0.17 0.42 0.17 0.02 0.42 0.86 0.19 0.22]
Recall on validation set: [0.51 0.27 0.24 0.17 0.39 0.59 0.34 0.92]
F1-score on validation set: [0.25 0.33 0.2  0.04 0.4  0.7  0.25 0.35]
ROC AUC on validation set: {'AK': 0.81, 'BCC': 0.84, 'BKL': 0.64, 'DF': 0.85, 'MEL': 0.51, 'NV': 0.22, 'SCC': 0.78, 'VASC': 0.23}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            22            5  ...            2             0
true class BCC           42           45  ...           21             5
true class BKL           22           14  ...           10             4
true class DF             2            6  ...            0             0
true class MEL           23           16  ...           11             5
true class NV            15           15  ...            2            28
true class SCC            7            6  ...           11             1
true class VASC           0            0  ...            0            12

/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
[8 rows x 8 columns]

Current validation loss: 1.418

Epoch 43:
Mean loss 1.5041720235385354 - Correctly labeled training images 47.76%
Classified 46.77 % of validation images correctly.
Precision on validation set: [0.14 0.4  0.16 0.04 0.42 0.86 0.18 0.14]
Recall on validation set: [0.67 0.22 0.18 0.08 0.44 0.6  0.22 0.85]
F1-score on validation set: [0.24 0.28 0.17 0.05 0.43 0.71 0.2  0.24]
ROC AUC on validation set: {'AK': 0.81, 'BCC': 0.84, 'BKL': 0.64, 'DF': 0.77, 'MEL': 0.5, 'NV': 0.22, 'SCC': 0.81, 'VASC': 0.18}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            29            2  ...            2             1
true class BCC           63           36  ...            9            10
true class BKL           41            9  ...            7             4
true class DF             6            2  ...            0             1
true class MEL           32           13  ...           12            11
true class NV            22           19  ...            2            38
true class SCC           10            8  ...            7             1
true class VASC           0            0  ...            0            11

[8 rows x 8 columns]

Current validation loss: 1.425

Epoch 44:
Mean loss 1.5054327388667157 - Correctly labeled training images 47.73%
Classified 49.61 % of validation images correctly.
Precision on validation set: [0.15 0.34 0.21 0.05 0.4  0.86 0.15 0.16]
Recall on validation set: [0.21 0.37 0.21 0.17 0.4  0.64 0.41 0.85]
F1-score on validation set: [0.17 0.35 0.21 0.08 0.4  0.74 0.22 0.28]
ROC AUC on validation set: {'AK': 0.82, 'BCC': 0.83, 'BKL': 0.65, 'DF': 0.81, 'MEL': 0.5, 'NV': 0.22, 'SCC': 0.75, 'VASC': 0.23}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK             9           18  ...            5             0
true class BCC           18           62  ...           33             9
true class BKL           12           27  ...            8             4
true class DF             2            5  ...            1             1
true class MEL            6           25  ...           19             9
true class NV             9           38  ...            5            32
true class SCC            4            8  ...           13             1
true class VASC           0            0  ...            0            11

[8 rows x 8 columns]

Current validation loss: 1.364

Epoch 45:
Mean loss 1.489854158945264 - Correctly labeled training images 48.86%
Classified 49.61 % of validation images correctly.
Precision on validation set: [0.15 0.38 0.21 0.07 0.42 0.85 0.19 0.26]
Recall on validation set: [0.63 0.26 0.21 0.33 0.41 0.65 0.22 0.85]
F1-score on validation set: [0.24 0.31 0.21 0.12 0.42 0.74 0.21 0.4 ]
ROC AUC on validation set: {'AK': 0.79, 'BCC': 0.85, 'BKL': 0.66, 'DF': 0.79, 'MEL': 0.49, 'NV': 0.22, 'SCC': 0.78, 'VASC': 0.33}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            27            8  ...            1             0
true class BCC           60           43  ...           12             4
true class BKL           28           15  ...            7             3
true class DF             2            3  ...            1             0
true class MEL           28           13  ...            6             4
true class NV            25           25  ...            2            19
true class SCC           12            5  ...            7             1
true class VASC           0            0  ...            0            11

[8 rows x 8 columns]

Current validation loss: 1.346

Epoch 46:
Mean loss 1.495337611775293 - Correctly labeled training images 48.46%
Classified 50.95 % of validation images correctly.
Precision on validation set: [0.14 0.36 0.22 0.04 0.46 0.83 0.17 0.22]
Recall on validation set: [0.65 0.26 0.18 0.08 0.36 0.7  0.25 0.85]
F1-score on validation set: [0.23 0.3  0.2  0.05 0.41 0.76 0.2  0.35]
ROC AUC on validation set: {'AK': 0.78, 'BCC': 0.84, 'BKL': 0.65, 'DF': 0.82, 'MEL': 0.49, 'NV': 0.23, 'SCC': 0.75, 'VASC': 0.27}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            28            7  ...            2             0
true class BCC           57           43  ...           18             9
true class BKL           35           15  ...            8             3
true class DF             5            1  ...            1             0
true class MEL           32           20  ...            8             6
true class NV            31           28  ...            3            19
true class SCC           13            4  ...            8             1
true class VASC           0            1  ...            0            11

[8 rows x 8 columns]

Current validation loss: 1.338

Epoch 47:
Mean loss 1.4988080434242634 - Correctly labeled training images 48.32%
Classified 44.64 % of validation images correctly.
Precision on validation set: [0.15 0.27 0.17 0.03 0.42 0.87 0.13 0.24]
Recall on validation set: [0.65 0.14 0.13 0.25 0.38 0.6  0.34 0.92]
F1-score on validation set: [0.24 0.18 0.15 0.05 0.4  0.71 0.18 0.38]
ROC AUC on validation set: {'AK': 0.78, 'BCC': 0.82, 'BKL': 0.65, 'DF': 0.8, 'MEL': 0.5, 'NV': 0.24, 'SCC': 0.72, 'VASC': 0.24}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            28            5  ...            4             0
true class BCC           61           23  ...           31             5
true class BKL           36           12  ...           13             4
true class DF             5            1  ...            2             0
true class MEL           26           19  ...           22             6
true class NV            26           24  ...            4            22
true class SCC            9            2  ...           11             1
true class VASC           0            0  ...            0            12

[8 rows x 8 columns]

Current validation loss: 1.467

Epoch 48:
Mean loss 1.4731410958977529 - Correctly labeled training images 48.66%
Classified 49.76 % of validation images correctly.
Precision on validation set: [0.17 0.35 0.19 0.03 0.43 0.86 0.21 0.22]
Recall on validation set: [0.65 0.3  0.13 0.17 0.39 0.66 0.31 1.  ]
F1-score on validation set: [0.27 0.32 0.15 0.05 0.41 0.74 0.25 0.36]
ROC AUC on validation set: {'AK': 0.81, 'BCC': 0.85, 'BKL': 0.65, 'DF': 0.8, 'MEL': 0.5, 'NV': 0.21, 'SCC': 0.8, 'VASC': 0.27}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            28            8  ...            2             0
true class BCC           51           50  ...           14             6
true class BKL           30           23  ...            9             3
true class DF             2            5  ...            0             1
true class MEL           30           20  ...           11             8
true class NV            18           31  ...            2            27
true class SCC            8            7  ...           10             1
true class VASC           0            0  ...            0            13

[8 rows x 8 columns]

Current validation loss: 1.356

Epoch 49:
Mean loss 1.4824340311510706 - Correctly labeled training images 49.16%
Classified 49.13 % of validation images correctly.
Precision on validation set: [0.19 0.46 0.24 0.03 0.41 0.85 0.16 0.22]
Recall on validation set: [0.58 0.22 0.21 0.25 0.43 0.64 0.38 0.85]
F1-score on validation set: [0.29 0.29 0.22 0.06 0.42 0.73 0.22 0.34]
ROC AUC on validation set: {'AK': 0.81, 'BCC': 0.85, 'BKL': 0.64, 'DF': 0.78, 'MEL': 0.5, 'NV': 0.22, 'SCC': 0.78, 'VASC': 0.22}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            25            4  ...            3             0
true class BCC           42           36  ...           29             5
true class BKL           22            6  ...           10             3
true class DF             3            2  ...            1             0
true class MEL           21           13  ...           18             8
true class NV            14           14  ...            4            23
true class SCC            5            4  ...           12             1
true class VASC           0            0  ...            0            11

[8 rows x 8 columns]

Current validation loss: 1.365

Epoch 50:
Mean loss 1.4561747128279052 - Correctly labeled training images 48.54%
Classified 49.21 % of validation images correctly.
Precision on validation set: [0.19 0.35 0.27 0.04 0.42 0.86 0.15 0.21]
Recall on validation set: [0.53 0.22 0.2  0.25 0.42 0.64 0.47 0.92]
F1-score on validation set: [0.28 0.27 0.23 0.06 0.42 0.74 0.23 0.34]
ROC AUC on validation set: {'AK': 0.8, 'BCC': 0.84, 'BKL': 0.64, 'DF': 0.79, 'MEL': 0.49, 'NV': 0.23, 'SCC': 0.75, 'VASC': 0.28}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            23           10  ...            4             0
true class BCC           42           37  ...           41             8
true class BKL           19           11  ...           13             4
true class DF             4            3  ...            0             0
true class MEL           18           21  ...           22             5
true class NV            11           17  ...            6            29
true class SCC            3            6  ...           15             0
true class VASC           0            0  ...            0            12

[8 rows x 8 columns]

Current validation loss: 1.361

Epoch 51:
Mean loss 1.4681996192653848 - Correctly labeled training images 49.20%
Classified 48.19 % of validation images correctly.
Precision on validation set: [0.15 0.4  0.24 0.05 0.39 0.87 0.17 0.14]
Recall on validation set: [0.63 0.25 0.23 0.08 0.45 0.61 0.31 0.77]
F1-score on validation set: [0.24 0.31 0.23 0.06 0.42 0.71 0.22 0.23]
ROC AUC on validation set: {'AK': 0.78, 'BCC': 0.85, 'BKL': 0.65, 'DF': 0.81, 'MEL': 0.48, 'NV': 0.23, 'SCC': 0.77, 'VASC': 0.22}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            27            4  ...            3             0
true class BCC           55           42  ...           27             8
true class BKL           33           14  ...            7             4
true class DF             3            4  ...            1             0
true class MEL           31            9  ...            8            10
true class NV            21           27  ...            3            41
true class SCC           11            3  ...           10             1
true class VASC           0            2  ...            0            10

[8 rows x 8 columns]

Current validation loss: 1.391

Epoch 52:
Mean loss 1.4693409444217802 - Correctly labeled training images 48.97%
Classified 49.21 % of validation images correctly.
Precision on validation set: [0.16 0.4  0.21 0.03 0.42 0.84 0.19 0.25]
Recall on validation set: [0.6  0.14 0.21 0.25 0.41 0.67 0.34 0.85]
F1-score on validation set: [0.25 0.21 0.21 0.06 0.42 0.74 0.25 0.39]
ROC AUC on validation set: {'AK': 0.81, 'BCC': 0.85, 'BKL': 0.64, 'DF': 0.79, 'MEL': 0.5, 'NV': 0.21, 'SCC': 0.81, 'VASC': 0.3}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            26            4  ...            2             0
true class BCC           52           24  ...           22             6
true class BKL           24            8  ...            8             3
true class DF             6            1  ...            1             0
true class MEL           26            8  ...           10             3
true class NV            19           13  ...            3            20
true class SCC           10            2  ...           11             1
true class VASC           0            0  ...            0            11

[8 rows x 8 columns]

Current validation loss: 1.324

Epoch 53:
Mean loss 1.4455504632710658 - Correctly labeled training images 49.77%
Classified 49.13 % of validation images correctly.
Precision on validation set: [0.16 0.39 0.19 0.02 0.43 0.86 0.13 0.21]
Recall on validation set: [0.6  0.16 0.18 0.08 0.4  0.67 0.41 0.85]
F1-score on validation set: [0.25 0.22 0.19 0.03 0.42 0.75 0.2  0.33]
ROC AUC on validation set: {'AK': 0.8, 'BCC': 0.85, 'BKL': 0.65, 'DF': 0.84, 'MEL': 0.49, 'NV': 0.22, 'SCC': 0.78, 'VASC': 0.23}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            26            5  ...            5             0
true class BCC           53           26  ...           36             7
true class BKL           31            9  ...           14             4
true class DF             4            2  ...            1             0
true class MEL           24            8  ...           25             5
true class NV            19           12  ...            5            25
true class SCC            7            5  ...           13             1
true class VASC           0            0  ...            0            11

[8 rows x 8 columns]

Current validation loss: 1.353

Epoch 54:
Mean loss 1.4467703181110345 - Correctly labeled training images 49.62%
Classified 48.19 % of validation images correctly.
Precision on validation set: [0.21 0.39 0.24 0.04 0.39 0.88 0.12 0.18]
Recall on validation set: [0.47 0.29 0.21 0.17 0.42 0.6  0.5  0.92]
F1-score on validation set: [0.29 0.33 0.23 0.06 0.41 0.72 0.2  0.3 ]
ROC AUC on validation set: {'AK': 0.81, 'BCC': 0.85, 'BKL': 0.65, 'DF': 0.83, 'MEL': 0.5, 'NV': 0.22, 'SCC': 0.77, 'VASC': 0.19}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            20            8  ...            8             0
true class BCC           27           48  ...           49             8
true class BKL           20           17  ...           17             4
true class DF             1            3  ...            2             1
true class MEL           13           19  ...           31             8
true class NV            12           22  ...            8            31
true class SCC            1            7  ...           16             2
true class VASC           0            0  ...            1            12

[8 rows x 8 columns]

Current validation loss: 1.392

Epoch 55:
Mean loss 1.4317105671020713 - Correctly labeled training images 50.20%
Classified 47.87 % of validation images correctly.
Precision on validation set: [0.17 0.39 0.22 0.02 0.4  0.88 0.14 0.21]
Recall on validation set: [0.56 0.25 0.27 0.08 0.37 0.62 0.41 0.85]
F1-score on validation set: [0.26 0.3  0.25 0.03 0.38 0.73 0.2  0.33]
ROC AUC on validation set: {'AK': 0.79, 'BCC': 0.86, 'BKL': 0.64, 'DF': 0.82, 'MEL': 0.51, 'NV': 0.22, 'SCC': 0.77, 'VASC': 0.23}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            24            5  ...            4             0
true class BCC           50           41  ...           33             6
true class BKL           22           13  ...           14             3
true class DF             3            4  ...            2             0
true class MEL           21           17  ...           23             7
true class NV            18           18  ...            7            25
true class SCC            5            6  ...           13             1
true class VASC           0            1  ...            0            11

[8 rows x 8 columns]

Current validation loss: 1.416

Epoch 56:
Mean loss 1.4062369008921674 - Correctly labeled training images 50.18%
Classified 45.43 % of validation images correctly.
Precision on validation set: [0.19 0.33 0.22 0.03 0.41 0.88 0.13 0.26]
Recall on validation set: [0.51 0.1  0.18 0.5  0.41 0.61 0.38 0.69]
F1-score on validation set: [0.28 0.16 0.2  0.06 0.41 0.72 0.2  0.37]
ROC AUC on validation set: {'AK': 0.8, 'BCC': 0.85, 'BKL': 0.65, 'DF': 0.75, 'MEL': 0.51, 'NV': 0.21, 'SCC': 0.76, 'VASC': 0.36}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            22            2  ...            4             0
true class BCC           37           17  ...           36             4
true class BKL           21            8  ...            9             3
true class DF             3            0  ...            1             0
true class MEL           16           14  ...           25             2
true class NV             9            7  ...            4            17
true class SCC            5            2  ...           12             0
true class VASC           0            1  ...            0             9

/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
[8 rows x 8 columns]

Current validation loss: 1.402

Epoch 57:
Mean loss 1.4240168665861859 - Correctly labeled training images 49.93%
Classified 47.63 % of validation images correctly.
Precision on validation set: [0.15 0.45 0.23 0.04 0.42 0.88 0.16 0.21]
Recall on validation set: [0.74 0.14 0.22 0.25 0.41 0.62 0.34 0.92]
F1-score on validation set: [0.25 0.21 0.23 0.06 0.42 0.73 0.22 0.34]
ROC AUC on validation set: {'AK': 0.75, 'BCC': 0.86, 'BKL': 0.64, 'DF': 0.78, 'MEL': 0.53, 'NV': 0.21, 'SCC': 0.78, 'VASC': 0.27}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            32            2  ...            3             0
true class BCC           65           23  ...           20             6
true class BKL           32            4  ...           13             3
true class DF             5            0  ...            1             0
true class MEL           39            9  ...           16             7
true class NV            26            9  ...            5            29
true class SCC            9            4  ...           11             1
true class VASC           0            0  ...            0            12

[8 rows x 8 columns]

Current validation loss: 1.400

Epoch 58:
Mean loss 1.4241280159927694 - Correctly labeled training images 50.02%
Classified 50.71 % of validation images correctly.
Precision on validation set: [0.18 0.38 0.22 0.07 0.46 0.85 0.12 0.25]
Recall on validation set: [0.74 0.18 0.11 0.5  0.43 0.69 0.31 0.77]
F1-score on validation set: [0.29 0.24 0.15 0.12 0.44 0.76 0.17 0.38]
ROC AUC on validation set: {'AK': 0.77, 'BCC': 0.84, 'BKL': 0.66, 'DF': 0.78, 'MEL': 0.52, 'NV': 0.21, 'SCC': 0.75, 'VASC': 0.33}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            32            2  ...            3             0
true class BCC           54           30  ...           28             4
true class BKL           29           14  ...           11             3
true class DF             3            1  ...            1             1
true class MEL           30           11  ...           23             1
true class NV            23           17  ...            8            20
true class SCC           10            3  ...           10             1
true class VASC           0            1  ...            0            10

[8 rows x 8 columns]

Current validation loss: 1.334

Epoch 59:
Mean loss 1.4063888598315724 - Correctly labeled training images 49.79%
Classified 51.81 % of validation images correctly.
Precision on validation set: [0.19 0.45 0.21 0.02 0.41 0.86 0.19 0.24]
Recall on validation set: [0.42 0.35 0.22 0.08 0.46 0.66 0.41 0.92]
F1-score on validation set: [0.26 0.39 0.22 0.03 0.44 0.74 0.26 0.38]
ROC AUC on validation set: {'AK': 0.8, 'BCC': 0.86, 'BKL': 0.66, 'DF': 0.82, 'MEL': 0.51, 'NV': 0.2, 'SCC': 0.77, 'VASC': 0.23}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            18            8  ...            3             0
true class BCC           28           58  ...           28             6
true class BKL           20           18  ...            9             3
true class DF             1            5  ...            1             1
true class MEL           15           18  ...           10             6
true class NV             6           18  ...            4            22
true class SCC            5            5  ...           13             0
true class VASC           0            0  ...            0            12

[8 rows x 8 columns]

Current validation loss: 1.267

Epoch 60:
Mean loss 1.4139398560162975 - Correctly labeled training images 50.17%
Classified 49.68 % of validation images correctly.
Precision on validation set: [0.15 0.38 0.18 0.06 0.4  0.87 0.17 0.28]
Recall on validation set: [0.58 0.29 0.18 0.17 0.45 0.64 0.28 0.77]
F1-score on validation set: [0.24 0.33 0.18 0.09 0.43 0.74 0.21 0.41]
ROC AUC on validation set: {'AK': 0.77, 'BCC': 0.86, 'BKL': 0.66, 'DF': 0.82, 'MEL': 0.49, 'NV': 0.21, 'SCC': 0.79, 'VASC': 0.37}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            25            7  ...            1             0
true class BCC           52           49  ...           21             3
true class BKL           29           19  ...            9             3
true class DF             3            4  ...            0             1
true class MEL           31           17  ...           10             2
true class NV            18           23  ...            2            17
true class SCC            8            8  ...            9             0
true class VASC           0            1  ...            0            10

[8 rows x 8 columns]

Current validation loss: 1.311

Epoch 61:
Mean loss 1.399209906344158 - Correctly labeled training images 49.89%
Classified 51.03 % of validation images correctly.
Precision on validation set: [0.16 0.5  0.22 0.09 0.44 0.88 0.15 0.22]
Recall on validation set: [0.53 0.31 0.26 0.42 0.43 0.65 0.28 0.85]
F1-score on validation set: [0.24 0.38 0.24 0.15 0.44 0.74 0.2  0.35]
ROC AUC on validation set: {'AK': 0.8, 'BCC': 0.86, 'BKL': 0.66, 'DF': 0.81, 'MEL': 0.51, 'NV': 0.2, 'SCC': 0.8, 'VASC': 0.26}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            23            7  ...            2             0
true class BCC           46           51  ...           18             5
true class BKL           30           11  ...            9             3
true class DF             1            3  ...            1             1
true class MEL           24           14  ...           18             5
true class NV            13           11  ...            3            24
true class SCC           11            4  ...            9             1
true class VASC           0            1  ...            0            11

[8 rows x 8 columns]

Current validation loss: 1.317

Epoch 62:
Mean loss 1.3848318416237455 - Correctly labeled training images 50.37%
Classified 49.76 % of validation images correctly.
Precision on validation set: [0.18 0.42 0.25 0.07 0.39 0.87 0.17 0.2 ]
Recall on validation set: [0.56 0.3  0.21 0.33 0.44 0.63 0.34 0.92]
F1-score on validation set: [0.28 0.35 0.23 0.11 0.41 0.73 0.23 0.32]
ROC AUC on validation set: {'AK': 0.78, 'BCC': 0.86, 'BKL': 0.64, 'DF': 0.78, 'MEL': 0.49, 'NV': 0.23, 'SCC': 0.77, 'VASC': 0.18}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            24            4  ...            1             0
true class BCC           43           50  ...           21            11
true class BKL           26           11  ...           10             3
true class DF             2            4  ...            0             1
true class MEL           18           26  ...           14             7
true class NV            12           21  ...            6            26
true class SCC            6            4  ...           11             1
true class VASC           0            0  ...            0            12

[8 rows x 8 columns]

Current validation loss: 1.361

Epoch 63:
Mean loss 1.3921319898746742 - Correctly labeled training images 51.03%
Classified 51.42 % of validation images correctly.
Precision on validation set: [0.23 0.39 0.25 0.07 0.43 0.88 0.16 0.25]
Recall on validation set: [0.53 0.35 0.22 0.25 0.46 0.63 0.5  0.92]
F1-score on validation set: [0.32 0.37 0.23 0.11 0.44 0.73 0.24 0.39]
ROC AUC on validation set: {'AK': 0.78, 'BCC': 0.86, 'BKL': 0.62, 'DF': 0.82, 'MEL': 0.5, 'NV': 0.22, 'SCC': 0.77, 'VASC': 0.27}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            23            5  ...            4             0
true class BCC           30           59  ...           34             4
true class BKL           18           20  ...           13             3
true class DF             2            4  ...            1             1
true class MEL           12           30  ...           24             3
true class NV            11           26  ...           11            25
true class SCC            5            6  ...           16             0
true class VASC           0            0  ...            0            12

/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
[8 rows x 8 columns]

Current validation loss: 1.329

Epoch 64:
Mean loss 1.3841677387054034 - Correctly labeled training images 50.51%
Classified 48.50 % of validation images correctly.
Precision on validation set: [0.18 0.42 0.22 0.1  0.42 0.87 0.12 0.27]
Recall on validation set: [0.53 0.26 0.22 0.42 0.44 0.6  0.47 0.92]
F1-score on validation set: [0.27 0.32 0.22 0.16 0.43 0.71 0.19 0.42]
ROC AUC on validation set: {'AK': 0.8, 'BCC': 0.86, 'BKL': 0.63, 'DF': 0.78, 'MEL': 0.5, 'NV': 0.22, 'SCC': 0.76, 'VASC': 0.31}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            23            8  ...            6             0
true class BCC           33           43  ...           45             5
true class BKL           23           12  ...           17             2
true class DF             2            3  ...            0             0
true class MEL           20           15  ...           31             3
true class NV            17           18  ...           14            22
true class SCC            7            4  ...           15             0
true class VASC           0            0  ...            0            12

[8 rows x 8 columns]

Current validation loss: 1.348

Epoch 65:
Mean loss 1.3687932909663167 - Correctly labeled training images 51.56%
Classified 49.37 % of validation images correctly.
Precision on validation set: [0.14 0.46 0.2  0.05 0.44 0.87 0.14 0.24]
Recall on validation set: [0.6  0.19 0.18 0.42 0.42 0.66 0.22 0.92]
F1-score on validation set: [0.22 0.26 0.19 0.1  0.43 0.75 0.17 0.39]
ROC AUC on validation set: {'AK': 0.77, 'BCC': 0.87, 'BKL': 0.65, 'DF': 0.78, 'MEL': 0.51, 'NV': 0.21, 'SCC': 0.77, 'VASC': 0.33}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            26            4  ...            1             0
true class BCC           57           31  ...           20             7
true class BKL           37            8  ...            6             3
true class DF             4            0  ...            1             1
true class MEL           36           10  ...           13             6
true class NV            22           10  ...            2            20
true class SCC            8            4  ...            7             0
true class VASC           0            0  ...            0            12

[8 rows x 8 columns]

Current validation loss: 1.343

Epoch 66:
Mean loss 1.3760600468901805 - Correctly labeled training images 50.19%
Classified 48.82 % of validation images correctly.
Precision on validation set: [0.18 0.43 0.2  0.04 0.41 0.89 0.12 0.28]
Recall on validation set: [0.63 0.23 0.25 0.17 0.41 0.62 0.34 0.92]
F1-score on validation set: [0.28 0.3  0.22 0.07 0.41 0.73 0.18 0.43]
ROC AUC on validation set: {'AK': 0.78, 'BCC': 0.87, 'BKL': 0.64, 'DF': 0.8, 'MEL': 0.5, 'NV': 0.21, 'SCC': 0.78, 'VASC': 0.29}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            27            4  ...            3             1
true class BCC           47           39  ...           28             5
true class BKL           32            8  ...           16             2
true class DF             4            2  ...            1             1
true class MEL           20           17  ...           23             3
true class NV            13           16  ...            7            19
true class SCC            8            4  ...           11             0
true class VASC           0            0  ...            0            12

[8 rows x 8 columns]

Current validation loss: 1.311

Epoch 67:
Mean loss 1.3586468009824633 - Correctly labeled training images 51.11%
Classified 51.81 % of validation images correctly.
Precision on validation set: [0.15 0.41 0.23 0.04 0.46 0.86 0.16 0.26]
Recall on validation set: [0.63 0.23 0.21 0.17 0.38 0.7  0.28 0.92]
F1-score on validation set: [0.25 0.3  0.22 0.06 0.42 0.77 0.2  0.41]
ROC AUC on validation set: {'AK': 0.76, 'BCC': 0.87, 'BKL': 0.64, 'DF': 0.81, 'MEL': 0.52, 'NV': 0.21, 'SCC': 0.78, 'VASC': 0.23}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            27            5  ...            2             1
true class BCC           55           39  ...           19             7
true class BKL           33            9  ...            8             2
true class DF             4            3  ...            1             0
true class MEL           33           17  ...           15             4
true class NV            15           20  ...            4            20
true class SCC            9            3  ...            9             0
true class VASC           0            0  ...            0            12

[8 rows x 8 columns]

Current validation loss: 1.284

Epoch 68:
Mean loss 1.3499376749390684 - Correctly labeled training images 51.55%
Classified 50.71 % of validation images correctly.
Precision on validation set: [0.15 0.47 0.23 0.07 0.41 0.86 0.19 0.18]
Recall on validation set: [0.49 0.26 0.21 0.42 0.43 0.66 0.31 0.92]
F1-score on validation set: [0.23 0.33 0.22 0.12 0.42 0.75 0.24 0.31]
ROC AUC on validation set: {'AK': 0.79, 'BCC': 0.86, 'BKL': 0.65, 'DF': 0.77, 'MEL': 0.51, 'NV': 0.21, 'SCC': 0.78, 'VASC': 0.12}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            21            6  ...            2             1
true class BCC           46           43  ...           20             9
true class BKL           22           14  ...            8             4
true class DF             2            2  ...            1             0
true class MEL           25           14  ...            9            10
true class NV            14           10  ...            2            28
true class SCC            6            3  ...           10             1
true class VASC           0            0  ...            0            12

[8 rows x 8 columns]

Current validation loss: 1.328

Epoch 69:
Mean loss 1.3378167242657875 - Correctly labeled training images 51.39%
Classified 48.03 % of validation images correctly.
Precision on validation set: [0.14 0.36 0.22 0.04 0.46 0.88 0.19 0.28]
Recall on validation set: [0.58 0.22 0.23 0.42 0.38 0.63 0.31 0.85]
F1-score on validation set: [0.23 0.27 0.22 0.08 0.41 0.73 0.23 0.42]
ROC AUC on validation set: {'AK': 0.77, 'BCC': 0.85, 'BKL': 0.62, 'DF': 0.78, 'MEL': 0.52, 'NV': 0.22, 'SCC': 0.75, 'VASC': 0.27}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            25            5  ...            2             1
true class BCC           55           36  ...           13             3
true class BKL           31           14  ...            8             2
true class DF             3            2  ...            1             0
true class MEL           31           16  ...           16             4
true class NV            23           24  ...            4            18
true class SCC            8            2  ...           10             0
true class VASC           0            1  ...            0            11

[8 rows x 8 columns]

Current validation loss: 1.378

Epoch 70:
Mean loss 1.3491511210470168 - Correctly labeled training images 50.98%
Classified 50.55 % of validation images correctly.
Precision on validation set: [0.23 0.41 0.2  0.07 0.41 0.88 0.14 0.23]
Recall on validation set: [0.42 0.29 0.24 0.25 0.46 0.64 0.41 1.  ]
F1-score on validation set: [0.3  0.34 0.22 0.11 0.43 0.74 0.21 0.38]
ROC AUC on validation set: {'AK': 0.77, 'BCC': 0.87, 'BKL': 0.63, 'DF': 0.85, 'MEL': 0.51, 'NV': 0.21, 'SCC': 0.76, 'VASC': 0.27}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            18            5  ...            4             1
true class BCC           26           48  ...           35             8
true class BKL           15           14  ...           12             3
true class DF             1            6  ...            1             0
true class MEL            9           26  ...           19             5
true class NV             8           14  ...            7            25
true class SCC            2            4  ...           13             1
true class VASC           0            0  ...            0            13

[8 rows x 8 columns]

Current validation loss: 1.291

Epoch 71:
Mean loss 1.3380324990027335 - Correctly labeled training images 52.14%
Classified 51.50 % of validation images correctly.
Precision on validation set: [0.16 0.46 0.25 0.04 0.46 0.86 0.17 0.2 ]
Recall on validation set: [0.51 0.28 0.24 0.25 0.41 0.67 0.34 0.92]
F1-score on validation set: [0.24 0.35 0.24 0.07 0.44 0.75 0.22 0.33]
ROC AUC on validation set: {'AK': 0.74, 'BCC': 0.87, 'BKL': 0.63, 'DF': 0.81, 'MEL': 0.52, 'NV': 0.21, 'SCC': 0.77, 'VASC': 0.2}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            22            5  ...            3             0
true class BCC           48           47  ...           22             6
true class BKL           24           10  ...           10             4
true class DF             4            1  ...            1             1
true class MEL           22           20  ...           16             8
true class NV            12           17  ...            3            28
true class SCC            8            2  ...           11             1
true class VASC           0            0  ...            0            12

[8 rows x 8 columns]

Current validation loss: 1.307

Epoch 72:
Mean loss 1.325648342350304 - Correctly labeled training images 52.44%
Classified 52.52 % of validation images correctly.
Precision on validation set: [0.2  0.51 0.23 0.09 0.43 0.87 0.14 0.27]
Recall on validation set: [0.6  0.28 0.23 0.33 0.43 0.68 0.47 0.85]
F1-score on validation set: [0.3  0.36 0.23 0.14 0.43 0.76 0.22 0.41]
ROC AUC on validation set: {'AK': 0.76, 'BCC': 0.87, 'BKL': 0.63, 'DF': 0.8, 'MEL': 0.5, 'NV': 0.22, 'SCC': 0.75, 'VASC': 0.3}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            26            4  ...            5             1
true class BCC           37           46  ...           33             4
true class BKL           24            8  ...           16             2
true class DF             1            3  ...            2             0
true class MEL           20           16  ...           23             3
true class NV            14           11  ...           11            20
true class SCC            6            3  ...           15             0
true class VASC           0            0  ...            0            11

[8 rows x 8 columns]

Current validation loss: 1.275

Epoch 73:
Mean loss 1.3078950387822341 - Correctly labeled training images 51.87%
Classified 52.60 % of validation images correctly.
Precision on validation set: [0.2  0.56 0.22 0.06 0.4  0.88 0.2  0.28]
Recall on validation set: [0.53 0.34 0.28 0.17 0.47 0.65 0.38 1.  ]
F1-score on validation set: [0.29 0.42 0.25 0.09 0.43 0.75 0.26 0.43]
ROC AUC on validation set: {'AK': 0.77, 'BCC': 0.88, 'BKL': 0.64, 'DF': 0.81, 'MEL': 0.5, 'NV': 0.21, 'SCC': 0.79, 'VASC': 0.24}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            23            4  ...            4             1
true class BCC           34           57  ...           19             4
true class BKL           20           13  ...            8             3
true class DF             2            5  ...            1             0
true class MEL           17           13  ...           12             4
true class NV            14            7  ...            4            21
true class SCC            7            3  ...           12             1
true class VASC           0            0  ...            0            13

[8 rows x 8 columns]

Current validation loss: 1.232

Epoch 74:
Mean loss 1.3048904677294781 - Correctly labeled training images 52.61%
Classified 49.76 % of validation images correctly.
Precision on validation set: [0.13 0.46 0.21 0.06 0.4  0.87 0.19 0.27]
Recall on validation set: [0.49 0.2  0.23 0.42 0.44 0.66 0.25 0.92]
F1-score on validation set: [0.21 0.28 0.22 0.11 0.42 0.75 0.22 0.42]
ROC AUC on validation set: {'AK': 0.77, 'BCC': 0.88, 'BKL': 0.63, 'DF': 0.81, 'MEL': 0.51, 'NV': 0.21, 'SCC': 0.77, 'VASC': 0.26}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            21            6  ...            2             1
true class BCC           55           33  ...           19             3
true class BKL           26           10  ...            5             3
true class DF             3            1  ...            1             0
true class MEL           24           14  ...            5             4
true class NV            16            6  ...            2            20
true class SCC           11            2  ...            8             1
true class VASC           0            0  ...            0            12

[8 rows x 8 columns]

Current validation loss: 1.259

Epoch 75:
Mean loss 1.3134836870883166 - Correctly labeled training images 52.17%
Classified 50.00 % of validation images correctly.
Precision on validation set: [0.2  0.47 0.21 0.07 0.44 0.88 0.14 0.31]
Recall on validation set: [0.56 0.25 0.24 0.42 0.41 0.64 0.5  1.  ]
F1-score on validation set: [0.29 0.32 0.22 0.12 0.42 0.74 0.22 0.47]
ROC AUC on validation set: {'AK': 0.75, 'BCC': 0.87, 'BKL': 0.64, 'DF': 0.75, 'MEL': 0.5, 'NV': 0.22, 'SCC': 0.75, 'VASC': 0.26}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            24            4  ...            5             0
true class BCC           38           41  ...           42             4
true class BKL           22           12  ...           16             3
true class DF             2            2  ...            1             0
true class MEL           18           11  ...           26             3
true class NV            15           13  ...            9            18
true class SCC            4            4  ...           16             1
true class VASC           0            0  ...            0            13

[8 rows x 8 columns]

Current validation loss: 1.308

Epoch 76:
Mean loss 1.2973743202370425 - Correctly labeled training images 52.38%
Classified 52.29 % of validation images correctly.
Precision on validation set: [0.2  0.53 0.22 0.04 0.44 0.87 0.16 0.24]
Recall on validation set: [0.65 0.33 0.2  0.25 0.43 0.67 0.31 1.  ]
F1-score on validation set: [0.3  0.41 0.21 0.08 0.44 0.75 0.21 0.38]
ROC AUC on validation set: {'AK': 0.76, 'BCC': 0.88, 'BKL': 0.64, 'DF': 0.8, 'MEL': 0.53, 'NV': 0.2, 'SCC': 0.76, 'VASC': 0.15}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            28            6  ...            3             1
true class BCC           42           55  ...           17             5
true class BKL           30           10  ...           11             3
true class DF             2            4  ...            2             0
true class MEL           21           15  ...           16             6
true class NV            13           10  ...            3            26
true class SCC            7            4  ...           10             1
true class VASC           0            0  ...            0            13

[8 rows x 8 columns]

Current validation loss: 1.275

Epoch 77:
Mean loss 1.2909083152983092 - Correctly labeled training images 52.74%
Classified 52.68 % of validation images correctly.
Precision on validation set: [0.2  0.47 0.22 0.07 0.48 0.86 0.21 0.27]
Recall on validation set: [0.51 0.34 0.34 0.42 0.33 0.69 0.31 1.  ]
F1-score on validation set: [0.29 0.39 0.26 0.12 0.39 0.76 0.25 0.43]
ROC AUC on validation set: {'AK': 0.75, 'BCC': 0.87, 'BKL': 0.62, 'DF': 0.77, 'MEL': 0.51, 'NV': 0.22, 'SCC': 0.76, 'VASC': 0.18}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            22            5  ...            2             1
true class BCC           34           56  ...           18             7
true class BKL           19           13  ...            8             4
true class DF             2            3  ...            0             1
true class MEL           16           23  ...            8             4
true class NV            10           15  ...            2            17
true class SCC            8            4  ...           10             1
true class VASC           0            0  ...            0            13

/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
[8 rows x 8 columns]

Current validation loss: 1.268

Epoch 78:
Mean loss 1.2956391688589042 - Correctly labeled training images 52.75%
Classified 50.47 % of validation images correctly.
Precision on validation set: [0.2  0.44 0.23 0.12 0.43 0.89 0.15 0.27]
Recall on validation set: [0.63 0.27 0.25 0.67 0.4  0.63 0.5  1.  ]
F1-score on validation set: [0.31 0.33 0.24 0.2  0.41 0.74 0.23 0.43]
ROC AUC on validation set: {'AK': 0.75, 'BCC': 0.87, 'BKL': 0.63, 'DF': 0.73, 'MEL': 0.52, 'NV': 0.22, 'SCC': 0.72, 'VASC': 0.19}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            27            4  ...            3             1
true class BCC           41           45  ...           35             6
true class BKL           22           11  ...           16             4
true class DF             1            1  ...            1             0
true class MEL           21           22  ...           24             5
true class NV            16           17  ...           10            19
true class SCC            6            3  ...           16             0
true class VASC           0            0  ...            0            13

[8 rows x 8 columns]

Current validation loss: 1.319

Epoch 79:
Mean loss 1.281179872268006 - Correctly labeled training images 51.66%
Classified 52.21 % of validation images correctly.
Precision on validation set: [0.15 0.5  0.23 0.07 0.42 0.85 0.17 0.36]
Recall on validation set: [0.49 0.31 0.27 0.33 0.38 0.69 0.31 1.  ]
F1-score on validation set: [0.23 0.39 0.24 0.11 0.4  0.76 0.22 0.53]
ROC AUC on validation set: {'AK': 0.75, 'BCC': 0.87, 'BKL': 0.62, 'DF': 0.76, 'MEL': 0.48, 'NV': 0.24, 'SCC': 0.76, 'VASC': 0.3}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            21            5  ...            2             1
true class BCC           50           52  ...           19             3
true class BKL           18           10  ...           12             2
true class DF             4            3  ...            0             0
true class MEL           22           11  ...           13             3
true class NV            11           18  ...            2            14
true class SCC           10            4  ...           10             0
true class VASC           0            0  ...            0            13

[8 rows x 8 columns]

Current validation loss: 1.237

Epoch 80:
Mean loss 1.2833069636242622 - Correctly labeled training images 52.55%
Classified 50.63 % of validation images correctly.
Precision on validation set: [0.2  0.44 0.22 0.1  0.45 0.86 0.14 0.24]
Recall on validation set: [0.58 0.31 0.21 0.58 0.37 0.66 0.47 0.92]
F1-score on validation set: [0.29 0.36 0.22 0.17 0.4  0.74 0.22 0.38]
ROC AUC on validation set: {'AK': 0.72, 'BCC': 0.87, 'BKL': 0.64, 'DF': 0.73, 'MEL': 0.53, 'NV': 0.22, 'SCC': 0.72, 'VASC': 0.26}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            25            3  ...            5             1
true class BCC           40           51  ...           34             6
true class BKL           25           15  ...           16             3
true class DF             1            0  ...            2             1
true class MEL           18           19  ...           27             7
true class NV            13           25  ...            7            21
true class SCC            6            3  ...           15             0
true class VASC           0            1  ...            0            12

[8 rows x 8 columns]

Current validation loss: 1.299

Epoch 81:
Mean loss 1.2842758802773449 - Correctly labeled training images 52.53%
Classified 52.52 % of validation images correctly.
Precision on validation set: [0.17 0.53 0.22 0.07 0.43 0.85 0.2  0.27]
Recall on validation set: [0.56 0.29 0.22 0.42 0.41 0.69 0.34 1.  ]
F1-score on validation set: [0.27 0.38 0.22 0.13 0.42 0.76 0.26 0.42]
ROC AUC on validation set: {'AK': 0.75, 'BCC': 0.88, 'BKL': 0.63, 'DF': 0.73, 'MEL': 0.52, 'NV': 0.21, 'SCC': 0.75, 'VASC': 0.23}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            24            5  ...            3             1
true class BCC           42           49  ...           13            10
true class BKL           24           10  ...            7             3
true class DF             3            0  ...            2             1
true class MEL           22           12  ...           13             7
true class NV            14           16  ...            5            13
true class SCC            9            1  ...           11             1
true class VASC           0            0  ...            0            13

[8 rows x 8 columns]

Current validation loss: 1.233

Epoch 82:
Mean loss 1.2633019862490873 - Correctly labeled training images 53.31%
Classified 52.68 % of validation images correctly.
Precision on validation set: [0.2  0.47 0.25 0.12 0.38 0.89 0.21 0.39]
Recall on validation set: [0.47 0.33 0.23 0.5  0.52 0.64 0.5  0.92]
F1-score on validation set: [0.28 0.39 0.24 0.19 0.44 0.74 0.3  0.55]
ROC AUC on validation set: {'AK': 0.76, 'BCC': 0.89, 'BKL': 0.64, 'DF': 0.76, 'MEL': 0.5, 'NV': 0.21, 'SCC': 0.74, 'VASC': 0.42}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            20            6  ...            2             1
true class BCC           32           55  ...           28             2
true class BKL           20           16  ...            7             2
true class DF             1            1  ...            2             0
true class MEL           15           17  ...           15             3
true class NV             6           17  ...            5            11
true class SCC            6            3  ...           16             0
true class VASC           0            1  ...            0            12

[8 rows x 8 columns]

Current validation loss: 1.197

Epoch 83:
Mean loss 1.2532241469019971 - Correctly labeled training images 53.09%
Classified 52.52 % of validation images correctly.
Precision on validation set: [0.22 0.47 0.22 0.11 0.45 0.88 0.17 0.25]
Recall on validation set: [0.44 0.39 0.21 0.75 0.42 0.65 0.47 1.  ]
F1-score on validation set: [0.29 0.43 0.22 0.19 0.44 0.75 0.25 0.4 ]
ROC AUC on validation set: {'AK': 0.76, 'BCC': 0.88, 'BKL': 0.64, 'DF': 0.7, 'MEL': 0.52, 'NV': 0.21, 'SCC': 0.73, 'VASC': 0.17}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            19            6  ...            4             1
true class BCC           27           65  ...           29             6
true class BKL           16           18  ...           14             3
true class DF             0            0  ...            1             1
true class MEL           13           21  ...           20             6
true class NV             8           24  ...            5            21
true class SCC            4            3  ...           15             1
true class VASC           0            0  ...            0            13

[8 rows x 8 columns]

Current validation loss: 1.268

Epoch 84:
Mean loss 1.2364271155761244 - Correctly labeled training images 53.47%
Classified 51.58 % of validation images correctly.
Precision on validation set: [0.18 0.52 0.21 0.07 0.44 0.88 0.23 0.25]
Recall on validation set: [0.58 0.37 0.24 0.42 0.41 0.64 0.38 1.  ]
F1-score on validation set: [0.27 0.43 0.22 0.12 0.42 0.74 0.29 0.4 ]
ROC AUC on validation set: {'AK': 0.72, 'BCC': 0.87, 'BKL': 0.61, 'DF': 0.73, 'MEL': 0.5, 'NV': 0.24, 'SCC': 0.74, 'VASC': 0.2}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            25            4  ...            3             1
true class BCC           41           61  ...           14             5
true class BKL           24           14  ...            6             3
true class DF             3            1  ...            1             1
true class MEL           24           17  ...           11             6
true class NV            17           18  ...            5            22
true class SCC            7            2  ...           12             1
true class VASC           0            0  ...            0            13

/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
[8 rows x 8 columns]

Current validation loss: 1.283

Epoch 85:
Mean loss 1.254284093949697 - Correctly labeled training images 53.07%
Classified 50.87 % of validation images correctly.
Precision on validation set: [0.17 0.54 0.21 0.07 0.46 0.87 0.19 0.23]
Recall on validation set: [0.49 0.3  0.24 0.75 0.35 0.67 0.34 1.  ]
F1-score on validation set: [0.25 0.39 0.23 0.13 0.4  0.75 0.25 0.38]
ROC AUC on validation set: {'AK': 0.77, 'BCC': 0.88, 'BKL': 0.64, 'DF': 0.7, 'MEL': 0.53, 'NV': 0.21, 'SCC': 0.74, 'VASC': 0.15}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            21            7  ...            2             1
true class BCC           41           50  ...           17             9
true class BKL           22           12  ...           10             3
true class DF             0            0  ...            2             1
true class MEL           21            8  ...           11             9
true class NV            10           13  ...            4            20
true class SCC            7            2  ...           11             0
true class VASC           0            0  ...            0            13

[8 rows x 8 columns]

Current validation loss: 1.309

Epoch 86:
Mean loss 1.2397316523154827 - Correctly labeled training images 53.87%
Classified 52.76 % of validation images correctly.
Precision on validation set: [0.2  0.53 0.25 0.12 0.41 0.87 0.22 0.28]
Recall on validation set: [0.63 0.35 0.23 0.67 0.46 0.65 0.34 1.  ]
F1-score on validation set: [0.3  0.42 0.24 0.2  0.44 0.74 0.27 0.43]
ROC AUC on validation set: {'AK': 0.75, 'BCC': 0.89, 'BKL': 0.62, 'DF': 0.7, 'MEL': 0.51, 'NV': 0.22, 'SCC': 0.73, 'VASC': 0.26}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            27            5  ...            2             1
true class BCC           42           58  ...           16             8
true class BKL           24           14  ...            9             2
true class DF             1            0  ...            1             1
true class MEL           19           16  ...           10             2
true class NV            12           16  ...            2            20
true class SCC           10            1  ...           11             0
true class VASC           0            0  ...            0            13

[8 rows x 8 columns]

Current validation loss: 1.215

Epoch 87:
Mean loss 1.2294772927317335 - Correctly labeled training images 53.47%
Classified 54.10 % of validation images correctly.
Precision on validation set: [0.17 0.57 0.22 0.1  0.46 0.87 0.2  0.27]
Recall on validation set: [0.44 0.38 0.3  0.5  0.37 0.7  0.44 1.  ]
F1-score on validation set: [0.25 0.45 0.26 0.17 0.41 0.77 0.28 0.42]
ROC AUC on validation set: {'AK': 0.77, 'BCC': 0.9, 'BKL': 0.64, 'DF': 0.71, 'MEL': 0.52, 'NV': 0.2, 'SCC': 0.78, 'VASC': 0.22}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            19            7  ...            4             1
true class BCC           34           63  ...           20            11
true class BKL           22            9  ...           12             2
true class DF             3            0  ...            1             0
true class MEL           18           16  ...           16             5
true class NV             9            9  ...            2            16
true class SCC            5            6  ...           14             1
true class VASC           0            0  ...            0            13

[8 rows x 8 columns]

Current validation loss: 1.199

Epoch 88:
Mean loss 1.2049858763296897 - Correctly labeled training images 53.65%
Classified 52.76 % of validation images correctly.
Precision on validation set: [0.21 0.47 0.24 0.1  0.43 0.86 0.19 0.25]
Recall on validation set: [0.53 0.5  0.24 0.33 0.42 0.63 0.41 1.  ]
F1-score on validation set: [0.31 0.49 0.24 0.16 0.42 0.73 0.26 0.39]
ROC AUC on validation set: {'AK': 0.77, 'BCC': 0.89, 'BKL': 0.62, 'DF': 0.69, 'MEL': 0.51, 'NV': 0.22, 'SCC': 0.74, 'VASC': 0.22}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            23           11  ...            3             1
true class BCC           25           84  ...           22             8
true class BKL           21           21  ...            9             3
true class DF             3            1  ...            2             0
true class MEL           15           24  ...           14             7
true class NV            15           29  ...            6            21
true class SCC            5            8  ...           13             0
true class VASC           0            0  ...            0            13

[8 rows x 8 columns]

Current validation loss: 1.237

Epoch 89:
Mean loss 1.198895142093442 - Correctly labeled training images 54.34%
Classified 53.23 % of validation images correctly.
Precision on validation set: [0.21 0.51 0.22 0.07 0.52 0.84 0.16 0.36]
Recall on validation set: [0.49 0.38 0.27 0.67 0.29 0.71 0.28 1.  ]
F1-score on validation set: [0.3  0.44 0.24 0.13 0.37 0.77 0.2  0.53]
ROC AUC on validation set: {'AK': 0.78, 'BCC': 0.9, 'BKL': 0.64, 'DF': 0.67, 'MEL': 0.53, 'NV': 0.19, 'SCC': 0.75, 'VASC': 0.34}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            21            7  ...            4             2
true class BCC           29           64  ...           15             4
true class BKL           18           14  ...           10             3
true class DF             0            1  ...            1             0
true class MEL           15           23  ...           15             3
true class NV             7           12  ...            3            10
true class SCC            9            4  ...            9             1
true class VASC           0            0  ...            0            13

[8 rows x 8 columns]

Current validation loss: 1.236

Epoch 90:
Mean loss 1.2153310462691431 - Correctly labeled training images 54.63%
Classified 53.63 % of validation images correctly.
Precision on validation set: [0.18 0.54 0.23 0.12 0.47 0.86 0.17 0.32]
Recall on validation set: [0.53 0.35 0.24 0.75 0.42 0.68 0.41 1.  ]
F1-score on validation set: [0.27 0.42 0.24 0.21 0.45 0.76 0.24 0.49]
ROC AUC on validation set: {'AK': 0.76, 'BCC': 0.89, 'BKL': 0.63, 'DF': 0.73, 'MEL': 0.52, 'NV': 0.21, 'SCC': 0.74, 'VASC': 0.24}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            23            4  ...            5             0
true class BCC           41           58  ...           29             4
true class BKL           23           14  ...            7             3
true class DF             1            0  ...            1             0
true class MEL           23           15  ...           15             3
true class NV            12           14  ...            5            16
true class SCC            4            2  ...           13             1
true class VASC           0            0  ...            0            13

[8 rows x 8 columns]

Current validation loss: 1.241

Epoch 91:
Mean loss 1.2013739058365958 - Correctly labeled training images 54.80%
Classified 54.10 % of validation images correctly.
Precision on validation set: [0.25 0.53 0.23 0.1  0.43 0.83 0.21 0.31]
Recall on validation set: [0.51 0.31 0.31 0.58 0.34 0.71 0.47 1.  ]
F1-score on validation set: [0.34 0.39 0.26 0.18 0.38 0.77 0.29 0.47]
ROC AUC on validation set: {'AK': 0.78, 'BCC': 0.88, 'BKL': 0.63, 'DF': 0.74, 'MEL': 0.52, 'NV': 0.21, 'SCC': 0.75, 'VASC': 0.21}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            22            4  ...            3             0
true class BCC           26           52  ...           28             5
true class BKL           15           15  ...            6             2
true class DF             0            1  ...            1             0
true class MEL           13           16  ...           12             5
true class NV             7            8  ...            6            16
true class SCC            4            3  ...           15             1
true class VASC           0            0  ...            0            13

[8 rows x 8 columns]

Current validation loss: 1.176

Epoch 92:
Mean loss 1.1969502519357844 - Correctly labeled training images 54.51%
Classified 54.50 % of validation images correctly.
Precision on validation set: [0.17 0.52 0.23 0.14 0.45 0.84 0.23 0.32]
Recall on validation set: [0.51 0.35 0.25 0.58 0.38 0.71 0.41 1.  ]
F1-score on validation set: [0.25 0.42 0.24 0.23 0.41 0.77 0.29 0.49]
ROC AUC on validation set: {'AK': 0.75, 'BCC': 0.89, 'BKL': 0.63, 'DF': 0.68, 'MEL': 0.51, 'NV': 0.21, 'SCC': 0.75, 'VASC': 0.26}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            22            6  ...            3             0
true class BCC           45           58  ...           20             2
true class BKL           22           17  ...            8             3
true class DF             2            0  ...            1             0
true class MEL           23           18  ...            8             6
true class NV            12           10  ...            4            16
true class SCC            7            3  ...           13             0
true class VASC           0            0  ...            0            13

[8 rows x 8 columns]

Current validation loss: 1.173

Epoch 93:
Mean loss 1.175879104609369 - Correctly labeled training images 54.94%
Classified 51.58 % of validation images correctly.
Precision on validation set: [0.17 0.56 0.22 0.11 0.4  0.86 0.26 0.39]
Recall on validation set: [0.51 0.35 0.33 0.67 0.38 0.64 0.38 1.  ]
F1-score on validation set: [0.26 0.43 0.26 0.19 0.39 0.74 0.3  0.57]
ROC AUC on validation set: {'AK': 0.76, 'BCC': 0.9, 'BKL': 0.62, 'DF': 0.67, 'MEL': 0.52, 'NV': 0.2, 'SCC': 0.75, 'VASC': 0.31}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            22            6  ...            2             1
true class BCC           43           58  ...           17             3
true class BKL           23            9  ...            6             3
true class DF             0            0  ...            2             0
true class MEL           21           15  ...            7             3
true class NV            12           10  ...            1            10
true class SCC            7            5  ...           12             0
true class VASC           0            0  ...            0            13

[8 rows x 8 columns]

Current validation loss: 1.225

Epoch 94:
Mean loss 1.1805194940664792 - Correctly labeled training images 54.54%
Classified 51.18 % of validation images correctly.
Precision on validation set: [0.21 0.53 0.21 0.11 0.39 0.87 0.23 0.3 ]
Recall on validation set: [0.56 0.4  0.22 0.67 0.46 0.6  0.47 1.  ]
F1-score on validation set: [0.31 0.45 0.21 0.2  0.43 0.71 0.31 0.46]
ROC AUC on validation set: {'AK': 0.74, 'BCC': 0.89, 'BKL': 0.62, 'DF': 0.69, 'MEL': 0.51, 'NV': 0.22, 'SCC': 0.74, 'VASC': 0.27}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            24            7  ...            3             1
true class BCC           39           66  ...           19             4
true class BKL           19           14  ...            8             3
true class DF             0            1  ...            1             0
true class MEL           15           20  ...           14             6
true class NV            13           13  ...            4            17
true class SCC            4            3  ...           15             0
true class VASC           0            0  ...            0            13

[8 rows x 8 columns]

Current validation loss: 1.255

Epoch 95:
Mean loss 1.1624075925500612 - Correctly labeled training images 55.33%
Classified 53.86 % of validation images correctly.
Precision on validation set: [0.19 0.48 0.27 0.12 0.44 0.86 0.2  0.34]
Recall on validation set: [0.51 0.37 0.26 0.75 0.4  0.68 0.5  0.77]
F1-score on validation set: [0.28 0.42 0.27 0.21 0.42 0.76 0.28 0.48]
ROC AUC on validation set: {'AK': 0.77, 'BCC': 0.88, 'BKL': 0.62, 'DF': 0.68, 'MEL': 0.5, 'NV': 0.22, 'SCC': 0.73, 'VASC': 0.4}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            22           10  ...            5             1
true class BCC           34           61  ...           27             6
true class BKL           20           15  ...            9             1
true class DF             0            1  ...            1             0
true class MEL           18           16  ...           20             2
true class NV            15           19  ...            3             9
true class SCC            6            2  ...           16             0
true class VASC           0            2  ...            0            10

[8 rows x 8 columns]

Current validation loss: 1.212

Epoch 96:
Mean loss 1.1609968593349969 - Correctly labeled training images 54.93%
Classified 55.28 % of validation images correctly.
Precision on validation set: [0.22 0.54 0.25 0.16 0.47 0.85 0.2  0.25]
Recall on validation set: [0.6  0.42 0.28 0.58 0.37 0.7  0.47 1.  ]
F1-score on validation set: [0.32 0.47 0.27 0.25 0.41 0.77 0.28 0.41]
ROC AUC on validation set: {'AK': 0.76, 'BCC': 0.9, 'BKL': 0.63, 'DF': 0.71, 'MEL': 0.5, 'NV': 0.22, 'SCC': 0.72, 'VASC': 0.22}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            26            8  ...            5             0
true class BCC           31           70  ...           27             7
true class BKL           21           15  ...            9             3
true class DF             1            1  ...            1             1
true class MEL           21           15  ...           13             6
true class NV            13           18  ...            5            20
true class SCC            4            3  ...           15             1
true class VASC           0            0  ...            0            13

[8 rows x 8 columns]

Current validation loss: 1.197

Epoch 97:
Mean loss 1.1457752846768978 - Correctly labeled training images 55.41%
Classified 53.79 % of validation images correctly.
Precision on validation set: [0.22 0.53 0.25 0.14 0.42 0.85 0.17 0.31]
Recall on validation set: [0.56 0.38 0.21 0.83 0.38 0.69 0.5  0.92]
F1-score on validation set: [0.32 0.45 0.23 0.24 0.4  0.76 0.26 0.46]
ROC AUC on validation set: {'AK': 0.75, 'BCC': 0.89, 'BKL': 0.62, 'DF': 0.73, 'MEL': 0.52, 'NV': 0.21, 'SCC': 0.75, 'VASC': 0.33}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            24            6  ...            5             1
true class BCC           30           64  ...           25             7
true class BKL           21           14  ...           14             3
true class DF             0            1  ...            1             0
true class MEL           20           15  ...           21             2
true class NV             9           15  ...           11            14
true class SCC            4            4  ...           16             0
true class VASC           0            1  ...            0            12

[8 rows x 8 columns]

Current validation loss: 1.217

Epoch 98:
Mean loss 1.1411556704939352 - Correctly labeled training images 55.13%
Classified 54.57 % of validation images correctly.
Precision on validation set: [0.19 0.55 0.27 0.25 0.43 0.88 0.19 0.36]
Recall on validation set: [0.51 0.37 0.34 0.67 0.41 0.67 0.59 1.  ]
F1-score on validation set: [0.28 0.44 0.3  0.36 0.42 0.76 0.28 0.53]
ROC AUC on validation set: {'AK': 0.75, 'BCC': 0.9, 'BKL': 0.61, 'DF': 0.68, 'MEL': 0.51, 'NV': 0.22, 'SCC': 0.72, 'VASC': 0.29}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            22            6  ...            5             1
true class BCC           34           62  ...           35             4
true class BKL           19           11  ...           12             3
true class DF             0            2  ...            1             0
true class MEL           17           11  ...           19             3
true class NV            15           19  ...           11            12
true class SCC            6            2  ...           19             0
true class VASC           0            0  ...            0            13

/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
[8 rows x 8 columns]

Current validation loss: 1.208

Epoch 99:
Mean loss 1.1298778783823789 - Correctly labeled training images 55.95%
Classified 53.47 % of validation images correctly.
Precision on validation set: [0.21 0.54 0.25 0.16 0.44 0.86 0.17 0.26]
Recall on validation set: [0.63 0.41 0.25 0.67 0.4  0.66 0.47 0.92]
F1-score on validation set: [0.32 0.46 0.25 0.26 0.42 0.75 0.25 0.4 ]
ROC AUC on validation set: {'AK': 0.74, 'BCC': 0.89, 'BKL': 0.61, 'DF': 0.7, 'MEL': 0.51, 'NV': 0.22, 'SCC': 0.73, 'VASC': 0.24}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            27            5  ...            4             1
true class BCC           38           68  ...           28             8
true class BKL           22            9  ...           12             3
true class DF             0            1  ...            1             0
true class MEL           19           16  ...           16             5
true class NV            14           23  ...           11            18
true class SCC            6            5  ...           15             0
true class VASC           0            0  ...            0            12

[8 rows x 8 columns]

Current validation loss: 1.251

Epoch 100:
Mean loss 1.117200421375055 - Correctly labeled training images 56.02%
Classified 55.91 % of validation images correctly.
Precision on validation set: [0.2  0.52 0.27 0.16 0.47 0.85 0.19 0.36]
Recall on validation set: [0.4  0.41 0.32 0.67 0.4  0.71 0.47 1.  ]
F1-score on validation set: [0.27 0.46 0.29 0.26 0.43 0.77 0.27 0.53]
ROC AUC on validation set: {'AK': 0.76, 'BCC': 0.9, 'BKL': 0.63, 'DF': 0.6, 'MEL': 0.51, 'NV': 0.22, 'SCC': 0.72, 'VASC': 0.17}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            17            8  ...            6             0
true class BCC           27           69  ...           29             5
true class BKL           16           10  ...           10             3
true class DF             0            1  ...            1             0
true class MEL           12           23  ...           15             3
true class NV             8           14  ...            5            12
true class SCC            4            7  ...           15             0
true class VASC           0            0  ...            0            13

[8 rows x 8 columns]

Current validation loss: 1.159

Epoch 101:
Mean loss 1.1100290822869971 - Correctly labeled training images 55.59%
Classified 56.78 % of validation images correctly.
Precision on validation set: [0.22 0.57 0.25 0.16 0.44 0.85 0.25 0.41]
Recall on validation set: [0.53 0.43 0.27 0.67 0.39 0.72 0.5  1.  ]
F1-score on validation set: [0.31 0.49 0.26 0.25 0.42 0.78 0.33 0.58]
ROC AUC on validation set: {'AK': 0.76, 'BCC': 0.91, 'BKL': 0.63, 'DF': 0.67, 'MEL': 0.5, 'NV': 0.21, 'SCC': 0.72, 'VASC': 0.24}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            23            7  ...            4             1
true class BCC           35           71  ...           23             4
true class BKL           16           13  ...            9             4
true class DF             0            2  ...            1             0
true class MEL           18           16  ...            9             2
true class NV             7           14  ...            3             8
true class SCC            6            2  ...           16             0
true class VASC           0            0  ...            0            13

[8 rows x 8 columns]

Current validation loss: 1.135

Epoch 102:
Mean loss 1.10534113979302 - Correctly labeled training images 56.14%
Classified 54.89 % of validation images correctly.
Precision on validation set: [0.23 0.55 0.26 0.13 0.45 0.86 0.21 0.36]
Recall on validation set: [0.56 0.46 0.27 0.67 0.4  0.67 0.56 1.  ]
F1-score on validation set: [0.32 0.5  0.26 0.22 0.43 0.75 0.31 0.53]
ROC AUC on validation set: {'AK': 0.74, 'BCC': 0.91, 'BKL': 0.62, 'DF': 0.64, 'MEL': 0.49, 'NV': 0.23, 'SCC': 0.71, 'VASC': 0.24}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            24            4  ...            7             1
true class BCC           31           77  ...           28             5
true class BKL           18           14  ...           13             3
true class DF             0            2  ...            1             0
true class MEL           18           17  ...           14             2
true class NV            10           23  ...            5            12
true class SCC            5            3  ...           18             0
true class VASC           0            0  ...            0            13

[8 rows x 8 columns]

Current validation loss: 1.196

Epoch 103:
Mean loss 1.107521596203091 - Correctly labeled training images 55.79%
Classified 54.65 % of validation images correctly.
Precision on validation set: [0.2  0.55 0.23 0.14 0.44 0.86 0.21 0.4 ]
Recall on validation set: [0.47 0.34 0.27 0.67 0.45 0.69 0.47 0.92]
F1-score on validation set: [0.28 0.42 0.25 0.23 0.45 0.76 0.29 0.56]
ROC AUC on validation set: {'AK': 0.76, 'BCC': 0.9, 'BKL': 0.62, 'DF': 0.69, 'MEL': 0.51, 'NV': 0.21, 'SCC': 0.76, 'VASC': 0.3}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            20            6  ...            3             0
true class BCC           34           56  ...           31             5
true class BKL           16           13  ...            8             4
true class DF             0            1  ...            1             0
true class MEL           17           10  ...           11             0
true class NV             9           11  ...            2             9
true class SCC            6            3  ...           15             0
true class VASC           0            1  ...            0            12

[8 rows x 8 columns]

Current validation loss: 1.166

Epoch 104:
Mean loss 1.1003367332535963 - Correctly labeled training images 56.01%
Classified 54.89 % of validation images correctly.
Precision on validation set: [0.19 0.59 0.26 0.14 0.47 0.85 0.17 0.45]
Recall on validation set: [0.53 0.31 0.31 0.58 0.38 0.71 0.53 1.  ]
F1-score on validation set: [0.28 0.4  0.28 0.22 0.42 0.77 0.26 0.62]
ROC AUC on validation set: {'AK': 0.75, 'BCC': 0.91, 'BKL': 0.63, 'DF': 0.61, 'MEL': 0.52, 'NV': 0.2, 'SCC': 0.74, 'VASC': 0.33}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            23            4  ...            5             0
true class BCC           38           51  ...           39             3
true class BKL           20            8  ...           14             2
true class DF             0            1  ...            2             0
true class MEL           18           11  ...           14             2
true class NV            16           10  ...            7             9
true class SCC            6            1  ...           17             0
true class VASC           0            0  ...            0            13

[8 rows x 8 columns]

Current validation loss: 1.158

Epoch 105:
Mean loss 1.0769976998447244 - Correctly labeled training images 56.66%
Classified 55.13 % of validation images correctly.
Precision on validation set: [0.21 0.61 0.22 0.18 0.43 0.86 0.27 0.34]
Recall on validation set: [0.65 0.44 0.24 0.67 0.42 0.67 0.53 0.92]
F1-score on validation set: [0.32 0.51 0.23 0.29 0.43 0.75 0.35 0.5 ]
ROC AUC on validation set: {'AK': 0.74, 'BCC': 0.9, 'BKL': 0.63, 'DF': 0.58, 'MEL': 0.51, 'NV': 0.22, 'SCC': 0.72, 'VASC': 0.33}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            28            4  ...            5             1
true class BCC           39           73  ...           17             4
true class BKL           22            9  ...           12             4
true class DF             0            1  ...            1             0
true class MEL           23           15  ...            8             5
true class NV            13           14  ...            4             9
true class SCC            6            4  ...           17             0
true class VASC           0            0  ...            0            12

/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
[8 rows x 8 columns]

Current validation loss: 1.175

Epoch 106:
Mean loss 1.0607796884391587 - Correctly labeled training images 57.44%
Classified 56.70 % of validation images correctly.
Precision on validation set: [0.21 0.55 0.27 0.16 0.46 0.84 0.3  0.5 ]
Recall on validation set: [0.56 0.5  0.32 0.67 0.38 0.7  0.5  0.85]
F1-score on validation set: [0.3  0.52 0.29 0.26 0.42 0.76 0.37 0.63]
ROC AUC on validation set: {'AK': 0.72, 'BCC': 0.91, 'BKL': 0.61, 'DF': 0.56, 'MEL': 0.5, 'NV': 0.22, 'SCC': 0.75, 'VASC': 0.39}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            24            8  ...            2             0
true class BCC           35           83  ...           16             2
true class BKL           20           14  ...            6             1
true class DF             0            1  ...            1             0
true class MEL           20           14  ...           11             2
true class NV            13           25  ...            2             6
true class SCC            5            5  ...           16             0
true class VASC           0            1  ...            0            11

[8 rows x 8 columns]

Current validation loss: 1.148

Epoch 107:
Mean loss 1.0377613243996533 - Correctly labeled training images 57.31%
Classified 54.97 % of validation images correctly.
Precision on validation set: [0.21 0.6  0.28 0.16 0.43 0.87 0.24 0.39]
Recall on validation set: [0.58 0.38 0.35 0.67 0.44 0.66 0.56 1.  ]
F1-score on validation set: [0.31 0.46 0.31 0.25 0.43 0.75 0.34 0.57]
ROC AUC on validation set: {'AK': 0.7, 'BCC': 0.9, 'BKL': 0.61, 'DF': 0.61, 'MEL': 0.49, 'NV': 0.24, 'SCC': 0.73, 'VASC': 0.33}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            25            3  ...            4             1
true class BCC           39           63  ...           26             4
true class BKL           20            5  ...           12             3
true class DF             0            1  ...            1             0
true class MEL           18           13  ...           11             3
true class NV            12           18  ...            2             9
true class SCC            5            2  ...           18             0
true class VASC           0            0  ...            0            13

[8 rows x 8 columns]

Current validation loss: 1.169

Epoch 108:
Mean loss 1.0565101265061165 - Correctly labeled training images 57.11%
Classified 53.79 % of validation images correctly.
Precision on validation set: [0.25 0.54 0.26 0.15 0.42 0.88 0.24 0.35]
Recall on validation set: [0.6  0.47 0.34 0.67 0.44 0.62 0.59 0.85]
F1-score on validation set: [0.35 0.5  0.29 0.25 0.43 0.73 0.34 0.5 ]
ROC AUC on validation set: {'AK': 0.73, 'BCC': 0.89, 'BKL': 0.6, 'DF': 0.53, 'MEL': 0.49, 'NV': 0.24, 'SCC': 0.72, 'VASC': 0.33}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            26            6  ...            3             1
true class BCC           27           78  ...           25             3
true class BKL           18           11  ...           11             2
true class DF             0            1  ...            1             0
true class MEL           18           17  ...           12             4
true class NV            11           29  ...            8            10
true class SCC            6            2  ...           19             0
true class VASC           0            1  ...            0            11

[8 rows x 8 columns]

Current validation loss: 1.233

Epoch 109:
Mean loss 1.0568348449487415 - Correctly labeled training images 57.20%
Classified 54.34 % of validation images correctly.
Precision on validation set: [0.21 0.61 0.24 0.17 0.48 0.87 0.21 0.39]
Recall on validation set: [0.56 0.46 0.37 0.75 0.38 0.64 0.53 1.  ]
F1-score on validation set: [0.31 0.52 0.29 0.28 0.43 0.74 0.3  0.57]
ROC AUC on validation set: {'AK': 0.69, 'BCC': 0.9, 'BKL': 0.59, 'DF': 0.6, 'MEL': 0.52, 'NV': 0.23, 'SCC': 0.71, 'VASC': 0.26}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            24            4  ...            3             0
true class BCC           34           76  ...           27             2
true class BKL           17           11  ...           11             3
true class DF             0            0  ...            1             0
true class MEL           16           15  ...           15             4
true class NV            16           16  ...            6            11
true class SCC            7            3  ...           17             0
true class VASC           0            0  ...            0            13

[8 rows x 8 columns]

Current validation loss: 1.227

Epoch 110:
Mean loss 1.0448850550298059 - Correctly labeled training images 57.29%
Classified 55.28 % of validation images correctly.
Precision on validation set: [0.22 0.54 0.29 0.19 0.44 0.87 0.25 0.36]
Recall on validation set: [0.65 0.52 0.4  0.58 0.41 0.64 0.38 1.  ]
F1-score on validation set: [0.33 0.53 0.33 0.29 0.42 0.74 0.3  0.53]
ROC AUC on validation set: {'AK': 0.74, 'BCC': 0.9, 'BKL': 0.61, 'DF': 0.63, 'MEL': 0.51, 'NV': 0.22, 'SCC': 0.76, 'VASC': 0.29}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            28            8  ...            1             0
true class BCC           34           87  ...           14             5
true class BKL           19           14  ...            7             2
true class DF             0            1  ...            1             0
true class MEL           21           25  ...            6             3
true class NV            15           19  ...            7            13
true class SCC            8            7  ...           12             0
true class VASC           0            0  ...            0            13

[8 rows x 8 columns]

Current validation loss: 1.188

Epoch 111:
Mean loss 1.0412768353987192 - Correctly labeled training images 57.64%
Classified 56.86 % of validation images correctly.
Precision on validation set: [0.27 0.63 0.25 0.17 0.42 0.84 0.28 0.37]
Recall on validation set: [0.53 0.49 0.3  0.75 0.43 0.69 0.44 1.  ]
F1-score on validation set: [0.36 0.55 0.27 0.28 0.43 0.76 0.34 0.54]
ROC AUC on validation set: {'AK': 0.76, 'BCC': 0.91, 'BKL': 0.61, 'DF': 0.5, 'MEL': 0.51, 'NV': 0.22, 'SCC': 0.75, 'VASC': 0.29}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            23            5  ...            3             1
true class BCC           17           81  ...           12             3
true class BKL           15           11  ...            8             2
true class DF             0            0  ...            1             0
true class MEL           18           11  ...           10             4
true class NV             8           16  ...            2            12
true class SCC            5            4  ...           14             0
true class VASC           0            0  ...            0            13

[8 rows x 8 columns]

Current validation loss: 1.115

Epoch 112:
Mean loss 1.0211623367450966 - Correctly labeled training images 57.77%
Classified 55.52 % of validation images correctly.
Precision on validation set: [0.23 0.57 0.25 0.2  0.43 0.88 0.35 0.46]
Recall on validation set: [0.53 0.46 0.42 0.67 0.44 0.64 0.5  0.92]
F1-score on validation set: [0.33 0.5  0.31 0.31 0.43 0.74 0.41 0.62]
ROC AUC on validation set: {'AK': 0.73, 'BCC': 0.9, 'BKL': 0.59, 'DF': 0.63, 'MEL': 0.49, 'NV': 0.24, 'SCC': 0.75, 'VASC': 0.37}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            23            7  ...            2             0
true class BCC           28           76  ...           15             2
true class BKL           15           13  ...            4             2
true class DF             0            1  ...            1             0
true class MEL           18           15  ...            4             2
true class NV             8           17  ...            4             8
true class SCC            6            5  ...           16             0
true class VASC           0            0  ...            0            12

[8 rows x 8 columns]

Current validation loss: 1.144

Epoch 113:
Mean loss 1.0042860745349518 - Correctly labeled training images 57.62%
Classified 56.78 % of validation images correctly.
Precision on validation set: [0.24 0.54 0.27 0.23 0.48 0.82 0.24 0.36]
Recall on validation set: [0.58 0.44 0.34 0.75 0.34 0.72 0.56 0.77]
F1-score on validation set: [0.34 0.49 0.3  0.35 0.39 0.77 0.34 0.49]
ROC AUC on validation set: {'AK': 0.75, 'BCC': 0.9, 'BKL': 0.62, 'DF': 0.63, 'MEL': 0.51, 'NV': 0.21, 'SCC': 0.72, 'VASC': 0.44}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            25            9  ...            4             1
true class BCC           24           74  ...           25             3
true class BKL           17           15  ...            9             2
true class DF             0            0  ...            1             0
true class MEL           21           14  ...           12             3
true class NV            10           20  ...            6             9
true class SCC            6            4  ...           18             0
true class VASC           0            0  ...            0            10

[8 rows x 8 columns]

Current validation loss: 1.126

Epoch 114:
Mean loss 1.0119822839457153 - Correctly labeled training images 57.64%
Classified 54.81 % of validation images correctly.
Precision on validation set: [0.24 0.64 0.24 0.18 0.43 0.87 0.22 0.46]
Recall on validation set: [0.6  0.45 0.38 0.58 0.42 0.64 0.5  0.85]
F1-score on validation set: [0.34 0.53 0.3  0.27 0.42 0.74 0.31 0.59]
ROC AUC on validation set: {'AK': 0.73, 'BCC': 0.92, 'BKL': 0.6, 'DF': 0.62, 'MEL': 0.5, 'NV': 0.22, 'SCC': 0.72, 'VASC': 0.44}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            26            6  ...            3             1
true class BCC           29           75  ...           23             1
true class BKL           15            9  ...           14             1
true class DF             2            1  ...            1             0
true class MEL           18           13  ...           12             3
true class NV            13           12  ...            3             6
true class SCC            6            2  ...           16             1
true class VASC           0            0  ...            0            11

[8 rows x 8 columns]

Current validation loss: 1.158

Epoch 115:
Mean loss 0.9879211331203532 - Correctly labeled training images 58.46%
Classified 57.73 % of validation images correctly.
Precision on validation set: [0.24 0.59 0.3  0.24 0.45 0.85 0.25 0.32]
Recall on validation set: [0.63 0.51 0.36 0.67 0.42 0.69 0.41 0.92]
F1-score on validation set: [0.35 0.55 0.33 0.36 0.44 0.76 0.31 0.48]
ROC AUC on validation set: {'AK': 0.73, 'BCC': 0.92, 'BKL': 0.59, 'DF': 0.6, 'MEL': 0.5, 'NV': 0.22, 'SCC': 0.75, 'VASC': 0.29}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            27            5  ...            3             1
true class BCC           27           86  ...           17             2
true class BKL           14           12  ...            8             2
true class DF             0            0  ...            2             1
true class MEL           22           19  ...            7             4
true class NV            16           17  ...            3            15
true class SCC            5            7  ...           13             0
true class VASC           0            1  ...            0            12

[8 rows x 8 columns]

Current validation loss: 1.123

Epoch 116:
Mean loss 1.0064247119407925 - Correctly labeled training images 58.33%
Classified 55.28 % of validation images correctly.
Precision on validation set: [0.23 0.53 0.24 0.21 0.44 0.86 0.19 0.32]
Recall on validation set: [0.51 0.52 0.27 0.58 0.42 0.66 0.47 0.92]
F1-score on validation set: [0.32 0.52 0.26 0.31 0.43 0.75 0.27 0.48]
ROC AUC on validation set: {'AK': 0.73, 'BCC': 0.91, 'BKL': 0.61, 'DF': 0.62, 'MEL': 0.51, 'NV': 0.21, 'SCC': 0.76, 'VASC': 0.29}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            22           10  ...            4             1
true class BCC           21           87  ...           21             6
true class BKL           16           16  ...            9             3
true class DF             1            1  ...            1             0
true class MEL           19           19  ...           16             4
true class NV            12           23  ...           12            11
true class SCC            5            9  ...           15             0
true class VASC           0            0  ...            0            12

[8 rows x 8 columns]

Current validation loss: 1.162

Epoch 117:
Mean loss 1.0002998553616016 - Correctly labeled training images 58.21%
Classified 53.63 % of validation images correctly.
Precision on validation set: [0.27 0.58 0.27 0.2  0.43 0.9  0.19 0.36]
Recall on validation set: [0.53 0.43 0.37 0.67 0.46 0.6  0.72 1.  ]
F1-score on validation set: [0.36 0.49 0.31 0.31 0.44 0.72 0.3  0.53]
ROC AUC on validation set: {'AK': 0.72, 'BCC': 0.91, 'BKL': 0.6, 'DF': 0.48, 'MEL': 0.51, 'NV': 0.23, 'SCC': 0.68, 'VASC': 0.27}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            23            4  ...            8             1
true class BCC           21           72  ...           42             5
true class BKL           15           11  ...           15             1
true class DF             0            1  ...            1             1
true class MEL           14           16  ...           20             4
true class NV            10           19  ...           14            11
true class SCC            3            1  ...           23             0
true class VASC           0            0  ...            0            13

[8 rows x 8 columns]

Current validation loss: 1.213

Epoch 118:
Mean loss 0.9631084499863044 - Correctly labeled training images 58.43%
Classified 56.07 % of validation images correctly.
Precision on validation set: [0.26 0.68 0.27 0.14 0.45 0.86 0.22 0.39]
Recall on validation set: [0.51 0.47 0.39 0.67 0.39 0.67 0.62 0.85]
F1-score on validation set: [0.34 0.55 0.32 0.23 0.42 0.75 0.33 0.54]
ROC AUC on validation set: {'AK': 0.74, 'BCC': 0.91, 'BKL': 0.6, 'DF': 0.61, 'MEL': 0.49, 'NV': 0.22, 'SCC': 0.71, 'VASC': 0.44}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            22            4  ...            7             0
true class BCC           16           78  ...           29             4
true class BKL           16           10  ...           11             2
true class DF             0            2  ...            1             0
true class MEL           15           10  ...           11             2
true class NV            12            8  ...           10             9
true class SCC            4            3  ...           20             0
true class VASC           0            0  ...            0            11

[8 rows x 8 columns]

Current validation loss: 1.163

Epoch 119:
Mean loss 0.970114353092311 - Correctly labeled training images 58.50%
Classified 57.33 % of validation images correctly.
Precision on validation set: [0.24 0.64 0.28 0.17 0.49 0.84 0.25 0.31]
Recall on validation set: [0.63 0.49 0.37 0.58 0.36 0.7  0.5  1.  ]
F1-score on validation set: [0.35 0.56 0.32 0.26 0.42 0.76 0.33 0.47]
ROC AUC on validation set: {'AK': 0.74, 'BCC': 0.92, 'BKL': 0.6, 'DF': 0.62, 'MEL': 0.52, 'NV': 0.21, 'SCC': 0.74, 'VASC': 0.27}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            27            5  ...            4             0
true class BCC           26           82  ...           22             5
true class BKL           15           11  ...            8             3
true class DF             1            1  ...            1             0
true class MEL           21           14  ...            9             4
true class NV            14           11  ...            4            17
true class SCC            8            4  ...           16             0
true class VASC           0            0  ...            0            13

/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
[8 rows x 8 columns]

Current validation loss: 1.148

Epoch 120:
Mean loss 0.95285281750494 - Correctly labeled training images 59.20%
Classified 56.94 % of validation images correctly.
Precision on validation set: [0.23 0.59 0.27 0.22 0.47 0.85 0.32 0.36]
Recall on validation set: [0.6  0.52 0.37 0.67 0.38 0.68 0.59 0.92]
F1-score on validation set: [0.33 0.55 0.31 0.33 0.42 0.75 0.41 0.52]
ROC AUC on validation set: {'AK': 0.7, 'BCC': 0.92, 'BKL': 0.61, 'DF': 0.62, 'MEL': 0.51, 'NV': 0.21, 'SCC': 0.7, 'VASC': 0.4}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            26            7  ...            2             0
true class BCC           26           87  ...           22             4
true class BKL           20           15  ...            5             1
true class DF             0            2  ...            1             0
true class MEL           25           17  ...            4             3
true class NV            12           15  ...            7            13
true class SCC            6            4  ...           19             0
true class VASC           0            0  ...            0            12

[8 rows x 8 columns]

Current validation loss: 1.113

Epoch 121:
Mean loss 0.9485329374059893 - Correctly labeled training images 58.96%
Classified 56.62 % of validation images correctly.
Precision on validation set: [0.24 0.56 0.28 0.26 0.44 0.84 0.19 0.4 ]
Recall on validation set: [0.58 0.43 0.27 0.58 0.42 0.7  0.56 0.92]
F1-score on validation set: [0.34 0.49 0.28 0.36 0.43 0.77 0.28 0.56]
ROC AUC on validation set: {'AK': 0.7, 'BCC': 0.91, 'BKL': 0.59, 'DF': 0.61, 'MEL': 0.5, 'NV': 0.24, 'SCC': 0.7, 'VASC': 0.38}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            25            6  ...            6             0
true class BCC           20           72  ...           32             3
true class BKL           18           12  ...           14             2
true class DF             0            1  ...            2             1
true class MEL           22           15  ...           15             3
true class NV            14           19  ...            8             9
true class SCC            7            3  ...           18             0
true class VASC           0            1  ...            0            12

[8 rows x 8 columns]

Current validation loss: 1.106

Epoch 122:
Mean loss 0.9430726995979574 - Correctly labeled training images 59.45%
Classified 57.57 % of validation images correctly.
Precision on validation set: [0.28 0.62 0.26 0.24 0.47 0.84 0.26 0.71]
Recall on validation set: [0.67 0.38 0.4  0.67 0.4  0.71 0.62 0.77]
F1-score on validation set: [0.39 0.47 0.32 0.36 0.43 0.77 0.36 0.74]
ROC AUC on validation set: {'AK': 0.71, 'BCC': 0.92, 'BKL': 0.59, 'DF': 0.57, 'MEL': 0.5, 'NV': 0.22, 'SCC': 0.7, 'VASC': 0.48}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            29            3  ...            2             0
true class BCC           26           64  ...           31             1
true class BKL           16            9  ...           10             0
true class DF             0            1  ...            2             0
true class MEL           17           12  ...           11             0
true class NV            11           11  ...            2             3
true class SCC            6            2  ...           20             0
true class VASC           0            1  ...            0            10

[8 rows x 8 columns]

Current validation loss: 1.091

Epoch 123:
Mean loss 0.9440550382016961 - Correctly labeled training images 59.35%
Classified 56.07 % of validation images correctly.
Precision on validation set: [0.22 0.5  0.29 0.32 0.45 0.86 0.22 0.57]
Recall on validation set: [0.6  0.4  0.38 0.58 0.4  0.68 0.59 0.92]
F1-score on validation set: [0.32 0.45 0.33 0.41 0.42 0.76 0.32 0.71]
ROC AUC on validation set: {'AK': 0.72, 'BCC': 0.9, 'BKL': 0.6, 'DF': 0.6, 'MEL': 0.5, 'NV': 0.23, 'SCC': 0.68, 'VASC': 0.43}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            26            5  ...            4             0
true class BCC           34           67  ...           28             2
true class BKL           19           12  ...           10             0
true class DF             0            2  ...            2             0
true class MEL           19           21  ...           17             2
true class NV            15           21  ...            5             5
true class SCC            7            4  ...           19             0
true class VASC           0            1  ...            0            12

[8 rows x 8 columns]

Current validation loss: 1.123

Epoch 124:
Mean loss 0.9428959875264754 - Correctly labeled training images 59.67%
Classified 59.86 % of validation images correctly.
Precision on validation set: [0.3  0.63 0.27 0.21 0.49 0.84 0.24 0.52]
Recall on validation set: [0.58 0.54 0.34 0.67 0.42 0.73 0.47 0.92]
F1-score on validation set: [0.4  0.58 0.3  0.32 0.45 0.78 0.32 0.67]
ROC AUC on validation set: {'AK': 0.75, 'BCC': 0.92, 'BKL': 0.61, 'DF': 0.59, 'MEL': 0.49, 'NV': 0.23, 'SCC': 0.73, 'VASC': 0.35}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            25            4  ...            4             0
true class BCC           16           91  ...           18             2
true class BKL           12           17  ...            9             2
true class DF             0            2  ...            1             0
true class MEL           16           13  ...           12             0
true class NV             8           14  ...            4             7
true class SCC            6            4  ...           15             0
true class VASC           0            0  ...            0            12

[8 rows x 8 columns]

Current validation loss: 1.057

Epoch 125:
Mean loss 0.9256771209206115 - Correctly labeled training images 59.31%
Classified 57.49 % of validation images correctly.
Precision on validation set: [0.27 0.62 0.26 0.2  0.47 0.84 0.25 0.48]
Recall on validation set: [0.65 0.47 0.36 0.75 0.37 0.7  0.59 0.85]
F1-score on validation set: [0.38 0.53 0.3  0.32 0.41 0.77 0.36 0.61]
ROC AUC on validation set: {'AK': 0.7, 'BCC': 0.92, 'BKL': 0.62, 'DF': 0.51, 'MEL': 0.5, 'NV': 0.23, 'SCC': 0.68, 'VASC': 0.34}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            28            1  ...            6             1
true class BCC           26           78  ...           22             2
true class BKL           15           13  ...           11             1
true class DF             0            1  ...            1             0
true class MEL           18           15  ...           11             2
true class NV            13           15  ...            5             6
true class SCC            5            3  ...           19             0
true class VASC           0            0  ...            0            11

[8 rows x 8 columns]

Current validation loss: 1.108

Epoch 126:
Mean loss 0.9197757418035333 - Correctly labeled training images 60.35%
Classified 57.89 % of validation images correctly.
Precision on validation set: [0.23 0.63 0.28 0.23 0.48 0.82 0.3  0.36]
Recall on validation set: [0.63 0.43 0.37 0.5  0.39 0.72 0.59 0.92]
F1-score on validation set: [0.34 0.51 0.32 0.32 0.43 0.77 0.4  0.52]
ROC AUC on validation set: {'AK': 0.72, 'BCC': 0.92, 'BKL': 0.62, 'DF': 0.6, 'MEL': 0.5, 'NV': 0.21, 'SCC': 0.73, 'VASC': 0.33}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            27            4  ...            4             0
true class BCC           29           71  ...           18             5
true class BKL           18            6  ...           11             3
true class DF             1            2  ...            1             0
true class MEL           19           13  ...            9             3
true class NV            14           13  ...            1            10
true class SCC            7            3  ...           19             0
true class VASC           0            0  ...            0            12

/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
[8 rows x 8 columns]

Current validation loss: 1.075

Epoch 127:
Mean loss 0.9262419021938125 - Correctly labeled training images 60.11%
Classified 58.60 % of validation images correctly.
Precision on validation set: [0.28 0.62 0.28 0.18 0.47 0.85 0.32 0.39]
Recall on validation set: [0.63 0.55 0.37 0.58 0.45 0.68 0.56 0.92]
F1-score on validation set: [0.39 0.58 0.32 0.28 0.46 0.76 0.4  0.55]
ROC AUC on validation set: {'AK': 0.73, 'BCC': 0.92, 'BKL': 0.61, 'DF': 0.54, 'MEL': 0.5, 'NV': 0.22, 'SCC': 0.75, 'VASC': 0.28}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            27            5  ...            3             1
true class BCC           16           92  ...           14             3
true class BKL           19           14  ...            7             1
true class DF             0            2  ...            1             0
true class MEL           16           12  ...           12             1
true class NV            12           18  ...            2            13
true class SCC            6            5  ...           18             0
true class VASC           0            0  ...            0            12

[8 rows x 8 columns]

Current validation loss: 1.101

Epoch 128:
Mean loss 0.9073448921039653 - Correctly labeled training images 59.86%
Classified 58.60 % of validation images correctly.
Precision on validation set: [0.26 0.56 0.27 0.26 0.46 0.84 0.42 0.34]
Recall on validation set: [0.6  0.54 0.33 0.58 0.4  0.71 0.59 0.92]
F1-score on validation set: [0.36 0.55 0.29 0.36 0.43 0.77 0.49 0.5 ]
ROC AUC on validation set: {'AK': 0.72, 'BCC': 0.92, 'BKL': 0.62, 'DF': 0.67, 'MEL': 0.5, 'NV': 0.21, 'SCC': 0.72, 'VASC': 0.31}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            26            6  ...            2             1
true class BCC           24           90  ...           11             4
true class BKL           17           21  ...            5             1
true class DF             0            3  ...            0             0
true class MEL           15           21  ...            7             5
true class NV            12           17  ...            1            12
true class SCC            6            4  ...           19             0
true class VASC           0            0  ...            0            12

[8 rows x 8 columns]

Current validation loss: 1.087

Epoch 129:
Mean loss 0.904736536839971 - Correctly labeled training images 60.26%
Classified 56.31 % of validation images correctly.
Precision on validation set: [0.23 0.62 0.25 0.2  0.44 0.84 0.3  0.39]
Recall on validation set: [0.67 0.45 0.3  0.67 0.42 0.68 0.44 0.92]
F1-score on validation set: [0.34 0.52 0.27 0.3  0.43 0.76 0.35 0.55]
ROC AUC on validation set: {'AK': 0.71, 'BCC': 0.92, 'BKL': 0.63, 'DF': 0.6, 'MEL': 0.51, 'NV': 0.21, 'SCC': 0.71, 'VASC': 0.29}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            29            3  ...            2             1
true class BCC           34           75  ...           15             2
true class BKL           22           13  ...            8             1
true class DF             0            2  ...            1             0
true class MEL           21           10  ...            6             4
true class NV            11           15  ...            1            11
true class SCC           11            3  ...           14             0
true class VASC           0            0  ...            0            12

[8 rows x 8 columns]

Current validation loss: 1.114

Epoch 130:
Mean loss 0.8771726948323686 - Correctly labeled training images 60.76%
Classified 56.86 % of validation images correctly.
Precision on validation set: [0.23 0.58 0.25 0.24 0.46 0.87 0.31 0.38]
Recall on validation set: [0.56 0.5  0.33 0.58 0.45 0.67 0.66 0.92]
F1-score on validation set: [0.33 0.53 0.28 0.34 0.45 0.75 0.42 0.53]
ROC AUC on validation set: {'AK': 0.69, 'BCC': 0.92, 'BKL': 0.6, 'DF': 0.59, 'MEL': 0.51, 'NV': 0.22, 'SCC': 0.74, 'VASC': 0.33}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            24            4  ...            5             1
true class BCC           27           83  ...           18             3
true class BKL           18           16  ...            7             1
true class DF             0            3  ...            1             0
true class MEL           16           18  ...           10             3
true class NV            13           17  ...            6            12
true class SCC            6            3  ...           21             0
true class VASC           0            0  ...            0            12

[8 rows x 8 columns]

Current validation loss: 1.109

Epoch 131:
Mean loss 0.8905542522950879 - Correctly labeled training images 60.66%
Classified 58.20 % of validation images correctly.
Precision on validation set: [0.24 0.55 0.28 0.24 0.48 0.86 0.38 0.52]
Recall on validation set: [0.6  0.5  0.42 0.67 0.43 0.69 0.47 0.85]
F1-score on validation set: [0.34 0.52 0.34 0.36 0.45 0.76 0.42 0.65]
ROC AUC on validation set: {'AK': 0.71, 'BCC': 0.92, 'BKL': 0.61, 'DF': 0.55, 'MEL': 0.49, 'NV': 0.22, 'SCC': 0.77, 'VASC': 0.49}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            26            6  ...            1             0
true class BCC           34           84  ...           10             0
true class BKL           15           17  ...            4             1
true class DF             0            2  ...            1             0
true class MEL           19           18  ...            5             3
true class NV             7           19  ...            3             6
true class SCC            7            7  ...           15             0
true class VASC           0            1  ...            0            11

[8 rows x 8 columns]

Current validation loss: 1.098

Epoch 132:
Mean loss 0.8852006386883251 - Correctly labeled training images 60.98%
Classified 59.07 % of validation images correctly.
Precision on validation set: [0.28 0.62 0.29 0.19 0.47 0.86 0.32 0.4 ]
Recall on validation set: [0.58 0.55 0.4  0.67 0.45 0.69 0.47 0.92]
F1-score on validation set: [0.38 0.58 0.33 0.3  0.46 0.77 0.38 0.56]
ROC AUC on validation set: {'AK': 0.72, 'BCC': 0.93, 'BKL': 0.62, 'DF': 0.52, 'MEL': 0.49, 'NV': 0.22, 'SCC': 0.75, 'VASC': 0.33}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            25            5  ...            1             0
true class BCC           17           92  ...           13             5
true class BKL           18           11  ...            7             3
true class DF             0            2  ...            1             0
true class MEL           15           17  ...            7             2
true class NV             8           16  ...            3             8
true class SCC            6            5  ...           15             0
true class VASC           0            0  ...            0            12

[8 rows x 8 columns]

Current validation loss: 1.073

Epoch 133:
Mean loss 0.8726839972219257 - Correctly labeled training images 61.00%
Classified 58.99 % of validation images correctly.
Precision on validation set: [0.27 0.61 0.29 0.26 0.45 0.86 0.37 0.36]
Recall on validation set: [0.65 0.51 0.4  0.58 0.44 0.69 0.59 0.92]
F1-score on validation set: [0.38 0.56 0.34 0.36 0.45 0.77 0.45 0.52]
ROC AUC on validation set: {'AK': 0.71, 'BCC': 0.92, 'BKL': 0.61, 'DF': 0.51, 'MEL': 0.49, 'NV': 0.24, 'SCC': 0.72, 'VASC': 0.21}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            28            6  ...            3             0
true class BCC           21           85  ...           14             5
true class BKL           16           12  ...            5             2
true class DF             0            2  ...            2             0
true class MEL           22           14  ...            4             5
true class NV            10           17  ...            5             9
true class SCC            7            3  ...           19             0
true class VASC           0            0  ...            0            12

[8 rows x 8 columns]

Current validation loss: 1.079

Epoch 134:
Mean loss 0.8482294965194603 - Correctly labeled training images 61.85%
Classified 57.81 % of validation images correctly.
Precision on validation set: [0.24 0.57 0.3  0.2  0.46 0.87 0.32 0.48]
Recall on validation set: [0.58 0.51 0.42 0.67 0.41 0.68 0.59 0.92]
F1-score on validation set: [0.34 0.54 0.35 0.31 0.43 0.76 0.41 0.63]
ROC AUC on validation set: {'AK': 0.66, 'BCC': 0.91, 'BKL': 0.6, 'DF': 0.56, 'MEL': 0.51, 'NV': 0.24, 'SCC': 0.67, 'VASC': 0.36}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            25            6  ...            2             1
true class BCC           27           85  ...           17             2
true class BKL           15           12  ...            7             0
true class DF             0            3  ...            0             0
true class MEL           15           19  ...           12             4
true class NV            15           20  ...            3             6
true class SCC            7            4  ...           19             0
true class VASC           0            0  ...            0            12

[8 rows x 8 columns]

Current validation loss: 1.111

Epoch 135:
Mean loss 0.8467232916821441 - Correctly labeled training images 62.11%
Classified 59.15 % of validation images correctly.
Precision on validation set: [0.27 0.62 0.28 0.3  0.46 0.86 0.32 0.46]
Recall on validation set: [0.72 0.53 0.37 0.58 0.46 0.68 0.56 0.92]
F1-score on validation set: [0.4  0.57 0.32 0.4  0.46 0.76 0.41 0.62]
ROC AUC on validation set: {'AK': 0.69, 'BCC': 0.92, 'BKL': 0.6, 'DF': 0.64, 'MEL': 0.49, 'NV': 0.23, 'SCC': 0.71, 'VASC': 0.35}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            31            4  ...            2             0
true class BCC           29           89  ...           19             2
true class BKL           18           11  ...            6             2
true class DF             0            3  ...            1             0
true class MEL           17           15  ...            8             0
true class NV            11           18  ...            2             9
true class SCC            7            3  ...           18             1
true class VASC           0            0  ...            0            12

[8 rows x 8 columns]

Current validation loss: 1.096

Epoch 136:
Mean loss 0.84339523931219 - Correctly labeled training images 61.52%
Classified 60.49 % of validation images correctly.
Precision on validation set: [0.3  0.63 0.28 0.22 0.51 0.84 0.41 0.45]
Recall on validation set: [0.65 0.59 0.4  0.67 0.37 0.72 0.59 1.  ]
F1-score on validation set: [0.41 0.61 0.33 0.33 0.43 0.78 0.49 0.62]
ROC AUC on validation set: {'AK': 0.69, 'BCC': 0.92, 'BKL': 0.61, 'DF': 0.49, 'MEL': 0.52, 'NV': 0.22, 'SCC': 0.71, 'VASC': 0.22}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            28            6  ...            3             1
true class BCC           18           98  ...           12             2
true class BKL           17           15  ...            4             0
true class DF             0            1  ...            1             1
true class MEL           16           16  ...            5             1
true class NV             8           17  ...            2            10
true class SCC            7            3  ...           19             1
true class VASC           0            0  ...            0            13

[8 rows x 8 columns]

Current validation loss: 1.043

Epoch 137:
Mean loss 0.823261082642462 - Correctly labeled training images 61.96%
Classified 59.62 % of validation images correctly.
Precision on validation set: [0.28 0.65 0.29 0.21 0.47 0.85 0.4  0.48]
Recall on validation set: [0.63 0.56 0.43 0.58 0.42 0.69 0.59 1.  ]
F1-score on validation set: [0.39 0.6  0.34 0.3  0.44 0.76 0.48 0.65]
ROC AUC on validation set: {'AK': 0.7, 'BCC': 0.93, 'BKL': 0.59, 'DF': 0.55, 'MEL': 0.51, 'NV': 0.22, 'SCC': 0.7, 'VASC': 0.37}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            27            5  ...            3             0
true class BCC           21           94  ...           12             1
true class BKL           17           10  ...            5             1
true class DF             0            1  ...            1             1
true class MEL           17           17  ...            5             3
true class NV             7           15  ...            2             8
true class SCC            7            2  ...           19             0
true class VASC           0            0  ...            0            13

[8 rows x 8 columns]

Current validation loss: 1.067

Epoch 138:
Mean loss 0.8213903001900351 - Correctly labeled training images 62.34%
Classified 59.54 % of validation images correctly.
Precision on validation set: [0.28 0.59 0.31 0.25 0.47 0.85 0.34 0.48]
Recall on validation set: [0.6  0.6  0.43 0.67 0.41 0.69 0.56 0.85]
F1-score on validation set: [0.38 0.6  0.36 0.36 0.44 0.76 0.42 0.61]
ROC AUC on validation set: {'AK': 0.68, 'BCC': 0.93, 'BKL': 0.6, 'DF': 0.52, 'MEL': 0.5, 'NV': 0.23, 'SCC': 0.66, 'VASC': 0.44}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            26            5  ...            4             1
true class BCC           19          101  ...           13             2
true class BKL           12           14  ...            6             1
true class DF             0            2  ...            1             0
true class MEL           16           20  ...            7             2
true class NV            12           23  ...            4             6
true class SCC            8            3  ...           18             0
true class VASC           0            2  ...            0            11

[8 rows x 8 columns]

Current validation loss: 1.059

Epoch 139:
Mean loss 0.8054296183003236 - Correctly labeled training images 62.68%
Classified 58.75 % of validation images correctly.
Precision on validation set: [0.32 0.62 0.26 0.18 0.48 0.86 0.29 0.48]
Recall on validation set: [0.63 0.59 0.4  0.58 0.38 0.68 0.62 1.  ]
F1-score on validation set: [0.42 0.61 0.32 0.27 0.42 0.76 0.4  0.65]
ROC AUC on validation set: {'AK': 0.69, 'BCC': 0.92, 'BKL': 0.6, 'DF': 0.51, 'MEL': 0.51, 'NV': 0.23, 'SCC': 0.68, 'VASC': 0.28}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            27            4  ...            3             1
true class BCC           14           99  ...           16             2
true class BKL           15           14  ...           11             0
true class DF             0            2  ...            1             1
true class MEL           16           20  ...           15             2
true class NV             8           18  ...            2             8
true class SCC            5            3  ...           20             0
true class VASC           0            0  ...            0            13

[8 rows x 8 columns]

Current validation loss: 1.104

Epoch 140:
Mean loss 0.8112130736232932 - Correctly labeled training images 62.38%
Classified 59.38 % of validation images correctly.
Precision on validation set: [0.3  0.64 0.29 0.21 0.48 0.83 0.38 0.58]
Recall on validation set: [0.6  0.5  0.47 0.67 0.38 0.71 0.62 0.85]
F1-score on validation set: [0.4  0.56 0.36 0.32 0.42 0.77 0.47 0.69]
ROC AUC on validation set: {'AK': 0.73, 'BCC': 0.93, 'BKL': 0.6, 'DF': 0.6, 'MEL': 0.51, 'NV': 0.21, 'SCC': 0.72, 'VASC': 0.43}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            26            5  ...            2             0
true class BCC           21           83  ...           13             1
true class BKL           10           10  ...            5             1
true class DF             0            2  ...            1             0
true class MEL           16           16  ...            8             1
true class NV            10            9  ...            4             5
true class SCC            5            4  ...           20             0
true class VASC           0            0  ...            0            11

/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
[8 rows x 8 columns]

Current validation loss: 1.046

Epoch 141:
Mean loss 0.803143884434309 - Correctly labeled training images 62.35%
Classified 56.78 % of validation images correctly.
Precision on validation set: [0.25 0.53 0.25 0.27 0.47 0.86 0.26 0.44]
Recall on validation set: [0.65 0.55 0.36 0.5  0.36 0.68 0.59 0.85]
F1-score on validation set: [0.37 0.54 0.3  0.35 0.41 0.76 0.37 0.58]
ROC AUC on validation set: {'AK': 0.68, 'BCC': 0.91, 'BKL': 0.61, 'DF': 0.58, 'MEL': 0.52, 'NV': 0.23, 'SCC': 0.64, 'VASC': 0.22}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            28            6  ...            4             0
true class BCC           26           92  ...           18             4
true class BKL           16           19  ...            7             0
true class DF             2            2  ...            1             0
true class MEL           17           25  ...           14             2
true class NV            13           26  ...            9             8
true class SCC            8            3  ...           19             0
true class VASC           0            0  ...            0            11

[8 rows x 8 columns]

Current validation loss: 1.136

Epoch 142:
Mean loss 0.79228490010515 - Correctly labeled training images 63.26%
Classified 59.78 % of validation images correctly.
Precision on validation set: [0.29 0.63 0.26 0.32 0.49 0.84 0.36 0.61]
Recall on validation set: [0.72 0.53 0.38 0.58 0.38 0.72 0.66 0.85]
F1-score on validation set: [0.41 0.58 0.31 0.41 0.43 0.77 0.47 0.71]
ROC AUC on validation set: {'AK': 0.7, 'BCC': 0.92, 'BKL': 0.6, 'DF': 0.56, 'MEL': 0.5, 'NV': 0.24, 'SCC': 0.67, 'VASC': 0.38}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            31            3  ...            2             0
true class BCC           24           89  ...           17             1
true class BKL           16           14  ...            6             1
true class DF             1            2  ...            1             0
true class MEL           17           15  ...            7             0
true class NV            12           16  ...            4             5
true class SCC            6            2  ...           21             0
true class VASC           0            0  ...            0            11

[8 rows x 8 columns]

Current validation loss: 1.053

Epoch 143:
Mean loss 0.7936976497951742 - Correctly labeled training images 62.96%
Classified 57.57 % of validation images correctly.
Precision on validation set: [0.29 0.58 0.31 0.16 0.44 0.85 0.27 0.33]
Recall on validation set: [0.51 0.58 0.39 0.67 0.38 0.67 0.59 0.92]
F1-score on validation set: [0.37 0.58 0.34 0.26 0.41 0.75 0.37 0.49]
ROC AUC on validation set: {'AK': 0.72, 'BCC': 0.92, 'BKL': 0.62, 'DF': 0.49, 'MEL': 0.51, 'NV': 0.22, 'SCC': 0.68, 'VASC': 0.22}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            22            8  ...            3             0
true class BCC           12           97  ...           20             3
true class BKL           12           16  ...            9             3
true class DF             0            2  ...            1             0
true class MEL           16           18  ...           14             5
true class NV             8           20  ...            5            13
true class SCC            6            5  ...           19             0
true class VASC           0            0  ...            0            12

[8 rows x 8 columns]

Current validation loss: 1.118

Epoch 144:
Mean loss 0.7988358955795081 - Correctly labeled training images 62.43%
Classified 58.36 % of validation images correctly.
Precision on validation set: [0.3  0.57 0.27 0.24 0.5  0.86 0.29 0.48]
Recall on validation set: [0.6  0.62 0.45 0.67 0.38 0.67 0.47 0.85]
F1-score on validation set: [0.4  0.59 0.34 0.36 0.43 0.75 0.36 0.61]
ROC AUC on validation set: {'AK': 0.69, 'BCC': 0.93, 'BKL': 0.6, 'DF': 0.51, 'MEL': 0.51, 'NV': 0.22, 'SCC': 0.68, 'VASC': 0.39}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            26            7  ...            3             0
true class BCC           14          103  ...           14             2
true class BKL           14           19  ...            5             1
true class DF             0            2  ...            1             0
true class MEL           18           22  ...            7             3
true class NV             8           22  ...            6             6
true class SCC            6            6  ...           15             0
true class VASC           0            0  ...            0            11

[8 rows x 8 columns]

Current validation loss: 1.107

Epoch 145:
Mean loss 0.7754007740069639 - Correctly labeled training images 63.51%
Classified 58.75 % of validation images correctly.
Precision on validation set: [0.3  0.56 0.29 0.24 0.5  0.84 0.28 0.5 ]
Recall on validation set: [0.65 0.63 0.4  0.67 0.33 0.69 0.72 0.85]
F1-score on validation set: [0.41 0.6  0.34 0.36 0.4  0.76 0.41 0.63]
ROC AUC on validation set: {'AK': 0.68, 'BCC': 0.91, 'BKL': 0.61, 'DF': 0.52, 'MEL': 0.49, 'NV': 0.24, 'SCC': 0.65, 'VASC': 0.26}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            28            4  ...            7             0
true class BCC           17          106  ...           18             2
true class BKL           14           20  ...           10             1
true class DF             0            2  ...            1             0
true class MEL           19           19  ...           16             2
true class NV            13           32  ...            6             6
true class SCC            3            5  ...           23             0
true class VASC           0            0  ...            0            11

[8 rows x 8 columns]

Current validation loss: 1.113

Epoch 146:
Mean loss 0.7572521183298966 - Correctly labeled training images 63.20%
Classified 59.78 % of validation images correctly.
Precision on validation set: [0.28 0.62 0.27 0.32 0.49 0.84 0.32 0.52]
Recall on validation set: [0.63 0.57 0.41 0.58 0.41 0.71 0.47 0.92]
F1-score on validation set: [0.39 0.59 0.33 0.41 0.45 0.77 0.38 0.67]
ROC AUC on validation set: {'AK': 0.68, 'BCC': 0.93, 'BKL': 0.6, 'DF': 0.62, 'MEL': 0.49, 'NV': 0.23, 'SCC': 0.69, 'VASC': 0.38}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            27            4  ...            4             0
true class BCC           24           96  ...           14             1
true class BKL           13           13  ...            5             1
true class DF             0            2  ...            2             0
true class MEL           18           16  ...            4             0
true class NV             7           21  ...            3             9
true class SCC            7            4  ...           15             0
true class VASC           0            0  ...            0            12

[8 rows x 8 columns]

Current validation loss: 1.047

Epoch 147:
Mean loss 0.7546650016862512 - Correctly labeled training images 63.76%
Classified 58.20 % of validation images correctly.
Precision on validation set: [0.29 0.55 0.26 0.33 0.48 0.85 0.35 0.5 ]
Recall on validation set: [0.77 0.55 0.41 0.58 0.37 0.68 0.5  1.  ]
F1-score on validation set: [0.43 0.55 0.32 0.42 0.42 0.76 0.41 0.67]
ROC AUC on validation set: {'AK': 0.65, 'BCC': 0.92, 'BKL': 0.6, 'DF': 0.59, 'MEL': 0.51, 'NV': 0.23, 'SCC': 0.69, 'VASC': 0.26}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            33            2  ...            1             0
true class BCC           26           92  ...           13             3
true class BKL           19           18  ...            4             0
true class DF             0            4  ...            0             0
true class MEL           15           21  ...            9             3
true class NV            11           25  ...            3             7
true class SCC            8            6  ...           16             0
true class VASC           0            0  ...            0            13

/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
[8 rows x 8 columns]

Current validation loss: 1.086

Epoch 148:
Mean loss 0.7447735995101252 - Correctly labeled training images 64.08%
Classified 59.15 % of validation images correctly.
Precision on validation set: [0.3  0.64 0.28 0.22 0.46 0.86 0.33 0.44]
Recall on validation set: [0.6  0.59 0.44 0.58 0.39 0.69 0.62 0.92]
F1-score on validation set: [0.4  0.61 0.34 0.32 0.42 0.76 0.43 0.6 ]
ROC AUC on validation set: {'AK': 0.68, 'BCC': 0.93, 'BKL': 0.61, 'DF': 0.61, 'MEL': 0.5, 'NV': 0.23, 'SCC': 0.69, 'VASC': 0.35}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            26            4  ...            4             0
true class BCC           15           98  ...           14             3
true class BKL           15           12  ...            8             2
true class DF             0            2  ...            1             1
true class MEL           14           18  ...            8             3
true class NV            12           15  ...            5             6
true class SCC            4            5  ...           20             0
true class VASC           0            0  ...            0            12

[8 rows x 8 columns]

Current validation loss: 1.098

Epoch 149:
Mean loss 0.7465804455220135 - Correctly labeled training images 64.14%
Classified 59.31 % of validation images correctly.
Precision on validation set: [0.26 0.65 0.27 0.25 0.52 0.86 0.32 0.46]
Recall on validation set: [0.53 0.55 0.48 0.5  0.42 0.69 0.56 1.  ]
F1-score on validation set: [0.35 0.6  0.34 0.33 0.46 0.77 0.4  0.63]
ROC AUC on validation set: {'AK': 0.68, 'BCC': 0.92, 'BKL': 0.59, 'DF': 0.56, 'MEL': 0.48, 'NV': 0.25, 'SCC': 0.69, 'VASC': 0.28}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            23            6  ...            3             1
true class BCC           19           92  ...           14             3
true class BKL           13            9  ...           10             2
true class DF             0            2  ...            2             0
true class MEL           14            9  ...            8             3
true class NV            13           18  ...            2             6
true class SCC            6            5  ...           18             0
true class VASC           0            0  ...            0            13

[8 rows x 8 columns]

Current validation loss: 1.085

Epoch 150:
Mean loss 0.7536493279392411 - Correctly labeled training images 63.90%
Classified 56.23 % of validation images correctly.
Precision on validation set: [0.24 0.61 0.27 0.39 0.42 0.87 0.33 0.58]
Recall on validation set: [0.58 0.51 0.46 0.58 0.44 0.63 0.59 0.85]
F1-score on validation set: [0.34 0.56 0.34 0.47 0.43 0.73 0.43 0.69]
ROC AUC on validation set: {'AK': 0.64, 'BCC': 0.92, 'BKL': 0.57, 'DF': 0.61, 'MEL': 0.5, 'NV': 0.25, 'SCC': 0.65, 'VASC': 0.38}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            25            4  ...            3             0
true class BCC           27           86  ...           14             2
true class BKL           17            8  ...            6             2
true class DF             0            2  ...            1             0
true class MEL           17           14  ...           11             1
true class NV            12           23  ...            3             3
true class SCC            8            3  ...           19             0
true class VASC           0            0  ...            0            11

[8 rows x 8 columns]

Current validation loss: 1.101

Epoch 151:
Mean loss 0.7565357712118032 - Correctly labeled training images 64.41%
Classified 57.65 % of validation images correctly.
Precision on validation set: [0.23 0.62 0.3  0.16 0.46 0.85 0.34 0.41]
Recall on validation set: [0.42 0.62 0.47 0.58 0.4  0.65 0.59 0.85]
F1-score on validation set: [0.3  0.62 0.37 0.25 0.43 0.74 0.43 0.55]
ROC AUC on validation set: {'AK': 0.69, 'BCC': 0.93, 'BKL': 0.58, 'DF': 0.5, 'MEL': 0.48, 'NV': 0.25, 'SCC': 0.68, 'VASC': 0.3}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            18            6  ...            5             0
true class BCC           15          104  ...           12             4
true class BKL           14           11  ...            8             1
true class DF             1            1  ...            1             0
true class MEL           15           18  ...            7             1
true class NV            11           22  ...            4            10
true class SCC            4            6  ...           19             0
true class VASC           0            0  ...            0            11

[8 rows x 8 columns]

Current validation loss: 1.125

Epoch 152:
Mean loss 0.7462248752357832 - Correctly labeled training images 64.37%
Classified 58.75 % of validation images correctly.
Precision on validation set: [0.22 0.59 0.27 0.23 0.51 0.84 0.34 0.52]
Recall on validation set: [0.58 0.53 0.4  0.5  0.39 0.7  0.53 0.92]
F1-score on validation set: [0.32 0.56 0.33 0.32 0.44 0.77 0.41 0.67]
ROC AUC on validation set: {'AK': 0.68, 'BCC': 0.92, 'BKL': 0.59, 'DF': 0.59, 'MEL': 0.49, 'NV': 0.25, 'SCC': 0.66, 'VASC': 0.32}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            25            6  ...            4             0
true class BCC           34           89  ...            8             2
true class BKL           17           13  ...            7             0
true class DF             2            1  ...            2             0
true class MEL           12           19  ...            8             2
true class NV            14           19  ...            4             7
true class SCC            9            3  ...           17             0
true class VASC           0            1  ...            0            12

[8 rows x 8 columns]

Current validation loss: 1.083

Epoch 153:
Mean loss 0.7316201443457829 - Correctly labeled training images 64.22%
Classified 59.07 % of validation images correctly.
Precision on validation set: [0.28 0.6  0.29 0.22 0.49 0.84 0.34 0.48]
Recall on validation set: [0.67 0.63 0.39 0.58 0.39 0.69 0.5  0.77]
F1-score on validation set: [0.39 0.61 0.33 0.32 0.44 0.75 0.41 0.59]
ROC AUC on validation set: {'AK': 0.69, 'BCC': 0.93, 'BKL': 0.6, 'DF': 0.47, 'MEL': 0.5, 'NV': 0.23, 'SCC': 0.68, 'VASC': 0.38}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            29            6  ...            1             1
true class BCC           20          105  ...           11             3
true class BKL           17           15  ...            7             0
true class DF             0            3  ...            1             0
true class MEL           19           17  ...            8             1
true class NV            13           25  ...            3             6
true class SCC            7            5  ...           16             0
true class VASC           0            0  ...            0            10

[8 rows x 8 columns]

Current validation loss: 1.083

Epoch 154:
Mean loss 0.7253800668409947 - Correctly labeled training images 64.92%
Classified 57.57 % of validation images correctly.
Precision on validation set: [0.28 0.6  0.28 0.28 0.43 0.85 0.35 0.48]
Recall on validation set: [0.67 0.59 0.34 0.58 0.49 0.64 0.5  1.  ]
F1-score on validation set: [0.39 0.59 0.31 0.38 0.46 0.73 0.41 0.65]
ROC AUC on validation set: {'AK': 0.66, 'BCC': 0.92, 'BKL': 0.6, 'DF': 0.48, 'MEL': 0.5, 'NV': 0.24, 'SCC': 0.67, 'VASC': 0.23}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            29            6  ...            2             0
true class BCC           24           98  ...           13             4
true class BKL           15           13  ...            5             1
true class DF             1            2  ...            1             0
true class MEL           15           19  ...            7             0
true class NV            13           21  ...            2             9
true class SCC            8            4  ...           16             0
true class VASC           0            0  ...            0            13

[8 rows x 8 columns]

Current validation loss: 1.071

Epoch 155:
Mean loss 0.6943978526708832 - Correctly labeled training images 65.48%
Classified 59.86 % of validation images correctly.
Precision on validation set: [0.31 0.64 0.28 0.46 0.45 0.84 0.3  0.6 ]
Recall on validation set: [0.74 0.63 0.4  0.5  0.35 0.7  0.59 0.92]
F1-score on validation set: [0.44 0.63 0.33 0.48 0.39 0.77 0.4  0.73]
ROC AUC on validation set: {'AK': 0.63, 'BCC': 0.93, 'BKL': 0.58, 'DF': 0.51, 'MEL': 0.51, 'NV': 0.25, 'SCC': 0.65, 'VASC': 0.31}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            32            3  ...            3             0
true class BCC           17          105  ...           16             0
true class BKL           16           12  ...            6             1
true class DF             0            2  ...            2             0
true class MEL           16           16  ...           14             1
true class NV            13           23  ...            4             6
true class SCC            9            3  ...           19             0
true class VASC           0            0  ...            0            12

[8 rows x 8 columns]

Current validation loss: 1.063

Epoch 156:
Mean loss 0.7182340198886883 - Correctly labeled training images 65.30%
Classified 60.65 % of validation images correctly.
Precision on validation set: [0.33 0.6  0.29 0.53 0.51 0.82 0.35 0.67]
Recall on validation set: [0.58 0.6  0.47 0.67 0.38 0.72 0.56 0.77]
F1-score on validation set: [0.42 0.6  0.36 0.59 0.43 0.77 0.43 0.71]
ROC AUC on validation set: {'AK': 0.68, 'BCC': 0.93, 'BKL': 0.58, 'DF': 0.53, 'MEL': 0.48, 'NV': 0.24, 'SCC': 0.67, 'VASC': 0.42}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            25            5  ...            4             0
true class BCC           13          100  ...           16             0
true class BKL           11           14  ...            4             0
true class DF             0            2  ...            1             0
true class MEL           14           17  ...            5             0
true class NV             6           22  ...            4             5
true class SCC            7            5  ...           18             0
true class VASC           0            1  ...            0            10

[8 rows x 8 columns]

Current validation loss: 1.015

Epoch 157:
Mean loss 0.6965062962580555 - Correctly labeled training images 65.45%
Classified 59.38 % of validation images correctly.
Precision on validation set: [0.37 0.61 0.29 0.25 0.45 0.87 0.35 0.68]
Recall on validation set: [0.58 0.67 0.46 0.67 0.46 0.64 0.59 1.  ]
F1-score on validation set: [0.45 0.64 0.36 0.36 0.46 0.74 0.44 0.81]
ROC AUC on validation set: {'AK': 0.66, 'BCC': 0.93, 'BKL': 0.57, 'DF': 0.48, 'MEL': 0.5, 'NV': 0.25, 'SCC': 0.68, 'VASC': 0.27}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            25            6  ...            4             0
true class BCC            7          112  ...           12             1
true class BKL            9           17  ...            5             0
true class DF             0            2  ...            1             0
true class MEL           12           18  ...            8             1
true class NV             9           24  ...            6             4
true class SCC            5            6  ...           19             0
true class VASC           0            0  ...            0            13

[8 rows x 8 columns]

Current validation loss: 1.075

Epoch 158:
Mean loss 0.6978895129747571 - Correctly labeled training images 65.18%
Classified 58.60 % of validation images correctly.
Precision on validation set: [0.32 0.56 0.27 0.15 0.47 0.84 0.32 0.65]
Recall on validation set: [0.58 0.66 0.4  0.42 0.35 0.68 0.62 0.85]
F1-score on validation set: [0.41 0.61 0.32 0.22 0.41 0.76 0.42 0.73]
ROC AUC on validation set: {'AK': 0.66, 'BCC': 0.93, 'BKL': 0.6, 'DF': 0.65, 'MEL': 0.51, 'NV': 0.22, 'SCC': 0.66, 'VASC': 0.44}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            25            7  ...            3             0
true class BCC           14          110  ...           13             0
true class BKL           14           16  ...            9             0
true class DF             2            2  ...            1             0
true class MEL           12           25  ...           14             2
true class NV             8           29  ...            3             4
true class SCC            4            6  ...           20             0
true class VASC           0            0  ...            0            11

[8 rows x 8 columns]

Current validation loss: 1.106

Epoch 159:
Mean loss 0.6750853030416492 - Correctly labeled training images 65.83%
Classified 61.04 % of validation images correctly.
Precision on validation set: [0.31 0.66 0.3  0.22 0.49 0.83 0.35 0.61]
Recall on validation set: [0.63 0.62 0.4  0.5  0.41 0.72 0.59 0.85]
F1-score on validation set: [0.42 0.64 0.34 0.31 0.45 0.77 0.44 0.71]
ROC AUC on validation set: {'AK': 0.66, 'BCC': 0.94, 'BKL': 0.59, 'DF': 0.67, 'MEL': 0.46, 'NV': 0.25, 'SCC': 0.65, 'VASC': 0.41}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            27            4  ...            5             0
true class BCC           12          103  ...           14             1
true class BKL           15           10  ...            6             1
true class DF             1            2  ...            1             0
true class MEL           16           14  ...            7             0
true class NV             8           20  ...            3             5
true class SCC            7            4  ...           19             0
true class VASC           0            0  ...            0            11

[8 rows x 8 columns]

Current validation loss: 1.024

Epoch 160:
Mean loss 0.6736002737415325 - Correctly labeled training images 65.94%
Classified 59.94 % of validation images correctly.
Precision on validation set: [0.29 0.62 0.31 0.26 0.47 0.86 0.38 0.55]
Recall on validation set: [0.67 0.65 0.45 0.42 0.46 0.66 0.56 0.85]
F1-score on validation set: [0.41 0.63 0.37 0.32 0.46 0.75 0.46 0.67]
ROC AUC on validation set: {'AK': 0.64, 'BCC': 0.94, 'BKL': 0.58, 'DF': 0.62, 'MEL': 0.5, 'NV': 0.24, 'SCC': 0.69, 'VASC': 0.35}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            29            4  ...            3             0
true class BCC           20          108  ...            9             0
true class BKL           15           13  ...            4             0
true class DF             1            3  ...            1             0
true class MEL           17           18  ...            9             2
true class NV            12           22  ...            3             7
true class SCC            6            6  ...           18             0
true class VASC           0            0  ...            0            11

[8 rows x 8 columns]

Current validation loss: 1.076

Epoch 161:
Mean loss 0.6973862912658637 - Correctly labeled training images 65.28%
Classified 61.91 % of validation images correctly.
Precision on validation set: [0.34 0.66 0.31 0.32 0.49 0.85 0.34 0.65]
Recall on validation set: [0.67 0.61 0.46 0.58 0.43 0.71 0.62 0.85]
F1-score on validation set: [0.45 0.64 0.37 0.41 0.46 0.77 0.44 0.73]
ROC AUC on validation set: {'AK': 0.69, 'BCC': 0.94, 'BKL': 0.6, 'DF': 0.62, 'MEL': 0.48, 'NV': 0.23, 'SCC': 0.67, 'VASC': 0.31}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            29            5  ...            2             0
true class BCC           17          102  ...           10             2
true class BKL            9           13  ...            8             0
true class DF             0            2  ...            1             0
true class MEL           14           12  ...           12             0
true class NV             9           17  ...            6             4
true class SCC            7            3  ...           20             0
true class VASC           0            0  ...            0            11

/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
[8 rows x 8 columns]

Current validation loss: 1.025

Epoch 162:
Mean loss 0.676788724629849 - Correctly labeled training images 65.81%
Classified 60.73 % of validation images correctly.
Precision on validation set: [0.33 0.64 0.28 0.3  0.47 0.83 0.38 0.65]
Recall on validation set: [0.58 0.63 0.45 0.5  0.39 0.71 0.5  0.85]
F1-score on validation set: [0.42 0.63 0.35 0.37 0.43 0.77 0.43 0.73]
ROC AUC on validation set: {'AK': 0.7, 'BCC': 0.94, 'BKL': 0.6, 'DF': 0.73, 'MEL': 0.49, 'NV': 0.22, 'SCC': 0.68, 'VASC': 0.42}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            25            6  ...            1             0
true class BCC           14          105  ...           12             0
true class BKL            8           14  ...            6             1
true class DF             0            2  ...            1             0
true class MEL           12           18  ...            6             2
true class NV             8           16  ...            0             3
true class SCC            8            3  ...           16             0
true class VASC           0            0  ...            0            11

[8 rows x 8 columns]

Current validation loss: 1.023

Epoch 163:
Mean loss 0.6653639549148571 - Correctly labeled training images 66.25%
Classified 61.75 % of validation images correctly.
Precision on validation set: [0.35 0.59 0.35 0.27 0.49 0.86 0.3  0.58]
Recall on validation set: [0.58 0.68 0.46 0.58 0.44 0.7  0.59 0.85]
F1-score on validation set: [0.43 0.63 0.4  0.37 0.46 0.77 0.4  0.69]
ROC AUC on validation set: {'AK': 0.67, 'BCC': 0.93, 'BKL': 0.57, 'DF': 0.53, 'MEL': 0.48, 'NV': 0.26, 'SCC': 0.62, 'VASC': 0.33}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            25            9  ...            3             0
true class BCC            9          113  ...           13             1
true class BKL            8           16  ...            5             1
true class DF             0            1  ...            1             1
true class MEL           14           20  ...           13             1
true class NV            10           27  ...            9             4
true class SCC            6            4  ...           19             0
true class VASC           0            1  ...            0            11

[8 rows x 8 columns]

Current validation loss: 1.043

Epoch 164:
Mean loss 0.6489162279839396 - Correctly labeled training images 67.07%
Classified 58.83 % of validation images correctly.
Precision on validation set: [0.26 0.61 0.28 0.29 0.48 0.86 0.37 0.59]
Recall on validation set: [0.47 0.63 0.53 0.42 0.4  0.66 0.62 0.77]
F1-score on validation set: [0.34 0.62 0.37 0.34 0.43 0.75 0.47 0.67]
ROC AUC on validation set: {'AK': 0.64, 'BCC': 0.93, 'BKL': 0.53, 'DF': 0.63, 'MEL': 0.49, 'NV': 0.27, 'SCC': 0.64, 'VASC': 0.38}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            20            5  ...            3             0
true class BCC            8          106  ...           11             2
true class BKL           12           12  ...            4             0
true class DF             1            3  ...            1             0
true class MEL           19           21  ...           11             1
true class NV            11           22  ...            4             4
true class SCC            5            4  ...           20             0
true class VASC           0            0  ...            0            10

[8 rows x 8 columns]

Current validation loss: 1.086

Epoch 165:
Mean loss 0.6472186898160432 - Correctly labeled training images 66.40%
Classified 60.33 % of validation images correctly.
Precision on validation set: [0.28 0.64 0.27 0.38 0.51 0.84 0.33 0.65]
Recall on validation set: [0.56 0.63 0.47 0.5  0.38 0.71 0.44 0.85]
F1-score on validation set: [0.38 0.63 0.34 0.43 0.44 0.77 0.38 0.73]
ROC AUC on validation set: {'AK': 0.71, 'BCC': 0.94, 'BKL': 0.58, 'DF': 0.61, 'MEL': 0.5, 'NV': 0.23, 'SCC': 0.64, 'VASC': 0.47}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            24            5  ...            3             0
true class BCC           12          105  ...            9             1
true class BKL           12           11  ...            5             1
true class DF             1            1  ...            1             0
true class MEL           17           20  ...            7             1
true class NV            11           17  ...            3             3
true class SCC            8            4  ...           14             0
true class VASC           0            1  ...            0            11

[8 rows x 8 columns]

Current validation loss: 1.028

Epoch 166:
Mean loss 0.6447252529417679 - Correctly labeled training images 67.48%
Classified 59.15 % of validation images correctly.
Precision on validation set: [0.32 0.58 0.28 0.37 0.44 0.86 0.37 0.62]
Recall on validation set: [0.49 0.7  0.46 0.58 0.41 0.66 0.56 0.77]
F1-score on validation set: [0.39 0.64 0.35 0.45 0.43 0.74 0.44 0.69]
ROC AUC on validation set: {'AK': 0.65, 'BCC': 0.93, 'BKL': 0.56, 'DF': 0.55, 'MEL': 0.47, 'NV': 0.27, 'SCC': 0.63, 'VASC': 0.45}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            21            6  ...            4             0
true class BCC            9          117  ...            8             2
true class BKL            9           15  ...            7             2
true class DF             0            2  ...            1             0
true class MEL           14           24  ...            8             1
true class NV             8           31  ...            3             1
true class SCC            4            6  ...           18             0
true class VASC           0            0  ...            0            10

[8 rows x 8 columns]

Current validation loss: 1.085

Epoch 167:
Mean loss 0.6309362757328181 - Correctly labeled training images 66.62%
Classified 58.12 % of validation images correctly.
Precision on validation set: [0.27 0.61 0.3  0.19 0.45 0.88 0.25 0.75]
Recall on validation set: [0.6  0.59 0.47 0.5  0.46 0.65 0.41 0.69]
F1-score on validation set: [0.37 0.6  0.37 0.28 0.45 0.75 0.31 0.72]
ROC AUC on validation set: {'AK': 0.64, 'BCC': 0.93, 'BKL': 0.56, 'DF': 0.6, 'MEL': 0.47, 'NV': 0.26, 'SCC': 0.65, 'VASC': 0.43}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            26            5  ...            4             0
true class BCC           17           99  ...           10             0
true class BKL           12           12  ...            8             0
true class DF             1            2  ...            1             0
true class MEL           21           14  ...            7             0
true class NV            13           24  ...            9             3
true class SCC            7            4  ...           13             0
true class VASC           0            1  ...            0             9

[8 rows x 8 columns]

Current validation loss: 1.126

Epoch 168:
Mean loss 0.6394017896253604 - Correctly labeled training images 67.03%
Classified 62.85 % of validation images correctly.
Precision on validation set: [0.31 0.63 0.33 0.3  0.51 0.83 0.37 0.79]
Recall on validation set: [0.63 0.62 0.43 0.5  0.41 0.75 0.56 0.85]
F1-score on validation set: [0.42 0.62 0.37 0.37 0.46 0.79 0.44 0.81]
ROC AUC on validation set: {'AK': 0.67, 'BCC': 0.94, 'BKL': 0.61, 'DF': 0.68, 'MEL': 0.51, 'NV': 0.21, 'SCC': 0.68, 'VASC': 0.34}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            27            2  ...            6             0
true class BCC           19          104  ...            9             0
true class BKL           10           11  ...            6             0
true class DF             0            3  ...            1             0
true class MEL           13           19  ...            8             0
true class NV            10           22  ...            1             3
true class SCC            7            5  ...           18             0
true class VASC           0            0  ...            0            11

/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
[8 rows x 8 columns]

Current validation loss: 0.982

Epoch 169:
Mean loss 0.6461699167824694 - Correctly labeled training images 67.20%
Classified 61.04 % of validation images correctly.
Precision on validation set: [0.3  0.64 0.3  0.3  0.53 0.84 0.5  0.71]
Recall on validation set: [0.67 0.6  0.52 0.58 0.39 0.7  0.59 0.77]
F1-score on validation set: [0.41 0.62 0.38 0.4  0.45 0.76 0.54 0.74]
ROC AUC on validation set: {'AK': 0.63, 'BCC': 0.93, 'BKL': 0.56, 'DF': 0.62, 'MEL': 0.48, 'NV': 0.25, 'SCC': 0.64, 'VASC': 0.53}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            29            4  ...            3             0
true class BCC           19          101  ...            5             1
true class BKL           14           11  ...            4             0
true class DF             1            1  ...            0             1
true class MEL           16           20  ...            4             0
true class NV            15           20  ...            3             2
true class SCC            3            2  ...           19             0
true class VASC           0            0  ...            0            10

[8 rows x 8 columns]

Current validation loss: 1.051

Epoch 170:
Mean loss 0.6269770105272437 - Correctly labeled training images 67.08%
Classified 60.49 % of validation images correctly.
Precision on validation set: [0.33 0.57 0.31 0.47 0.47 0.86 0.38 0.55]
Recall on validation set: [0.56 0.66 0.48 0.58 0.45 0.67 0.5  0.85]
F1-score on validation set: [0.42 0.61 0.37 0.52 0.46 0.76 0.43 0.67]
ROC AUC on validation set: {'AK': 0.67, 'BCC': 0.93, 'BKL': 0.56, 'DF': 0.58, 'MEL': 0.48, 'NV': 0.26, 'SCC': 0.62, 'VASC': 0.4}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            24            7  ...            3             0
true class BCC           12          111  ...           10             1
true class BKL           10           19  ...            5             0
true class DF             0            2  ...            1             0
true class MEL           13           21  ...            5             2
true class NV             8           31  ...            2             6
true class SCC            5            5  ...           16             0
true class VASC           0            0  ...            0            11

[8 rows x 8 columns]

Current validation loss: 1.053

Epoch 171:
Mean loss 0.611380470593457 - Correctly labeled training images 67.78%
Classified 61.75 % of validation images correctly.
Precision on validation set: [0.36 0.64 0.3  0.32 0.49 0.85 0.4  0.55]
Recall on validation set: [0.6  0.66 0.5  0.5  0.43 0.7  0.5  0.85]
F1-score on validation set: [0.45 0.65 0.38 0.39 0.46 0.77 0.44 0.67]
ROC AUC on validation set: {'AK': 0.69, 'BCC': 0.94, 'BKL': 0.6, 'DF': 0.53, 'MEL': 0.49, 'NV': 0.23, 'SCC': 0.63, 'VASC': 0.43}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            26            6  ...            3             0
true class BCC            7          110  ...            8             2
true class BKL           12           13  ...            4             1
true class DF             0            1  ...            2             1
true class MEL           11           21  ...            6             0
true class NV            10           16  ...            1             5
true class SCC            6            5  ...           16             0
true class VASC           0            0  ...            0            11

[8 rows x 8 columns]

Current validation loss: 1.024

Epoch 172:
Mean loss 0.6206180894576977 - Correctly labeled training images 67.19%
Classified 59.54 % of validation images correctly.
Precision on validation set: [0.31 0.61 0.3  0.35 0.47 0.87 0.35 0.59]
Recall on validation set: [0.7  0.59 0.49 0.58 0.46 0.66 0.56 0.77]
F1-score on validation set: [0.43 0.6  0.37 0.44 0.46 0.75 0.43 0.67]
ROC AUC on validation set: {'AK': 0.65, 'BCC': 0.94, 'BKL': 0.6, 'DF': 0.59, 'MEL': 0.49, 'NV': 0.24, 'SCC': 0.61, 'VASC': 0.43}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            30            3  ...            3             0
true class BCC           17           98  ...           11             1
true class BKL           14           17  ...            5             0
true class DF             0            1  ...            2             0
true class MEL           17           20  ...            9             0
true class NV            12           16  ...            3             6
true class SCC            6            5  ...           18             0
true class VASC           0            0  ...            0            10

[8 rows x 8 columns]

Current validation loss: 1.071

Epoch 173:
Mean loss 0.5999602463202146 - Correctly labeled training images 68.06%
Classified 61.75 % of validation images correctly.
Precision on validation set: [0.37 0.63 0.32 0.26 0.5  0.85 0.44 0.46]
Recall on validation set: [0.77 0.66 0.51 0.5  0.38 0.7  0.47 0.85]
F1-score on validation set: [0.5  0.65 0.39 0.34 0.43 0.77 0.45 0.59]
ROC AUC on validation set: {'AK': 0.65, 'BCC': 0.94, 'BKL': 0.59, 'DF': 0.55, 'MEL': 0.5, 'NV': 0.23, 'SCC': 0.67, 'VASC': 0.36}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            33            5  ...            2             1
true class BCC           13          111  ...            6             1
true class BKL           11           15  ...            5             1
true class DF             1            1  ...            1             1
true class MEL           18           19  ...            3             1
true class NV             7           21  ...            2             8
true class SCC            6            5  ...           15             0
true class VASC           0            0  ...            0            11

[8 rows x 8 columns]

Current validation loss: 1.033

Epoch 174:
Mean loss 0.6105413205616106 - Correctly labeled training images 67.24%
Classified 59.70 % of validation images correctly.
Precision on validation set: [0.35 0.62 0.29 0.29 0.43 0.85 0.38 0.42]
Recall on validation set: [0.6  0.69 0.4  0.67 0.42 0.67 0.56 0.77]
F1-score on validation set: [0.44 0.66 0.34 0.4  0.43 0.75 0.46 0.54]
ROC AUC on validation set: {'AK': 0.62, 'BCC': 0.93, 'BKL': 0.56, 'DF': 0.56, 'MEL': 0.49, 'NV': 0.26, 'SCC': 0.64, 'VASC': 0.28}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            26            4  ...            4             0
true class BCC           11          116  ...            3             3
true class BKL           10           18  ...            7             1
true class DF             0            2  ...            1             0
true class MEL           16           18  ...            8             1
true class NV             7           22  ...            6             9
true class SCC            5            6  ...           18             0
true class VASC           0            0  ...            0            10

[8 rows x 8 columns]

Current validation loss: 1.074

Epoch 175:
Mean loss 0.5974590351528926 - Correctly labeled training images 68.32%
Classified 61.67 % of validation images correctly.
Precision on validation set: [0.31 0.64 0.33 0.23 0.49 0.86 0.31 0.53]
Recall on validation set: [0.65 0.68 0.45 0.42 0.43 0.7  0.53 0.77]
F1-score on validation set: [0.42 0.66 0.38 0.29 0.46 0.77 0.39 0.62]
ROC AUC on validation set: {'AK': 0.63, 'BCC': 0.93, 'BKL': 0.59, 'DF': 0.54, 'MEL': 0.49, 'NV': 0.25, 'SCC': 0.62, 'VASC': 0.44}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            28            4  ...            3             1
true class BCC           12          113  ...           10             1
true class BKL           13           17  ...            7             1
true class DF             0            1  ...            2             1
true class MEL           16           18  ...           12             0
true class NV            14           18  ...            4             5
true class SCC            7            4  ...           17             0
true class VASC           0            2  ...            0            10

[8 rows x 8 columns]

Current validation loss: 1.070

Epoch 176:
Mean loss 0.5879894480673297 - Correctly labeled training images 68.46%
Classified 60.80 % of validation images correctly.
Precision on validation set: [0.33 0.61 0.29 0.28 0.5  0.84 0.35 0.5 ]
Recall on validation set: [0.49 0.66 0.48 0.67 0.38 0.71 0.59 0.77]
F1-score on validation set: [0.4  0.64 0.37 0.39 0.43 0.77 0.44 0.61]
ROC AUC on validation set: {'AK': 0.68, 'BCC': 0.94, 'BKL': 0.58, 'DF': 0.51, 'MEL': 0.49, 'NV': 0.24, 'SCC': 0.62, 'VASC': 0.45}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            21            7  ...            4             0
true class BCC           11          110  ...            9             3
true class BKL            8           14  ...            9             1
true class DF             0            2  ...            1             0
true class MEL           11           18  ...            8             1
true class NV             9           22  ...            4             5
true class SCC            3            5  ...           19             0
true class VASC           0            1  ...            0            10

[8 rows x 8 columns]

Current validation loss: 1.049

Epoch 177:
Mean loss 0.5755751639228514 - Correctly labeled training images 68.22%
Classified 61.67 % of validation images correctly.
Precision on validation set: [0.35 0.69 0.28 0.4  0.48 0.87 0.55 0.65]
Recall on validation set: [0.63 0.62 0.53 0.5  0.49 0.68 0.5  0.85]
F1-score on validation set: [0.45 0.65 0.37 0.44 0.48 0.76 0.52 0.73]
ROC AUC on validation set: {'AK': 0.69, 'BCC': 0.94, 'BKL': 0.57, 'DF': 0.66, 'MEL': 0.48, 'NV': 0.23, 'SCC': 0.68, 'VASC': 0.55}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            27            5  ...            0             1
true class BCC           14          103  ...            5             1
true class BKL           11           12  ...            1             0
true class DF             1            2  ...            2             0
true class MEL           11           12  ...            4             1
true class NV             6           11  ...            1             3
true class SCC            8            5  ...           16             0
true class VASC           0            0  ...            0            11

[8 rows x 8 columns]

Current validation loss: 1.046

Epoch 178:
Mean loss 0.5703530136249043 - Correctly labeled training images 68.94%
Classified 60.33 % of validation images correctly.
Precision on validation set: [0.34 0.61 0.29 0.19 0.5  0.82 0.27 0.55]
Recall on validation set: [0.56 0.6  0.4  0.58 0.36 0.73 0.5  0.85]
F1-score on validation set: [0.42 0.61 0.33 0.29 0.42 0.78 0.35 0.67]
ROC AUC on validation set: {'AK': 0.7, 'BCC': 0.93, 'BKL': 0.61, 'DF': 0.6, 'MEL': 0.5, 'NV': 0.22, 'SCC': 0.62, 'VASC': 0.43}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            24            7  ...            4             1
true class BCC           13          101  ...           13             0
true class BKL           10           15  ...            9             1
true class DF             0            1  ...            2             1
true class MEL           11           19  ...           12             1
true class NV             4           19  ...            3             5
true class SCC            9            4  ...           16             0
true class VASC           0            0  ...            0            11

[8 rows x 8 columns]

Current validation loss: 1.072

Epoch 179:
Mean loss 0.568294046805108 - Correctly labeled training images 69.27%
Classified 61.99 % of validation images correctly.
Precision on validation set: [0.4  0.68 0.27 0.26 0.48 0.82 0.43 0.46]
Recall on validation set: [0.49 0.68 0.43 0.42 0.42 0.73 0.41 0.85]
F1-score on validation set: [0.44 0.68 0.33 0.32 0.45 0.77 0.42 0.59]
ROC AUC on validation set: {'AK': 0.71, 'BCC': 0.95, 'BKL': 0.59, 'DF': 0.59, 'MEL': 0.49, 'NV': 0.23, 'SCC': 0.7, 'VASC': 0.38}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            21            6  ...            2             0
true class BCC            5          114  ...            3             1
true class BKL            6           11  ...            4             0
true class DF             0            1  ...            2             1
true class MEL           12           14  ...            4             2
true class NV             3           14  ...            2             9
true class SCC            5            7  ...           13             0
true class VASC           0            0  ...            0            11

[8 rows x 8 columns]

Current validation loss: 0.997

Epoch 180:
Mean loss 0.562742516233906 - Correctly labeled training images 68.96%
Classified 61.04 % of validation images correctly.
Precision on validation set: [0.28 0.67 0.3  0.38 0.51 0.85 0.49 0.52]
Recall on validation set: [0.58 0.58 0.55 0.5  0.45 0.69 0.56 0.85]
F1-score on validation set: [0.38 0.62 0.39 0.43 0.48 0.76 0.52 0.65]
ROC AUC on validation set: {'AK': 0.66, 'BCC': 0.94, 'BKL': 0.58, 'DF': 0.65, 'MEL': 0.48, 'NV': 0.24, 'SCC': 0.65, 'VASC': 0.44}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            25            7  ...            0             1
true class BCC           18           97  ...            7             2
true class BKL           13            8  ...            2             0
true class DF             0            1  ...            2             1
true class MEL           13           13  ...            6             0
true class NV            11           14  ...            2             6
true class SCC            8            4  ...           18             0
true class VASC           0            0  ...            0            11

[8 rows x 8 columns]

Current validation loss: 1.062

Epoch 181:
Mean loss 0.5789503308735812 - Correctly labeled training images 68.87%
Classified 61.99 % of validation images correctly.
Precision on validation set: [0.3  0.65 0.3  0.29 0.51 0.85 0.47 0.65]
Recall on validation set: [0.53 0.63 0.5  0.58 0.42 0.71 0.56 0.85]
F1-score on validation set: [0.39 0.64 0.38 0.39 0.46 0.78 0.51 0.73]
ROC AUC on validation set: {'AK': 0.67, 'BCC': 0.93, 'BKL': 0.56, 'DF': 0.56, 'MEL': 0.46, 'NV': 0.27, 'SCC': 0.62, 'VASC': 0.49}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            23            4  ...            2             1
true class BCC           16          105  ...            8             0
true class BKL           12           12  ...            3             0
true class DF             0            2  ...            1             0
true class MEL           11           15  ...            4             1
true class NV             8           19  ...            2             4
true class SCC            6            4  ...           18             0
true class VASC           0            0  ...            0            11

[8 rows x 8 columns]

Current validation loss: 1.058

Epoch 182:
Mean loss 0.5709592742310714 - Correctly labeled training images 69.06%
Classified 61.99 % of validation images correctly.
Precision on validation set: [0.41 0.63 0.3  0.41 0.48 0.85 0.5  0.43]
Recall on validation set: [0.47 0.71 0.5  0.75 0.43 0.7  0.47 1.  ]
F1-score on validation set: [0.43 0.66 0.37 0.53 0.46 0.77 0.48 0.6 ]
ROC AUC on validation set: {'AK': 0.7, 'BCC': 0.94, 'BKL': 0.58, 'DF': 0.63, 'MEL': 0.5, 'NV': 0.23, 'SCC': 0.7, 'VASC': 0.28}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            20            9  ...            2             1
true class BCC            4          118  ...            4             4
true class BKL            5           15  ...            4             1
true class DF             0            1  ...            0             1
true class MEL           11           22  ...            3             2
true class NV             5           15  ...            2             8
true class SCC            4            8  ...           15             0
true class VASC           0            0  ...            0            13

/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
[8 rows x 8 columns]

Current validation loss: 1.032

Epoch 183:
Mean loss 0.5597117298785068 - Correctly labeled training images 69.35%
Classified 60.65 % of validation images correctly.
Precision on validation set: [0.31 0.61 0.3  0.28 0.48 0.87 0.35 0.65]
Recall on validation set: [0.49 0.68 0.49 0.58 0.44 0.68 0.5  0.85]
F1-score on validation set: [0.38 0.65 0.37 0.38 0.46 0.76 0.41 0.73]
ROC AUC on validation set: {'AK': 0.64, 'BCC': 0.93, 'BKL': 0.55, 'DF': 0.56, 'MEL': 0.48, 'NV': 0.27, 'SCC': 0.6, 'VASC': 0.4}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            21            7  ...            4             0
true class BCC           12          114  ...            6             0
true class BKL           11           18  ...            6             0
true class DF             0            2  ...            2             0
true class MEL           10           21  ...            7             1
true class NV             8           18  ...            5             5
true class SCC            6            6  ...           16             0
true class VASC           0            0  ...            0            11

[8 rows x 8 columns]

Current validation loss: 1.106

Epoch 184:
Mean loss 0.5489354934484613 - Correctly labeled training images 69.30%
Classified 60.02 % of validation images correctly.
Precision on validation set: [0.34 0.62 0.3  0.26 0.48 0.87 0.47 0.38]
Recall on validation set: [0.51 0.66 0.57 0.42 0.42 0.66 0.5  0.92]
F1-score on validation set: [0.41 0.64 0.39 0.32 0.45 0.75 0.48 0.53]
ROC AUC on validation set: {'AK': 0.68, 'BCC': 0.94, 'BKL': 0.58, 'DF': 0.62, 'MEL': 0.5, 'NV': 0.23, 'SCC': 0.64, 'VASC': 0.35}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            22           10  ...            0             0
true class BCC            8          110  ...            6             4
true class BKL            8           14  ...            4             2
true class DF             1            2  ...            2             0
true class MEL           14           14  ...            4             3
true class NV             8           19  ...            2            11
true class SCC            4            8  ...           16             0
true class VASC           0            0  ...            0            12

[8 rows x 8 columns]

Current validation loss: 1.086

Epoch 185:
Mean loss 0.5314269854631334 - Correctly labeled training images 70.11%
Classified 60.73 % of validation images correctly.
Precision on validation set: [0.33 0.61 0.3  0.3  0.48 0.86 0.44 0.41]
Recall on validation set: [0.49 0.65 0.5  0.5  0.43 0.69 0.53 0.92]
F1-score on validation set: [0.39 0.63 0.37 0.37 0.45 0.77 0.48 0.57]
ROC AUC on validation set: {'AK': 0.66, 'BCC': 0.94, 'BKL': 0.58, 'DF': 0.58, 'MEL': 0.48, 'NV': 0.25, 'SCC': 0.64, 'VASC': 0.34}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            21            8  ...            1             1
true class BCC           10          108  ...            7             3
true class BKL            8           14  ...            6             1
true class DF             0            2  ...            1             0
true class MEL           14           18  ...            5             2
true class NV             6           24  ...            2            10
true class SCC            5            4  ...           17             0
true class VASC           0            0  ...            0            12

[8 rows x 8 columns]

Current validation loss: 1.066

Epoch 186:
Mean loss 0.5308975073206312 - Correctly labeled training images 70.39%
Classified 61.51 % of validation images correctly.
Precision on validation set: [0.34 0.61 0.29 0.32 0.5  0.85 0.52 0.58]
Recall on validation set: [0.56 0.63 0.51 0.5  0.45 0.7  0.38 0.85]
F1-score on validation set: [0.42 0.62 0.37 0.39 0.48 0.77 0.44 0.69]
ROC AUC on validation set: {'AK': 0.69, 'BCC': 0.94, 'BKL': 0.58, 'DF': 0.64, 'MEL': 0.49, 'NV': 0.23, 'SCC': 0.67, 'VASC': 0.44}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            24            5  ...            1             1
true class BCC           12          105  ...            5             1
true class BKL            7           17  ...            1             0
true class DF             0            1  ...            2             1
true class MEL           13           17  ...            2             1
true class NV             5           19  ...            0             4
true class SCC            9            6  ...           12             0
true class VASC           0            1  ...            0            11

[8 rows x 8 columns]

Current validation loss: 1.072

Epoch 187:
Mean loss 0.531117060806379 - Correctly labeled training images 70.01%
Classified 61.20 % of validation images correctly.
Precision on validation set: [0.32 0.63 0.31 0.27 0.49 0.84 0.37 0.55]
Recall on validation set: [0.53 0.68 0.45 0.58 0.42 0.69 0.59 0.85]
F1-score on validation set: [0.4  0.66 0.37 0.37 0.45 0.76 0.46 0.67]
ROC AUC on validation set: {'AK': 0.65, 'BCC': 0.94, 'BKL': 0.59, 'DF': 0.55, 'MEL': 0.5, 'NV': 0.24, 'SCC': 0.63, 'VASC': 0.39}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            23            7  ...            2             1
true class BCC            9          114  ...           13             0
true class BKL           11           17  ...            5             0
true class DF             0            2  ...            1             0
true class MEL           15           17  ...            6             1
true class NV             8           21  ...            5             7
true class SCC            7            3  ...           19             0
true class VASC           0            0  ...            0            11

[8 rows x 8 columns]

Current validation loss: 1.084

Epoch 188:
Mean loss 0.5290652377419292 - Correctly labeled training images 70.45%
Classified 60.33 % of validation images correctly.
Precision on validation set: [0.34 0.56 0.27 0.41 0.5  0.83 0.38 0.43]
Recall on validation set: [0.56 0.64 0.4  0.58 0.38 0.72 0.47 0.77]
F1-score on validation set: [0.42 0.6  0.32 0.48 0.43 0.77 0.42 0.56]
ROC AUC on validation set: {'AK': 0.66, 'BCC': 0.93, 'BKL': 0.59, 'DF': 0.58, 'MEL': 0.47, 'NV': 0.26, 'SCC': 0.64, 'VASC': 0.24}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            24           10  ...            1             0
true class BCC           11          107  ...            9             2
true class BKL           10           20  ...            5             0
true class DF             0            2  ...            0             0
true class MEL           12           22  ...            8             1
true class NV             6           24  ...            2            10
true class SCC            8            5  ...           15             0
true class VASC           0            0  ...            0            10

[8 rows x 8 columns]

Current validation loss: 1.059

Epoch 189:
Mean loss 0.5239655950138997 - Correctly labeled training images 70.53%
Classified 60.73 % of validation images correctly.
Precision on validation set: [0.36 0.58 0.27 0.38 0.48 0.85 0.61 0.5 ]
Recall on validation set: [0.6  0.73 0.47 0.5  0.38 0.69 0.53 0.69]
F1-score on validation set: [0.45 0.65 0.34 0.43 0.43 0.76 0.57 0.58]
ROC AUC on validation set: {'AK': 0.66, 'BCC': 0.94, 'BKL': 0.58, 'DF': 0.57, 'MEL': 0.46, 'NV': 0.25, 'SCC': 0.69, 'VASC': 0.46}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            26           10  ...            1             0
true class BCC            9          122  ...            3             1
true class BKL           13           21  ...            2             0
true class DF             1            2  ...            1             0
true class MEL           14           22  ...            4             1
true class NV             5           26  ...            0             7
true class SCC            5            7  ...           17             0
true class VASC           0            1  ...            0             9

/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
[8 rows x 8 columns]

Current validation loss: 1.062

Epoch 190:
Mean loss 0.5132290663826353 - Correctly labeled training images 70.70%
Classified 61.04 % of validation images correctly.
Precision on validation set: [0.31 0.6  0.28 0.36 0.52 0.85 0.43 0.61]
Recall on validation set: [0.56 0.65 0.52 0.67 0.37 0.71 0.5  0.85]
F1-score on validation set: [0.4  0.62 0.37 0.47 0.43 0.77 0.46 0.71]
ROC AUC on validation set: {'AK': 0.65, 'BCC': 0.93, 'BKL': 0.58, 'DF': 0.51, 'MEL': 0.49, 'NV': 0.25, 'SCC': 0.62, 'VASC': 0.43}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            24            6  ...            3             0
true class BCC           17          108  ...            5             0
true class BKL           11           19  ...            4             0
true class DF             0            2  ...            1             0
true class MEL           14           17  ...            5             1
true class NV             4           22  ...            3             6
true class SCC            7            6  ...           16             0
true class VASC           0            0  ...            0            11

[8 rows x 8 columns]

Current validation loss: 1.059

Epoch 191:
Mean loss 0.5124240072461709 - Correctly labeled training images 71.21%
Classified 60.96 % of validation images correctly.
Precision on validation set: [0.31 0.65 0.3  0.33 0.51 0.86 0.4  0.56]
Recall on validation set: [0.6  0.68 0.58 0.5  0.42 0.68 0.31 0.77]
F1-score on validation set: [0.41 0.66 0.4  0.4  0.46 0.76 0.35 0.65]
ROC AUC on validation set: {'AK': 0.66, 'BCC': 0.94, 'BKL': 0.57, 'DF': 0.57, 'MEL': 0.49, 'NV': 0.23, 'SCC': 0.69, 'VASC': 0.4}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            26            2  ...            1             0
true class BCC           17          113  ...            3             2
true class BKL            8           12  ...            5             0
true class DF             1            2  ...            1             0
true class MEL           14           17  ...            2             1
true class NV            10           20  ...            3             5
true class SCC            7            7  ...           10             0
true class VASC           0            1  ...            0            10

[8 rows x 8 columns]

Current validation loss: 1.074

Epoch 192:
Mean loss 0.5128483469553926 - Correctly labeled training images 70.53%
Classified 61.99 % of validation images correctly.
Precision on validation set: [0.34 0.67 0.31 0.38 0.49 0.87 0.4  0.5 ]
Recall on validation set: [0.56 0.72 0.52 0.5  0.47 0.67 0.59 0.85]
F1-score on validation set: [0.42 0.69 0.39 0.43 0.48 0.76 0.48 0.63]
ROC AUC on validation set: {'AK': 0.62, 'BCC': 0.95, 'BKL': 0.56, 'DF': 0.56, 'MEL': 0.48, 'NV': 0.25, 'SCC': 0.66, 'VASC': 0.35}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            24            6  ...            4             0
true class BCC            9          120  ...            5             4
true class BKL            8           13  ...            6             1
true class DF             1            2  ...            1             0
true class MEL           13           14  ...            7             0
true class NV            11           20  ...            6             6
true class SCC            5            4  ...           19             0
true class VASC           0            1  ...            0            11

[8 rows x 8 columns]

Current validation loss: 1.052

Epoch 193:
Mean loss 0.5092646078873508 - Correctly labeled training images 70.70%
Classified 63.64 % of validation images correctly.
Precision on validation set: [0.34 0.67 0.34 0.21 0.54 0.84 0.38 0.69]
Recall on validation set: [0.58 0.67 0.54 0.5  0.37 0.75 0.56 0.85]
F1-score on validation set: [0.43 0.67 0.42 0.29 0.44 0.79 0.46 0.76]
ROC AUC on validation set: {'AK': 0.64, 'BCC': 0.94, 'BKL': 0.56, 'DF': 0.54, 'MEL': 0.49, 'NV': 0.25, 'SCC': 0.62, 'VASC': 0.47}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            25            2  ...            5             0
true class BCC           13          112  ...            4             0
true class BKL            9           12  ...            4             0
true class DF             0            2  ...            1             0
true class MEL           13           16  ...           10             0
true class NV             5           19  ...            5             5
true class SCC            8            3  ...           18             0
true class VASC           0            0  ...            0            11

[8 rows x 8 columns]

Current validation loss: 1.028

Epoch 194:
Mean loss 0.5108623498292751 - Correctly labeled training images 71.30%
Classified 63.01 % of validation images correctly.
Precision on validation set: [0.37 0.59 0.34 0.29 0.52 0.86 0.36 0.61]
Recall on validation set: [0.44 0.77 0.5  0.58 0.41 0.71 0.62 0.85]
F1-score on validation set: [0.4  0.67 0.41 0.39 0.46 0.78 0.45 0.71]
ROC AUC on validation set: {'AK': 0.64, 'BCC': 0.94, 'BKL': 0.56, 'DF': 0.47, 'MEL': 0.5, 'NV': 0.25, 'SCC': 0.6, 'VASC': 0.47}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            19            6  ...            4             1
true class BCC            6          128  ...            6             0
true class BKL            7           15  ...            6             1
true class DF             0            2  ...            1             0
true class MEL            7           26  ...           13             0
true class NV             6           35  ...            6             5
true class SCC            6            5  ...           20             0
true class VASC           0            0  ...            0            11

[8 rows x 8 columns]

Current validation loss: 1.053

Epoch 195:
Mean loss 0.5155620032257462 - Correctly labeled training images 71.27%
Classified 63.33 % of validation images correctly.
Precision on validation set: [0.35 0.61 0.34 0.43 0.51 0.87 0.36 0.58]
Recall on validation set: [0.56 0.74 0.5  0.5  0.44 0.7  0.59 0.85]
F1-score on validation set: [0.43 0.67 0.41 0.46 0.47 0.78 0.45 0.69]
ROC AUC on validation set: {'AK': 0.62, 'BCC': 0.94, 'BKL': 0.58, 'DF': 0.69, 'MEL': 0.46, 'NV': 0.26, 'SCC': 0.65, 'VASC': 0.41}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            24            8  ...            3             1
true class BCC            9          124  ...            5             0
true class BKL           11           17  ...            7             0
true class DF             1            4  ...            0             0
true class MEL           13           19  ...           11             0
true class NV             6           25  ...            8             7
true class SCC            4            6  ...           19             0
true class VASC           0            0  ...            0            11

[8 rows x 8 columns]

Current validation loss: 1.059

Epoch 196:
Mean loss 0.49986898052955653 - Correctly labeled training images 71.32%
Classified 62.15 % of validation images correctly.
Precision on validation set: [0.39 0.59 0.32 0.53 0.45 0.84 0.67 0.73]
Recall on validation set: [0.51 0.72 0.47 0.75 0.49 0.69 0.38 0.85]
F1-score on validation set: [0.44 0.65 0.38 0.62 0.47 0.76 0.48 0.79]
ROC AUC on validation set: {'AK': 0.68, 'BCC': 0.94, 'BKL': 0.58, 'DF': 0.61, 'MEL': 0.46, 'NV': 0.25, 'SCC': 0.72, 'VASC': 0.43}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            22            8  ...            0             0
true class BCC            8          120  ...            1             1
true class BKL            9           17  ...            2             0
true class DF             0            2  ...            0             0
true class MEL           10           16  ...            2             0
true class NV             2           31  ...            1             3
true class SCC            6            8  ...           12             0
true class VASC           0            0  ...            0            11

[8 rows x 8 columns]

Current validation loss: 1.042

Epoch 197:
Mean loss 0.4869042959193514 - Correctly labeled training images 71.39%
Classified 62.22 % of validation images correctly.
Precision on validation set: [0.37 0.61 0.33 0.26 0.51 0.85 0.45 0.52]
Recall on validation set: [0.53 0.69 0.55 0.42 0.42 0.7  0.47 0.85]
F1-score on validation set: [0.43 0.65 0.41 0.32 0.46 0.77 0.46 0.65]
ROC AUC on validation set: {'AK': 0.68, 'BCC': 0.94, 'BKL': 0.56, 'DF': 0.6, 'MEL': 0.48, 'NV': 0.25, 'SCC': 0.69, 'VASC': 0.39}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            23            5  ...            2             0
true class BCC           11          116  ...            2             1
true class BKL            7           16  ...            2             0
true class DF             0            4  ...            2             0
true class MEL           10           20  ...            8             1
true class NV             5           22  ...            2             8
true class SCC            7            8  ...           15             0
true class VASC           0            0  ...            0            11

[8 rows x 8 columns]

Current validation loss: 1.050

Epoch 198:
Mean loss 0.4748576221875964 - Correctly labeled training images 72.13%
Classified 63.33 % of validation images correctly.
Precision on validation set: [0.4  0.65 0.33 0.37 0.5  0.85 0.43 0.48]
Recall on validation set: [0.51 0.76 0.5  0.58 0.44 0.7  0.56 0.77]
F1-score on validation set: [0.45 0.7  0.4  0.45 0.46 0.77 0.49 0.59]
ROC AUC on validation set: {'AK': 0.69, 'BCC': 0.95, 'BKL': 0.57, 'DF': 0.59, 'MEL': 0.48, 'NV': 0.24, 'SCC': 0.66, 'VASC': 0.39}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            22            5  ...            4             0
true class BCC            6          127  ...            4             3
true class BKL            6           16  ...            3             1
true class DF             1            2  ...            1             0
true class MEL           11           17  ...            8             1
true class NV             4           21  ...            4             6
true class SCC            5            6  ...           18             0
true class VASC           0            1  ...            0            10

[8 rows x 8 columns]

Current validation loss: 1.032

Epoch 199:
Mean loss 0.4726199952750364 - Correctly labeled training images 72.34%
Classified 63.80 % of validation images correctly.
Precision on validation set: [0.43 0.65 0.33 0.33 0.51 0.85 0.41 0.67]
Recall on validation set: [0.53 0.75 0.56 0.42 0.43 0.71 0.47 0.77]
F1-score on validation set: [0.48 0.7  0.41 0.37 0.47 0.78 0.43 0.71]
ROC AUC on validation set: {'AK': 0.66, 'BCC': 0.95, 'BKL': 0.55, 'DF': 0.63, 'MEL': 0.48, 'NV': 0.25, 'SCC': 0.69, 'VASC': 0.41}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            23            6  ...            1             0
true class BCC            4          126  ...            5             0
true class BKL            7           15  ...            5             0
true class DF             0            3  ...            2             0
true class MEL            8           18  ...            7             1
true class NV             7           22  ...            2             4
true class SCC            4            5  ...           15             0
true class VASC           0            0  ...            0            10

[8 rows x 8 columns]

Current validation loss: 1.060

Epoch 200:
Mean loss 0.47729598543950436 - Correctly labeled training images 72.10%
Classified 64.91 % of validation images correctly.
Precision on validation set: [0.35 0.65 0.36 0.35 0.53 0.83 0.57 0.73]
Recall on validation set: [0.51 0.67 0.58 0.5  0.41 0.76 0.53 0.85]
F1-score on validation set: [0.42 0.66 0.44 0.41 0.46 0.79 0.55 0.79]
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:206: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  mean = torch.tensor(mean, dtype=torch.float32)
/share/apps/anaconda-ci/fgci-centos7-anaconda/software/anaconda/2021-03-tf2/e54ecce8/lib/python3.8/site-packages/torchvision/transforms/functional.py:207: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  std = torch.tensor(std, dtype=torch.float32)
ROC AUC on validation set: {'AK': 0.66, 'BCC': 0.94, 'BKL': 0.56, 'DF': 0.61, 'MEL': 0.47, 'NV': 0.25, 'SCC': 0.67, 'VASC': 0.4}
Confusion matrix on validation set:
                 pred as AK  pred as BCC  ...  pred as SCC  pred as VASC
true class AK            22            5  ...            1             0
true class BCC           10          112  ...            4             0
true class BKL            4           15  ...            3             0
true class DF             0            3  ...            1             0
true class MEL           14           14  ...            3             1
true class NV             8           17  ...            1             3
true class SCC            5            6  ...           17             0
true class VASC           0            0  ...            0            11

[8 rows x 8 columns]

Current validation loss: 0.997
Training finished. Time >28.0 hours.
Model succesfully saved to /scratch/work/hakkina7/melanoma/inceptionV3.pth
