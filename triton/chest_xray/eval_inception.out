/home/hakkina7/.local/lib/python3.8/site-packages/torchvision/models/inception.py:81: FutureWarning: The default weight initialization of inception_v3 will be changed in future releases of torchvision. If you wish to keep the old behavior (which leads to long initialization times due to scipy/scipy#11299), please set init_weights=True.
  warnings.warn('The default weight initialization of inception_v3 will be changed in future releases of '
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers).
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers).
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers).
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers).
/home/hakkina7/.local/lib/python3.8/site-packages/cleverhans/torch/attacks/spsa.py:122: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  perturbation = torch.tensor(_project_perturbation(perturbation, norm, eps, x, clip_min, clip_max), requires_grad=True)
/home/hakkina7/.local/lib/python3.8/site-packages/cleverhans/torch/attacks/spsa.py:141: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  perturbation = torch.tensor(_project_perturbation(perturbation, norm, eps, x, clip_min, clip_max), requires_grad=True)
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers).
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers).
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers).
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers).
Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers).
File path is /scratch/work/hakkina7/chest_xray/
Device is cuda
Model succesfully loaded from /scratch/work/hakkina7/chest_xray/inceptionV3.pth
Evaluating the inceptionV3.pth model on the test set.

##################################################################
No attack
Computing took ~0 minutes.

Classified 94.76 % of test images correctly.
##################################################################

Precision on test set: 0.96
Recall on test set: 0.96
F1-score on test set: 0.96
AUC score on test set: 0.99
Confusion matrix on test set:
                pred as NEG  pred as POS
true class NEG          214           23
true class POS           23          618


##################################################################
FGM
Computing took ~0 minutes.

Classified 61.96 % of test images correctly.
##################################################################


##################################################################
CW
Computing took ~494 minutes.

Classified 5.24 % of test images correctly.
##################################################################


##################################################################
PGD_with_1_iterations_and_0.02_eps
Computing took ~0 minutes.

Classified 53.19 % of test images correctly.
##################################################################


##################################################################
PGD_with_2_iterations_and_0.02_eps
Computing took ~0 minutes.

Classified 26.31 % of test images correctly.
##################################################################


##################################################################
PGD_with_5_iterations_and_0.02_eps
Computing took ~0 minutes.

Classified 9.34 % of test images correctly.
##################################################################


##################################################################
SPSA_with_5_iterations_and_0.02_eps
Computing took ~9 minutes.

Classified 94.53 % of test images correctly.
##################################################################


##################################################################
SPSA_with_5_iterations_and_0.05_eps
Computing took ~9 minutes.

Classified 94.65 % of test images correctly.
##################################################################


##################################################################
SPSA_with_5_iterations_and_0.1_eps
Computing took ~9 minutes.

Classified 92.37 % of test images correctly.
##################################################################


##################################################################
SPSA_with_5_iterations_and_0.5_eps
Computing took ~9 minutes.

Classified 26.99 % of test images correctly.
##################################################################


##################################################################
SPSA_with_5_iterations_and_1_eps
Computing took ~9 minutes.

Classified 26.99 % of test images correctly.
##################################################################

