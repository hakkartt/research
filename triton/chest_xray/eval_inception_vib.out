File path is /scratch/work/hakkina7/chest_xray/
Device is cuda
Pre-trained base models succesfully loaded from /scratch/work/hakkina7/chest_xray/inceptionV3.pth
==================================================================
BETA = 1e-10
==================================================================
Pretrained VIB succesfully loaded from /scratch/work/hakkina7/chest_xray/inceptionV3_vib_1e-10.pth
Evaluating the inceptionV3_vib_1e-10.pth model on the test set.

##################################################################
No attack
Computing took ~0 minutes.

Classified 94.65 % of test images correctly when perturbed images were created with 12 latent samples.
##################################################################


##################################################################
FGM
Computing took ~0 minutes.

Classified 63.55 % of test images correctly when perturbed images were created with 12 latent samples.
##################################################################


##################################################################
PGD_with_1_iterations_and_0.02_eps
Computing took ~0 minutes.

Classified 54.56 % of test images correctly when perturbed images were created with 12 latent samples.
##################################################################


##################################################################
PGD_with_2_iterations_and_0.02_eps
Computing took ~0 minutes.

Classified 27.11 % of test images correctly when perturbed images were created with 12 latent samples.
##################################################################


##################################################################
PGD_with_5_iterations_and_0.02_eps
Computing took ~0 minutes.

Classified 10.14 % of test images correctly when perturbed images were created with 12 latent samples.
##################################################################


##################################################################
SPSA_with_5_iterations_and_0.02_eps
Computing took ~22 minutes.

Classified 95.10 % of test images correctly when perturbed images were created with 12 latent samples.
##################################################################


##################################################################
SPSA_with_5_iterations_and_0.05_eps
Computing took ~22 minutes.

Classified 94.99 % of test images correctly when perturbed images were created with 12 latent samples.
##################################################################


##################################################################
SPSA_with_5_iterations_and_0.1_eps
Computing took ~22 minutes.

Classified 91.91 % of test images correctly when perturbed images were created with 12 latent samples.
##################################################################


##################################################################
SPSA_with_5_iterations_and_0.5_eps
Computing took ~22 minutes.

Classified 26.99 % of test images correctly when perturbed images were created with 12 latent samples.
##################################################################


##################################################################
SPSA_with_5_iterations_and_1_eps
Computing took ~22 minutes.

Classified 26.99 % of test images correctly when perturbed images were created with 12 latent samples.
##################################################################

==================================================================
BETA = 1e-09
==================================================================
Pretrained VIB succesfully loaded from /scratch/work/hakkina7/chest_xray/inceptionV3_vib_1e-09.pth
Evaluating the inceptionV3_vib_1e-09.pth model on the test set.

##################################################################
No attack
Computing took ~0 minutes.

Classified 94.99 % of test images correctly when perturbed images were created with 12 latent samples.
##################################################################


##################################################################
FGM
Computing took ~0 minutes.

Classified 64.81 % of test images correctly when perturbed images were created with 12 latent samples.
##################################################################


##################################################################
PGD_with_1_iterations_and_0.02_eps
Computing took ~0 minutes.

Classified 56.26 % of test images correctly when perturbed images were created with 12 latent samples.
##################################################################


##################################################################
PGD_with_2_iterations_and_0.02_eps
Computing took ~0 minutes.

Classified 29.27 % of test images correctly when perturbed images were created with 12 latent samples.
##################################################################


##################################################################
PGD_with_5_iterations_and_0.02_eps
Computing took ~0 minutes.

Classified 10.59 % of test images correctly when perturbed images were created with 12 latent samples.
##################################################################


##################################################################
SPSA_with_5_iterations_and_0.02_eps
Computing took ~22 minutes.

Classified 95.44 % of test images correctly when perturbed images were created with 12 latent samples.
##################################################################


##################################################################
SPSA_with_5_iterations_and_0.05_eps
Computing took ~22 minutes.

Classified 95.56 % of test images correctly when perturbed images were created with 12 latent samples.
##################################################################


##################################################################
SPSA_with_5_iterations_and_0.1_eps
Computing took ~22 minutes.

Classified 92.26 % of test images correctly when perturbed images were created with 12 latent samples.
##################################################################


##################################################################
SPSA_with_5_iterations_and_0.5_eps
Computing took ~22 minutes.

Classified 26.99 % of test images correctly when perturbed images were created with 12 latent samples.
##################################################################


##################################################################
SPSA_with_5_iterations_and_1_eps
Computing took ~22 minutes.

Classified 26.99 % of test images correctly when perturbed images were created with 12 latent samples.
##################################################################

==================================================================
BETA = 1e-08
==================================================================
Pretrained VIB succesfully loaded from /scratch/work/hakkina7/chest_xray/inceptionV3_vib_1e-08.pth
Evaluating the inceptionV3_vib_1e-08.pth model on the test set.

##################################################################
No attack
Computing took ~0 minutes.

Classified 94.65 % of test images correctly when perturbed images were created with 12 latent samples.
##################################################################


##################################################################
FGM
Computing took ~0 minutes.

Classified 63.90 % of test images correctly when perturbed images were created with 12 latent samples.
##################################################################


##################################################################
PGD_with_1_iterations_and_0.02_eps
Computing took ~0 minutes.

Classified 55.35 % of test images correctly when perturbed images were created with 12 latent samples.
##################################################################


##################################################################
PGD_with_2_iterations_and_0.02_eps
Computing took ~0 minutes.

Classified 29.16 % of test images correctly when perturbed images were created with 12 latent samples.
##################################################################


##################################################################
PGD_with_5_iterations_and_0.02_eps
Computing took ~0 minutes.

Classified 10.59 % of test images correctly when perturbed images were created with 12 latent samples.
##################################################################


##################################################################
SPSA_with_5_iterations_and_0.02_eps
Computing took ~22 minutes.

Classified 95.22 % of test images correctly when perturbed images were created with 12 latent samples.
##################################################################


##################################################################
SPSA_with_5_iterations_and_0.05_eps
Computing took ~22 minutes.

Classified 94.87 % of test images correctly when perturbed images were created with 12 latent samples.
##################################################################


##################################################################
SPSA_with_5_iterations_and_0.1_eps
Computing took ~22 minutes.

Classified 92.71 % of test images correctly when perturbed images were created with 12 latent samples.
##################################################################


##################################################################
SPSA_with_5_iterations_and_0.5_eps
Computing took ~22 minutes.

Classified 26.99 % of test images correctly when perturbed images were created with 12 latent samples.
##################################################################


##################################################################
SPSA_with_5_iterations_and_1_eps
Computing took ~22 minutes.

Classified 26.99 % of test images correctly when perturbed images were created with 12 latent samples.
##################################################################

==================================================================
BETA = 1e-07
==================================================================
Pretrained VIB succesfully loaded from /scratch/work/hakkina7/chest_xray/inceptionV3_vib_1e-07.pth
Evaluating the inceptionV3_vib_1e-07.pth model on the test set.

##################################################################
No attack
Computing took ~0 minutes.

Classified 94.65 % of test images correctly when perturbed images were created with 12 latent samples.
##################################################################


##################################################################
FGM
Computing took ~0 minutes.

Classified 62.87 % of test images correctly when perturbed images were created with 12 latent samples.
##################################################################


##################################################################
PGD_with_1_iterations_and_0.02_eps
Computing took ~0 minutes.

Classified 52.85 % of test images correctly when perturbed images were created with 12 latent samples.
##################################################################


##################################################################
PGD_with_2_iterations_and_0.02_eps
Computing took ~0 minutes.

Classified 24.72 % of test images correctly when perturbed images were created with 12 latent samples.
##################################################################


##################################################################
PGD_with_5_iterations_and_0.02_eps
Computing took ~0 minutes.

Classified 9.11 % of test images correctly when perturbed images were created with 12 latent samples.
##################################################################


##################################################################
SPSA_with_5_iterations_and_0.02_eps
Computing took ~22 minutes.

Classified 94.65 % of test images correctly when perturbed images were created with 12 latent samples.
##################################################################


##################################################################
SPSA_with_5_iterations_and_0.05_eps
Computing took ~22 minutes.

Classified 94.42 % of test images correctly when perturbed images were created with 12 latent samples.
##################################################################


##################################################################
SPSA_with_5_iterations_and_0.1_eps
Computing took ~22 minutes.

Classified 90.32 % of test images correctly when perturbed images were created with 12 latent samples.
##################################################################


##################################################################
SPSA_with_5_iterations_and_0.5_eps
Computing took ~22 minutes.

Classified 26.99 % of test images correctly when perturbed images were created with 12 latent samples.
##################################################################


##################################################################
SPSA_with_5_iterations_and_1_eps
Computing took ~22 minutes.

Classified 26.99 % of test images correctly when perturbed images were created with 12 latent samples.
##################################################################

==================================================================
BETA = 1e-06
==================================================================
Pretrained VIB succesfully loaded from /scratch/work/hakkina7/chest_xray/inceptionV3_vib_1e-06.pth
Evaluating the inceptionV3_vib_1e-06.pth model on the test set.

##################################################################
No attack
Computing took ~0 minutes.

Classified 95.44 % of test images correctly when perturbed images were created with 12 latent samples.
##################################################################


##################################################################
FGM
Computing took ~0 minutes.

Classified 64.24 % of test images correctly when perturbed images were created with 12 latent samples.
##################################################################


##################################################################
PGD_with_1_iterations_and_0.02_eps
Computing took ~0 minutes.

Classified 57.40 % of test images correctly when perturbed images were created with 12 latent samples.
##################################################################


##################################################################
PGD_with_2_iterations_and_0.02_eps
Computing took ~0 minutes.

Classified 31.09 % of test images correctly when perturbed images were created with 12 latent samples.
##################################################################


##################################################################
PGD_with_5_iterations_and_0.02_eps
Computing took ~0 minutes.

Classified 10.25 % of test images correctly when perturbed images were created with 12 latent samples.
##################################################################


##################################################################
SPSA_with_5_iterations_and_0.02_eps
Computing took ~22 minutes.

Classified 95.56 % of test images correctly when perturbed images were created with 12 latent samples.
##################################################################


##################################################################
SPSA_with_5_iterations_and_0.05_eps
Computing took ~22 minutes.

Classified 95.79 % of test images correctly when perturbed images were created with 12 latent samples.
##################################################################


##################################################################
SPSA_with_5_iterations_and_0.1_eps
Computing took ~22 minutes.

Classified 92.60 % of test images correctly when perturbed images were created with 12 latent samples.
##################################################################


##################################################################
SPSA_with_5_iterations_and_0.5_eps
Computing took ~22 minutes.

Classified 26.99 % of test images correctly when perturbed images were created with 12 latent samples.
##################################################################


##################################################################
SPSA_with_5_iterations_and_1_eps
Computing took ~22 minutes.

Classified 26.99 % of test images correctly when perturbed images were created with 12 latent samples.
##################################################################

==================================================================
BETA = 1e-05
==================================================================
Pretrained VIB succesfully loaded from /scratch/work/hakkina7/chest_xray/inceptionV3_vib_1e-05.pth
Evaluating the inceptionV3_vib_1e-05.pth model on the test set.

##################################################################
No attack
Computing took ~0 minutes.

Classified 94.87 % of test images correctly when perturbed images were created with 12 latent samples.
##################################################################


##################################################################
FGM
Computing took ~0 minutes.

Classified 64.58 % of test images correctly when perturbed images were created with 12 latent samples.
##################################################################


##################################################################
PGD_with_1_iterations_and_0.02_eps
Computing took ~0 minutes.

Classified 56.83 % of test images correctly when perturbed images were created with 12 latent samples.
##################################################################


##################################################################
PGD_with_2_iterations_and_0.02_eps
Computing took ~0 minutes.

Classified 31.78 % of test images correctly when perturbed images were created with 12 latent samples.
##################################################################


##################################################################
PGD_with_5_iterations_and_0.02_eps
Computing took ~0 minutes.

Classified 10.93 % of test images correctly when perturbed images were created with 12 latent samples.
##################################################################


##################################################################
SPSA_with_5_iterations_and_0.02_eps
Computing took ~22 minutes.

Classified 95.67 % of test images correctly when perturbed images were created with 12 latent samples.
##################################################################


##################################################################
SPSA_with_5_iterations_and_0.05_eps
Computing took ~22 minutes.

Classified 94.87 % of test images correctly when perturbed images were created with 12 latent samples.
##################################################################


##################################################################
SPSA_with_5_iterations_and_0.1_eps
Computing took ~22 minutes.

Classified 92.82 % of test images correctly when perturbed images were created with 12 latent samples.
##################################################################


##################################################################
SPSA_with_5_iterations_and_0.5_eps
Computing took ~22 minutes.

Classified 26.99 % of test images correctly when perturbed images were created with 12 latent samples.
##################################################################


##################################################################
SPSA_with_5_iterations_and_1_eps
Computing took ~22 minutes.

Classified 26.99 % of test images correctly when perturbed images were created with 12 latent samples.
##################################################################

==================================================================
BETA = 0.0001
==================================================================
Pretrained VIB succesfully loaded from /scratch/work/hakkina7/chest_xray/inceptionV3_vib_0.0001.pth
Evaluating the inceptionV3_vib_0.0001.pth model on the test set.

##################################################################
No attack
Computing took ~0 minutes.

Classified 95.44 % of test images correctly when perturbed images were created with 12 latent samples.
##################################################################


##################################################################
FGM
Computing took ~0 minutes.

Classified 65.38 % of test images correctly when perturbed images were created with 12 latent samples.
##################################################################


##################################################################
PGD_with_1_iterations_and_0.02_eps
Computing took ~0 minutes.

Classified 57.18 % of test images correctly when perturbed images were created with 12 latent samples.
##################################################################


##################################################################
PGD_with_2_iterations_and_0.02_eps
Computing took ~0 minutes.

Classified 32.23 % of test images correctly when perturbed images were created with 12 latent samples.
##################################################################


##################################################################
PGD_with_5_iterations_and_0.02_eps
Computing took ~0 minutes.

Classified 10.59 % of test images correctly when perturbed images were created with 12 latent samples.
##################################################################


##################################################################
SPSA_with_5_iterations_and_0.02_eps
Computing took ~22 minutes.

Classified 95.44 % of test images correctly when perturbed images were created with 12 latent samples.
##################################################################


##################################################################
SPSA_with_5_iterations_and_0.05_eps
Computing took ~22 minutes.

Classified 94.31 % of test images correctly when perturbed images were created with 12 latent samples.
##################################################################


##################################################################
SPSA_with_5_iterations_and_0.1_eps
Computing took ~22 minutes.

Classified 92.71 % of test images correctly when perturbed images were created with 12 latent samples.
##################################################################


##################################################################
SPSA_with_5_iterations_and_0.5_eps
Computing took ~22 minutes.

Classified 26.99 % of test images correctly when perturbed images were created with 12 latent samples.
##################################################################


##################################################################
SPSA_with_5_iterations_and_1_eps
Computing took ~22 minutes.

Classified 26.99 % of test images correctly when perturbed images were created with 12 latent samples.
##################################################################

==================================================================
BETA = 0.001
==================================================================
Pretrained VIB succesfully loaded from /scratch/work/hakkina7/chest_xray/inceptionV3_vib_0.001.pth
Evaluating the inceptionV3_vib_0.001.pth model on the test set.

##################################################################
No attack
Computing took ~0 minutes.

Classified 95.79 % of test images correctly when perturbed images were created with 12 latent samples.
##################################################################


##################################################################
FGM
Computing took ~0 minutes.

Classified 64.81 % of test images correctly when perturbed images were created with 12 latent samples.
##################################################################


##################################################################
PGD_with_1_iterations_and_0.02_eps
Computing took ~0 minutes.

Classified 57.63 % of test images correctly when perturbed images were created with 12 latent samples.
##################################################################


##################################################################
PGD_with_2_iterations_and_0.02_eps
Computing took ~0 minutes.

Classified 32.00 % of test images correctly when perturbed images were created with 12 latent samples.
##################################################################


##################################################################
PGD_with_5_iterations_and_0.02_eps
Computing took ~0 minutes.

Classified 10.93 % of test images correctly when perturbed images were created with 12 latent samples.
##################################################################


##################################################################
SPSA_with_5_iterations_and_0.02_eps
Computing took ~22 minutes.

Classified 95.67 % of test images correctly when perturbed images were created with 12 latent samples.
##################################################################


##################################################################
SPSA_with_5_iterations_and_0.05_eps
Computing took ~22 minutes.

Classified 94.99 % of test images correctly when perturbed images were created with 12 latent samples.
##################################################################


##################################################################
SPSA_with_5_iterations_and_0.1_eps
Computing took ~22 minutes.

Classified 92.03 % of test images correctly when perturbed images were created with 12 latent samples.
##################################################################


##################################################################
SPSA_with_5_iterations_and_0.5_eps
Computing took ~22 minutes.

Classified 27.11 % of test images correctly when perturbed images were created with 12 latent samples.
##################################################################


##################################################################
SPSA_with_5_iterations_and_1_eps
Computing took ~22 minutes.

Classified 26.99 % of test images correctly when perturbed images were created with 12 latent samples.
##################################################################

==================================================================
BETA = 0.01
==================================================================
Pretrained VIB succesfully loaded from /scratch/work/hakkina7/chest_xray/inceptionV3_vib_0.01.pth
Evaluating the inceptionV3_vib_0.01.pth model on the test set.

##################################################################
No attack
Computing took ~0 minutes.

Classified 94.19 % of test images correctly when perturbed images were created with 12 latent samples.
##################################################################


##################################################################
FGM
Computing took ~0 minutes.

Classified 64.24 % of test images correctly when perturbed images were created with 12 latent samples.
##################################################################


##################################################################
PGD_with_1_iterations_and_0.02_eps
Computing took ~0 minutes.

Classified 54.21 % of test images correctly when perturbed images were created with 12 latent samples.
##################################################################


##################################################################
PGD_with_2_iterations_and_0.02_eps
Computing took ~0 minutes.

Classified 24.60 % of test images correctly when perturbed images were created with 12 latent samples.
##################################################################


##################################################################
PGD_with_5_iterations_and_0.02_eps
Computing took ~0 minutes.

Classified 10.02 % of test images correctly when perturbed images were created with 12 latent samples.
##################################################################


##################################################################
SPSA_with_5_iterations_and_0.02_eps
Computing took ~22 minutes.

Classified 94.08 % of test images correctly when perturbed images were created with 12 latent samples.
##################################################################


##################################################################
SPSA_with_5_iterations_and_0.05_eps
Computing took ~22 minutes.

Classified 94.65 % of test images correctly when perturbed images were created with 12 latent samples.
##################################################################


##################################################################
SPSA_with_5_iterations_and_0.1_eps
Computing took ~22 minutes.

Classified 91.12 % of test images correctly when perturbed images were created with 12 latent samples.
##################################################################


##################################################################
SPSA_with_5_iterations_and_0.5_eps
Computing took ~22 minutes.

Classified 26.99 % of test images correctly when perturbed images were created with 12 latent samples.
##################################################################


##################################################################
SPSA_with_5_iterations_and_1_eps
Computing took ~22 minutes.

Classified 26.99 % of test images correctly when perturbed images were created with 12 latent samples.
##################################################################

==================================================================
BETA = 0.1
==================================================================
Pretrained VIB succesfully loaded from /scratch/work/hakkina7/chest_xray/inceptionV3_vib_0.1.pth
Evaluating the inceptionV3_vib_0.1.pth model on the test set.

##################################################################
No attack
Computing took ~0 minutes.

Classified 94.31 % of test images correctly when perturbed images were created with 12 latent samples.
##################################################################


##################################################################
FGM
Computing took ~0 minutes.

Classified 66.86 % of test images correctly when perturbed images were created with 12 latent samples.
##################################################################


##################################################################
PGD_with_1_iterations_and_0.02_eps
Computing took ~0 minutes.

Classified 56.15 % of test images correctly when perturbed images were created with 12 latent samples.
##################################################################


##################################################################
PGD_with_2_iterations_and_0.02_eps
Computing took ~0 minutes.

Classified 26.65 % of test images correctly when perturbed images were created with 12 latent samples.
##################################################################


##################################################################
PGD_with_5_iterations_and_0.02_eps
Computing took ~0 minutes.

Classified 10.71 % of test images correctly when perturbed images were created with 12 latent samples.
##################################################################


##################################################################
SPSA_with_5_iterations_and_0.02_eps
Computing took ~22 minutes.

Classified 94.31 % of test images correctly when perturbed images were created with 12 latent samples.
##################################################################


##################################################################
SPSA_with_5_iterations_and_0.05_eps
Computing took ~22 minutes.

Classified 94.31 % of test images correctly when perturbed images were created with 12 latent samples.
##################################################################


##################################################################
SPSA_with_5_iterations_and_0.1_eps
Computing took ~22 minutes.

Classified 90.66 % of test images correctly when perturbed images were created with 12 latent samples.
##################################################################


##################################################################
SPSA_with_5_iterations_and_0.5_eps
Computing took ~22 minutes.

Classified 26.99 % of test images correctly when perturbed images were created with 12 latent samples.
##################################################################


##################################################################
SPSA_with_5_iterations_and_1_eps
Computing took ~22 minutes.

Classified 26.99 % of test images correctly when perturbed images were created with 12 latent samples.
##################################################################

/home/hakkina7/.local/lib/python3.8/site-packages/torchvision/models/inception.py:81: FutureWarning: The default weight initialization of inception_v3 will be changed in future releases of torchvision. If you wish to keep the old behavior (which leads to long initialization times due to scipy/scipy#11299), please set init_weights=True.
  warnings.warn('The default weight initialization of inception_v3 will be changed in future releases of '
/home/hakkina7/.local/lib/python3.8/site-packages/cleverhans/torch/attacks/spsa.py:122: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  perturbation = torch.tensor(_project_perturbation(perturbation, norm, eps, x, clip_min, clip_max), requires_grad=True)
/home/hakkina7/.local/lib/python3.8/site-packages/cleverhans/torch/attacks/spsa.py:141: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  perturbation = torch.tensor(_project_perturbation(perturbation, norm, eps, x, clip_min, clip_max), requires_grad=True)
